{"version":3,"file":"bundle.9z98d53gpt.js","sources":["../../node_modules/svelte/internal/index.mjs","../../node_modules/svelte/store/index.mjs","../../demo/iframe/stores.js","../../dist/wasmboy.wasm.esm.js","../../demo/iframe/components/PlayPoster.svelte","../../demo/iframe/components/WasmBoy.svelte","../../demo/iframe/components/LoadState.svelte","../../demo/iframe/components/About.svelte","../../demo/iframe/components/Modal.svelte","../../demo/iframe/components/ControlsBar.svelte","../../demo/iframe/components/touchpad/GameBoyLetterButton.svelte","../../demo/iframe/components/touchpad/GameBoyWordButton.svelte","../../demo/iframe/components/touchpad/GameBoyTouchPad.svelte","../../node_modules/devtools-detect/index.js","../../demo/iframe/scripts/layout-change.js","../../demo/iframe/scripts/hotkeys.js","../../node_modules/load-script/index.js","../../demo/iframe/scripts/load-analytics.js","../../demo/iframe/App.svelte","../../demo/iframe/index.js"],"sourcesContent":["function noop() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction is_promise(value) {\n    return value && typeof value === 'object' && typeof value.then === 'function';\n}\nfunction add_location(element, file, line, column, char) {\n    element.__svelte_meta = {\n        loc: { file, line, column, char }\n    };\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction not_equal(a, b) {\n    return a != a ? b == b : a !== b;\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction validate_store(store, name) {\n    if (store != null && typeof store.subscribe !== 'function') {\n        throw new Error(`'${name}' is not a store with a 'subscribe' method`);\n    }\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction compute_rest_props(props, keys) {\n    const rest = {};\n    keys = new Set(keys);\n    for (const k in props)\n        if (!keys.has(k) && k[0] !== '$')\n            rest[k] = props[k];\n    return rest;\n}\nfunction compute_slots(slots) {\n    const result = {};\n    for (const key in slots) {\n        result[key] = true;\n    }\n    return result;\n}\nfunction once(fn) {\n    let ran = false;\n    return function (...args) {\n        if (ran)\n            return;\n        ran = true;\n        fn.call(this, ...args);\n    };\n}\nfunction null_to_empty(value) {\n    return value == null ? '' : value;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nconst has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop;\n// used internally for testing\nfunction set_now(fn) {\n    now = fn;\n}\nfunction set_raf(fn) {\n    raf = fn;\n}\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * For testing purposes only!\n */\nfunction clear_loops() {\n    tasks.clear();\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction destroy_each(iterations, detaching) {\n    for (let i = 0; i < iterations.length; i += 1) {\n        if (iterations[i])\n            iterations[i].d(detaching);\n    }\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction element_is(name, is) {\n    return document.createElement(name, { is });\n}\nfunction object_without_properties(obj, exclude) {\n    const target = {};\n    for (const k in obj) {\n        if (has_prop(obj, k)\n            // @ts-ignore\n            && exclude.indexOf(k) === -1) {\n            // @ts-ignore\n            target[k] = obj[k];\n        }\n    }\n    return target;\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction self(fn) {\n    return function (event) {\n        // @ts-ignore\n        if (event.target === this)\n            fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction set_svg_attributes(node, attributes) {\n    for (const key in attributes) {\n        attr(node, key, attributes[key]);\n    }\n}\nfunction set_custom_element_data(node, prop, value) {\n    if (prop in node) {\n        node[prop] = value;\n    }\n    else {\n        attr(node, prop, value);\n    }\n}\nfunction xlink_attr(node, attribute, value) {\n    node.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\nfunction get_binding_group_value(group, __value, checked) {\n    const value = new Set();\n    for (let i = 0; i < group.length; i += 1) {\n        if (group[i].checked)\n            value.add(group[i].__value);\n    }\n    if (!checked) {\n        value.delete(__value);\n    }\n    return Array.from(value);\n}\nfunction to_number(value) {\n    return value === '' ? null : +value;\n}\nfunction time_ranges_to_array(ranges) {\n    const array = [];\n    for (let i = 0; i < ranges.length; i += 1) {\n        array.push({ start: ranges.start(i), end: ranges.end(i) });\n    }\n    return array;\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction claim_element(nodes, name, attributes, svg) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeName === name) {\n            let j = 0;\n            const remove = [];\n            while (j < node.attributes.length) {\n                const attribute = node.attributes[j++];\n                if (!attributes[attribute.name]) {\n                    remove.push(attribute.name);\n                }\n            }\n            for (let k = 0; k < remove.length; k++) {\n                node.removeAttribute(remove[k]);\n            }\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return svg ? svg_element(name) : element(name);\n}\nfunction claim_text(nodes, data) {\n    for (let i = 0; i < nodes.length; i += 1) {\n        const node = nodes[i];\n        if (node.nodeType === 3) {\n            node.data = '' + data;\n            return nodes.splice(i, 1)[0];\n        }\n    }\n    return text(data);\n}\nfunction claim_space(nodes) {\n    return claim_text(nodes, ' ');\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_input_type(input, type) {\n    try {\n        input.type = type;\n    }\n    catch (e) {\n        // do nothing\n    }\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction select_option(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        if (option.__value === value) {\n            option.selected = true;\n            return;\n        }\n    }\n}\nfunction select_options(select, value) {\n    for (let i = 0; i < select.options.length; i += 1) {\n        const option = select.options[i];\n        option.selected = ~value.indexOf(option.__value);\n    }\n}\nfunction select_value(select) {\n    const selected_option = select.querySelector(':checked') || select.options[0];\n    return selected_option && selected_option.__value;\n}\nfunction select_multiple_value(select) {\n    return [].map.call(select.querySelectorAll(':checked'), option => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\nlet crossorigin;\nfunction is_crossorigin() {\n    if (crossorigin === undefined) {\n        crossorigin = false;\n        try {\n            if (typeof window !== 'undefined' && window.parent) {\n                void window.parent.document;\n            }\n        }\n        catch (error) {\n            crossorigin = true;\n        }\n    }\n    return crossorigin;\n}\nfunction add_resize_listener(node, fn) {\n    const computed_style = getComputedStyle(node);\n    const z_index = (parseInt(computed_style.zIndex) || 0) - 1;\n    if (computed_style.position === 'static') {\n        node.style.position = 'relative';\n    }\n    const iframe = element('iframe');\n    iframe.setAttribute('style', `display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ` +\n        `overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: ${z_index};`);\n    iframe.setAttribute('aria-hidden', 'true');\n    iframe.tabIndex = -1;\n    const crossorigin = is_crossorigin();\n    let unsubscribe;\n    if (crossorigin) {\n        iframe.src = `data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>`;\n        unsubscribe = listen(window, 'message', (event) => {\n            if (event.source === iframe.contentWindow)\n                fn();\n        });\n    }\n    else {\n        iframe.src = 'about:blank';\n        iframe.onload = () => {\n            unsubscribe = listen(iframe.contentWindow, 'resize', fn);\n        };\n    }\n    append(node, iframe);\n    return () => {\n        if (crossorigin) {\n            unsubscribe();\n        }\n        else if (unsubscribe && iframe.contentWindow) {\n            unsubscribe();\n        }\n        detach(iframe);\n    };\n}\nfunction toggle_class(element, name, toggle) {\n    element.classList[toggle ? 'add' : 'remove'](name);\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\nfunction query_selector_all(selector, parent = document.body) {\n    return Array.from(parent.querySelectorAll(selector));\n}\nclass HtmlTag {\n    constructor(anchor = null) {\n        this.a = anchor;\n        this.e = this.n = null;\n    }\n    m(html, target, anchor = null) {\n        if (!this.e) {\n            this.e = element(target.nodeName);\n            this.t = target;\n            this.h(html);\n        }\n        this.i(anchor);\n    }\n    h(html) {\n        this.e.innerHTML = html;\n        this.n = Array.from(this.e.childNodes);\n    }\n    i(anchor) {\n        for (let i = 0; i < this.n.length; i += 1) {\n            insert(this.t, this.n[i], anchor);\n        }\n    }\n    p(html) {\n        this.d();\n        this.h(html);\n        this.i(this.a);\n    }\n    d() {\n        this.n.forEach(detach);\n    }\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ``}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nfunction create_animation(node, from, fn, params) {\n    if (!from)\n        return noop;\n    const to = node.getBoundingClientRect();\n    if (from.left === to.left && from.right === to.right && from.top === to.top && from.bottom === to.bottom)\n        return noop;\n    const { delay = 0, duration = 300, easing = identity, \n    // @ts-ignore todo: should this be separated from destructuring? Or start/end added to public api and documentation?\n    start: start_time = now() + delay, \n    // @ts-ignore todo:\n    end = start_time + duration, tick = noop, css } = fn(node, { from, to }, params);\n    let running = true;\n    let started = false;\n    let name;\n    function start() {\n        if (css) {\n            name = create_rule(node, 0, 1, duration, delay, easing, css);\n        }\n        if (!delay) {\n            started = true;\n        }\n    }\n    function stop() {\n        if (css)\n            delete_rule(node, name);\n        running = false;\n    }\n    loop(now => {\n        if (!started && now >= start_time) {\n            started = true;\n        }\n        if (started && now >= end) {\n            tick(1, 0);\n            stop();\n        }\n        if (!running) {\n            return false;\n        }\n        if (started) {\n            const p = now - start_time;\n            const t = 0 + 1 * easing(p / duration);\n            tick(t, 1 - t);\n        }\n        return true;\n    });\n    start();\n    tick(0, 1);\n    return stop;\n}\nfunction fix_position(node) {\n    const style = getComputedStyle(node);\n    if (style.position !== 'absolute' && style.position !== 'fixed') {\n        const { width, height } = style;\n        const a = node.getBoundingClientRect();\n        node.style.position = 'absolute';\n        node.style.width = width;\n        node.style.height = height;\n        add_transform(node, a);\n    }\n}\nfunction add_transform(node, a) {\n    const b = node.getBoundingClientRect();\n    if (a.left !== b.left || a.top !== b.top) {\n        const style = getComputedStyle(node);\n        const transform = style.transform === 'none' ? '' : style.transform;\n        node.style.transform = `${transform} translate(${a.left - b.left}px, ${a.top - b.top}px)`;\n    }\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error(`Function called outside component initialization`);\n    return current_component;\n}\nfunction beforeUpdate(fn) {\n    get_current_component().$$.before_update.push(fn);\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst intros = { enabled: false };\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction tick() {\n    schedule_update();\n    return resolved_promise;\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_in_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = false;\n    let animation_name;\n    let task;\n    let uid = 0;\n    function cleanup() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n        tick(0, 1);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        if (task)\n            task.abort();\n        running = true;\n        add_render_callback(() => dispatch(node, true, 'start'));\n        task = loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(1, 0);\n                    dispatch(node, true, 'end');\n                    cleanup();\n                    return running = false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(t, 1 - t);\n                }\n            }\n            return running;\n        });\n    }\n    let started = false;\n    return {\n        start() {\n            if (started)\n                return;\n            delete_rule(node);\n            if (is_function(config)) {\n                config = config();\n                wait().then(go);\n            }\n            else {\n                go();\n            }\n        },\n        invalidate() {\n            started = false;\n        },\n        end() {\n            if (running) {\n                cleanup();\n                running = false;\n            }\n        }\n    };\n}\nfunction create_out_transition(node, fn, params) {\n    let config = fn(node, params);\n    let running = true;\n    let animation_name;\n    const group = outros;\n    group.r += 1;\n    function go() {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        if (css)\n            animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n        const start_time = now() + delay;\n        const end_time = start_time + duration;\n        add_render_callback(() => dispatch(node, false, 'start'));\n        loop(now => {\n            if (running) {\n                if (now >= end_time) {\n                    tick(0, 1);\n                    dispatch(node, false, 'end');\n                    if (!--group.r) {\n                        // this will result in `end()` being called,\n                        // so we don't need to clean up here\n                        run_all(group.c);\n                    }\n                    return false;\n                }\n                if (now >= start_time) {\n                    const t = easing((now - start_time) / duration);\n                    tick(1 - t, t);\n                }\n            }\n            return running;\n        });\n    }\n    if (is_function(config)) {\n        wait().then(() => {\n            // @ts-ignore\n            config = config();\n            go();\n        });\n    }\n    else {\n        go();\n    }\n    return {\n        end(reset) {\n            if (reset && config.tick) {\n                config.tick(1, 0);\n            }\n            if (running) {\n                if (animation_name)\n                    delete_rule(node, animation_name);\n                running = false;\n            }\n        }\n    };\n}\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro — we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro — needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nfunction handle_promise(promise, info) {\n    const token = info.token = {};\n    function update(type, index, key, value) {\n        if (info.token !== token)\n            return;\n        info.resolved = value;\n        let child_ctx = info.ctx;\n        if (key !== undefined) {\n            child_ctx = child_ctx.slice();\n            child_ctx[key] = value;\n        }\n        const block = type && (info.current = type)(child_ctx);\n        let needs_flush = false;\n        if (info.block) {\n            if (info.blocks) {\n                info.blocks.forEach((block, i) => {\n                    if (i !== index && block) {\n                        group_outros();\n                        transition_out(block, 1, 1, () => {\n                            info.blocks[i] = null;\n                        });\n                        check_outros();\n                    }\n                });\n            }\n            else {\n                info.block.d(1);\n            }\n            block.c();\n            transition_in(block, 1);\n            block.m(info.mount(), info.anchor);\n            needs_flush = true;\n        }\n        info.block = block;\n        if (info.blocks)\n            info.blocks[index] = block;\n        if (needs_flush) {\n            flush();\n        }\n    }\n    if (is_promise(promise)) {\n        const current_component = get_current_component();\n        promise.then(value => {\n            set_current_component(current_component);\n            update(info.then, 1, info.value, value);\n            set_current_component(null);\n        }, error => {\n            set_current_component(current_component);\n            update(info.catch, 2, info.error, error);\n            set_current_component(null);\n            if (!info.hasCatch) {\n                throw error;\n            }\n        });\n        // if we previously had a then/catch block, destroy it\n        if (info.current !== info.pending) {\n            update(info.pending, 0);\n            return true;\n        }\n    }\n    else {\n        if (info.current !== info.then) {\n            update(info.then, 1, info.value, promise);\n            return true;\n        }\n        info.resolved = promise;\n    }\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction fix_and_destroy_block(block, lookup) {\n    block.f();\n    destroy_block(block, lookup);\n}\nfunction fix_and_outro_and_destroy_block(block, lookup) {\n    block.f();\n    outro_and_destroy_block(block, lookup);\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\nfunction validate_each_keys(ctx, list, get_context, get_key) {\n    const keys = new Set();\n    for (let i = 0; i < list.length; i++) {\n        const key = get_key(get_context(ctx, list, i));\n        if (keys.has(key)) {\n            throw new Error(`Cannot have duplicate keys in a keyed each`);\n        }\n        keys.add(key);\n    }\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\n// source: https://html.spec.whatwg.org/multipage/indices.html\nconst boolean_attributes = new Set([\n    'allowfullscreen',\n    'allowpaymentrequest',\n    'async',\n    'autofocus',\n    'autoplay',\n    'checked',\n    'controls',\n    'default',\n    'defer',\n    'disabled',\n    'formnovalidate',\n    'hidden',\n    'ismap',\n    'loop',\n    'multiple',\n    'muted',\n    'nomodule',\n    'novalidate',\n    'open',\n    'playsinline',\n    'readonly',\n    'required',\n    'reversed',\n    'selected'\n]);\n\nconst invalid_attribute_name_character = /[\\s'\">/=\\u{FDD0}-\\u{FDEF}\\u{FFFE}\\u{FFFF}\\u{1FFFE}\\u{1FFFF}\\u{2FFFE}\\u{2FFFF}\\u{3FFFE}\\u{3FFFF}\\u{4FFFE}\\u{4FFFF}\\u{5FFFE}\\u{5FFFF}\\u{6FFFE}\\u{6FFFF}\\u{7FFFE}\\u{7FFFF}\\u{8FFFE}\\u{8FFFF}\\u{9FFFE}\\u{9FFFF}\\u{AFFFE}\\u{AFFFF}\\u{BFFFE}\\u{BFFFF}\\u{CFFFE}\\u{CFFFF}\\u{DFFFE}\\u{DFFFF}\\u{EFFFE}\\u{EFFFF}\\u{FFFFE}\\u{FFFFF}\\u{10FFFE}\\u{10FFFF}]/u;\n// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n// https://infra.spec.whatwg.org/#noncharacter\nfunction spread(args, classes_to_add) {\n    const attributes = Object.assign({}, ...args);\n    if (classes_to_add) {\n        if (attributes.class == null) {\n            attributes.class = classes_to_add;\n        }\n        else {\n            attributes.class += ' ' + classes_to_add;\n        }\n    }\n    let str = '';\n    Object.keys(attributes).forEach(name => {\n        if (invalid_attribute_name_character.test(name))\n            return;\n        const value = attributes[name];\n        if (value === true)\n            str += \" \" + name;\n        else if (boolean_attributes.has(name.toLowerCase())) {\n            if (value)\n                str += \" \" + name;\n        }\n        else if (value != null) {\n            str += ` ${name}=\"${String(value).replace(/\"/g, '&#34;').replace(/'/g, '&#39;')}\"`;\n        }\n    });\n    return str;\n}\nconst escaped = {\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;'\n};\nfunction escape(html) {\n    return String(html).replace(/[\"'&<>]/g, match => escaped[match]);\n}\nfunction each(items, fn) {\n    let str = '';\n    for (let i = 0; i < items.length; i += 1) {\n        str += fn(items[i], i);\n    }\n    return str;\n}\nconst missing_component = {\n    $$render: () => ''\n};\nfunction validate_component(component, name) {\n    if (!component || !component.$$render) {\n        if (name === 'svelte:component')\n            name += ' this={...}';\n        throw new Error(`<${name}> is not a valid SSR component. You may need to review your build config to ensure that dependencies are compiled, rather than imported as pre-compiled modules`);\n    }\n    return component;\n}\nfunction debug(file, line, column, values) {\n    console.log(`{@debug} ${file ? file + ' ' : ''}(${line}:${column})`); // eslint-disable-line no-console\n    console.log(values); // eslint-disable-line no-console\n    return '';\n}\nlet on_destroy;\nfunction create_ssr_component(fn) {\n    function $$render(result, props, bindings, slots) {\n        const parent_component = current_component;\n        const $$ = {\n            on_destroy,\n            context: new Map(parent_component ? parent_component.$$.context : []),\n            // these will be immediately discarded\n            on_mount: [],\n            before_update: [],\n            after_update: [],\n            callbacks: blank_object()\n        };\n        set_current_component({ $$ });\n        const html = fn(result, props, bindings, slots);\n        set_current_component(parent_component);\n        return html;\n    }\n    return {\n        render: (props = {}, options = {}) => {\n            on_destroy = [];\n            const result = { title: '', head: '', css: new Set() };\n            const html = $$render(result, props, {}, options);\n            run_all(on_destroy);\n            return {\n                html,\n                css: {\n                    code: Array.from(result.css).map(css => css.code).join('\\n'),\n                    map: null // TODO\n                },\n                head: result.title + result.head\n            };\n        },\n        $$render\n    };\n}\nfunction add_attribute(name, value, boolean) {\n    if (value == null || (boolean && !value))\n        return '';\n    return ` ${name}${value === true ? '' : `=${typeof value === 'string' ? JSON.stringify(escape(value)) : `\"${value}\"`}`}`;\n}\nfunction add_classes(classes) {\n    return classes ? ` class=\"${classes}\"` : ``;\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction claim_component(block, parent_nodes) {\n    block && block.l(parent_nodes);\n}\nfunction mount_component(component, target, anchor) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    // onMount happens before the initial afterUpdate\n    add_render_callback(() => {\n        const new_on_destroy = on_mount.map(run).filter(is_function);\n        if (on_destroy) {\n            on_destroy.push(...new_on_destroy);\n        }\n        else {\n            // Edge case - component was destroyed immediately,\n            // most likely as a result of a binding initialising\n            run_all(new_on_destroy);\n        }\n        component.$$.on_mount = [];\n    });\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const prop_values = options.props || {};\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, prop_values, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nlet SvelteElement;\nif (typeof HTMLElement === 'function') {\n    SvelteElement = class extends HTMLElement {\n        constructor() {\n            super();\n            this.attachShadow({ mode: 'open' });\n        }\n        connectedCallback() {\n            // @ts-ignore todo: improve typings\n            for (const key in this.$$.slotted) {\n                // @ts-ignore todo: improve typings\n                this.appendChild(this.$$.slotted[key]);\n            }\n        }\n        attributeChangedCallback(attr, _oldValue, newValue) {\n            this[attr] = newValue;\n        }\n        $destroy() {\n            destroy_component(this, 1);\n            this.$destroy = noop;\n        }\n        $on(type, callback) {\n            // TODO should this delegate to addEventListener?\n            const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n            callbacks.push(callback);\n            return () => {\n                const index = callbacks.indexOf(callback);\n                if (index !== -1)\n                    callbacks.splice(index, 1);\n            };\n        }\n        $set($$props) {\n            if (this.$$set && !is_empty($$props)) {\n                this.$$.skip_bound = true;\n                this.$$set($$props);\n                this.$$.skip_bound = false;\n            }\n        }\n    };\n}\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nfunction dispatch_dev(type, detail) {\n    document.dispatchEvent(custom_event(type, Object.assign({ version: '3.29.0' }, detail)));\n}\nfunction append_dev(target, node) {\n    dispatch_dev(\"SvelteDOMInsert\", { target, node });\n    append(target, node);\n}\nfunction insert_dev(target, node, anchor) {\n    dispatch_dev(\"SvelteDOMInsert\", { target, node, anchor });\n    insert(target, node, anchor);\n}\nfunction detach_dev(node) {\n    dispatch_dev(\"SvelteDOMRemove\", { node });\n    detach(node);\n}\nfunction detach_between_dev(before, after) {\n    while (before.nextSibling && before.nextSibling !== after) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction detach_before_dev(after) {\n    while (after.previousSibling) {\n        detach_dev(after.previousSibling);\n    }\n}\nfunction detach_after_dev(before) {\n    while (before.nextSibling) {\n        detach_dev(before.nextSibling);\n    }\n}\nfunction listen_dev(node, event, handler, options, has_prevent_default, has_stop_propagation) {\n    const modifiers = options === true ? [\"capture\"] : options ? Array.from(Object.keys(options)) : [];\n    if (has_prevent_default)\n        modifiers.push('preventDefault');\n    if (has_stop_propagation)\n        modifiers.push('stopPropagation');\n    dispatch_dev(\"SvelteDOMAddEventListener\", { node, event, handler, modifiers });\n    const dispose = listen(node, event, handler, options);\n    return () => {\n        dispatch_dev(\"SvelteDOMRemoveEventListener\", { node, event, handler, modifiers });\n        dispose();\n    };\n}\nfunction attr_dev(node, attribute, value) {\n    attr(node, attribute, value);\n    if (value == null)\n        dispatch_dev(\"SvelteDOMRemoveAttribute\", { node, attribute });\n    else\n        dispatch_dev(\"SvelteDOMSetAttribute\", { node, attribute, value });\n}\nfunction prop_dev(node, property, value) {\n    node[property] = value;\n    dispatch_dev(\"SvelteDOMSetProperty\", { node, property, value });\n}\nfunction dataset_dev(node, property, value) {\n    node.dataset[property] = value;\n    dispatch_dev(\"SvelteDOMSetDataset\", { node, property, value });\n}\nfunction set_data_dev(text, data) {\n    data = '' + data;\n    if (text.wholeText === data)\n        return;\n    dispatch_dev(\"SvelteDOMSetData\", { node: text, data });\n    text.data = data;\n}\nfunction validate_each_argument(arg) {\n    if (typeof arg !== 'string' && !(arg && typeof arg === 'object' && 'length' in arg)) {\n        let msg = '{#each} only iterates over array-like objects.';\n        if (typeof Symbol === 'function' && arg && Symbol.iterator in arg) {\n            msg += ' You can use a spread to convert this iterable into an array.';\n        }\n        throw new Error(msg);\n    }\n}\nfunction validate_slots(name, slot, keys) {\n    for (const slot_key of Object.keys(slot)) {\n        if (!~keys.indexOf(slot_key)) {\n            console.warn(`<${name}> received an unexpected slot \"${slot_key}\".`);\n        }\n    }\n}\nclass SvelteComponentDev extends SvelteComponent {\n    constructor(options) {\n        if (!options || (!options.target && !options.$$inline)) {\n            throw new Error(`'target' is a required option`);\n        }\n        super();\n    }\n    $destroy() {\n        super.$destroy();\n        this.$destroy = () => {\n            console.warn(`Component was already destroyed`); // eslint-disable-line no-console\n        };\n    }\n    $capture_state() { }\n    $inject_state() { }\n}\nfunction loop_guard(timeout) {\n    const start = Date.now();\n    return () => {\n        if (Date.now() - start > timeout) {\n            throw new Error(`Infinite loop detected`);\n        }\n    };\n}\n\nexport { HtmlTag, SvelteComponent, SvelteComponentDev, SvelteElement, action_destroyer, add_attribute, add_classes, add_flush_callback, add_location, add_render_callback, add_resize_listener, add_transform, afterUpdate, append, append_dev, assign, attr, attr_dev, beforeUpdate, bind, binding_callbacks, blank_object, bubble, check_outros, children, claim_component, claim_element, claim_space, claim_text, clear_loops, component_subscribe, compute_rest_props, compute_slots, createEventDispatcher, create_animation, create_bidirectional_transition, create_component, create_in_transition, create_out_transition, create_slot, create_ssr_component, current_component, custom_event, dataset_dev, debug, destroy_block, destroy_component, destroy_each, detach, detach_after_dev, detach_before_dev, detach_between_dev, detach_dev, dirty_components, dispatch_dev, each, element, element_is, empty, escape, escaped, exclude_internal_props, fix_and_destroy_block, fix_and_outro_and_destroy_block, fix_position, flush, getContext, get_binding_group_value, get_current_component, get_slot_changes, get_slot_context, get_spread_object, get_spread_update, get_store_value, globals, group_outros, handle_promise, has_prop, identity, init, insert, insert_dev, intros, invalid_attribute_name_character, is_client, is_crossorigin, is_empty, is_function, is_promise, listen, listen_dev, loop, loop_guard, missing_component, mount_component, noop, not_equal, now, null_to_empty, object_without_properties, onDestroy, onMount, once, outro_and_destroy_block, prevent_default, prop_dev, query_selector_all, raf, run, run_all, safe_not_equal, schedule_update, select_multiple_value, select_option, select_options, select_value, self, setContext, set_attributes, set_current_component, set_custom_element_data, set_data, set_data_dev, set_input_type, set_input_value, set_now, set_raf, set_store_value, set_style, set_svg_attributes, space, spread, stop_propagation, subscribe, svg_element, text, tick, time_ranges_to_array, to_number, toggle_class, transition_in, transition_out, update_keyed_each, update_slot, validate_component, validate_each_argument, validate_each_keys, validate_slots, validate_store, xlink_attr };\n","import { noop, safe_not_equal, subscribe, run_all, is_function } from '../internal';\nexport { get_store_value as get } from '../internal';\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop) {\n    let stop;\n    const subscribers = [];\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (let i = 0; i < subscribers.length; i += 1) {\n                    const s = subscribers[i];\n                    s[1]();\n                    subscriber_queue.push(s, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop) {\n        const subscriber = [run, invalidate];\n        subscribers.push(subscriber);\n        if (subscribers.length === 1) {\n            stop = start(set) || noop;\n        }\n        run(value);\n        return () => {\n            const index = subscribers.indexOf(subscriber);\n            if (index !== -1) {\n                subscribers.splice(index, 1);\n            }\n            if (subscribers.length === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nexport { derived, readable, writable };\n","import { writable, readable } from 'svelte/store';\n\nexport const isStarted = writable(false);\nexport const isLoaded = writable(false);\nexport const isPlaying = writable(false);\n\nexport const modalStore = writable(0);\nexport const hideModal = () => modalStore.set(0);\nexport const showLoadState = () => modalStore.set(1);\nexport const showAbout = () => modalStore.set(2);\n\nexport const saveState = writable(0);\nexport const triggerSaveState = () => saveState.update(value => value + 1);\n\n// Set the current status message\nlet statusMessage;\nlet statusTimeout;\nlet statusReadableSet;\nexport const status = readable(\n  {\n    message: statusMessage,\n    timeout: statusTimeout\n  },\n  set => {\n    statusReadableSet = set;\n    return () => {};\n  }\n);\nexport const setStatus = (message, timeout) => {\n  if (!timeout) {\n    timeout = 2000;\n  }\n\n  if (statusReadableSet) {\n    statusReadableSet({\n      message,\n      timeout\n    });\n  }\n};\n\n// Get our search params\nconst params = new URLSearchParams(document.location.search.substring(1));\nexport const playPoster = writable(params.get('play-poster'));\nexport const romUrl = writable(params.get('rom-url'));\nexport const romName = writable(params.get('rom-name'));\n\n// Handle showing and hiding the mobile controls\nconst isUserAgentMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\nexport const isTouchPadVisible = writable(!!isUserAgentMobile);\n\nexport const isFullScreen = writable(false);\n","// API For adding plugins for WasmBoy\n// Should follow the Rollup Plugin API\n// https://rollupjs.org/guide/en#plugins\n// Plugins have the following supported hooks\n// And properties\nconst WASMBOY_PLUGIN = {\n  name: 'wasmboy-plugin REQUIRED',\n  graphics: rgbaArray => {},\n  // Returns undefined. Edit object in place\n  audio: (audioContext, headAudioNode, channelId) => {},\n  // Return AudioNode, which will be connected to the destination node eventually.\n  saveState: saveStateObject => {},\n  // Returns undefined. Edit object in place.\n  canvas: (canvasElement, canvasContext, canvasImageData) => {},\n  // Returns undefined. Edit object in place.\n  breakpoint: () => {},\n  ready: () => {},\n  play: () => {},\n  pause: () => {},\n  loadedAndStarted: () => {}\n};\n\nclass WasmBoyPluginsService {\n  constructor() {\n    this.plugins = {};\n    this.pluginIdCounter = 0;\n  }\n\n  addPlugin(pluginObject) {\n    // Verify the plugin\n    if (!pluginObject && typeof pluginObject !== 'object') {\n      throw new Error('Invalid Plugin Object');\n    }\n\n    if (!pluginObject.name) {\n      throw new Error('Added plugin must have a \"name\" property');\n    } // Add the plugin to our plugin container\n\n\n    const id = this.pluginIdCounter;\n    this.plugins[this.pluginIdCounter] = pluginObject;\n    this.pluginIdCounter++; // Return a function to remove the plugin\n\n    return () => {\n      this.removePlugin(id);\n    };\n  }\n\n  removePlugin(id) {\n    delete this.plugins[id];\n  }\n\n  runHook(hookConfig) {\n    if (!WASMBOY_PLUGIN[hookConfig.key] || typeof WASMBOY_PLUGIN[hookConfig.key] !== 'function') {\n      throw new Error('No such hook as ' + hookConfig.key);\n    }\n\n    Object.keys(this.plugins).forEach(pluginKey => {\n      const plugin = this.plugins[pluginKey];\n\n      if (plugin[hookConfig.key]) {\n        let hookResponse = undefined;\n\n        try {\n          hookResponse = plugin[hookConfig.key].apply(null, hookConfig.params);\n        } catch (e) {\n          console.error(`There was an error running the '${hookConfig.key}' hook, on the ${plugin.name} plugin.`);\n          console.error(e);\n        }\n\n        if (hookConfig.callback) {\n          hookConfig.callback(hookResponse);\n        }\n      }\n    });\n  }\n\n}\n\nconst WasmBoyPlugins = new WasmBoyPluginsService();\n\n// Some shared constants by the graphics lib and worker\nconst GAMEBOY_CAMERA_WIDTH = 160;\nconst GAMEBOY_CAMERA_HEIGHT = 144;\n\nconst WORKER_MESSAGE_TYPE = {\n  CONNECT: 'CONNECT',\n  INSTANTIATE_WASM: 'INSTANTIATE_WASM',\n  CLEAR_MEMORY: 'CLEAR_MEMORY',\n  CLEAR_MEMORY_DONE: 'CLEAR_MEMORY_DONE',\n  GET_MEMORY: 'GET_MEMORY',\n  SET_MEMORY: 'SET_MEMORY',\n  SET_MEMORY_DONE: 'SET_MEMORY_DONE',\n  GET_CONSTANTS: 'GET_CONSTANTS',\n  GET_CONSTANTS_DONE: 'GET_CONSTANTS_DONE',\n  CONFIG: 'CONFIG',\n  RESET_AUDIO_QUEUE: 'RESET_AUDIO_QUEUE',\n  PLAY: 'PLAY',\n  BREAKPOINT: 'BREAKPOINT',\n  PAUSE: 'PAUSE',\n  UPDATED: 'UPDATED',\n  CRASHED: 'CRASHED',\n  SET_JOYPAD_STATE: 'SET_JOYPAD_STATE',\n  AUDIO_LATENCY: 'AUDIO_LATENCY',\n  RUN_WASM_EXPORT: 'RUN_WASM_EXPORT',\n  GET_WASM_MEMORY_SECTION: 'GET_WASM_MEMORY_SECTION',\n  GET_WASM_CONSTANT: 'GET_WASM_CONSTANT',\n  FORCE_OUTPUT_FRAME: 'FORCE_OUTPUT_FRAME',\n  SET_SPEED: 'SET_SPEED',\n  IS_GBC: 'IS_GBC'\n};\nconst WORKER_ID = {\n  LIB: 'LIB',\n  GRAPHICS: 'GRAPHICS',\n  MEMORY: 'MEMORY',\n  CONTROLLER: 'CONTROLLER',\n  AUDIO: 'AUDIO'\n};\nconst MEMORY_TYPE = {\n  BOOT_ROM: 'BOOT_ROM',\n  CARTRIDGE_RAM: 'CARTRIDGE_RAM',\n  CARTRIDGE_ROM: 'CARTRIDGE_ROM',\n  CARTRIDGE_HEADER: 'CARTRIDGE_HEADER',\n  GAMEBOY_MEMORY: 'GAMEBOY_MEMORY',\n  PALETTE_MEMORY: 'PALETTE_MEMORY',\n  INTERNAL_STATE: 'INTERNAL_STATE'\n};\n\nfunction getEventData(event) {\n  if (event.data) {\n    return event.data;\n  }\n\n  return event;\n}\n\n// Handles rendering graphics using the HTML5 Canvas\n// https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas\n\nclass WasmBoyGraphicsService {\n  constructor() {\n    this.worker = undefined;\n    this.updateGraphicsCallback = undefined;\n    this.frameQueue = undefined;\n    this.frameQueueRenderPromise = undefined;\n    this.canvasElement = undefined;\n    this.canvasContext = undefined;\n    this.canvasImageData = undefined;\n    this.imageDataArray = undefined;\n    this.imageDataArrayChanged = false;\n  }\n\n  initialize(canvasElement, updateGraphicsCallback) {\n    this.updateGraphicsCallback = updateGraphicsCallback; // Initialiuze our cached wasm constants\n    // WASMBOY_CURRENT_FRAME_OUTPUT_LOCATION = this.wasmInstance.exports.frameInProgressGRAPHICS_OUTPUT_LOCATION.valueOf();\n    // Reset our frame queue and render promises\n\n    this.frameQueue = [];\n\n    const initializeTask = async () => {\n      // Prepare our canvas\n      this.canvasElement = canvasElement;\n      this.canvasContext = this.canvasElement.getContext('2d');\n      this.canvasElement.width = GAMEBOY_CAMERA_WIDTH;\n      this.canvasElement.height = GAMEBOY_CAMERA_HEIGHT;\n      this.canvasImageData = this.canvasContext.createImageData(this.canvasElement.width, this.canvasElement.height); // Add some css for smooth 8-bit canvas scaling\n      // https://stackoverflow.com/questions/7615009/disable-interpolation-when-scaling-a-canvas\n      // https://caniuse.com/#feat=css-crisp-edges\n\n      this.canvasElement.style = `\n        image-rendering: optimizeSpeed;\n        image-rendering: -moz-crisp-edges;\n        image-rendering: -webkit-optimize-contrast;\n        image-rendering: -o-crisp-edges;\n        image-rendering: pixelated;\n        -ms-interpolation-mode: nearest-neighbor;\n      `; // Fill the canvas with a blank screen\n      // using client width since we are not requiring a width and height oin the canvas\n      // https://developer.mozilla.org/en-US/docs/Web/API/Element/clientWidth\n      // TODO: Mention respopnsive canvas scaling in the docs\n\n      this.canvasContext.clearRect(0, 0, this.canvasElement.width, this.canvasElement.height); // Doing set canvas here, as multiple sources can re-initialize the graphics\n      // TODO: Move setCanvas out of initialize :p\n\n      WasmBoyPlugins.runHook({\n        key: 'canvas',\n        params: [this.canvasElement, this.canvasContext, this.canvasImageData],\n        callback: response => {\n          if (!response) {\n            return;\n          }\n\n          if (response.canvasElement) {\n            this.canvasElement = response.canvasElement;\n          }\n\n          if (response.canvasContext) {\n            this.canvasContext = response.canvasContext;\n          }\n\n          if (response.canvasImageData) {\n            this.canvasImageData = response.canvasImageData;\n          }\n        }\n      }); // Finally make sure we set our constants for our worker\n\n      if (this.worker) {\n        await this.worker.postMessage({\n          type: WORKER_MESSAGE_TYPE.GET_CONSTANTS\n        });\n      }\n    };\n\n    return initializeTask();\n  } // Function to set our worker\n\n\n  setWorker(worker) {\n    this.worker = worker;\n    this.worker.addMessageListener(event => {\n      const eventData = getEventData(event);\n\n      switch (eventData.message.type) {\n        case WORKER_MESSAGE_TYPE.UPDATED:\n          {\n            this.imageDataArray = new Uint8ClampedArray(eventData.message.imageDataArrayBuffer);\n            this.imageDataArrayChanged = true;\n            return;\n          }\n      }\n    });\n  } // Function to render a frame\n  // Will add the frame to the frame queue to be rendered\n  // Returns the promise from this.drawFrameQueue\n  // Which resolves once all frames are rendered\n\n\n  renderFrame() {\n    // Check if we have new graphics to show\n    if (!this.imageDataArrayChanged) {\n      return;\n    }\n\n    this.imageDataArrayChanged = false; // Check for a callback for accessing image data\n\n    if (this.updateGraphicsCallback) {\n      this.updateGraphicsCallback(this.imageDataArray);\n    } // Set the imageDataArray to our plugins\n\n\n    WasmBoyPlugins.runHook({\n      key: 'graphics',\n      params: [this.imageDataArray],\n      callback: response => {\n        if (response) {\n          this.imageDataArray = response;\n        }\n      }\n    }); // Add our new imageData\n\n    this.canvasImageData.data.set(this.imageDataArray);\n    this.canvasContext.clearRect(0, 0, this.canvasElement.width, this.canvasElement.height);\n    this.canvasContext.putImageData(this.canvasImageData, 0, 0);\n  }\n\n}\n\nconst WasmBoyGraphics = new WasmBoyGraphicsService();\n\nfunction index(buffer, opt) {\n  opt = opt || {};\n\n  var numChannels = buffer.numberOfChannels;\n  var sampleRate = buffer.sampleRate;\n  var format = opt.float32 ? 3 : 1;\n  var bitDepth = format === 3 ? 32 : 16;\n\n  var result;\n  if (numChannels === 2) {\n    result = interleave(buffer.getChannelData(0), buffer.getChannelData(1));\n  } else {\n    result = buffer.getChannelData(0);\n  }\n\n  return encodeWAV(result, format, sampleRate, numChannels, bitDepth)\n}\n\nfunction encodeWAV (samples, format, sampleRate, numChannels, bitDepth) {\n  var bytesPerSample = bitDepth / 8;\n  var blockAlign = numChannels * bytesPerSample;\n\n  var buffer = new ArrayBuffer(44 + samples.length * bytesPerSample);\n  var view = new DataView(buffer);\n\n  /* RIFF identifier */\n  writeString(view, 0, 'RIFF');\n  /* RIFF chunk length */\n  view.setUint32(4, 36 + samples.length * bytesPerSample, true);\n  /* RIFF type */\n  writeString(view, 8, 'WAVE');\n  /* format chunk identifier */\n  writeString(view, 12, 'fmt ');\n  /* format chunk length */\n  view.setUint32(16, 16, true);\n  /* sample format (raw) */\n  view.setUint16(20, format, true);\n  /* channel count */\n  view.setUint16(22, numChannels, true);\n  /* sample rate */\n  view.setUint32(24, sampleRate, true);\n  /* byte rate (sample rate * block align) */\n  view.setUint32(28, sampleRate * blockAlign, true);\n  /* block align (channel count * bytes per sample) */\n  view.setUint16(32, blockAlign, true);\n  /* bits per sample */\n  view.setUint16(34, bitDepth, true);\n  /* data chunk identifier */\n  writeString(view, 36, 'data');\n  /* data chunk length */\n  view.setUint32(40, samples.length * bytesPerSample, true);\n  if (format === 1) { // Raw PCM\n    floatTo16BitPCM(view, 44, samples);\n  } else {\n    writeFloat32(view, 44, samples);\n  }\n\n  return buffer\n}\n\nfunction interleave (inputL, inputR) {\n  var length = inputL.length + inputR.length;\n  var result = new Float32Array(length);\n\n  var index = 0;\n  var inputIndex = 0;\n\n  while (index < length) {\n    result[index++] = inputL[inputIndex];\n    result[index++] = inputR[inputIndex];\n    inputIndex++;\n  }\n  return result\n}\n\nfunction writeFloat32 (output, offset, input) {\n  for (var i = 0; i < input.length; i++, offset += 4) {\n    output.setFloat32(offset, input[i], true);\n  }\n}\n\nfunction floatTo16BitPCM (output, offset, input) {\n  for (var i = 0; i < input.length; i++, offset += 2) {\n    var s = Math.max(-1, Math.min(1, input[i]));\n    output.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7FFF, true);\n  }\n}\n\nfunction writeString (view, offset, string) {\n  for (var i = 0; i < string.length; i++) {\n    view.setUint8(offset + i, string.charCodeAt(i));\n  }\n}\n\n// Gameboy Channel Output\n// Both of these make it sound off\n// Latency controls how much delay audio has, larger = more delay, goal is to be as small as possible\n// Time remaining controls how far ahead we can be., larger = more frames rendered before playing a new set of samples. goal is to be as small as possible. May want to adjust this number according to performance of device\n// These magic numbers just come from preference, can be set as options\n\nconst DEFAULT_AUDIO_LATENCY_IN_MILLI = 100; // Some constants that use the ones above that will allow for faster performance\n\nconst DEFAULT_AUDIO_LATENCY_IN_SECONDS = DEFAULT_AUDIO_LATENCY_IN_MILLI / 1000; // Seems like the super quiet popping, and the wace form spikes in the visualizer,\n// are caused by the sample rate :P\n// Thus need to figure out why that is.\n\nconst WASMBOY_SAMPLE_RATE = 44100;\nclass GbChannelWebAudio {\n  constructor(id) {\n    this.id = id;\n    this.audioContext = undefined;\n    this.audioBuffer = undefined; // The play time for our audio samples\n\n    this.audioPlaytime = undefined;\n    this.audioSources = []; // Gain Node for muting\n\n    this.gainNode = undefined;\n    this.muted = false;\n    this.libMuted = false; // Our buffer for recording PCM Samples as they come\n\n    this.recording = false;\n    this.recordingLeftBuffers = undefined;\n    this.recordingRightBuffers = undefined;\n    this.recordingAudioBuffer = undefined;\n    this.recordingAnchor = undefined;\n  }\n\n  createAudioContextIfNone() {\n    if (!this.audioContext && typeof window !== 'undefined') {\n      // Get our Audio context\n      this.audioContext = new (window.AudioContext || window.webkitAudioContext)(); // Set up our nodes\n      // Seems like closure compiler will optimize this out\n      // Thus, need to do a very specifc type check if statement here.\n\n      if (!!this.audioContext === true) {\n        this.gainNode = this.audioContext.createGain();\n      }\n    }\n  }\n\n  getCurrentTime() {\n    this.createAudioContextIfNone();\n\n    if (!this.audioContext) {\n      return;\n    }\n\n    return this.audioContext.currentTime;\n  }\n\n  getPlayTime() {\n    return this.audioPlaytime;\n  }\n\n  resumeAudioContext() {\n    this.createAudioContextIfNone();\n\n    if (!this.audioContext) {\n      return;\n    }\n\n    if (this.audioContext.state === 'suspended') {\n      this.audioContext.resume();\n      this.audioPlaytime = this.audioContext.currentTime;\n    }\n  }\n\n  playAudio(numberOfSamples, leftChannelBuffer, rightChannelBuffer, playbackRate, updateAudioCallback) {\n    if (!this.audioContext) {\n      return;\n    } // Get our buffers as floats\n\n\n    const leftChannelBufferAsFloat = new Float32Array(leftChannelBuffer);\n    const rightChannelBufferAsFloat = new Float32Array(rightChannelBuffer); // Create an audio buffer, with a left and right channel\n\n    this.audioBuffer = this.audioContext.createBuffer(2, numberOfSamples, WASMBOY_SAMPLE_RATE);\n\n    this._setSamplesToAudioBuffer(this.audioBuffer, leftChannelBufferAsFloat, rightChannelBufferAsFloat);\n\n    if (this.recording) {\n      this.recordingLeftBuffers.push(leftChannelBufferAsFloat);\n      this.recordingRightBuffers.push(rightChannelBufferAsFloat);\n    } // Get an AudioBufferSourceNode.\n    // This is the AudioNode to use when we want to play an AudioBuffer\n\n\n    let source = this.audioContext.createBufferSource(); // set the buffer in the AudioBufferSourceNode\n\n    source.buffer = this.audioBuffer; // Set our playback rate for time resetretching\n\n    source.playbackRate.setValueAtTime(playbackRate, this.audioContext.currentTime); // Set up our \"final node\", as in the one that will be connected\n    // to the destination (output)\n\n    let finalNode = source; // Call our callback/plugins, if we have one\n\n    if (updateAudioCallback) {\n      const responseNode = updateAudioCallback(this.audioContext, finalNode, this.id);\n\n      if (responseNode) {\n        finalNode = responseNode;\n      }\n    } // Call our plugins\n\n\n    WasmBoyPlugins.runHook({\n      key: 'audio',\n      params: [this.audioContext, finalNode, this.id],\n      callback: hookResponse => {\n        if (hookResponse) {\n          finalNode.connect(hookResponse);\n          finalNode = hookResponse;\n        }\n      }\n    }); // Lastly, apply our gain node to mute/unmute\n\n    if (this.gainNode) {\n      finalNode.connect(this.gainNode);\n      finalNode = this.gainNode;\n    } // connect the AudioBufferSourceNode to the\n    // destination so we can hear the sound\n\n\n    finalNode.connect(this.audioContext.destination); // Check if we made it in time\n    // Idea from: https://github.com/binji/binjgb/blob/master/demo/demo.js\n\n    let audioContextCurrentTime = this.audioContext.currentTime;\n    let audioContextCurrentTimeWithLatency = audioContextCurrentTime + DEFAULT_AUDIO_LATENCY_IN_SECONDS;\n    this.audioPlaytime = this.audioPlaytime || audioContextCurrentTimeWithLatency;\n\n    if (this.audioPlaytime < audioContextCurrentTime) {\n      // We took too long, or something happen and hiccup'd the emulator, reset audio playback times\n      this.cancelAllAudio();\n      this.audioPlaytime = audioContextCurrentTimeWithLatency;\n    } // start the source playing\n\n\n    source.start(this.audioPlaytime); // Set our new audio playtime goal\n\n    const sourcePlaybackLength = numberOfSamples / (WASMBOY_SAMPLE_RATE * playbackRate);\n    this.audioPlaytime = this.audioPlaytime + sourcePlaybackLength; // Cancel all audio sources on the tail that play before us\n\n    while (this.audioSources[this.audioSources.length - 1] && this.audioSources[this.audioSources.length - 1].playtime <= this.audioPlaytime) {\n      this.audioSources[this.audioSources.length - 1].source.stop();\n      this.audioSources.pop();\n    } // Add the source so we can stop this if needed\n\n\n    this.audioSources.push({\n      source: source,\n      playTime: this.audioPlaytime\n    }); // Shift ourselves out when finished\n\n    const timeUntilSourceEnds = this.audioPlaytime - this.audioContext.currentTime + 500;\n    setTimeout(() => {\n      this.audioSources.shift();\n    }, timeUntilSourceEnds);\n  }\n\n  cancelAllAudio(stopCurrentAudio) {\n    if (!this.audioContext) {\n      return;\n    } // Cancel all audio That was queued to play\n\n\n    for (let i = 0; i < this.audioSources.length; i++) {\n      if (stopCurrentAudio || this.audioSources[i].playTime > this.audioPlaytime) {\n        this.audioSources[i].source.stop();\n      }\n    }\n\n    this.audioSources = []; // Reset our audioPlaytime\n\n    this.audioPlaytime = this.audioContext.currentTime + DEFAULT_AUDIO_LATENCY_IN_SECONDS;\n  }\n\n  mute() {\n    if (!this.muted) {\n      this._setGain(0);\n\n      this.muted = true;\n    }\n  }\n\n  unmute() {\n    if (this.muted) {\n      this._setGain(1);\n\n      this.muted = false;\n    }\n  }\n\n  hasRecording() {\n    return !!this.recordingAudioBuffer;\n  }\n\n  startRecording() {\n    if (!this.recording) {\n      this.recording = true;\n      this.recordingLeftBuffers = [];\n      this.recordingRightBuffers = [];\n      this.recordingAudioBuffer = undefined;\n    }\n  }\n\n  stopRecording() {\n    // Check if we were recoridng\n    if (!this.recording) {\n      return;\n    }\n\n    this.recording = false; // Create a left/right buffer from all the buffers stored\n\n    const createBufferFromBuffers = buffers => {\n      let totalLength = 0;\n      buffers.forEach(buffer => {\n        totalLength += buffer.length;\n      });\n      const totalBuffer = new Float32Array(totalLength);\n      let currentLength = 0;\n      buffers.forEach(buffer => {\n        totalBuffer.set(buffer, currentLength);\n        currentLength += buffer.length;\n      });\n      return totalBuffer;\n    };\n\n    const totalLeftBuffer = createBufferFromBuffers(this.recordingLeftBuffers);\n    const totalRightBuffer = createBufferFromBuffers(this.recordingRightBuffers);\n    this.recordingAudioBuffer = this.audioContext.createBuffer(2, totalLeftBuffer.length, WASMBOY_SAMPLE_RATE);\n\n    this._setSamplesToAudioBuffer(this.recordingAudioBuffer, totalLeftBuffer, totalRightBuffer);\n\n    this.recordingLeftBuffer = undefined;\n    this.recordingRightBuffer = undefined;\n  }\n\n  downloadRecordingAsWav(filename) {\n    if (!this.recordingAudioBuffer) {\n      return;\n    } // Check if we need to create our anchor tag\n    // Which is used to download the audio\n\n\n    if (!this.recordingAnchor) {\n      this.recordingAnchor = document.createElement('a');\n      document.body.appendChild(this.recordingAnchor);\n      this.recordingAnchor.style = 'display: none';\n    } // Create our wav as a downloadable blob\n\n\n    const wav = index(this.recordingAudioBuffer);\n    const blob = new window.Blob([new DataView(wav)], {\n      type: 'audio/wav'\n    }); // Create our url / download name\n\n    const url = window.URL.createObjectURL(blob);\n    this.recordingAnchor.href = url;\n    let downloadName;\n\n    if (filename) {\n      downloadName = `${filename}.wav`;\n    } else {\n      const shortDateWithTime = new Date().toLocaleDateString(undefined, {\n        month: '2-digit',\n        day: '2-digit',\n        year: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        second: '2-digit'\n      });\n      downloadName = `wasmboy-${shortDateWithTime}.wav`;\n    }\n\n    this.recordingAnchor.download = downloadName; // Download our wav\n\n    this.recordingAnchor.click();\n    window.URL.revokeObjectURL(url);\n  }\n\n  getRecordingAsWavBase64EncodedString() {\n    if (!this.recordingAudioBuffer) {\n      return;\n    } // Create our wav as a downloadable blob\n\n\n    const wav = index(this.recordingAudioBuffer);\n\n    const base64String = this._arrayBufferToBase64(wav);\n\n    return `data:audio/wav;base64,${base64String}`;\n  }\n\n  getRecordingAsAudioBuffer() {\n    return this.recordingAudioBuffer;\n  }\n\n  _libMute() {\n    this._setGain(0);\n\n    this.libMuted = true;\n  }\n\n  _libUnmute() {\n    if (this.libMuted) {\n      this._setGain(1);\n\n      this.libMuted = false;\n    }\n  }\n\n  _setGain(gain) {\n    this.createAudioContextIfNone();\n\n    if (this.gainNode) {\n      this.gainNode.gain.setValueAtTime(gain, this.audioContext.currentTime);\n    }\n  }\n\n  _setSamplesToAudioBuffer(audioBuffer, leftChannelSamples, rightChannelSamples) {\n    if (audioBuffer.copyToChannel) {\n      audioBuffer.copyToChannel(leftChannelSamples, 0, 0);\n      audioBuffer.copyToChannel(rightChannelSamples, 1, 0);\n    } else {\n      // Safari fallback\n      audioBuffer.getChannelData(0).set(leftChannelSamples);\n      audioBuffer.getChannelData(1).set(rightChannelSamples);\n    }\n  } // https://stackoverflow.com/questions/9267899/arraybuffer-to-base64-encoded-string/38858127\n\n\n  _arrayBufferToBase64(buffer) {\n    let binary = '';\n    let bytes = new Uint8Array(buffer);\n    let len = bytes.byteLength;\n\n    for (var i = 0; i < len; i++) {\n      binary += String.fromCharCode(bytes[i]);\n    }\n\n    return window.btoa(binary);\n  }\n\n}\n\n// Tons of help from:\n\nconst SLOW_TIME_STRETCH_MIN_FPS = 57;\n\nclass WasmBoyAudioService {\n  constructor() {\n    // Wasmboy instance and memory\n    this.worker = undefined;\n    this.updateAudioCallback = undefined; // Our Channels\n\n    this.gbChannels = {\n      master: new GbChannelWebAudio('master'),\n      channel1: new GbChannelWebAudio('channel1'),\n      channel2: new GbChannelWebAudio('channel2'),\n      channel3: new GbChannelWebAudio('channel3'),\n      channel4: new GbChannelWebAudio('channel4')\n    };\n\n    this._createAudioContextIfNone(); // Mute all the child channels,\n    // As we will assume all channels are enabled\n\n\n    if (typeof window !== 'undefined') {\n      this.gbChannels.channel1._libMute();\n\n      this.gbChannels.channel2._libMute();\n\n      this.gbChannels.channel3._libMute();\n\n      this.gbChannels.channel4._libMute();\n    } // Average fps for time stretching\n\n\n    this.averageTimeStretchFps = [];\n    this.speed = 1.0; // Our sound output Location, we will initialize this in init\n\n    this.WASMBOY_SOUND_OUTPUT_LOCATION = 0;\n    this.WASMBOY_CHANNEL_1_OUTPUT_LOCATION = 0;\n    this.WASMBOY_CHANNEL_2_OUTPUT_LOCATION = 0;\n    this.WASMBOY_CHANNEL_3_OUTPUT_LOCATION = 0;\n    this.WASMBOY_CHANNEL_4_OUTPUT_LOCATION = 0;\n  }\n\n  initialize(updateAudioCallback) {\n    const initializeTask = async () => {\n      this.updateAudioCallback = updateAudioCallback;\n      this.averageTimeStretchFps = [];\n      this.speed = 1.0;\n\n      this._createAudioContextIfNone();\n\n      this.cancelAllAudio(); // Lastly get our audio constants\n\n      return this.worker.postMessage({\n        type: WORKER_MESSAGE_TYPE.GET_CONSTANTS\n      });\n    };\n\n    return initializeTask();\n  }\n\n  setWorker(worker) {\n    this.worker = worker;\n    this.worker.addMessageListener(event => {\n      const eventData = getEventData(event);\n\n      switch (eventData.message.type) {\n        case WORKER_MESSAGE_TYPE.UPDATED:\n          {\n            // Dont wait for raf.\n            // Audio being shown is not dependent on the browser drawing a frame :)\n            // Just send the message directly\n            this.playAudio(eventData.message); // Next, send back how much forward latency\n            // we have\n\n            let latency = 0;\n            let currentTime = this.gbChannels.master.getCurrentTime();\n            let playtime = this.gbChannels.master.getPlayTime();\n\n            if (currentTime && currentTime > 0) {\n              latency = playtime - currentTime;\n            }\n\n            this.worker.postMessageIgnoreResponse({\n              type: WORKER_MESSAGE_TYPE.AUDIO_LATENCY,\n              latency\n            });\n            return;\n          }\n      }\n    });\n  }\n\n  getAudioChannels() {\n    return this.gbChannels;\n  }\n\n  setSpeed(speed) {\n    this.speed = speed;\n    this.cancelAllAudio(true);\n    this.resetTimeStretch();\n  }\n\n  resetTimeStretch() {\n    // Simply reset our average FPS counter array\n    this.averageTimeStretchFps = [];\n  } // Function to queue up and audio buyffer to be played\n  // Returns a promise so that we may \"sync by audio\"\n  // https://www.reddit.com/r/EmuDev/comments/5gkwi5/gb_apu_sound_emulation/dau8e2w/\n\n\n  playAudio(audioMessage) {\n    let currentFps = audioMessage.fps;\n    let allowFastSpeedStretching = audioMessage.allowFastSpeedStretching;\n    let numberOfSamples = audioMessage.numberOfSamples; // Find our averageFps\n\n    let fps = currentFps || 60; // Check if we got a huge fps outlier.\n    // If so, let's just reset our average.\n    // This will fix the slow gradual ramp down\n\n    const fpsDifference = Math.abs(currentFps - this.averageTimeStretchFps[this.averageTimeStretchFps.length - 1]);\n\n    if (fpsDifference && fpsDifference >= 15) {\n      this.resetTimeStretch();\n    } // Find our average fps for time stretching\n\n\n    this.averageTimeStretchFps.push(currentFps); // TODO Make the multiplier Const the timeshift speed\n\n    if (this.averageTimeStretchFps.length > Math.floor(SLOW_TIME_STRETCH_MIN_FPS * 3)) {\n      this.averageTimeStretchFps.shift();\n    } // Make sure we have a minimum number of time stretch fps timestamps to judge the average time\n\n\n    if (this.averageTimeStretchFps.length >= SLOW_TIME_STRETCH_MIN_FPS) {\n      fps = this.averageTimeStretchFps.reduce((accumulator, currentValue) => {\n        return accumulator + currentValue;\n      });\n      fps = Math.floor(fps / this.averageTimeStretchFps.length);\n    } // Find if we should time stretch this sample or not from our current fps\n\n\n    let playbackRate = 1.0;\n    let shouldTimeStretch = (fps < SLOW_TIME_STRETCH_MIN_FPS || allowFastSpeedStretching) && this.speed === 1.0;\n\n    if (shouldTimeStretch) {\n      // Has to be 60 to get accurent playback regarless of fps cap\n      playbackRate = playbackRate * (fps / 60);\n\n      if (playbackRate <= 0) {\n        playbackRate = 0.01;\n      }\n    } // Apply our speed to the playback rate\n\n\n    playbackRate = playbackRate * this.speed; // Play the master channel\n\n    this.gbChannels.master.playAudio(numberOfSamples, audioMessage.audioBuffer.left, audioMessage.audioBuffer.right, playbackRate, this.updateAudioCallback); // Play on all of our channels if we have buffers for them\n\n    for (let i = 0; i < 4; i++) {\n      let channelNumber = i + 1;\n\n      if (audioMessage[`channel${channelNumber}Buffer`]) {\n        this.gbChannels[`channel${channelNumber}`].playAudio(numberOfSamples, audioMessage[`channel${channelNumber}Buffer`].left, audioMessage[`channel${channelNumber}Buffer`].right, playbackRate, this.updateAudioCallback);\n      }\n    }\n\n    let playingAllChannels = !this.gbChannels.channel1.muted && !this.gbChannels.channel2.muted && !this.gbChannels.channel3.muted && !this.gbChannels.channel4.muted; // Mute and unmute accordingly\n\n    if (this.gbChannels.master.muted && playingAllChannels) {\n      this.gbChannels.master.unmute(); // We want to \"force\" mute here\n      // Because master is secretly playing all the audio,\n      // But we want the channels to appear not muted :)\n\n      this.gbChannels.channel1._libMute();\n\n      this.gbChannels.channel2._libMute();\n\n      this.gbChannels.channel3._libMute();\n\n      this.gbChannels.channel4._libMute();\n    } else if (!this.gbChannels.master.muted && !playingAllChannels) {\n      this.gbChannels.master.mute();\n\n      this.gbChannels.channel1._libUnmute();\n\n      this.gbChannels.channel2._libUnmute();\n\n      this.gbChannels.channel3._libUnmute();\n\n      this.gbChannels.channel4._libUnmute();\n    }\n  } // Functions to simply run on all of our channels\n  // Ensure that Audio is blessed.\n  // Meaning, the audioContext won't be\n  // affected by any autoplay issues.\n  // https://www.chromium.org/audio-video/autoplay\n\n\n  resumeAudioContext() {\n    this._applyOnAllChannels('resumeAudioContext');\n  }\n\n  cancelAllAudio(stopCurrentAudio) {\n    this._applyOnAllChannels('cancelAllAudio', [stopCurrentAudio]);\n  }\n\n  _createAudioContextIfNone() {\n    this._applyOnAllChannels('createAudioContextIfNone');\n  }\n\n  _applyOnAllChannels(functionKey, argsArray) {\n    Object.keys(this.gbChannels).forEach(gbChannelKey => {\n      this.gbChannels[gbChannelKey][functionKey].apply(this.gbChannels[gbChannelKey], argsArray);\n    });\n  }\n\n}\n\nconst WasmBoyAudio = new WasmBoyAudioService();\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar idb = createCommonjsModule(function (module) {\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n}());\n});\n\nvar node = createCommonjsModule(function (module) {\nif (typeof indexedDB != 'undefined') {\n  module.exports = idb;\n}\nelse {\n  module.exports = {\n    open: function () {\n      return Promise.reject('IDB requires a browser environment');\n    },\n    delete: function () {\n      return Promise.reject('IDB requires a browser environment');\n    }\n  };\n}\n});\nvar node_1 = node.open;\n\n// Get our idb instance, and initialize to asn idb-keyval\nlet keyval = false; // Get our idb dPromise\n\nif (typeof window !== 'undefined') {\n  const dbPromise = node.open('wasmboy', 1, upgradeDB => {\n    upgradeDB.createObjectStore('keyval');\n  }); // Get our idb-keyval instance\n\n  keyval = {\n    get(key) {\n      return dbPromise.then(db => {\n        return db.transaction('keyval').objectStore('keyval').get(key);\n      });\n    },\n\n    set(key, val) {\n      return dbPromise.then(db => {\n        const tx = db.transaction('keyval', 'readwrite');\n        tx.objectStore('keyval').put(val, key);\n        return tx.complete;\n      });\n    },\n\n    delete(key) {\n      return dbPromise.then(db => {\n        const tx = db.transaction('keyval', 'readwrite');\n        tx.objectStore('keyval').delete(key);\n        return tx.complete;\n      });\n    },\n\n    clear() {\n      return dbPromise.then(db => {\n        const tx = db.transaction('keyval', 'readwrite');\n        tx.objectStore('keyval').clear();\n        return tx.complete;\n      });\n    },\n\n    keys() {\n      return dbPromise.then(db => {\n        const tx = db.transaction('keyval');\n        const keys = [];\n        const store = tx.objectStore('keyval'); // This would be store.getAllKeys(), but it isn't supported by Edge or Safari.\n        // openKeyCursor isn't supported by Safari, so we fall back\n\n        (store.iterateKeyCursor || store.iterateCursor).call(store, cursor => {\n          if (!cursor) return;\n          keys.push(cursor.key);\n          cursor.continue();\n        });\n        return tx.complete.then(() => keys);\n      });\n    }\n\n  };\n} else {\n  // Create a mock keyval for node\n  keyval = {\n    get: () => {},\n    set: () => {},\n    delete: () => {},\n    clear: () => {},\n    keys: () => {}\n  };\n}\n\nconst idbKeyval = keyval;\n\n// Taken/Modified From: https://github.com/photopea/UZIP.js\nlet UZIP = {}; // Make it a hacky es module\n\nconst uzip = UZIP;\n\nUZIP['parse'] = function (buf // ArrayBuffer\n) {\n  let rUs = UZIP.bin.readUshort,\n      rUi = UZIP.bin.readUint,\n      o = 0,\n      out = {};\n  let data = new Uint8Array(buf);\n  let eocd = data.length - 4;\n\n  while (rUi(data, eocd) != 0x06054b50) eocd--;\n\n  o = eocd;\n  o += 4; // sign  = 0x06054b50\n\n  o += 4; // disks = 0;\n\n  let cnu = rUs(data, o);\n  o += 2;\n  let cnt = rUs(data, o);\n  o += 2;\n  let csize = rUi(data, o);\n  o += 4;\n  let coffs = rUi(data, o);\n  o += 4;\n  o = coffs;\n\n  for (let i = 0; i < cnu; i++) {\n    let sign = rUi(data, o);\n    o += 4;\n    o += 4; // versions;\n\n    o += 4; // flag + compr\n\n    o += 4; // time\n\n    let crc32 = rUi(data, o);\n    o += 4;\n    let csize = rUi(data, o);\n    o += 4;\n    let usize = rUi(data, o);\n    o += 4;\n    let nl = rUs(data, o),\n        el = rUs(data, o + 2),\n        cl = rUs(data, o + 4);\n    o += 6; // name, extra, comment\n\n    o += 8; // disk, attribs\n\n    let roff = rUi(data, o);\n    o += 4;\n    o += nl + el + cl;\n\n    UZIP._readLocal(data, roff, out, csize, usize);\n  } //console.log(out);\n\n\n  return out;\n};\n\nUZIP._readLocal = function (data, o, out, csize, usize) {\n  let rUs = UZIP.bin.readUshort,\n      rUi = UZIP.bin.readUint;\n  let sign = rUi(data, o);\n  o += 4;\n  let ver = rUs(data, o);\n  o += 2;\n  let gpflg = rUs(data, o);\n  o += 2; //if((gpflg&8)!=0) throw \"unknown sizes\";\n\n  let cmpr = rUs(data, o);\n  o += 2;\n  let time = rUi(data, o);\n  o += 4;\n  let crc32 = rUi(data, o);\n  o += 4; //let csize = rUi(data, o);  o+=4;\n  //let usize = rUi(data, o);  o+=4;\n\n  o += 8;\n  let nlen = rUs(data, o);\n  o += 2;\n  let elen = rUs(data, o);\n  o += 2;\n  let name = UZIP.bin.readUTF8(data, o, nlen);\n  o += nlen;\n  o += elen; //console.log(sign.toString(16), ver, gpflg, cmpr, crc32.toString(16), \"csize, usize\", csize, usize, nlen, elen, name, o);\n\n  let file = new Uint8Array(data.buffer, o);\n\n  if (cmpr == 0) out[name] = new Uint8Array(file.buffer.slice(o, o + csize));else if (cmpr == 8) {\n    let buf = new Uint8Array(usize);\n    UZIP.inflateRaw(file, buf); //let nbuf = pako[\"inflateRaw\"](file);\n    //for(let i=0; i<buf.length; i++) if(buf[i]!=nbuf[i]) {  console.log(buf.length, nbuf.length, usize, i);  throw \"e\";  }\n\n    out[name] = buf;\n  } else throw 'unknown compression method: ' + cmpr;\n};\n\nUZIP.inflateRaw = function (file, buf) {\n  return UZIP.F.inflate(file, buf);\n};\n\nUZIP.inflate = function (file, buf) {\n  let CMF = file[0],\n      FLG = file[1];\n\n  return UZIP.inflateRaw(new Uint8Array(file.buffer, file.byteOffset + 2, file.length - 6), buf);\n};\n\nUZIP.deflate = function (data, opts\n/*, buf, off*/\n) {\n  if (opts == null) opts = {\n    level: 6\n  };\n  let off = 0,\n      buf = new Uint8Array(50 + Math.floor(data.length * 1.1));\n  buf[off] = 120;\n  buf[off + 1] = 156;\n  off += 2;\n  off = UZIP.F.deflateRaw(data, buf, off, opts.level);\n  let crc = UZIP.adler(data, 0, data.length);\n  buf[off + 0] = crc >>> 24 & 255;\n  buf[off + 1] = crc >>> 16 & 255;\n  buf[off + 2] = crc >>> 8 & 255;\n  buf[off + 3] = crc >>> 0 & 255;\n  return new Uint8Array(buf.buffer, 0, off + 4);\n};\n\nUZIP.deflateRaw = function (data, opts) {\n  if (opts == null) opts = {\n    level: 6\n  };\n  let buf = new Uint8Array(50 + Math.floor(data.length * 1.1));\n  let off;\n  off = UZIP.F.deflateRaw(data, buf, off, opts.level);\n  return new Uint8Array(buf.buffer, 0, off);\n};\n\nUZIP.encode = function (obj) {\n  let tot = 0,\n      wUi = UZIP.bin.writeUint,\n      wUs = UZIP.bin.writeUshort;\n  let zpd = {};\n\n  for (let p in obj) {\n    let cpr = !UZIP._noNeed(p),\n        buf = obj[p],\n        crc = UZIP.crc.crc(buf, 0, buf.length);\n    zpd[p] = {\n      cpr: cpr,\n      usize: buf.length,\n      crc: crc,\n      file: cpr ? UZIP.deflateRaw(buf) : buf\n    };\n  }\n\n  for (let p in zpd) tot += zpd[p].file.length + 30 + 46 + 2 * UZIP.bin.sizeUTF8(p);\n\n  tot += 22;\n  let data = new Uint8Array(tot),\n      o = 0;\n  let fof = [];\n\n  for (let p in zpd) {\n    let file = zpd[p];\n    fof.push(o);\n    o = UZIP._writeHeader(data, o, p, file, 0);\n  }\n\n  let i = 0,\n      ioff = o;\n\n  for (let p in zpd) {\n    let file = zpd[p];\n    fof.push(o);\n    o = UZIP._writeHeader(data, o, p, file, 1, fof[i++]);\n  }\n\n  let csize = o - ioff;\n  wUi(data, o, 0x06054b50);\n  o += 4;\n  o += 4; // disks\n\n  wUs(data, o, i);\n  o += 2;\n  wUs(data, o, i);\n  o += 2; // number of c d records\n\n  wUi(data, o, csize);\n  o += 4;\n  wUi(data, o, ioff);\n  o += 4;\n  o += 2;\n  return data.buffer;\n}; // no need to compress .PNG, .ZIP, .JPEG ....\n\n\nUZIP._noNeed = function (fn) {\n  let ext = fn.split('.').pop().toLowerCase();\n  return 'png,jpg,jpeg,zip'.indexOf(ext) != -1;\n};\n\nUZIP._writeHeader = function (data, o, p, obj, t, roff) {\n  let wUi = UZIP.bin.writeUint,\n      wUs = UZIP.bin.writeUshort;\n  let file = obj.file;\n  wUi(data, o, t == 0 ? 0x04034b50 : 0x02014b50);\n  o += 4; // sign\n\n  if (t == 1) o += 2; // ver made by\n\n  wUs(data, o, 20);\n  o += 2; // ver\n\n  wUs(data, o, 0);\n  o += 2; // gflip\n\n  wUs(data, o, obj.cpr ? 8 : 0);\n  o += 2; // cmpr\n\n  wUi(data, o, 0);\n  o += 4; // time\n\n  wUi(data, o, obj.crc);\n  o += 4; // crc32\n\n  wUi(data, o, file.length);\n  o += 4; // csize\n\n  wUi(data, o, obj.usize);\n  o += 4; // usize\n\n  wUs(data, o, UZIP.bin.sizeUTF8(p));\n  o += 2; // nlen\n\n  wUs(data, o, 0);\n  o += 2; // elen\n\n  if (t == 1) {\n    o += 2; // comment length\n\n    o += 2; // disk number\n\n    o += 6; // attributes\n\n    wUi(data, o, roff);\n    o += 4; // usize\n  }\n\n  let nlen = UZIP.bin.writeUTF8(data, o, p);\n  o += nlen;\n\n  if (t == 0) {\n    data.set(file, o);\n    o += file.length;\n  }\n\n  return o;\n};\n\nUZIP.crc = {\n  table: function () {\n    let tab = new Uint32Array(256);\n\n    for (let n = 0; n < 256; n++) {\n      let c = n;\n\n      for (let k = 0; k < 8; k++) {\n        if (c & 1) c = 0xedb88320 ^ c >>> 1;else c = c >>> 1;\n      }\n\n      tab[n] = c;\n    }\n\n    return tab;\n  }(),\n  update: function (c, buf, off, len) {\n    for (let i = 0; i < len; i++) c = UZIP.crc.table[(c ^ buf[off + i]) & 0xff] ^ c >>> 8;\n\n    return c;\n  },\n  crc: function (b, o, l) {\n    return UZIP.crc.update(0xffffffff, b, o, l) ^ 0xffffffff;\n  }\n};\n\nUZIP.adler = function (data, o, len) {\n  let a = 1,\n      b = 0;\n  let off = o,\n      end = o + len;\n\n  while (off < end) {\n    let eend = Math.min(off + 5552, end);\n\n    while (off < eend) {\n      a += data[off++];\n      b += a;\n    }\n\n    a = a % 65521;\n    b = b % 65521;\n  }\n\n  return b << 16 | a;\n};\n\nUZIP.bin = {\n  readUshort: function (buff, p) {\n    return buff[p] | buff[p + 1] << 8;\n  },\n  writeUshort: function (buff, p, n) {\n    buff[p] = n & 255;\n    buff[p + 1] = n >> 8 & 255;\n  },\n  readUint: function (buff, p) {\n    return buff[p + 3] * (256 * 256 * 256) + (buff[p + 2] << 16 | buff[p + 1] << 8 | buff[p]);\n  },\n  writeUint: function (buff, p, n) {\n    buff[p] = n & 255;\n    buff[p + 1] = n >> 8 & 255;\n    buff[p + 2] = n >> 16 & 255;\n    buff[p + 3] = n >> 24 & 255;\n  },\n  readASCII: function (buff, p, l) {\n    let s = '';\n\n    for (let i = 0; i < l; i++) s += String.fromCharCode(buff[p + i]);\n\n    return s;\n  },\n  writeASCII: function (data, p, s) {\n    for (let i = 0; i < s.length; i++) data[p + i] = s.charCodeAt(i);\n  },\n  pad: function (n) {\n    return n.length < 2 ? '0' + n : n;\n  },\n  readUTF8: function (buff, p, l) {\n    let s = '',\n        ns;\n\n    for (let i = 0; i < l; i++) s += '%' + UZIP.bin.pad(buff[p + i].toString(16));\n\n    try {\n      ns = decodeURIComponent(s);\n    } catch (e) {\n      return UZIP.bin.readASCII(buff, p, l);\n    }\n\n    return ns;\n  },\n  writeUTF8: function (buff, p, str) {\n    let strl = str.length,\n        i = 0;\n\n    for (let ci = 0; ci < strl; ci++) {\n      let code = str.charCodeAt(ci);\n\n      if ((code & 0xffffffff - (1 << 7) + 1) == 0) {\n        buff[p + i] = code;\n        i++;\n      } else if ((code & 0xffffffff - (1 << 11) + 1) == 0) {\n        buff[p + i] = 192 | code >> 6;\n        buff[p + i + 1] = 128 | code >> 0 & 63;\n        i += 2;\n      } else if ((code & 0xffffffff - (1 << 16) + 1) == 0) {\n        buff[p + i] = 224 | code >> 12;\n        buff[p + i + 1] = 128 | code >> 6 & 63;\n        buff[p + i + 2] = 128 | code >> 0 & 63;\n        i += 3;\n      } else if ((code & 0xffffffff - (1 << 21) + 1) == 0) {\n        buff[p + i] = 240 | code >> 18;\n        buff[p + i + 1] = 128 | code >> 12 & 63;\n        buff[p + i + 2] = 128 | code >> 6 & 63;\n        buff[p + i + 3] = 128 | code >> 0 & 63;\n        i += 4;\n      } else throw 'e';\n    }\n\n    return i;\n  },\n  sizeUTF8: function (str) {\n    let strl = str.length,\n        i = 0;\n\n    for (let ci = 0; ci < strl; ci++) {\n      let code = str.charCodeAt(ci);\n\n      if ((code & 0xffffffff - (1 << 7) + 1) == 0) {\n        i++;\n      } else if ((code & 0xffffffff - (1 << 11) + 1) == 0) {\n        i += 2;\n      } else if ((code & 0xffffffff - (1 << 16) + 1) == 0) {\n        i += 3;\n      } else if ((code & 0xffffffff - (1 << 21) + 1) == 0) {\n        i += 4;\n      } else throw 'e';\n    }\n\n    return i;\n  }\n};\nUZIP.F = {};\n\nUZIP.F.deflateRaw = function (data, out, opos, lvl) {\n  let opts = [\n  /*\n  ush good_length; /* reduce lazy search above this match length \n  ush max_lazy;    /* do not perform lazy search above this match length \n       ush nice_length; /* quit search above this match length \n  */\n\n  /*      good lazy nice chain */\n\n  /* 0 */\n  [0, 0, 0, 0, 0]\n  /* store only */\n  ,\n  /* 1 */\n  [4, 4, 8, 4, 0]\n  /* max speed, no lazy matches */\n  ,\n  /* 2 */\n  [4, 5, 16, 8, 0],\n  /* 3 */\n  [4, 6, 16, 16, 0],\n  /* 4 */\n  [4, 10, 16, 32, 0]\n  /* lazy matches */\n  ,\n  /* 5 */\n  [8, 16, 32, 32, 0],\n  /* 6 */\n  [8, 16, 128, 128, 0],\n  /* 7 */\n  [8, 32, 128, 256, 0],\n  /* 8 */\n  [32, 128, 258, 1024, 1],\n  /* 9 */\n  [32, 258, 258, 4096, 1]];\n  /* max compression */\n\n  let opt = opts[lvl];\n  let U = UZIP.F.U,\n      goodIndex = UZIP.F._goodIndex,\n      hash = UZIP.F._hash,\n      putsE = UZIP.F._putsE;\n  let i = 0,\n      pos = opos << 3,\n      cvrd = 0,\n      dlen = data.length;\n\n  if (lvl == 0) {\n    while (i < dlen) {\n      let len = Math.min(0xffff, dlen - i);\n      putsE(out, pos, i + len == dlen ? 1 : 0);\n      pos = UZIP.F._copyExact(data, i, len, out, pos + 8);\n      i += len;\n    }\n\n    return pos >>> 3;\n  }\n\n  let lits = U.lits,\n      strt = U.strt,\n      prev = U.prev,\n      li = 0,\n      lc = 0,\n      bs = 0,\n      ebits = 0,\n      c = 0,\n      nc = 0; // last_item, literal_count, block_start\n\n  if (dlen > 2) {\n    nc = UZIP.F._hash(data, 0);\n    strt[nc] = 0;\n  }\n\n  for (i = 0; i < dlen; i++) {\n    c = nc; //*\n\n    if (i + 1 < dlen - 2) {\n      nc = UZIP.F._hash(data, i + 1);\n      let ii = i + 1 & 0x7fff;\n      prev[ii] = strt[nc];\n      strt[nc] = ii;\n    } //*/\n\n\n    if (cvrd <= i) {\n      if (li > 14000 || lc > 26697) {\n        if (cvrd < i) {\n          lits[li] = i - cvrd;\n          li += 2;\n          cvrd = i;\n        }\n\n        pos = UZIP.F._writeBlock(i == dlen - 1 || cvrd == dlen ? 1 : 0, lits, li, ebits, data, bs, i - bs, out, pos);\n        li = lc = ebits = 0;\n        bs = i;\n      }\n\n      let mch = 0; //if(nmci==i) mch= nmch;  else\n\n      if (i < dlen - 2) mch = UZIP.F._bestMatch(data, i, prev, c, Math.min(opt[2], dlen - i), opt[3]);\n\n      if (mch != 0) {\n        let len = mch >>> 16,\n            dst = mch & 0xffff; //if(i-dst<0) throw \"e\";\n\n        let lgi = goodIndex(len, U.of0);\n        U.lhst[257 + lgi]++;\n        let dgi = goodIndex(dst, U.df0);\n        U.dhst[dgi]++;\n        ebits += U.exb[lgi] + U.dxb[dgi];\n        lits[li] = len << 23 | i - cvrd;\n        lits[li + 1] = dst << 16 | lgi << 8 | dgi;\n        li += 2;\n        cvrd = i + len;\n      } else {\n        U.lhst[data[i]]++;\n      }\n\n      lc++;\n    }\n  }\n\n  if (bs != i || data.length == 0) {\n    if (cvrd < i) {\n      lits[li] = i - cvrd;\n      li += 2;\n      cvrd = i;\n    }\n\n    pos = UZIP.F._writeBlock(1, lits, li, ebits, data, bs, i - bs, out, pos);\n    li = 0;\n    lc = 0;\n    li = lc = ebits = 0;\n    bs = i;\n  }\n\n  while ((pos & 7) != 0) pos++;\n\n  return pos >>> 3;\n};\n\nUZIP.F._bestMatch = function (data, i, prev, c, nice, chain) {\n  let ci = i & 0x7fff,\n      pi = prev[ci]; //console.log(\"----\", i);\n\n  let dif = ci - pi + (1 << 15) & 0x7fff;\n  if (pi == ci || c != UZIP.F._hash(data, i - dif)) return 0;\n  let tl = 0,\n      td = 0; // top length, top distance\n\n  let dlim = Math.min(0x7fff, i);\n\n  while (dif <= dlim && --chain != 0 && pi != ci\n  /*&& c==UZIP.F._hash(data,i-dif)*/\n  ) {\n    if (tl == 0 || data[i + tl] == data[i + tl - dif]) {\n      let cl = UZIP.F._howLong(data, i, dif);\n\n      if (cl > tl) {\n        tl = cl;\n        td = dif;\n        if (tl >= nice) break; //*\n\n        if (dif + 2 < cl) cl = dif + 2;\n        let maxd = 0; // pi does not point to the start of the word\n\n        for (let j = 0; j < cl - 2; j++) {\n          let ei = i - dif + j + (1 << 15) & 0x7fff;\n          let li = prev[ei];\n          let curd = ei - li + (1 << 15) & 0x7fff;\n\n          if (curd > maxd) {\n            maxd = curd;\n            pi = ei;\n          }\n        } //*/\n\n      }\n    }\n\n    ci = pi;\n    pi = prev[ci];\n    dif += ci - pi + (1 << 15) & 0x7fff;\n  }\n\n  return tl << 16 | td;\n};\n\nUZIP.F._howLong = function (data, i, dif) {\n  if (data[i] != data[i - dif] || data[i + 1] != data[i + 1 - dif] || data[i + 2] != data[i + 2 - dif]) return 0;\n  let oi = i,\n      l = Math.min(data.length, i + 258);\n  i += 3; //while(i+4<l && data[i]==data[i-dif] && data[i+1]==data[i+1-dif] && data[i+2]==data[i+2-dif] && data[i+3]==data[i+3-dif]) i+=4;\n\n  while (i < l && data[i] == data[i - dif]) i++;\n\n  return i - oi;\n};\n\nUZIP.F._hash = function (data, i) {\n  return (data[i] << 8 | data[i + 1]) + (data[i + 2] << 4) & 0xffff; //let hash_shift = 0, hash_mask = 255;\n  //let h = data[i+1] % 251;\n  //h = (((h << 8) + data[i+2]) % 251);\n  //h = (((h << 8) + data[i+2]) % 251);\n  //h = ((h<<hash_shift) ^ (c) ) & hash_mask;\n  //return h | (data[i]<<8);\n  //return (data[i] | (data[i+1]<<8));\n}; //UZIP.___toth = 0;\n\n\nUZIP.saved = 0;\n\nUZIP.F._writeBlock = function (BFINAL, lits, li, ebits, data, o0, l0, out, pos) {\n  let U = UZIP.F.U,\n      putsF = UZIP.F._putsF,\n      putsE = UZIP.F._putsE; //*\n\n  let T, ML, MD, MH, numl, numd, numh, lset, dset;\n  U.lhst[256]++;\n  T = UZIP.F.getTrees();\n  ML = T[0];\n  MD = T[1];\n  MH = T[2];\n  numl = T[3];\n  numd = T[4];\n  numh = T[5];\n  lset = T[6];\n  dset = T[7];\n  let cstSize = ((pos + 3 & 7) == 0 ? 0 : 8 - (pos + 3 & 7)) + 32 + (l0 << 3);\n  let fxdSize = ebits + UZIP.F.contSize(U.fltree, U.lhst) + UZIP.F.contSize(U.fdtree, U.dhst);\n  let dynSize = ebits + UZIP.F.contSize(U.ltree, U.lhst) + UZIP.F.contSize(U.dtree, U.dhst);\n  dynSize += 14 + 3 * numh + UZIP.F.contSize(U.itree, U.ihst) + (U.ihst[16] * 2 + U.ihst[17] * 3 + U.ihst[18] * 7);\n\n  for (let j = 0; j < 286; j++) U.lhst[j] = 0;\n\n  for (let j = 0; j < 30; j++) U.dhst[j] = 0;\n\n  for (let j = 0; j < 19; j++) U.ihst[j] = 0; //*/\n\n\n  let BTYPE = cstSize < fxdSize && cstSize < dynSize ? 0 : fxdSize < dynSize ? 1 : 2;\n  putsF(out, pos, BFINAL);\n  putsF(out, pos + 1, BTYPE);\n  pos += 3;\n\n  if (BTYPE == 0) {\n    while ((pos & 7) != 0) pos++;\n\n    pos = UZIP.F._copyExact(data, o0, l0, out, pos);\n  } else {\n    let ltree, dtree;\n\n    if (BTYPE == 1) {\n      ltree = U.fltree;\n      dtree = U.fdtree;\n    }\n\n    if (BTYPE == 2) {\n      UZIP.F.makeCodes(U.ltree, ML);\n      UZIP.F.revCodes(U.ltree, ML);\n      UZIP.F.makeCodes(U.dtree, MD);\n      UZIP.F.revCodes(U.dtree, MD);\n      UZIP.F.makeCodes(U.itree, MH);\n      UZIP.F.revCodes(U.itree, MH);\n      ltree = U.ltree;\n      dtree = U.dtree;\n      putsE(out, pos, numl - 257);\n      pos += 5; // 286\n\n      putsE(out, pos, numd - 1);\n      pos += 5; // 30\n\n      putsE(out, pos, numh - 4);\n      pos += 4; // 19\n\n      for (let i = 0; i < numh; i++) putsE(out, pos + i * 3, U.itree[(U.ordr[i] << 1) + 1]);\n\n      pos += 3 * numh;\n      pos = UZIP.F._codeTiny(lset, U.itree, out, pos);\n      pos = UZIP.F._codeTiny(dset, U.itree, out, pos);\n    }\n\n    let off = o0;\n\n    for (let si = 0; si < li; si += 2) {\n      let qb = lits[si],\n          len = qb >>> 23,\n          end = off + (qb & (1 << 23) - 1);\n\n      while (off < end) pos = UZIP.F._writeLit(data[off++], ltree, out, pos);\n\n      if (len != 0) {\n        let qc = lits[si + 1],\n            dst = qc >> 16,\n            lgi = qc >> 8 & 255,\n            dgi = qc & 255;\n        pos = UZIP.F._writeLit(257 + lgi, ltree, out, pos);\n        putsE(out, pos, len - U.of0[lgi]);\n        pos += U.exb[lgi];\n        pos = UZIP.F._writeLit(dgi, dtree, out, pos);\n        putsF(out, pos, dst - U.df0[dgi]);\n        pos += U.dxb[dgi];\n        off += len;\n      }\n    }\n\n    pos = UZIP.F._writeLit(256, ltree, out, pos);\n  } //console.log(pos-opos, fxdSize, dynSize, cstSize);\n\n\n  return pos;\n};\n\nUZIP.F._copyExact = function (data, off, len, out, pos) {\n  let p8 = pos >>> 3;\n  out[p8] = len;\n  out[p8 + 1] = len >>> 8;\n  out[p8 + 2] = 255 - out[p8];\n  out[p8 + 3] = 255 - out[p8 + 1];\n  p8 += 4;\n  out.set(new Uint8Array(data.buffer, off, len), p8); //for(let i=0; i<len; i++) out[p8+i]=data[off+i];\n\n  return pos + (len + 4 << 3);\n};\n/*\n\tInteresting facts:\n\t- decompressed block can have bytes, which do not occur in a Huffman tree (copied from the previous block by reference)\n*/\n\n\nUZIP.F.getTrees = function () {\n  let U = UZIP.F.U;\n\n  let ML = UZIP.F._hufTree(U.lhst, U.ltree, 15);\n\n  let MD = UZIP.F._hufTree(U.dhst, U.dtree, 15);\n\n  let lset = [],\n      numl = UZIP.F._lenCodes(U.ltree, lset);\n\n  let dset = [],\n      numd = UZIP.F._lenCodes(U.dtree, dset);\n\n  for (let i = 0; i < lset.length; i += 2) U.ihst[lset[i]]++;\n\n  for (let i = 0; i < dset.length; i += 2) U.ihst[dset[i]]++;\n\n  let MH = UZIP.F._hufTree(U.ihst, U.itree, 7);\n\n  let numh = 19;\n\n  while (numh > 4 && U.itree[(U.ordr[numh - 1] << 1) + 1] == 0) numh--;\n\n  return [ML, MD, MH, numl, numd, numh, lset, dset];\n};\n\nUZIP.F.getSecond = function (a) {\n  let b = [];\n\n  for (let i = 0; i < a.length; i += 2) b.push(a[i + 1]);\n\n  return b;\n};\n\nUZIP.F.nonZero = function (a) {\n  let b = '';\n\n  for (let i = 0; i < a.length; i += 2) if (a[i + 1] != 0) b += (i >> 1) + ',';\n\n  return b;\n};\n\nUZIP.F.contSize = function (tree, hst) {\n  let s = 0;\n\n  for (let i = 0; i < hst.length; i++) s += hst[i] * tree[(i << 1) + 1];\n\n  return s;\n};\n\nUZIP.F._codeTiny = function (set, tree, out, pos) {\n  for (let i = 0; i < set.length; i += 2) {\n    let l = set[i],\n        rst = set[i + 1]; //console.log(l, pos, tree[(l<<1)+1]);\n\n    pos = UZIP.F._writeLit(l, tree, out, pos);\n    let rsl = l == 16 ? 2 : l == 17 ? 3 : 7;\n\n    if (l > 15) {\n      UZIP.F._putsE(out, pos, rst, rsl);\n\n      pos += rsl;\n    }\n  }\n\n  return pos;\n};\n\nUZIP.F._lenCodes = function (tree, set) {\n  let len = tree.length;\n\n  while (len != 2 && tree[len - 1] == 0) len -= 2; // when no distances, keep one code with length 0\n\n\n  for (let i = 0; i < len; i += 2) {\n    let l = tree[i + 1],\n        nxt = i + 3 < len ? tree[i + 3] : -1,\n        nnxt = i + 5 < len ? tree[i + 5] : -1,\n        prv = i == 0 ? -1 : tree[i - 1];\n\n    if (l == 0 && nxt == l && nnxt == l) {\n      let lz = i + 5;\n\n      while (lz + 2 < len && tree[lz + 2] == l) lz += 2;\n\n      let zc = Math.min(lz + 1 - i >>> 1, 138);\n      if (zc < 11) set.push(17, zc - 3);else set.push(18, zc - 11);\n      i += zc * 2 - 2;\n    } else if (l == prv && nxt == l && nnxt == l) {\n      let lz = i + 5;\n\n      while (lz + 2 < len && tree[lz + 2] == l) lz += 2;\n\n      let zc = Math.min(lz + 1 - i >>> 1, 6);\n      set.push(16, zc - 3);\n      i += zc * 2 - 2;\n    } else set.push(l, 0);\n  }\n\n  return len >>> 1;\n};\n\nUZIP.F._hufTree = function (hst, tree, MAXL) {\n  let list = [],\n      hl = hst.length,\n      tl = tree.length,\n      i = 0;\n\n  for (i = 0; i < tl; i += 2) {\n    tree[i] = 0;\n    tree[i + 1] = 0;\n  }\n\n  for (i = 0; i < hl; i++) if (hst[i] != 0) list.push({\n    lit: i,\n    f: hst[i]\n  });\n\n  let end = list.length,\n      l2 = list.slice(0);\n  if (end == 0) return 0; // empty histogram (usually for dist)\n\n  if (end == 1) {\n    let lit = list[0].lit,\n        l2 = lit == 0 ? 1 : 0;\n    tree[(lit << 1) + 1] = 1;\n    tree[(l2 << 1) + 1] = 1;\n    return 1;\n  }\n\n  list.sort(function (a, b) {\n    return a.f - b.f;\n  });\n  let a = list[0],\n      b = list[1],\n      i0 = 0,\n      i1 = 1,\n      i2 = 2;\n  list[0] = {\n    lit: -1,\n    f: a.f + b.f,\n    l: a,\n    r: b,\n    d: 0\n  };\n\n  while (i1 != end - 1) {\n    if (i0 != i1 && (i2 == end || list[i0].f < list[i2].f)) {\n      a = list[i0++];\n    } else {\n      a = list[i2++];\n    }\n\n    if (i0 != i1 && (i2 == end || list[i0].f < list[i2].f)) {\n      b = list[i0++];\n    } else {\n      b = list[i2++];\n    }\n\n    list[i1++] = {\n      lit: -1,\n      f: a.f + b.f,\n      l: a,\n      r: b\n    };\n  }\n\n  let maxl = UZIP.F.setDepth(list[i1 - 1], 0);\n\n  if (maxl > MAXL) {\n    UZIP.F.restrictDepth(l2, MAXL, maxl);\n    maxl = MAXL;\n  }\n\n  for (i = 0; i < end; i++) tree[(l2[i].lit << 1) + 1] = l2[i].d;\n\n  return maxl;\n};\n\nUZIP.F.setDepth = function (t, d) {\n  if (t.lit != -1) {\n    t.d = d;\n    return d;\n  }\n\n  return Math.max(UZIP.F.setDepth(t.l, d + 1), UZIP.F.setDepth(t.r, d + 1));\n};\n\nUZIP.F.restrictDepth = function (dps, MD, maxl) {\n  let i = 0,\n      bCost = 1 << maxl - MD,\n      dbt = 0;\n  dps.sort(function (a, b) {\n    return b.d == a.d ? a.f - b.f : b.d - a.d;\n  });\n\n  for (i = 0; i < dps.length; i++) if (dps[i].d > MD) {\n    let od = dps[i].d;\n    dps[i].d = MD;\n    dbt += bCost - (1 << maxl - od);\n  } else break;\n\n  dbt = dbt >>> maxl - MD;\n\n  while (dbt > 0) {\n    let od = dps[i].d;\n\n    if (od < MD) {\n      dps[i].d++;\n      dbt -= 1 << MD - od - 1;\n    } else i++;\n  }\n\n  for (; i >= 0; i--) if (dps[i].d == MD && dbt < 0) {\n    dps[i].d--;\n    dbt++;\n  }\n\n  if (dbt != 0) console.log('debt left');\n};\n\nUZIP.F._goodIndex = function (v, arr) {\n  let i = 0;\n  if (arr[i | 16] <= v) i |= 16;\n  if (arr[i | 8] <= v) i |= 8;\n  if (arr[i | 4] <= v) i |= 4;\n  if (arr[i | 2] <= v) i |= 2;\n  if (arr[i | 1] <= v) i |= 1;\n  return i;\n};\n\nUZIP.F._writeLit = function (ch, ltree, out, pos) {\n  UZIP.F._putsF(out, pos, ltree[ch << 1]);\n\n  return pos + ltree[(ch << 1) + 1];\n};\n\nUZIP.F.inflate = function (data, buf) {\n  if (data[0] == 3 && data[1] == 0) return buf ? buf : new Uint8Array(0);\n  let F = UZIP.F,\n      bitsF = F._bitsF,\n      bitsE = F._bitsE,\n      decodeTiny = F._decodeTiny,\n      makeCodes = F.makeCodes,\n      codes2map = F.codes2map,\n      get17 = F._get17;\n  let U = F.U;\n  let noBuf = buf == null;\n  if (noBuf) buf = new Uint8Array(data.length >> 2 << 3);\n  let BFINAL = 0,\n      BTYPE = 0,\n      HLIT = 0,\n      HDIST = 0,\n      HCLEN = 0,\n      ML = 0,\n      MD = 0;\n  let off = 0,\n      pos = 0;\n  let lmap, dmap;\n\n  while (BFINAL == 0) {\n    BFINAL = bitsF(data, pos, 1);\n    BTYPE = bitsF(data, pos + 1, 2);\n    pos += 3; //console.log(BFINAL, BTYPE);\n\n    if (BTYPE == 0) {\n      if ((pos & 7) != 0) pos += 8 - (pos & 7);\n      let p8 = (pos >>> 3) + 4,\n          len = data[p8 - 4] | data[p8 - 3] << 8; //console.log(len);//bitsF(data, pos, 16),\n\n      if (noBuf) buf = UZIP.F._check(buf, off + len);\n      buf.set(new Uint8Array(data.buffer, data.byteOffset + p8, len), off); //for(let i=0; i<len; i++) buf[off+i] = data[p8+i];\n      //for(let i=0; i<len; i++) if(buf[off+i] != data[p8+i]) throw \"e\";\n\n      pos = p8 + len << 3;\n      off += len;\n      continue;\n    }\n\n    if (noBuf) buf = UZIP.F._check(buf, off + (1 << 17));\n\n    if (BTYPE == 1) {\n      lmap = U.flmap;\n      dmap = U.fdmap;\n      ML = (1 << 9) - 1;\n      MD = (1 << 5) - 1;\n    }\n\n    if (BTYPE == 2) {\n      HLIT = bitsE(data, pos, 5) + 257;\n      HDIST = bitsE(data, pos + 5, 5) + 1;\n      HCLEN = bitsE(data, pos + 10, 4) + 4;\n      pos += 14;\n\n      for (let i = 0; i < 38; i += 2) {\n        U.itree[i] = 0;\n        U.itree[i + 1] = 0;\n      }\n\n      let tl = 1;\n\n      for (let i = 0; i < HCLEN; i++) {\n        let l = bitsE(data, pos + i * 3, 3);\n        U.itree[(U.ordr[i] << 1) + 1] = l;\n        if (l > tl) tl = l;\n      }\n\n      pos += 3 * HCLEN; //console.log(itree);\n\n      makeCodes(U.itree, tl);\n      codes2map(U.itree, tl, U.imap);\n      lmap = U.lmap;\n      dmap = U.dmap;\n      let ml = decodeTiny(U.imap, (1 << tl) - 1, HLIT, data, pos, U.ltree);\n      ML = (1 << (ml >>> 24)) - 1;\n      pos += ml & 0xffffff;\n      makeCodes(U.ltree, ml >>> 24);\n      codes2map(U.ltree, ml >>> 24, lmap);\n      let md = decodeTiny(U.imap, (1 << tl) - 1, HDIST, data, pos, U.dtree);\n      MD = (1 << (md >>> 24)) - 1;\n      pos += md & 0xffffff;\n      makeCodes(U.dtree, md >>> 24);\n      codes2map(U.dtree, md >>> 24, dmap);\n    } //let ooff=off, opos=pos;\n\n\n    while (true) {\n      let code = lmap[get17(data, pos) & ML];\n      pos += code & 15;\n      let lit = code >>> 4; //U.lhst[lit]++;\n\n      if (lit >>> 8 == 0) {\n        buf[off++] = lit;\n      } else if (lit == 256) {\n        break;\n      } else {\n        let end = off + lit - 254;\n\n        if (lit > 264) {\n          let ebs = U.ldef[lit - 257];\n          end = off + (ebs >>> 3) + bitsE(data, pos, ebs & 7);\n          pos += ebs & 7;\n        } //UZIP.F.dst[end-off]++;\n\n\n        let dcode = dmap[get17(data, pos) & MD];\n        pos += dcode & 15;\n        let dlit = dcode >>> 4;\n        let dbs = U.ddef[dlit],\n            dst = (dbs >>> 4) + bitsF(data, pos, dbs & 15);\n        pos += dbs & 15; //let o0 = off-dst, stp = Math.min(end-off, dst);\n        //if(stp>20) while(off<end) {  buf.copyWithin(off, o0, o0+stp);  off+=stp;  }  else\n        //if(end-dst<=off) buf.copyWithin(off, off-dst, end-dst);  else\n        //if(dst==1) buf.fill(buf[off-1], off, end);  else\n\n        while (off < end) {\n          buf[off] = buf[off++ - dst];\n          buf[off] = buf[off++ - dst];\n          buf[off] = buf[off++ - dst];\n          buf[off] = buf[off++ - dst];\n        }\n\n        off = end; //while(off!=end) {  buf[off]=buf[off++-dst];  }\n      }\n    } //console.log(off-ooff, (pos-opos)>>>3);\n\n  } //console.log(UZIP.F.dst);\n  //console.log(tlen, dlen, off-tlen+tcnt);\n\n\n  return buf.length == off ? buf : buf.slice(0, off);\n};\n\nUZIP.F._check = function (buf, len) {\n  let bl = buf.length;\n  if (len <= bl) return buf;\n  let nbuf = new Uint8Array(bl << 1);\n\n  for (let i = 0; i < bl; i += 4) {\n    nbuf[i] = buf[i];\n    nbuf[i + 1] = buf[i + 1];\n    nbuf[i + 2] = buf[i + 2];\n    nbuf[i + 3] = buf[i + 3];\n  }\n\n  return nbuf;\n};\n\nUZIP.F._decodeTiny = function (lmap, LL, len, data, pos, tree) {\n  let opos = pos;\n  let bitsE = UZIP.F._bitsE,\n      get17 = UZIP.F._get17;\n  let dlen = len << 1,\n      i = 0,\n      mx = 0; //if(pos<1000) console.log(\"--------\");\n  //console.log(\"----\", pos, \":\",  data[7],data[8], data[9], data[10], data[11]);\n\n  while (i < dlen) {\n    let code = lmap[get17(data, pos) & LL];\n    pos += code & 15;\n    let lit = code >>> 4; //if(pos<1000) console.log(lit, i>>>1);\n    //if(i<20)console.log(lit, code>>>9, pos);\n\n    if (lit <= 15) {\n      tree[i] = 0;\n      tree[i + 1] = lit;\n      if (lit > mx) mx = lit;\n      i += 2;\n    } else {\n      let ll = 0,\n          n = 0;\n\n      if (lit == 16) {\n        n = 3 + bitsE(data, pos, 2) << 1;\n        pos += 2;\n        ll = tree[i - 1];\n      } else if (lit == 17) {\n        n = 3 + bitsE(data, pos, 3) << 1;\n        pos += 3;\n      } else if (lit == 18) {\n        n = 11 + bitsE(data, pos, 7) << 1;\n        pos += 7;\n      }\n\n      let ni = i + n;\n\n      while (i < ni) {\n        tree[i] = 0;\n        tree[i + 1] = ll;\n        i += 2;\n      }\n    }\n  }\n\n  let tl = tree.length;\n\n  while (i < tl) {\n    tree[i + 1] = 0;\n    i += 2;\n  }\n\n  return mx << 24 | pos - opos;\n};\n\nUZIP.F.makeCodes = function (tree, MAX_BITS) {\n  // code, length\n  let U = UZIP.F.U;\n  let max_code = tree.length;\n  let code, bits, n, i, len;\n  let bl_count = U.bl_count;\n\n  for (let i = 0; i <= MAX_BITS; i++) bl_count[i] = 0;\n\n  for (i = 1; i < max_code; i += 2) bl_count[tree[i]]++;\n\n  let next_code = U.next_code; // smallest code for each length\n\n  code = 0;\n  bl_count[0] = 0;\n\n  for (bits = 1; bits <= MAX_BITS; bits++) {\n    code = code + bl_count[bits - 1] << 1;\n    next_code[bits] = code;\n  }\n\n  for (n = 0; n < max_code; n += 2) {\n    len = tree[n + 1];\n\n    if (len != 0) {\n      tree[n] = next_code[len];\n      next_code[len]++;\n    }\n  }\n};\n\nUZIP.F.codes2map = function (tree, MAX_BITS, map) {\n  let max_code = tree.length;\n  let U = UZIP.F.U,\n      r15 = U.rev15;\n\n  for (let i = 0; i < max_code; i += 2) if (tree[i + 1] != 0) {\n    let lit = i >> 1;\n    let cl = tree[i + 1],\n        val = lit << 4 | cl; // :  (0x8000 | (U.of0[lit-257]<<7) | (U.exb[lit-257]<<4) | cl);\n\n    let rest = MAX_BITS - cl,\n        i0 = tree[i] << rest,\n        i1 = i0 + (1 << rest); //tree[i]=r15[i0]>>>(15-MAX_BITS);\n\n    while (i0 != i1) {\n      let p0 = r15[i0] >>> 15 - MAX_BITS;\n      map[p0] = val;\n      i0++;\n    }\n  }\n};\n\nUZIP.F.revCodes = function (tree, MAX_BITS) {\n  let r15 = UZIP.F.U.rev15,\n      imb = 15 - MAX_BITS;\n\n  for (let i = 0; i < tree.length; i += 2) {\n    let i0 = tree[i] << MAX_BITS - tree[i + 1];\n    tree[i] = r15[i0] >>> imb;\n  }\n};\n\nUZIP.F._putsE = function (dt, pos, val) {\n  val = val << (pos & 7);\n  let o = pos >>> 3;\n  dt[o] |= val;\n  dt[o + 1] |= val >>> 8;\n};\n\nUZIP.F._putsF = function (dt, pos, val) {\n  val = val << (pos & 7);\n  let o = pos >>> 3;\n  dt[o] |= val;\n  dt[o + 1] |= val >>> 8;\n  dt[o + 2] |= val >>> 16;\n};\n\nUZIP.F._bitsE = function (dt, pos, length) {\n  return (dt[pos >>> 3] | dt[(pos >>> 3) + 1] << 8) >>> (pos & 7) & (1 << length) - 1;\n};\n\nUZIP.F._bitsF = function (dt, pos, length) {\n  return (dt[pos >>> 3] | dt[(pos >>> 3) + 1] << 8 | dt[(pos >>> 3) + 2] << 16) >>> (pos & 7) & (1 << length) - 1;\n};\n/*\nUZIP.F._get9 = function(dt, pos) {\n\treturn ((dt[pos>>>3] | (dt[(pos>>>3)+1]<<8))>>>(pos&7))&511;\n} */\n\n\nUZIP.F._get17 = function (dt, pos) {\n  // return at least 17 meaningful bytes\n  return (dt[pos >>> 3] | dt[(pos >>> 3) + 1] << 8 | dt[(pos >>> 3) + 2] << 16) >>> (pos & 7);\n};\n\nUZIP.F._get25 = function (dt, pos) {\n  // return at least 17 meaningful bytes\n  return (dt[pos >>> 3] | dt[(pos >>> 3) + 1] << 8 | dt[(pos >>> 3) + 2] << 16 | dt[(pos >>> 3) + 3] << 24) >>> (pos & 7);\n};\n\nUZIP.F.U = {\n  next_code: new Uint16Array(16),\n  bl_count: new Uint16Array(16),\n  ordr: [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15],\n  of0: [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 999, 999, 999],\n  exb: [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, 0, 0, 0],\n  ldef: new Uint16Array(32),\n  df0: [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 65535, 65535],\n  dxb: [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, 0, 0],\n  ddef: new Uint32Array(32),\n  flmap: new Uint16Array(512),\n  fltree: [],\n  fdmap: new Uint16Array(32),\n  fdtree: [],\n  lmap: new Uint16Array(32768),\n  ltree: [],\n  dmap: new Uint16Array(32768),\n  dtree: [],\n  imap: new Uint16Array(512),\n  itree: [],\n  //rev9 : new Uint16Array(  512)\n  rev15: new Uint16Array(1 << 15),\n  lhst: new Uint32Array(286),\n  dhst: new Uint32Array(30),\n  ihst: new Uint32Array(19),\n  lits: new Uint32Array(15000),\n  strt: new Uint16Array(1 << 16),\n  prev: new Uint16Array(1 << 15)\n};\n\n(function () {\n  let U = UZIP.F.U;\n  let len = 1 << 15;\n\n  for (let i = 0; i < len; i++) {\n    let x = i;\n    x = (x & 0xaaaaaaaa) >>> 1 | (x & 0x55555555) << 1;\n    x = (x & 0xcccccccc) >>> 2 | (x & 0x33333333) << 2;\n    x = (x & 0xf0f0f0f0) >>> 4 | (x & 0x0f0f0f0f) << 4;\n    x = (x & 0xff00ff00) >>> 8 | (x & 0x00ff00ff) << 8;\n    U.rev15[i] = (x >>> 16 | x << 16) >>> 17;\n  }\n\n  for (let i = 0; i < 32; i++) {\n    U.ldef[i] = U.of0[i] << 3 | U.exb[i];\n    U.ddef[i] = U.df0[i] << 4 | U.dxb[i];\n  }\n\n  let i = 0;\n\n  for (; i <= 143; i++) U.fltree.push(0, 8);\n\n  for (; i <= 255; i++) U.fltree.push(0, 9);\n\n  for (; i <= 279; i++) U.fltree.push(0, 7);\n\n  for (; i <= 287; i++) U.fltree.push(0, 8);\n\n  UZIP.F.makeCodes(U.fltree, 9);\n  UZIP.F.codes2map(U.fltree, 9, U.flmap);\n  UZIP.F.revCodes(U.fltree, 9);\n\n  for (i = 0; i < 32; i++) U.fdtree.push(0, 5);\n\n  UZIP.F.makeCodes(U.fdtree, 5);\n  UZIP.F.codes2map(U.fdtree, 5, U.fdmap);\n  UZIP.F.revCodes(U.fdtree, 5);\n\n  for (let i = 0; i < 19; i++) U.itree.push(0, 0);\n\n  for (let i = 0; i < 286; i++) U.ltree.push(0, 0);\n\n  for (let i = 0; i < 30; i++) U.dtree.push(0, 0);\n})();\n\n// Modules\n// Private function to fetch a game\n\nconst fetchROMAsByteArray = (ROM, loadOptions) => {\n  const fetchROMAsByteArrayTask = async () => {\n    // Check if we were passed straight bytes\n    if (ArrayBuffer.isView(ROM) && ROM.constructor === Uint8Array) {\n      return {\n        ROM: ROM\n      };\n    } else if (typeof ROM === 'object' && ROM.size) {\n      // We were passed a file from HTML file input\n      // Read the file as a Uint8Array\n      let byteArray = await getROMFromFileReaderAsByteArray(ROM);\n\n      if (ROM.name.toLowerCase().endsWith('.zip')) {\n        byteArray = await parseByteArrayAsZip(byteArray);\n      }\n\n      return {\n        ROM: byteArray,\n        name: ROM.name\n      };\n    } else {\n      // We were passed a URL\n      // Fetch the file\n      // First check if we have headers\n      const fetchHeaders = {};\n\n      if (loadOptions && loadOptions.headers) {\n        fetchHeaders.headers = loadOptions.headers;\n      }\n\n      let bytes = await fetch(ROM, fetchHeaders).then(blob => {\n        if (!blob.ok) {\n          return Promise.reject(blob);\n        }\n\n        return blob.arrayBuffer();\n      });\n      let fileName = ROM;\n\n      if (loadOptions && loadOptions.fileName) {\n        fileName = loadOptions.fileName;\n      } // Get our byteArray\n\n\n      let byteArray = new Uint8Array(bytes);\n\n      if (fileName.toLowerCase().endsWith('.zip')) {\n        byteArray = await parseByteArrayAsZip(byteArray);\n      }\n\n      return {\n        ROM: byteArray,\n        name: fileName\n      };\n    }\n  };\n\n  return fetchROMAsByteArrayTask();\n};\n\nconst getROMFromFileReaderAsByteArray = async ROM => {\n  const fileReaderByteArray = await new Promise((resolve, reject) => {\n    // Read the file object\n    // https://www.javascripture.com/FileReader#readAsArrayBuffer_Blob\n    const fileReader = new FileReader();\n\n    fileReader.onload = () => {\n      const byteArray = new Uint8Array(fileReader.result);\n      resolve(byteArray);\n    };\n\n    fileReader.readAsArrayBuffer(ROM);\n  });\n  return fileReaderByteArray;\n}; // Function to parse and find the gb files within an archive\n\n\nconst parseByteArrayAsZip = async byteArray => {\n  // Parse the zip using UZIP\n  const unzipObject = await uzip.parse(byteArray); // Find the ROM in the output\n\n  let foundROM = false;\n  const unzipObjectKeys = Object.keys(unzipObject);\n  unzipObjectKeys.some(key => {\n    const lowercaseKey = key.toLowerCase();\n\n    if (lowercaseKey.includes('.gb') || lowercaseKey.includes('.gbc') || lowercaseKey.includes('.bin')) {\n      foundROM = unzipObject[key];\n      return true;\n    }\n\n    return false;\n  });\n\n  if (!foundROM) {\n    throw new Error('Could not find a ROM in zip...');\n  }\n\n  return foundROM;\n};\n\n// Functions here are depedent on WasmBoyMemory state.\n// https://docs.google.com/spreadsheets/d/17xrEzJk5-sCB9J2mMJcVnzhbE-XH_NvczVSQH9OHvRk/edit?usp=sharing\n\nconst WASMBOY_SAVE_STATE_SCHEMA = {\n  wasmboyMemory: {\n    wasmBoyInternalState: [],\n    wasmBoyPaletteMemory: [],\n    gameBoyMemory: [],\n    cartridgeRam: []\n  },\n  date: undefined,\n  isAuto: undefined\n}; // Function to return a save state of the current memory\n\nfunction getSaveState() {\n  // Save our internal wasmboy state to memory\n  // Should be done whenever we send back memory\n  // this.wasmInstance.exports.saveState();\n  let saveState = Object.assign({}, WASMBOY_SAVE_STATE_SCHEMA);\n  saveState.wasmboyMemory.wasmBoyInternalState = this.internalState;\n  saveState.wasmboyMemory.wasmBoyPaletteMemory = this.paletteMemory;\n  saveState.wasmboyMemory.gameBoyMemory = this.gameboyMemory;\n  saveState.wasmboyMemory.cartridgeRam = this.cartridgeRam;\n  saveState.date = Date.now();\n  saveState.isAuto = false;\n\n  if (this.saveStateCallback) {\n    this.saveStateCallback(saveState);\n  }\n\n  WasmBoyPlugins.runHook({\n    key: 'saveState',\n    params: [saveState]\n  });\n  return saveState;\n}\n\n// Functions here are depedent on WasmBoyMemory state.\n\nfunction _prepareAndStoreAutoSave() {\n  // Check if the game is currently playing\n  if (!this.internalState) {\n    return null;\n  } // Get our cartridge ram and header\n  // Use this.cartridgeHeader and this.cartridgeRam\n  //const header = getCartridgeHeader.bind(this)();\n  //const cartridgeRam = getCartridgeRam.bind(this)();\n  // Get our save state, and un type our arrays\n\n\n  const saveState = getSaveState.bind(this)();\n  const saveStateMemoryKeys = Object.keys(saveState.wasmboyMemory);\n\n  for (let i = 0; i < saveStateMemoryKeys.length; i++) {\n    saveState.wasmboyMemory[saveStateMemoryKeys[i]] = Array.prototype.slice.call(saveState.wasmboyMemory[saveStateMemoryKeys[i]]);\n  } // Set isAuto\n\n\n  saveState.isAuto = true; // Need to conert types arrays, and back, or selse wll get indexed JSON\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays\n\n  localStorage.setItem(this.WASMBOY_UNLOAD_STORAGE, JSON.stringify({\n    header: Array.prototype.slice.call(this.cartridgeHeader),\n    cartridgeRam: Array.prototype.slice.call(this.cartridgeRam),\n    saveState: saveState\n  }));\n  return null;\n} // Function to find any autosaves in localstorage, and commit them to our idb\n\n\nfunction _findAndCommitAutoSave() {\n  const findAndCommitAutoSaveTask = async () => {\n    // Load any unloaded storage in our localStorage\n    const unloadStorage = localStorage.getItem(this.WASMBOY_UNLOAD_STORAGE);\n\n    if (unloadStorage) {\n      const unloadStorageObject = JSON.parse(unloadStorage);\n      localStorage.removeItem(this.WASMBOY_UNLOAD_STORAGE);\n      const header = new Uint8Array(unloadStorageObject.header);\n      const cartridgeRam = new Uint8Array(unloadStorageObject.cartridgeRam); // Get our save state, and re-type our array\n\n      const saveState = unloadStorageObject.saveState;\n\n      if (saveState) {\n        const saveStateMemoryKeys = Object.keys(saveState.wasmboyMemory);\n\n        for (let i = 0; i < saveStateMemoryKeys.length; i++) {\n          saveState.wasmboyMemory[saveStateMemoryKeys[i]] = new Uint8Array(saveState.wasmboyMemory[saveStateMemoryKeys[i]]);\n        }\n      }\n\n      await this.saveCartridgeRam(header, cartridgeRam);\n      await this.saveState(header, saveState);\n    }\n  };\n\n  return findAndCommitAutoSaveTask();\n} // Function to set event listeners to run our unload handler\n\n\nfunction initializeAutoSave() {\n  // Set listeners to ensure we save our cartridge ram before closing\n  window.addEventListener('beforeunload', () => {\n    _prepareAndStoreAutoSave.bind(this)();\n  }, false);\n  window.addEventListener('unload', () => {\n    _prepareAndStoreAutoSave.bind(this)();\n  }, false);\n  window.addEventListener('pagehide', () => {\n    _prepareAndStoreAutoSave.bind(this)();\n  }, false); // Mobile Page visibility, for pressing home, closing tabs, task switcher, etc...\n  // https://www.igvita.com/2015/11/20/dont-lose-user-and-app-state-use-page-visibility/\n\n  document.addEventListener('visibilitychange', () => {\n    // fires when user switches tabs, apps, goes to homescreen, etc.\n    // NOTE: This will not create a new save state in desktop browser,\n    // Because the localstorage string is only picked up on refresh :)\n    // Unless you force kill the browser or something, which is what we want\n    // Anyways\n    if (document.visibilityState === 'hidden') {\n      _prepareAndStoreAutoSave.bind(this)();\n    }\n  }); // Restore any autosave lingering to be committed\n\n  return _findAndCommitAutoSave.bind(this)();\n}\n\nconst BOOT_ROM_KEY = 'boot-rom-';\n\nclass WasmBoyMemoryService {\n  constructor() {\n    this.worker = undefined;\n    this.maxNumberOfAutoSaveStates = undefined;\n    this.saveStateCallback = undefined;\n    this.loadedCartridgeMemoryState = {\n      ROM: false,\n      RAM: false,\n      BOOT: false\n    }; // Our different types of memory\n\n    this.bootRom = undefined;\n    this.cartridgeRom = undefined;\n    this.cartridgeRomFileName = undefined;\n    this.cartridgeHeader = undefined;\n    this.cartridgeRam = undefined;\n    this.gameboyMemory = undefined;\n    this.paletteMemory = undefined;\n    this.internalState = undefined; // Going to set the key for idbKeyval as the cartridge header.\n    // Then, for each cartridge, it will return an object.\n    // there will be a cartridgeRam Key, settings Key, and a saveState key\n    // Not going to make one giant object, as we want to keep idb transactions light and fast\n\n    this.WASMBOY_UNLOAD_STORAGE = 'WASMBOY_UNLOAD_STORAGE'; // Define some constants since calls to wasm are expensive\n\n    this.WASMBOY_GAME_BYTES_LOCATION = 0;\n    this.WASMBOY_GAME_RAM_BANKS_LOCATION = 0;\n    this.WASMBOY_INTERNAL_STATE_SIZE = 0;\n    this.WASMBOY_INTERNAL_STATE_LOCATION = 0;\n    this.WASMBOY_INTERNAL_MEMORY_SIZE = 0;\n    this.WASMBOY_INTERNAL_MEMORY_LOCATION = 0;\n    this.WASMBOY_PALETTE_MEMORY_SIZE = 0;\n    this.WASMBOY_PALETTE_MEMORY_LOCATION = 0; // Define some other constants\n\n    this.SUPPORTED_BOOT_ROM_TYPES = {\n      GB: 'GB',\n      GBC: 'GBC'\n    };\n  }\n\n  initialize(headless, maxNumberOfAutoSaveStates, saveStateCallback) {\n    this.maxNumberOfAutoSaveStates = maxNumberOfAutoSaveStates;\n    this.saveStateCallback = saveStateCallback;\n\n    const initializeTask = async () => {\n      await this._initializeConstants();\n\n      if (!headless) {\n        await initializeAutoSave.call(this);\n      }\n    };\n\n    return initializeTask();\n  }\n\n  setWorker(worker) {\n    this.worker = worker; // Also set our handler\n\n    this.worker.addMessageListener(event => {\n      const eventData = getEventData(event);\n\n      switch (eventData.message.type) {\n        case WORKER_MESSAGE_TYPE.UPDATED:\n          {\n            // Simply set our memory\n            const memoryTypes = Object.keys(eventData.message);\n            delete memoryTypes.type;\n\n            if (memoryTypes.includes(MEMORY_TYPE.BOOT_ROM)) {\n              this.bootRom = new Uint8Array(eventData.message[MEMORY_TYPE.BOOT_ROM]);\n            }\n\n            if (memoryTypes.includes(MEMORY_TYPE.CARTRIDGE_ROM)) {\n              this.cartridgeRom = new Uint8Array(eventData.message[MEMORY_TYPE.CARTRIDGE_ROM]);\n            }\n\n            if (memoryTypes.includes(MEMORY_TYPE.CARTRIDGE_RAM)) {\n              this.cartridgeRam = new Uint8Array(eventData.message[MEMORY_TYPE.CARTRIDGE_RAM]);\n            }\n\n            if (memoryTypes.includes(MEMORY_TYPE.GAMEBOY_MEMORY)) {\n              this.gameboyMemory = new Uint8Array(eventData.message[MEMORY_TYPE.GAMEBOY_MEMORY]);\n            }\n\n            if (memoryTypes.includes(MEMORY_TYPE.PALETTE_MEMORY)) {\n              this.paletteMemory = new Uint8Array(eventData.message[MEMORY_TYPE.PALETTE_MEMORY]);\n            }\n\n            if (memoryTypes.includes(MEMORY_TYPE.INTERNAL_STATE)) {\n              this.internalState = new Uint8Array(eventData.message[MEMORY_TYPE.INTERNAL_STATE]);\n            }\n\n            return;\n          }\n      }\n    });\n  } // Function to get all cartridge objects\n  // Saved in our indexed db\n\n\n  getSavedMemory() {\n    const getSavedMemoryTask = async () => {\n      const memory = [];\n      const keys = await idbKeyval.keys();\n\n      for (let i = 0; i < keys.length; i++) {\n        const cartridgeObject = await idbKeyval.get(keys[i]);\n        memory.push(cartridgeObject);\n      }\n\n      return memory;\n    };\n\n    return getSavedMemoryTask();\n  }\n\n  getLoadedCartridgeMemoryState() {\n    return this.loadedCartridgeMemoryState;\n  }\n\n  clearMemory() {\n    // Clear Wasm memory\n    // https://docs.google.com/spreadsheets/d/17xrEzJk5-sCB9J2mMJcVnzhbE-XH_NvczVSQH9OHvRk/edit?usp=sharing\n    return this.worker.postMessage({\n      type: WORKER_MESSAGE_TYPE.CLEAR_MEMORY\n    }).then(event => {\n      this.loadedCartridgeMemoryState.ROM = false;\n      this.loadedCartridgeMemoryState.RAM = false; // Reset everything\n\n      this.cartridgeRom = undefined;\n      this.cartridgeHeader = undefined;\n      this.cartridgeRam = undefined;\n      this.gameboyMemory = undefined;\n      this.paletteMemory = undefined;\n      this.internalState = undefined;\n    });\n  }\n\n  isValidBootROMType(type) {\n    return Object.keys(this.SUPPORTED_BOOT_ROM_TYPES).some(bootROMTypeKey => {\n      return this.SUPPORTED_BOOT_ROM_TYPES[bootROMTypeKey] === type;\n    });\n  }\n\n  async addBootROM(type, file, fetchHeaders, additionalInfo) {\n    type = type.toUpperCase();\n\n    if (!this.isValidBootROMType(type)) {\n      throw new Error('Invalid Boot ROM type');\n    } // Get our fetch rom object\n\n\n    const fetchROMObject = await fetchROMAsByteArray(file, fetchHeaders); // Remove any keys we don't want to allow\n    // Overriding in the additionalInfo\n\n    if (additionalInfo) {\n      delete additionalInfo.name;\n      delete additionalInfo.ROM;\n    }\n\n    let name = 'Game Boy';\n\n    if (this.SUPPORTED_BOOT_ROM_TYPES.GBC === type) {\n      name = 'Game Boy Color';\n    }\n\n    const bootROMObject = _objectSpread2({\n      ROM: fetchROMObject.ROM,\n      name,\n      type,\n      date: Date.now()\n    }, additionalInfo);\n\n    await idbKeyval.set(BOOT_ROM_KEY + type, bootROMObject);\n  }\n\n  async getBootROMs() {\n    const bootROMs = [];\n\n    for (let bootROMType in this.SUPPORTED_BOOT_ROM_TYPES) {\n      const bootROMObject = await idbKeyval.get(BOOT_ROM_KEY + bootROMType);\n\n      if (bootROMObject) {\n        bootROMs.push(bootROMObject);\n      }\n    }\n\n    return bootROMs;\n  }\n\n  async loadBootROMIfAvailable(type) {\n    if (!idbKeyval) {\n      // TODO: Allow headless Boot ROMs\n      return;\n    }\n\n    type = type.toUpperCase();\n\n    if (!this.isValidBootROMType(type)) {\n      throw new Error('Invalid Boot ROM type');\n    } // Try to get the boot rom object\n\n\n    const bootROMObject = await idbKeyval.get(BOOT_ROM_KEY + type);\n\n    if (!bootROMObject) {\n      // Return silently\n      return;\n    }\n\n    const workerMemoryObject = {};\n    workerMemoryObject[MEMORY_TYPE.BOOT_ROM] = bootROMObject.ROM.buffer; // Don't pass the rom as a transferrable, since,\n    // We want to keep a copy of it for reset\n\n    await this.worker.postMessage(_objectSpread2({\n      type: WORKER_MESSAGE_TYPE.SET_MEMORY\n    }, workerMemoryObject)).then(event => {\n      this.loadedCartridgeMemoryState.BOOT = true;\n    }); // Also get our cartridge header\n\n    await this.worker.postMessage({\n      type: WORKER_MESSAGE_TYPE.GET_MEMORY,\n      memoryTypes: [MEMORY_TYPE.BOOT_ROM]\n    }).then(event => {\n      const eventData = getEventData(event);\n      this.bootRom = new Uint8Array(eventData.message[MEMORY_TYPE.BOOT_ROM]);\n    });\n  }\n\n  loadCartridgeRom(ROM, fileName) {\n    const loadTask = async () => {\n      const workerMemoryObject = {};\n      workerMemoryObject[MEMORY_TYPE.CARTRIDGE_ROM] = ROM.buffer; // Don't pass the rom as a transferrable, since,\n      // We want to keep a copy of it for reset\n\n      await this.worker.postMessage(_objectSpread2({\n        type: WORKER_MESSAGE_TYPE.SET_MEMORY\n      }, workerMemoryObject)).then(event => {\n        this.loadedCartridgeMemoryState.ROM = true;\n      }); // Also get our cartridge header\n\n      await this.worker.postMessage({\n        type: WORKER_MESSAGE_TYPE.GET_MEMORY,\n        memoryTypes: [MEMORY_TYPE.CARTRIDGE_ROM, MEMORY_TYPE.CARTRIDGE_HEADER]\n      }).then(event => {\n        const eventData = getEventData(event);\n        this.cartridgeRom = new Uint8Array(eventData.message[MEMORY_TYPE.CARTRIDGE_ROM]);\n        this.cartridgeRomFileName = fileName;\n        this.cartridgeHeader = new Uint8Array(eventData.message[MEMORY_TYPE.CARTRIDGE_HEADER]);\n      });\n    };\n\n    return loadTask();\n  }\n\n  saveLoadedCartridge(additionalInfo) {\n    const saveLoadedCartridgeRomTask = async () => {\n      if (!this.cartridgeHeader) {\n        throw new Error('Error parsing the cartridge header');\n      }\n\n      let cartridgeObject = await idbKeyval.get(this.cartridgeHeader);\n\n      if (!cartridgeObject) {\n        cartridgeObject = {};\n      }\n\n      const cartridgeInfo = await this.getCartridgeInfo(); // Remove any keys we don't want to allow\n      // Overriding in the additionalInfo\n\n      if (additionalInfo) {\n        delete additionalInfo.ROM;\n        delete additionalInfo.header;\n      } // In the rare chance we don't know the name, set to unkown.\n\n\n      let fileName = this.cartridgeRomFileName || 'Unknown';\n      cartridgeObject.cartridgeRom = _objectSpread2({\n        ROM: this.cartridgeRom,\n        header: this.cartridgeHeader,\n        fileName: fileName,\n        date: Date.now()\n      }, additionalInfo);\n      cartridgeObject.cartridgeInfo = cartridgeInfo;\n\n      if (this.cartridgeRam) {\n        await this.saveCartridgeRam();\n      }\n\n      await idbKeyval.set(this.cartridgeHeader, cartridgeObject);\n      return cartridgeObject;\n    };\n\n    return saveLoadedCartridgeRomTask();\n  }\n\n  deleteSavedCartridge(cartridge) {\n    const deleteLoadedCartridgeTask = async () => {\n      const cartridgeHeader = cartridge.cartridgeInfo.header;\n\n      if (!cartridgeHeader) {\n        throw new Error('Error parsing the cartridge header');\n      }\n\n      let cartridgeObject = await idbKeyval.get(cartridgeHeader);\n\n      if (!cartridgeObject) {\n        throw new Error('Could not find the passed cartridge');\n      }\n\n      delete cartridgeObject.cartridgeRom;\n      await idbKeyval.set(cartridgeHeader, cartridgeObject);\n      return cartridgeObject;\n    };\n\n    return deleteLoadedCartridgeTask();\n  } // Function to save the cartridge ram\n  // This emulates the cartridge having a battery to\n  // Keep things like Pokemon Save data in memory\n  // Also allows passing in a a Uint8Array header and ram to be set manually\n\n\n  saveCartridgeRam(passedHeader, passedCartridgeRam) {\n    const saveCartridgeRamTask = async () => {\n      // Get the entire header in byte memory\n      // Each version of a rom can have similar title and checksums\n      // Therefore comparing all of it should help with this :)\n      // https://drive.google.com/file/d/0B7y-o-Uytiv9OThXWXFCM1FPbGs/view\n      let header;\n      let cartridgeRam;\n\n      if (passedHeader && passedCartridgeRam) {\n        header = passedHeader;\n        cartridgeRam = passedCartridgeRam;\n      } else {\n        header = this.cartridgeHeader;\n        cartridgeRam = this.cartridgeRam;\n      }\n\n      if (!header || !cartridgeRam) {\n        throw new Error('Error parsing the cartridgeRam or cartridge header');\n      } // Get our cartridge object\n\n\n      let cartridgeObject = await idbKeyval.get(header);\n\n      if (!cartridgeObject) {\n        cartridgeObject = {};\n      } // Set the cartridgeRam to our cartridgeObject\n\n\n      cartridgeObject.cartridgeRam = cartridgeRam;\n      await idbKeyval.set(header, cartridgeObject);\n    };\n\n    return saveCartridgeRamTask();\n  } // function to load the cartridge ram\n  // opposite of above\n\n\n  loadCartridgeRam() {\n    const loadCartridgeRamTask = async () => {\n      const header = this.cartridgeHeader;\n\n      if (!header) {\n        throw new Error('Error parsing the cartridge header');\n      }\n\n      const cartridgeObject = await idbKeyval.get(header);\n\n      if (!cartridgeObject || !cartridgeObject.cartridgeRam) {\n        return;\n      } // Set the cartridgeRam\n      // Don't transfer, because we want to keep a reference to it\n\n\n      const workerMemoryObject = {};\n      workerMemoryObject[MEMORY_TYPE.CARTRIDGE_RAM] = cartridgeObject.cartridgeRam.buffer;\n      await this.worker.postMessage(_objectSpread2({\n        type: WORKER_MESSAGE_TYPE.SET_MEMORY\n      }, workerMemoryObject)).then(event => {\n        this.loadedCartridgeMemoryState.RAM = true;\n        this.cartridgeRam = cartridgeObject.cartridgeRam;\n      });\n    };\n\n    return loadCartridgeRamTask();\n  } // Function to save the state to the indexeddb\n\n\n  saveState(passedHeader, passedSaveState) {\n    const saveStateTask = async () => {\n      // Get our save state\n      let saveState;\n      let header;\n\n      if (passedHeader && passedSaveState) {\n        saveState = passedSaveState;\n        header = passedHeader;\n      } else {\n        saveState = getSaveState.call(this);\n        header = this.cartridgeHeader;\n      }\n\n      if (!header) {\n        throw new Error('Error parsing the cartridge header');\n      }\n\n      let cartridgeObject = await idbKeyval.get(header);\n\n      if (!cartridgeObject) {\n        cartridgeObject = {};\n      }\n\n      if (!cartridgeObject.saveStates) {\n        cartridgeObject.saveStates = [];\n      } // Check if we are auto\n\n\n      if (saveState.isAuto && this.maxNumberOfAutoSaveStates && this.maxNumberOfAutoSaveStates > 0) {\n        // Make sure we are not exceeding the max number of auto save states\n        const autoSaveStates = [];\n        cartridgeObject.saveStates.forEach(savedState => {\n          if (savedState.isAuto) {\n            autoSaveStates.push(savedState);\n          }\n        }); // Sort auto save states by date\n\n        autoSaveStates.sort((a, b) => {\n          if (a.date < b.date) {\n            return -1;\n          }\n\n          if (a.date > b.date) {\n            return 1;\n          }\n\n          return 0;\n        });\n\n        while (autoSaveStates.length > 0 && autoSaveStates.length + 1 > this.maxNumberOfAutoSaveStates) {\n          const autoSaveState = autoSaveStates.shift(); // Find the save state\n\n          const saveStateIndex = this._indexOfSaveStateIndexInSaveStates(autoSaveState, cartridgeObject.saveStates);\n\n          cartridgeObject.saveStates.splice(saveStateIndex, 1);\n        }\n\n        if (this.maxNumberOfAutoSaveStates > 0) {\n          cartridgeObject.saveStates.push(saveState);\n        }\n      } else {\n        cartridgeObject.saveStates.push(saveState);\n      }\n\n      await idbKeyval.set(header, cartridgeObject);\n      return saveState;\n    };\n\n    return saveStateTask();\n  }\n\n  loadState(saveState) {\n    const loadStateTask = async () => {\n      const header = this.cartridgeHeader;\n\n      if (!header) {\n        throw new Error('Error getting the cartridge header');\n      }\n\n      if (!saveState) {\n        const cartridgeObject = await idbKeyval.get(header);\n\n        if (!cartridgeObject || !cartridgeObject.saveStates) {\n          throw new Error('No Save State passed, and no cartridge object found');\n          return;\n        }\n\n        saverState = cartridgeObject.saveStates[0];\n      }\n\n      const workerMemoryObject = {};\n      workerMemoryObject[MEMORY_TYPE.CARTRIDGE_RAM] = saveState.wasmboyMemory.cartridgeRam.buffer;\n      workerMemoryObject[MEMORY_TYPE.GAMEBOY_MEMORY] = saveState.wasmboyMemory.gameBoyMemory.buffer;\n      workerMemoryObject[MEMORY_TYPE.PALETTE_MEMORY] = saveState.wasmboyMemory.wasmBoyPaletteMemory.buffer;\n      workerMemoryObject[MEMORY_TYPE.INTERNAL_STATE] = saveState.wasmboyMemory.wasmBoyInternalState.buffer;\n      await this.worker.postMessage(_objectSpread2({\n        type: WORKER_MESSAGE_TYPE.SET_MEMORY\n      }, workerMemoryObject), [workerMemoryObject[MEMORY_TYPE.CARTRIDGE_RAM], workerMemoryObject[MEMORY_TYPE.GAMEBOY_MEMORY], workerMemoryObject[MEMORY_TYPE.PALETTE_MEMORY], workerMemoryObject[MEMORY_TYPE.INTERNAL_STATE]]);\n      await this.worker.postMessage({\n        type: WORKER_MESSAGE_TYPE.GET_MEMORY,\n        memoryTypes: [MEMORY_TYPE.CARTRIDGE_RAM, MEMORY_TYPE.GAMEBOY_MEMORY, MEMORY_TYPE.PALETTE_MEMORY, MEMORY_TYPE.INTERNAL_STATE]\n      }).then(event => {\n        const eventData = getEventData(event);\n        this.cartridgeRam = eventData.message[MEMORY_TYPE.CARTRIDGE_RAM];\n        this.gameboyMemory = eventData.message[MEMORY_TYPE.GAMEBOY_MEMORY];\n        this.paletteMemory = eventData.message[MEMORY_TYPE.PALETTE_MEMORY];\n        this.internalState = eventData.message[MEMORY_TYPE.INTERNAL_STATE];\n      });\n    };\n\n    return loadStateTask();\n  }\n\n  deleteState(saveState, passedHeader) {\n    const deleteStateTask = async () => {\n      if (!saveState) {\n        throw new Error('You must provide a save state to delete');\n        return;\n      }\n\n      let header;\n\n      if (passedHeader) {\n        header = passedHeader;\n      } else if (this.cartridgeHeader) {\n        header = this.cartridgeHeader;\n      }\n\n      if (!header) {\n        throw new Error('Please load a ROM, or pass a Cartridge header...');\n        return;\n      }\n\n      let cartridgeObject = await idbKeyval.get(header);\n\n      if (!cartridgeObject || !cartridgeObject.saveStates) {\n        throw new Error('No save states found for the Cartridge...');\n        return;\n      } // Find the save state\n\n\n      const saveStateIndex = this._indexOfSaveStateIndexInSaveStates(saveState, cartridgeObject.saveStates); // If not found, throw an error\n\n\n      if (saveStateIndex < 0) {\n        throw new Error('Could not find the passed save state for the related cartridge...');\n        return;\n      }\n\n      cartridgeObject.saveStates.splice(saveStateIndex, 1);\n      await idbKeyval.set(header, cartridgeObject);\n      return saveState;\n    };\n\n    return deleteStateTask();\n  } // Function to return the current cartridge object\n\n\n  getCartridgeObject() {\n    return idbKeyval.get(this.cartridgeHeader);\n  } // Function to return all informationh aboyut the currently loaded cart.\n  // This will include, the ROM, the RAM, the header, and the indivudal pieces of the header\n  // See: http://gbdev.gg8.se/wiki/articles/The_Cartridge_Header\n\n\n  getCartridgeInfo() {\n    if (!this.loadedCartridgeMemoryState.ROM) {\n      return Promise.reject('No ROM has been loaded');\n    }\n\n    let getCartridgeInfoTask = async () => {\n      const cartridgeInfo = {};\n      cartridgeInfo.header = this.cartridgeHeader;\n      cartridgeInfo.ROM = this.cartridgeRom;\n      cartridgeInfo.RAM = this.cartridgeRam; // Now parse our header for additional information\n\n      cartridgeInfo.nintendoLogo = cartridgeInfo.ROM.slice(0x104, 0x134);\n      cartridgeInfo.title = cartridgeInfo.ROM.slice(0x134, 0x144);\n      cartridgeInfo.titleAsString = String.fromCharCode.apply(null, cartridgeInfo.title);\n      cartridgeInfo.manufacturerCode = cartridgeInfo.ROM.slice(0x13f, 0x143);\n      cartridgeInfo.CGBFlag = cartridgeInfo.ROM[0x143];\n      cartridgeInfo.newLicenseeCode = cartridgeInfo.ROM.slice(0x144, 0x146);\n      cartridgeInfo.SGBFlag = cartridgeInfo.ROM[0x146];\n      cartridgeInfo.cartridgeType = cartridgeInfo.ROM[0x147];\n      cartridgeInfo.ROMSize = cartridgeInfo.ROM[0x148];\n      cartridgeInfo.RAMSize = cartridgeInfo.ROM[0x149];\n      cartridgeInfo.destinationCode = cartridgeInfo.ROM[0x14a];\n      cartridgeInfo.oldLicenseeCode = cartridgeInfo.ROM[0x14b];\n      cartridgeInfo.maskROMVersionNumber = cartridgeInfo.ROM[0x14c];\n      cartridgeInfo.headerChecksum = cartridgeInfo.ROM[0x14d];\n      cartridgeInfo.globalChecksum = cartridgeInfo.ROM.slice(0x14e, 0x150);\n      return cartridgeInfo;\n    };\n\n    return getCartridgeInfoTask();\n  }\n\n  _initializeConstants() {\n    // Initialize our cached wasm constants\n    return this.worker.postMessage({\n      type: WORKER_MESSAGE_TYPE.GET_CONSTANTS\n    }).then(event => {\n      const eventData = getEventData(event);\n      Object.keys(this).forEach(key => {\n        if (eventData.message[key] !== undefined) {\n          this[key] = eventData.message[key];\n        }\n      });\n    });\n  }\n\n  _indexOfSaveStateIndexInSaveStates(saveState, saveStates) {\n    // Find the save state\n    let saveStateIndex = saveStates.indexOf(saveState);\n\n    if (saveStateIndex < 0) {\n      const keysCheck = (a, b) => {\n        return JSON.stringify(Object.keys(a)) === JSON.stringify(Object.keys(b));\n      };\n\n      const dateCheck = (a, b) => {\n        return a.date === b.date;\n      };\n\n      const autoCheck = (a, b) => {\n        return a.isAuto === b.isAuto;\n      };\n\n      saveStates.some((savedState, index) => {\n        if (keysCheck(saveState, savedState) && dateCheck(saveState, savedState) && autoCheck(saveState, savedState)) {\n          saveStateIndex = index;\n          return true;\n        }\n\n        return false;\n      });\n    }\n\n    return saveStateIndex;\n  }\n\n} // Create a singleton to export\n\n\nconst WasmBoyMemory = new WasmBoyMemoryService();\n\nfunction d(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},e=Object.keys(c);\"function\"===typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable})));e.forEach(function(b){var e=c[b];b in a?Object.defineProperty(a,b,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[b]=e;});}return a}\nlet g={DPAD_UP:\"DPAD_UP\",DPAD_RIGHT:\"DPAD_RIGHT\",DPAD_DOWN:\"DPAD_DOWN\",DPAD_LEFT:\"DPAD_LEFT\",LEFT_ANALOG_HORIZONTAL_AXIS:\"LEFT_ANALOG_HORIZONTAL_AXIS\",LEFT_ANALOG_VERTICAL_AXIS:\"LEFT_ANALOG_VERTICAL_AXIS\",LEFT_ANALOG_UP:\"LEFT_ANALOG_UP\",LEFT_ANALOG_RIGHT:\"LEFT_ANALOG_RIGHT\",LEFT_ANALOG_DOWN:\"LEFT_ANALOG_DOWN\",LEFT_ANALOG_LEFT:\"LEFT_ANALOG_LEFT\",RIGHT_ANALOG_HORIZONTAL_AXIS:\"RIGHT_ANALOG_HORIZONTAL_AXIS\",RIGHT_ANALOG_VERTICAL_AXIS:\"RIGHT_ANALOG_VERTICAL_AXIS\",RIGHT_ANALOG_UP:\"RIGHT_ANALOG_UP\",RIGHT_ANALOG_RIGHT:\"RIGHT_ANALOG_RIGHT\",\nRIGHT_ANALOG_DOWN:\"RIGHT_ANALOG_DOWN\",RIGHT_ANALOG_LEFT:\"RIGHT_ANALOG_LEFT\",A:\"A\",B:\"B\",X:\"X\",Y:\"Y\",LEFT_TRIGGER:\"LEFT_TRIGGER\",LEFT_BUMPER:\"LEFT_BUMPER\",RIGHT_TRIGGER:\"RIGHT_TRIGGER\",RIGHT_BUMPER:\"RIGHT_BUMPER\",SELECT:\"SELECT\",START:\"START\",SPECIAL:\"SPECIAL\"};class h{constructor(){}enable(){throw Error(\"enable() must be overridden\");}disable(){throw Error(\"disable() must be overridden\");}getState(){throw Error(\"getState() must be overridden\");}}\nlet k=\"input textarea button select option optgroup label datalist\".split(\" \"),l=[\"Alt\",\"Control\",\"Meta\",\"OS\"];\nclass m extends h{constructor(){super();this.keymap={};Object.keys(g).forEach((a)=>{this.keymap[a]={keys:[],value:void 0};});this.enableIgnoreWhenInputElementFocused();this.enableIgnoreWhenModifierState();this._boundUpdateKeymapValues=this._updateKeymapValues.bind(this);}enable(){if(\"undefined\"===typeof window)throw Error(\"Keyboard can only be used with a browser environment\");window.addEventListener(\"keyup\",this._boundUpdateKeymapValues);window.addEventListener(\"keydown\",this._boundUpdateKeymapValues);}disable(){if(\"undefined\"===\ntypeof window)throw Error(\"Keyboard can only be used with a browser environment\");window.removeEventListener(\"keyup\",this._boundUpdateKeymapValues);window.removeEventListener(\"keydown\",this._boundUpdateKeymapValues);}getState(){let a=d({},g);Object.keys(this.keymap).forEach((b)=>{a[b]=this.keymap[b].value;});Object.keys(a).forEach((b)=>{\"string\"===typeof a[b]&&delete a[b];});return a}enableIgnoreWhenInputElementFocused(){this.ignoreWhenInputElementFocused=!0;}disableIgnoreWhenInputElementFocused(){this.ignoreWhenInputElementFocused=\n!1;}enableIgnoreWhenModifierState(){this.ignoreOnModifierState=!0;}disableIgnoreWhenModifierState(){this.ignoreOnModifierState=!1;}setKeysToResponsiveGamepadInput(a,b){if(!a||!b||0===a.length)throw Error(\"Could not set the specificed keyboard keys to input\");\"string\"===typeof a&&(a=[a]);this.keymap[b].keys=a;}_isFocusedOnInputElement(){return k.some((a)=>document.activeElement&&document.activeElement.tagName.toLowerCase()===a.toLowerCase()?!0:!1)}_isInModifierState(a){return l.some((b)=>a.getModifierState(b)||\na.code===b)}_updateKeymapValues(a){this.ignoreWhenInputElementFocused&&this._isFocusedOnInputElement()||this.ignoreOnModifierState&&this._isInModifierState(a)||(a.preventDefault(),Object.keys(this.keymap).some((b)=>this.keymap[b].keys.some((c)=>c===a.code?(this.keymap[b].value=\"keydown\"===a.type?!0:!1,!0):!1)));}}\nclass n extends h{constructor(){super();this.gamepadAnalogStickDeadZone=.25;this.keymap={};}enable(){}disable(){}getState(a){let b=this._getGamepads();a||(a=0);let c=b[a];if(!c)return !1;Object.keys(this.keymap).forEach((a)=>{if(this.keymap[a].buttons)this.keymap[a].value=this.keymap[a].buttons.some((a)=>this._isButtonPressed(c,a));else if(this.keymap[a].axis){let b=this._getAnalogStickAxis(c,this.keymap[a].axis);this.keymap[a].value=b;}});let e=d({},g);Object.keys(this.keymap).forEach((a)=>{e[a]=this.keymap[a].value;});\ne[g.LEFT_ANALOG_DOWN]=e.LEFT_ANALOG_VERTICAL_AXIS>this.gamepadAnalogStickDeadZone;e[g.LEFT_ANALOG_UP]=e.LEFT_ANALOG_VERTICAL_AXIS<-1*this.gamepadAnalogStickDeadZone;e[g.LEFT_ANALOG_RIGHT]=e.LEFT_ANALOG_HORIZONTAL_AXIS>this.gamepadAnalogStickDeadZone;e[g.LEFT_ANALOG_LEFT]=e.LEFT_ANALOG_HORIZONTAL_AXIS<-1*this.gamepadAnalogStickDeadZone;e[g.RIGHT_ANALOG_DOWN]=e.RIGHT_ANALOG_VERTICAL_AXIS>this.gamepadAnalogStickDeadZone;e[g.RIGHT_ANALOG_UP]=e.RIGHT_ANALOG_VERTICAL_AXIS<-1*this.gamepadAnalogStickDeadZone;\ne[g.RIGHT_ANALOG_RIGHT]=e.RIGHT_ANALOG_HORIZONTAL_AXIS>this.gamepadAnalogStickDeadZone;e[g.RIGHT_ANALOG_LEFT]=e.RIGHT_ANALOG_HORIZONTAL_AXIS<-1*this.gamepadAnalogStickDeadZone;Object.keys(e).forEach((a)=>{\"string\"===typeof e[a]&&delete e[a];});return e}setGamepadButtonsToResponsiveGamepadInput(a,b){if(!a||!b||0===a.length)throw Error(\"Could not set the specificed buttons to input\");\"number\"===typeof a&&(a=[a]);this.keymap[b]={};this.keymap[b].buttons=a;}setGamepadAxisToResponsiveGamepadInput(a,b){if(void 0===\na||!b)throw Error(\"Could not set the specificed buttons to input\");if(\"number\"===typeof axes)throw Error(\"Must pass in an axis id\");this.keymap[b]={};this.keymap[b].axis=a;}_isButtonPressed(a,b){return a.buttons[b]?a.buttons[b].pressed:!1}_getGamepads(){return navigator.getGamepads?navigator.getGamepads():[]}_getAnalogStickAxis(a,b){return a?a.axes[b]||0:0}}let q=\"touchstart touchmove touchend mousedown mousemove mouseup mouseleave\".split(\" \");\nclass r{constructor(a){if(!a)throw Error(\"Touch inputs require an element.\");this.listeners=[];this.element=a;this._addTouchStyles();this.boundingClientRect=void 0;this._updateElementBoundingClientRect();this.active=!1;this.boundUpdateElementRect=this._updateElementBoundingClientRect.bind(this);this.boundTouchEvent=this._touchEvent.bind(this);}remove(){this._removeTouchStyles();this.stopListening();this.element=void 0;}listen(){if(!this.element)throw Error(\"You must supply an element first with add()\");\nwindow.addEventListener(\"resize\",this.boundUpdateElementRect);q.forEach((a)=>{this.element.addEventListener(a,this.boundTouchEvent);});}stopListening(){if(!this.element)throw Error(\"You must supply an element first with add()\");window.removeEventListener(\"resize\",this.boundUpdateElementRect);q.forEach((a)=>{this.element.removeEventListener(a,this.boundTouchEvent);});}_touchEvent(a){if(a&&(!a.type.includes(\"touch\")||a.touches)){a.preventDefault();var b=\"touchstart\"===a.type||\"touchmove\"===a.type||\"mousedown\"===\na.type,c=\"mousemove\"===a.type,e=!b&&!c;this._updateActiveStatus(b,e);this._updateTouchStyles(b,c,e);if(this.onTouchEvent)this.onTouchEvent(a,b,c,e);}}_updateElementBoundingClientRect(){this.boundingClientRect=this.element.getBoundingClientRect();}_addTouchStyles(){this.element.style.userSelect=\"none\";}_removeTouchStyles(){this.element.style.userSelect=\"\";}_updateTouchStyles(a,b){b||(a?this.element.classList.add(\"active\"):this.element.classList.remove(\"active\"));}_updateActiveStatus(a,b){this.active&&b?\nthis.active=!1:!this.active&&a&&(this.active=!0);}}function t(a,b){let c;a.type.includes(\"touch\")?c=a.touches[0]:a.type.includes(\"mouse\")&&(c=a);return {rectCenterX:(b.right-b.left)/2,rectCenterY:(b.bottom-b.top)/2,touchX:c.clientX-b.left,touchY:c.clientY-b.top}}\nclass u extends r{constructor(a,b){super(a);this.config=b?b:{allowMultipleDirections:!1};this._resetState();}_resetState(){this.state={DPAD_UP:!1,DPAD_RIGHT:!1,DPAD_DOWN:!1,DPAD_LEFT:!1};}onTouchEvent(a){if(this.active){var {rectCenterX:a,rectCenterY:b,touchX:c,touchY:e}=t(a,this.boundingClientRect);if(!(c>a+this.boundingClientRect.width/2+50)){this._resetState();var f=this.boundingClientRect.width/20,p=this.boundingClientRect.height/20;this.config.allowMultipleDirections?(this.setHorizontalState(c,\nf),this.setVerticalState(e,p)):Math.abs(a-c)+this.boundingClientRect.width/8>Math.abs(b-e)?this.setHorizontalState(c,f):this.setVerticalState(e);}}else this._resetState();}setHorizontalState(a,b){b&&Math.abs(this.boundingClientRect.width/2-a)<=b||(a<this.boundingClientRect.width/2?this.state.DPAD_LEFT=!0:this.state.DPAD_RIGHT=!0);}setVerticalState(a,b){b&&Math.abs(this.boundingClientRect.height/2-a)<b||(a<this.boundingClientRect.height/2?this.state.DPAD_UP=!0:this.state.DPAD_DOWN=!0);}}\nclass v extends r{constructor(a){super(a);this._resetState();}_resetState(){this.state={HORIZONTAL_AXIS:0,VERTICAL_AXIS:0,UP:!1,RIGHT:!1,DOWN:!1,LEFT:!1};this.element.style.transform=\"translate(0px, 0px)\";this.deadzone=.5;}onTouchEvent(a){if(this.active){var {rectCenterX:a,rectCenterY:b,touchX:c,touchY:e}=t(a,this.boundingClientRect);c=(c-a)/a;1<c?c=1:-1>c&&(c=-1);e=(e-b)/b;1<e?e=1:-1>e&&(e=-1);this.element.style.transform=`translate(${a*c/2}px, ${b*e/2}px)`;this.state.HORIZONTAL_AXIS=c;this.state.VERTICAL_AXIS=\ne;this.state.UP=!1;this.state.RIGHT=!1;this.state.DOWN=!1;this.state.LEFT=!1;Math.abs(c)>this.deadzone&&(0<c?this.state.RIGHT=!0:0>c&&(this.state.LEFT=!0));Math.abs(e)>this.deadzone&&(0<e?this.state.DOWN=!0:0>e&&(this.state.UP=!0));}else this._resetState();}}class w extends r{constructor(a,b){super(a);this.input=b;}}let x={LEFT:\"LEFT\",RIGHT:\"RIGHT\"};\nclass y extends h{constructor(){super();this.enabled=!1;this.dpads=[];this.leftAnalogs=[];this.rightAnalogs=[];this.buttons=[];}enable(){if(\"undefined\"===typeof window)throw Error(\"TouchInput can only be used with a browser environment\");this.enabled=!0;this.dpads.forEach((a)=>a.listen());this.leftAnalogs.forEach((a)=>a.listen());this.rightAnalogs.forEach((a)=>a.listen());this.buttons.forEach((a)=>a.listen());}disable(){if(\"undefined\"===typeof window)throw Error(\"TouchInput can only be used with a browser environment\");\nthis.enabled=!1;this.dpads.forEach((a)=>a.stopListening());this.leftAnalogs.forEach((a)=>a.stopListening());this.rightAnalogs.forEach((a)=>a.stopListening());this.buttons.forEach((a)=>a.stopListening());}getState(){let a=d({},g);this.buttons.forEach((b)=>{a[b.input]=b.active;});this.dpads.forEach((b)=>{Object.keys(b.state).forEach((c)=>{a[c]=b.state[c]||a[c];});});0<this.leftAnalogs.length&&(a.LEFT_ANALOG_HORIZONTAL_AXIS=this.leftAnalogs[0].state.HORIZONTAL_AXIS,a.LEFT_ANALOG_VERTICAL_AXIS=this.leftAnalogs[0].state.VERTICAL_AXIS,\na.LEFT_ANALOG_UP=this.leftAnalogs[0].state.UP,a.LEFT_ANALOG_RIGHT=this.leftAnalogs[0].state.RIGHT,a.LEFT_ANALOG_DOWN=this.leftAnalogs[0].state.DOWN,a.LEFT_ANALOG_LEFT=this.leftAnalogs[0].state.LEFT);0<this.rightAnalogs.length&&(a.RIGHT_ANALOG_HORIZONTAL_AXIS=this.rightAnalogs[0].state.HORIZONTAL_AXIS,a.RIGHT_ANALOG_VERTICAL_AXIS=this.rightAnalogs[0].state.VERTICAL_AXIS,a.RIGHT_ANALOG_UP=this.rightAnalogs[0].state.UP,a.RIGHT_ANALOG_RIGHT=this.rightAnalogs[0].state.RIGHT,a.RIGHT_ANALOG_DOWN=this.rightAnalogs[0].state.DOWN,\na.RIGHT_ANALOG_LEFT=this.rightAnalogs[0].state.LEFT);Object.keys(a).forEach((b)=>{\"string\"===typeof a[b]&&delete a[b];});return a}addButtonInput(a,b){let c=new w(a,b);this.enabled&&c.listen();this.buttons.push(c);return ()=>{c.stopListening();this.buttons.splice(this.buttons.indexOf(c),1);}}addDpadInput(a,b){let c=new u(a,b);this.enabled&&c.listen();this.dpads.push(c);return ()=>{c.stopListening();this.dpads.splice(this.dpads.indexOf(c),1);}}addLeftAnalogInput(a){this.addAnalogInput(a,x.LEFT);}addRightAnalogInput(a){this.addAnalogInput(a,\nx.RIGHT);}addAnalogInput(a,b){let c=new v(a);this.enabled&&c.listen();if(b===x.LEFT)return this.leftAnalogs.push(c),()=>{c.stopListening();this.leftAnalogs.splice(this.leftAnalogs.indexOf(c),1);};this.rightAnalogs.push(c);return ()=>{c.stopListening();this.rightAnalogs.splice(this.rightAnalogs.indexOf(c),1);}}}\nclass z{constructor(){this.RESPONSIVE_GAMEPAD_INPUTS=g;this._enabled=!1;this._multipleDirectionInput=!0;this.Keyboard=new m;this.Gamepad=new n;this.TouchInput=new y;this.Keyboard.setKeysToResponsiveGamepadInput([\"ArrowUp\",\"Numpad8\"],g.DPAD_UP);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyW\"],g.LEFT_ANALOG_UP);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyI\"],g.RIGHT_ANALOG_UP);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([12],g.DPAD_UP);this.Keyboard.setKeysToResponsiveGamepadInput([\"ArrowRight\",\n\"Numpad6\"],g.DPAD_RIGHT);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyD\"],g.LEFT_ANALOG_RIGHT);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyL\"],g.RIGHT_ANALOG_RIGHT);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([15],g.DPAD_RIGHT);this.Keyboard.setKeysToResponsiveGamepadInput([\"ArrowDown\",\"Numpad5\",\"Numpad2\"],g.DPAD_DOWN);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyS\"],g.LEFT_ANALOG_DOWN);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyK\"],g.RIGHT_ANALOG_DOWN);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([13],\ng.DPAD_DOWN);this.Keyboard.setKeysToResponsiveGamepadInput([\"ArrowLeft\",\"Numpad4\"],g.DPAD_LEFT);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyA\"],g.LEFT_ANALOG_LEFT);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyJ\"],g.RIGHT_ANALOG_LEFT);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([14],g.DPAD_LEFT);this.Gamepad.setGamepadAxisToResponsiveGamepadInput([0],g.LEFT_ANALOG_HORIZONTAL_AXIS);this.Gamepad.setGamepadAxisToResponsiveGamepadInput([1],g.LEFT_ANALOG_VERTICAL_AXIS);this.Gamepad.setGamepadAxisToResponsiveGamepadInput([2],\ng.RIGHT_ANALOG_HORIZONTAL_AXIS);this.Gamepad.setGamepadAxisToResponsiveGamepadInput([3],g.RIGHT_ANALOG_VERTICAL_AXIS);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyX\",\"Semicolon\",\"Numpad7\"],g.A);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([0],g.A);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyZ\",\"Escape\",\"Quote\",\"Backspace\",\"Numpad9\"],g.B);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([1],g.B);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyC\"],g.X);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([2],\ng.X);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyV\"],g.Y);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([3],g.Y);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyQ\"],g.LEFT_TRIGGER);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([6],g.LEFT_TRIGGER);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyE\"],g.LEFT_BUMPER);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([4],g.LEFT_BUMPER);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyU\"],g.RIGHT_TRIGGER);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([7],\ng.RIGHT_TRIGGER);this.Keyboard.setKeysToResponsiveGamepadInput([\"KeyO\"],g.RIGHT_BUMPER);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([5],g.RIGHT_BUMPER);this.Keyboard.setKeysToResponsiveGamepadInput([\"Enter\",\"Numpad3\"],g.START);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([9],g.START);this.Keyboard.setKeysToResponsiveGamepadInput([\"ShiftRight\",\"ShiftLeft\",\"Tab\",\"Numpad1\"],g.SELECT);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([8],g.SELECT);this.Keyboard.setKeysToResponsiveGamepadInput([\"Space\",\n\"Backslash\",\"Backquote\"],g.SPECIAL);this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([16],g.SPECIAL);this.plugins=[];this.inputChangeMap={};this.inputChangeOldState={};this.cancelInputChangeListener=void 0;}getVersion(){return \"1.0.0\"}enable(){this.Keyboard.enable();this.Gamepad.enable();this.TouchInput.enable();0<Object.keys(this.inputChangeMap).length&&this._startInputChangeInterval();this._enabled=!0;}disable(){this.Keyboard.disable();this.Gamepad.disable();this.TouchInput.disable();this.cancelInputChangeListener&&\n(this.cancelInputChangeListener(),this.cancelInputChangeListener=void 0);this._enabled=!1;}isEnabled(){return this._enabled}addPlugin(a){this.plugins.push(a);if(a.onAddPlugin)a.onAddPlugin();return ()=>{if(a.onRemovePlugin)a.onRemovePlugin();this.plugins.splice(this.plugins.indexOf(a),1);}}getState(){if(!this._enabled)return {};let a=d({},g),b=this.Gamepad.getState(),c=this.TouchInput.getState(),e=this.Keyboard.getState();a=d({},g);Object.keys(a).forEach((f)=>{a[f]=b[f]||c[f]||e[f];});[\"LEFT\",\"RIGHT\"].forEach((b)=>\n{[g[`${b}_ANALOG_HORIZONTAL_AXIS`],g[`${b}_ANALOG_VERTICAL_AXIS`]].forEach((c,e)=>{if(\"number\"!==typeof a[c]){if(0===e||2===e)a[c]=a[g[`${b}_ANALOG_RIGHT`]]?1:a[g[`${b}_ANALOG_LEFT`]]?-1:0;if(1===e||3===e)a[c]=a[g[`${b}_ANALOG_UP`]]?-1:a[g[`${b}_ANALOG_DOWN`]]?1:0;}});});a.UP=a.DPAD_UP||a.LEFT_ANALOG_UP;a.RIGHT=a.DPAD_RIGHT||a.LEFT_ANALOG_RIGHT;a.DOWN=a.DPAD_DOWN||a.LEFT_ANALOG_DOWN;a.LEFT=a.DPAD_LEFT||a.LEFT_ANALOG_LEFT;Object.keys(a).forEach((b)=>{if(void 0===a[b]||\"string\"===typeof a[b])a[b]=!1;});\nthis.plugins.forEach((b)=>{b.onGetState&&(b=b.onGetState(a))&&(this.state=b);});return a}onInputsChange(a,b){\"string\"===typeof a&&(a=[a]);this.inputChangeMap[a]={codes:a,callback:b};this.cancelInputChangeListener||this._startInputChangeInterval();return ()=>{delete this.inputChangeMap[a];}}_startInputChangeInterval(){let a=setInterval(this._inputChangeIntervalHandler.bind(this),16);this.cancelInputChangeListener=()=>clearInterval(a);}_inputChangeIntervalHandler(){let a=this.getState(),b=[];Object.keys(a).forEach((c)=>\n{a[c]!==this.inputChangeOldState[c]&&b.push(c);});Object.keys(this.inputChangeMap).forEach((c)=>{this.inputChangeMap[c].codes.some((a)=>b.includes(a))&&this.inputChangeMap[c].callback(a);});this.inputChangeOldState=a;}}let A=new z;var ResponsiveGamepad=A;\n\n// Responsive Gamepad plugin to simulate GB Inputs\nfunction ResponsiveGamepadPluginGB() {\n  return {\n    onGetState: state => {\n      const gamepadA = state.A;\n      const gamepadB = state.B;\n      state.A = gamepadA || state.X;\n      state.B = gamepadB || state.Y;\n      return state;\n    }\n  };\n}\n\n// https://github.com/torch2424/responsive-gamepad\n\nclass WasmBoyControllerService {\n  constructor() {\n    // Our wasm instance\n    this.worker = undefined;\n    this.isEnabled = false; // Bind Repsonsive Gamepad to this\n\n    this.ResponsiveGamepad = ResponsiveGamepad;\n    ResponsiveGamepad.addPlugin(ResponsiveGamepadPluginGB());\n  }\n\n  initialize() {\n    if (!this.isEnabled) {\n      this.enableDefaultJoypad();\n    }\n\n    return Promise.resolve();\n  }\n\n  setWorker(worker) {\n    this.worker = worker;\n  }\n\n  updateController() {\n    if (!this.isEnabled) {\n      return {};\n    } // Create an abstracted controller state\n\n\n    const controllerState = ResponsiveGamepad.getState(); // Set the new controller state on the instance\n\n    this.setJoypadState(controllerState); // Return the controller state in case we need something from it\n\n    return controllerState;\n  }\n\n  setJoypadState(controllerState) {\n    const setJoypadStateParamsAsArray = [controllerState.UP ? 1 : 0, controllerState.RIGHT ? 1 : 0, controllerState.DOWN ? 1 : 0, controllerState.LEFT ? 1 : 0, controllerState.A ? 1 : 0, controllerState.B ? 1 : 0, controllerState.SELECT ? 1 : 0, controllerState.START ? 1 : 0];\n    this.worker.postMessageIgnoreResponse({\n      type: WORKER_MESSAGE_TYPE.SET_JOYPAD_STATE,\n      setJoypadStateParamsAsArray\n    });\n  }\n\n  enableDefaultJoypad() {\n    this.isEnabled = true;\n    ResponsiveGamepad.enable();\n  }\n\n  disableDefaultJoypad() {\n    this.isEnabled = false;\n    ResponsiveGamepad.disable();\n  }\n\n}\n\nconst WasmBoyController = new WasmBoyControllerService();\n\nvar wasmboyLibWasmWorkerUrl = \"worker/wasmboy.wasm.worker.js\";\n\nvar wasmboyGraphicsWorkerUrl = \"worker/graphics.worker.js\";\n\nvar wasmboyAudioWorkerUrl = \"worker/audio.worker.js\";\n\nvar wasmboyControllerWorkerUrl = \"worker/controller.worker.js\";\n\nvar wasmboyMemoryWorkerUrl = \"worker/memory.worker.js\";\n\n// Smarter workers.\n\nlet idCounter = 0;\n\nconst generateId = () => {\n  const randomId = Math.random().toString(36).replace(/[^a-z]+/g, '').substr(2, 10);\n  idCounter++;\n  const id = `${randomId}-${idCounter}`;\n\n  if (idCounter > 100000) {\n    idCounter = 0;\n  }\n\n  return id;\n};\n\nfunction getSmartWorkerMessage(message, messageId, workerId) {\n  if (!messageId) {\n    messageId = generateId();\n  }\n\n  return {\n    workerId,\n    messageId,\n    message\n  };\n}\nclass SmartWorker {\n  constructor(workerUrl, id) {\n    this.id = generateId();\n\n    if (id) {\n      this.id = id;\n    }\n\n    this.messageListeners = [];\n    /*ROLLUP_REPLACE_PROD_BROWSER\n    \n    // Can't load base63 data string directly because safari\n    // https://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\n     let workerJs = atob(workerUrl.split(',')[1]);\n    let blob;\n    try {\n      blob = new Blob([workerJs], {type: 'application/javascript'});\n    } catch (e) {\n      // Legacy\n      window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder;\n      blob = new BlobBuilder();\n      blob.append(workerJs);\n      blob = blob.getBlob();\n    }\n    this.worker = new Worker(URL.createObjectURL(blob));\n      this.worker.onmessage = this._onMessageHandler.bind(this);\n    \n    ROLLUP_REPLACE_PROD_BROWSER*/\n\n    this.worker = new Worker(workerUrl);\n    this.worker.onmessage = this._onMessageHandler.bind(this);\n    /*ROLLUP_REPLACE_NODE\n     // Split by Comma, to remove the file header from the base 64 string\n    const workerAsString = readBase64String(workerUrl);\n    this.worker = new Worker(workerAsString, {\n      eval: true\n    });\n    this.worker.on('message', this._onMessageHandler.bind(this))\n     ROLLUP_REPLACE_NODE*/\n  }\n\n  postMessageIgnoreResponse(message, transfer) {\n    const messageObject = getSmartWorkerMessage(message, undefined, this.id);\n    this.worker.postMessage(messageObject, transfer);\n  }\n\n  postMessage(message, transfer, timeout) {\n    if (!timeout) {\n      timeout = 1000;\n    }\n\n    const messageObject = getSmartWorkerMessage(message, undefined, this.id);\n    const messageId = messageObject.messageId;\n    const messageIdListener = new Promise((resolve, reject) => {\n      // Set a timeout before killing the message listener\n      let messageDroppedTimeout = setTimeout(() => {\n        console.warn('Message dropped', message);\n        this.removeMessageListener(messageId);\n        reject();\n      }, timeout); // Listen for a message with the same message id to be returned\n\n      this.addMessageListener((responseMessage, messageListener) => {\n        const eventData = getEventData(responseMessage);\n\n        if (eventData.messageId === messageId) {\n          clearTimeout(messageDroppedTimeout);\n          messageDroppedTimeout = undefined;\n          this.removeMessageListener(messageListener.id);\n          resolve(eventData);\n        }\n      });\n    });\n    this.worker.postMessage(messageObject, transfer);\n    return messageIdListener;\n  }\n\n  addMessageListener(callback) {\n    this.messageListeners.push({\n      id: generateId(),\n      callback: callback\n    });\n  }\n\n  removeMessageListener(id) {\n    let messageListenerIndex;\n    this.messageListeners.some((messageListener, index) => {\n      if (messageListener.id === id) {\n        messageListenerIndex = index;\n        return true;\n      }\n\n      return false;\n    });\n\n    if (messageListenerIndex !== undefined) {\n      this.messageListeners.splice(messageListenerIndex, 1);\n    }\n  }\n\n  _onMessageHandler(message) {\n    this.messageListeners.forEach(messageListener => {\n      messageListener.callback(message, messageListener);\n    });\n  }\n\n}\n\n// WasmBoy Modules\n/*ROLLUP_REPLACE_NODE\nconst { MessageChannel } = require('worker_threads');\nROLLUP_REPLACE_NODE*/\n\nconst instantiateWorkers = async () => {\n  // Create our workers\n  let libWorkerUrl;\n  libWorkerUrl = wasmboyLibWasmWorkerUrl;\n  const libWorker = new SmartWorker(libWorkerUrl, WORKER_ID.LIB);\n  const graphicsWorker = new SmartWorker(wasmboyGraphicsWorkerUrl, WORKER_ID.GRAPHICS);\n  const audioWorker = new SmartWorker(wasmboyAudioWorkerUrl, WORKER_ID.AUDIO);\n  const controllerWorker = new SmartWorker(wasmboyControllerWorkerUrl, WORKER_ID.CONTROLLER);\n  const memoryWorker = new SmartWorker(wasmboyMemoryWorkerUrl, WORKER_ID.MEMORY); // Create an array of promises for when each worker is ready\n\n  const workerReadyPromises = []; // Add our workers to an array,\n\n  const childWorkers = [graphicsWorker, audioWorker, controllerWorker, memoryWorker]; // Create a messaging channel between our main lib worker,\n  // And all of the children workers\n\n  childWorkers.forEach(childWorker => {\n    // Create our message channel\n    // https://stackoverflow.com/questions/14191394/web-workers-communication-using-messagechannel-html5\n    const messageChannel = new MessageChannel();\n    const workerReadyPromise = new Promise(resolve => {\n      // Our resolve function\n      let messagesReceived = 0;\n\n      const tryResolveWorkerReady = () => {\n        messagesReceived++;\n\n        if (messagesReceived >= 2) {\n          resolve();\n        }\n      }; // Post our connect messages\n\n\n      libWorker.postMessage({\n        type: WORKER_MESSAGE_TYPE.CONNECT,\n        workerId: childWorker.id,\n        ports: [messageChannel.port1]\n      }, [messageChannel.port1]).then(() => {\n        tryResolveWorkerReady();\n      });\n      childWorker.postMessage({\n        type: WORKER_MESSAGE_TYPE.CONNECT,\n        workerId: libWorker.id,\n        ports: [messageChannel.port2]\n      }, [messageChannel.port2]).then(() => {\n        tryResolveWorkerReady();\n      });\n    });\n    workerReadyPromises.push(workerReadyPromise);\n  }); // Wait for all workers to be ready\n\n  await Promise.all(workerReadyPromises); // Finally, pass the ready workers to all of our children lib\n\n  WasmBoyGraphics.setWorker(graphicsWorker);\n  WasmBoyAudio.setWorker(audioWorker);\n  WasmBoyController.setWorker(controllerWorker);\n  WasmBoyMemory.setWorker(memoryWorker); // Return the main worker for the main lib\n\n  return libWorker;\n};\n\n// Functions here are depedent on WasmBoyMemory state.\n// Getting started with wasm\n// http://webassembly.org/getting-started/js-api/\n\nasync function initialize() {\n  if (this.initialized) {\n    return;\n  }\n\n  this.ready = false;\n  this.loadedAndStarted = false; // Instantiate our workers\n\n  await this._instantiateWorkers(); // Now tell the wasm module to instantiate wasm\n\n  const response = await this.worker.postMessage({\n    type: WORKER_MESSAGE_TYPE.INSTANTIATE_WASM\n  });\n  this.coreType = response.message.type; // Set up Memory\n\n  await WasmBoyMemory.initialize(this.options.headless, this.options.maxNumberOfAutoSaveStates, this.options.saveStateCallback); // Clear what is currently in memory, then load the cartridge memory\n\n  await WasmBoyMemory.clearMemory();\n  this.initialized = true;\n} // Finish request for wasm module, and fetch game\n// NOTE: **Should bind the wasmboy this here**\n\n\nfunction loadROMToWasmBoy(ROM, fetchHeaders) {\n  const loadROMAndConfigTask = async () => {\n    // Save cartridge RAM if have it\n    if (!this.options.headless && WasmBoyMemory.getLoadedCartridgeMemoryState().RAM) {\n      await WasmBoyMemory.saveCartridgeRam();\n    } // Get our fetch rom object\n\n\n    const fetchROMObject = await fetchROMAsByteArray(ROM, fetchHeaders);\n    await WasmBoyMemory.loadCartridgeRom(fetchROMObject.ROM, fetchROMObject.name); // Load a Boot ROM\n\n    if (this.options.enableBootROMIfAvailable) {\n      // Get the cartridge info\n      const cartridgeInfo = await WasmBoyMemory.getCartridgeInfo();\n\n      if (cartridgeInfo.CGBFlag) {\n        await WasmBoyMemory.loadBootROMIfAvailable(WasmBoyMemory.SUPPORTED_BOOT_ROM_TYPES.GBC);\n      } else {\n        await WasmBoyMemory.loadBootROMIfAvailable(WasmBoyMemory.SUPPORTED_BOOT_ROM_TYPES.GB);\n      }\n    } // Save the game that we loaded if we need to reload the game\n\n\n    this.loadedROM = ROM; // Run our initialization on the core\n\n    await this.worker.postMessage({\n      type: WORKER_MESSAGE_TYPE.CONFIG,\n      config: [WasmBoyMemory.loadedCartridgeMemoryState.BOOT ? 1 : 0, // Loaded Boot Rom\n      this.options.isGbcEnabled ? 1 : 0, this.options.audioBatchProcessing ? 1 : 0, this.options.graphicsBatchProcessing ? 1 : 0, this.options.timersBatchProcessing ? 1 : 0, this.options.graphicsDisableScanlineRendering ? 1 : 0, this.options.audioAccumulateSamples ? 1 : 0, this.options.tileRendering ? 1 : 0, this.options.tileCaching ? 1 : 0, this.options.enableAudioDebugging ? 1 : 0],\n      options: {\n        gameboyFrameRate: this.options.gameboyFrameRate,\n        headless: this.options.headless,\n        isAudioEnabled: this.options.isAudioEnabled,\n        isGbcColorizationEnabled: this.options.isGbcColorizationEnabled,\n        gbcColorizationPalette: this.options.gbcColorizationPalette,\n        enableAudioDebugging: this.options.enableAudioDebugging,\n        frameSkip: this.options.frameSkip\n      }\n    });\n  };\n\n  const loadROMTask = async () => {\n    // Pause wasmBoy\n    await this.pause();\n    await initialize.bind(this)(); // Check if we are running headless\n\n    if (this.options.headless) {\n      await loadROMAndConfigTask();\n      this.ready = true;\n\n      if (this.options.onReady) {\n        this.options.onReady();\n      }\n\n      WasmBoyPlugins.runHook({\n        key: 'ready'\n      });\n    } else {\n      // Finally intialize all of our services\n      // Initialize our services\n      // Except memory, which would already be initialized\n      await Promise.all([WasmBoyGraphics.initialize(this.canvasElement, this.options.updateGraphicsCallback), WasmBoyAudio.initialize(this.options.updateAudioCallback), WasmBoyController.initialize()]);\n      await loadROMAndConfigTask(); // Load the game's cartridge ram\n\n      await WasmBoyMemory.loadCartridgeRam();\n      this.ready = true;\n\n      if (this.options.onReady) {\n        this.options.onReady();\n      }\n\n      WasmBoyPlugins.runHook({\n        key: 'ready'\n      });\n    }\n  };\n\n  return loadROMTask();\n}\n\nvar performanceNow = createCommonjsModule(function (module) {\n// Generated by CoffeeScript 1.12.2\n(function() {\n  var getNanoSeconds, hrtime, loadTime, moduleLoadTime, nodeLoadTime, upTime;\n\n  if ((typeof performance !== \"undefined\" && performance !== null) && performance.now) {\n    module.exports = function() {\n      return performance.now();\n    };\n  } else if ((typeof process !== \"undefined\" && process !== null) && process.hrtime) {\n    module.exports = function() {\n      return (getNanoSeconds() - nodeLoadTime) / 1e6;\n    };\n    hrtime = process.hrtime;\n    getNanoSeconds = function() {\n      var hr;\n      hr = hrtime();\n      return hr[0] * 1e9 + hr[1];\n    };\n    moduleLoadTime = getNanoSeconds();\n    upTime = process.uptime() * 1e9;\n    nodeLoadTime = moduleLoadTime - upTime;\n  } else if (Date.now) {\n    module.exports = function() {\n      return Date.now() - loadTime;\n    };\n    loadTime = Date.now();\n  } else {\n    module.exports = function() {\n      return new Date().getTime() - loadTime;\n    };\n    loadTime = new Date().getTime();\n  }\n\n}).call(commonjsGlobal);\n\n//# sourceMappingURL=performance-now.js.map\n});\n\nvar root = typeof window === 'undefined' ? commonjsGlobal : window\n  , vendors = ['moz', 'webkit']\n  , suffix = 'AnimationFrame'\n  , raf = root['request' + suffix]\n  , caf = root['cancel' + suffix] || root['cancelRequest' + suffix];\n\nfor(var i = 0; !raf && i < vendors.length; i++) {\n  raf = root[vendors[i] + 'Request' + suffix];\n  caf = root[vendors[i] + 'Cancel' + suffix]\n      || root[vendors[i] + 'CancelRequest' + suffix];\n}\n\n// Some versions of FF have rAF but not cAF\nif(!raf || !caf) {\n  var last = 0\n    , id$1 = 0\n    , queue = []\n    , frameDuration = 1000 / 60;\n\n  raf = function(callback) {\n    if(queue.length === 0) {\n      var _now = performanceNow()\n        , next = Math.max(0, frameDuration - (_now - last));\n      last = next + _now;\n      setTimeout(function() {\n        var cp = queue.slice(0);\n        // Clear queue here to prevent\n        // callbacks from appending listeners\n        // to the current frame's queue\n        queue.length = 0;\n        for(var i = 0; i < cp.length; i++) {\n          if(!cp[i].cancelled) {\n            try{\n              cp[i].callback(last);\n            } catch(e) {\n              setTimeout(function() { throw e }, 0);\n            }\n          }\n        }\n      }, Math.round(next));\n    }\n    queue.push({\n      handle: ++id$1,\n      callback: callback,\n      cancelled: false\n    });\n    return id$1\n  };\n\n  caf = function(handle) {\n    for(var i = 0; i < queue.length; i++) {\n      if(queue[i].handle === handle) {\n        queue[i].cancelled = true;\n      }\n    }\n  };\n}\n\nvar raf_1 = function(fn) {\n  // Wrap in a new function to prevent\n  // `cancel` potentially being assigned\n  // to the native rAF function\n  return raf.call(root, fn)\n};\nvar cancel = function() {\n  caf.apply(root, arguments);\n};\nvar polyfill = function(object) {\n  if (!object) {\n    object = root;\n  }\n  object.requestAnimationFrame = raf;\n  object.cancelAnimationFrame = caf;\n};\nraf_1.cancel = cancel;\nraf_1.polyfill = polyfill;\n\n// Functions here are depedent on WasmBoyMemory state.\n\nfunction render() {\n  // Don't run if paused\n  if (this.paused) {\n    return true;\n  } // Check if we have frameskip\n\n\n  let shouldSkipRenderingFrame = false;\n\n  if (this.frameSkip && this.frameSkip > 0) {\n    this.frameSkipCounter++;\n\n    if (this.frameSkipCounter < this.frameSkip) {\n      shouldSkipRenderingFrame = true;\n    } else {\n      this.frameSkipCounter = 0;\n    }\n  } // Render the display\n\n\n  if (!shouldSkipRenderingFrame) {\n    WasmBoyGraphics.renderFrame();\n  } // Update our controller\n\n\n  WasmBoyController.updateController();\n  this.renderId = raf_1(() => {\n    render.call(this);\n  });\n}\n\nvar BigInteger = createCommonjsModule(function (module) {\nvar bigInt = (function (undefined) {\r\n\r\n    var BASE = 1e7,\r\n        LOG_BASE = 7,\r\n        MAX_INT = 9007199254740992,\r\n        MAX_INT_ARR = smallToArray(MAX_INT),\r\n        DEFAULT_ALPHABET = \"0123456789abcdefghijklmnopqrstuvwxyz\";\r\n\r\n    var supportsNativeBigInt = typeof BigInt === \"function\";\r\n\r\n    function Integer(v, radix, alphabet, caseSensitive) {\r\n        if (typeof v === \"undefined\") return Integer[0];\r\n        if (typeof radix !== \"undefined\") return +radix === 10 && !alphabet ? parseValue(v) : parseBase(v, radix, alphabet, caseSensitive);\r\n        return parseValue(v);\r\n    }\r\n\r\n    function BigInteger(value, sign) {\r\n        this.value = value;\r\n        this.sign = sign;\r\n        this.isSmall = false;\r\n    }\r\n    BigInteger.prototype = Object.create(Integer.prototype);\r\n\r\n    function SmallInteger(value) {\r\n        this.value = value;\r\n        this.sign = value < 0;\r\n        this.isSmall = true;\r\n    }\r\n    SmallInteger.prototype = Object.create(Integer.prototype);\r\n\r\n    function NativeBigInt(value) {\r\n        this.value = value;\r\n    }\r\n    NativeBigInt.prototype = Object.create(Integer.prototype);\r\n\r\n    function isPrecise(n) {\r\n        return -MAX_INT < n && n < MAX_INT;\r\n    }\r\n\r\n    function smallToArray(n) { // For performance reasons doesn't reference BASE, need to change this function if BASE changes\r\n        if (n < 1e7)\r\n            return [n];\r\n        if (n < 1e14)\r\n            return [n % 1e7, Math.floor(n / 1e7)];\r\n        return [n % 1e7, Math.floor(n / 1e7) % 1e7, Math.floor(n / 1e14)];\r\n    }\r\n\r\n    function arrayToSmall(arr) { // If BASE changes this function may need to change\r\n        trim(arr);\r\n        var length = arr.length;\r\n        if (length < 4 && compareAbs(arr, MAX_INT_ARR) < 0) {\r\n            switch (length) {\r\n                case 0: return 0;\r\n                case 1: return arr[0];\r\n                case 2: return arr[0] + arr[1] * BASE;\r\n                default: return arr[0] + (arr[1] + arr[2] * BASE) * BASE;\r\n            }\r\n        }\r\n        return arr;\r\n    }\r\n\r\n    function trim(v) {\r\n        var i = v.length;\r\n        while (v[--i] === 0);\r\n        v.length = i + 1;\r\n    }\r\n\r\n    function createArray(length) { // function shamelessly stolen from Yaffle's library https://github.com/Yaffle/BigInteger\r\n        var x = new Array(length);\r\n        var i = -1;\r\n        while (++i < length) {\r\n            x[i] = 0;\r\n        }\r\n        return x;\r\n    }\r\n\r\n    function truncate(n) {\r\n        if (n > 0) return Math.floor(n);\r\n        return Math.ceil(n);\r\n    }\r\n\r\n    function add(a, b) { // assumes a and b are arrays with a.length >= b.length\r\n        var l_a = a.length,\r\n            l_b = b.length,\r\n            r = new Array(l_a),\r\n            carry = 0,\r\n            base = BASE,\r\n            sum, i;\r\n        for (i = 0; i < l_b; i++) {\r\n            sum = a[i] + b[i] + carry;\r\n            carry = sum >= base ? 1 : 0;\r\n            r[i] = sum - carry * base;\r\n        }\r\n        while (i < l_a) {\r\n            sum = a[i] + carry;\r\n            carry = sum === base ? 1 : 0;\r\n            r[i++] = sum - carry * base;\r\n        }\r\n        if (carry > 0) r.push(carry);\r\n        return r;\r\n    }\r\n\r\n    function addAny(a, b) {\r\n        if (a.length >= b.length) return add(a, b);\r\n        return add(b, a);\r\n    }\r\n\r\n    function addSmall(a, carry) { // assumes a is array, carry is number with 0 <= carry < MAX_INT\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            base = BASE,\r\n            sum, i;\r\n        for (i = 0; i < l; i++) {\r\n            sum = a[i] - base + carry;\r\n            carry = Math.floor(sum / base);\r\n            r[i] = sum - carry * base;\r\n            carry += 1;\r\n        }\r\n        while (carry > 0) {\r\n            r[i++] = carry % base;\r\n            carry = Math.floor(carry / base);\r\n        }\r\n        return r;\r\n    }\r\n\r\n    BigInteger.prototype.add = function (v) {\r\n        var n = parseValue(v);\r\n        if (this.sign !== n.sign) {\r\n            return this.subtract(n.negate());\r\n        }\r\n        var a = this.value, b = n.value;\r\n        if (n.isSmall) {\r\n            return new BigInteger(addSmall(a, Math.abs(b)), this.sign);\r\n        }\r\n        return new BigInteger(addAny(a, b), this.sign);\r\n    };\r\n    BigInteger.prototype.plus = BigInteger.prototype.add;\r\n\r\n    SmallInteger.prototype.add = function (v) {\r\n        var n = parseValue(v);\r\n        var a = this.value;\r\n        if (a < 0 !== n.sign) {\r\n            return this.subtract(n.negate());\r\n        }\r\n        var b = n.value;\r\n        if (n.isSmall) {\r\n            if (isPrecise(a + b)) return new SmallInteger(a + b);\r\n            b = smallToArray(Math.abs(b));\r\n        }\r\n        return new BigInteger(addSmall(b, Math.abs(a)), a < 0);\r\n    };\r\n    SmallInteger.prototype.plus = SmallInteger.prototype.add;\r\n\r\n    NativeBigInt.prototype.add = function (v) {\r\n        return new NativeBigInt(this.value + parseValue(v).value);\r\n    };\r\n    NativeBigInt.prototype.plus = NativeBigInt.prototype.add;\r\n\r\n    function subtract(a, b) { // assumes a and b are arrays with a >= b\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            r = new Array(a_l),\r\n            borrow = 0,\r\n            base = BASE,\r\n            i, difference;\r\n        for (i = 0; i < b_l; i++) {\r\n            difference = a[i] - borrow - b[i];\r\n            if (difference < 0) {\r\n                difference += base;\r\n                borrow = 1;\r\n            } else borrow = 0;\r\n            r[i] = difference;\r\n        }\r\n        for (i = b_l; i < a_l; i++) {\r\n            difference = a[i] - borrow;\r\n            if (difference < 0) difference += base;\r\n            else {\r\n                r[i++] = difference;\r\n                break;\r\n            }\r\n            r[i] = difference;\r\n        }\r\n        for (; i < a_l; i++) {\r\n            r[i] = a[i];\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    function subtractAny(a, b, sign) {\r\n        var value;\r\n        if (compareAbs(a, b) >= 0) {\r\n            value = subtract(a, b);\r\n        } else {\r\n            value = subtract(b, a);\r\n            sign = !sign;\r\n        }\r\n        value = arrayToSmall(value);\r\n        if (typeof value === \"number\") {\r\n            if (sign) value = -value;\r\n            return new SmallInteger(value);\r\n        }\r\n        return new BigInteger(value, sign);\r\n    }\r\n\r\n    function subtractSmall(a, b, sign) { // assumes a is array, b is number with 0 <= b < MAX_INT\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            carry = -b,\r\n            base = BASE,\r\n            i, difference;\r\n        for (i = 0; i < l; i++) {\r\n            difference = a[i] + carry;\r\n            carry = Math.floor(difference / base);\r\n            difference %= base;\r\n            r[i] = difference < 0 ? difference + base : difference;\r\n        }\r\n        r = arrayToSmall(r);\r\n        if (typeof r === \"number\") {\r\n            if (sign) r = -r;\r\n            return new SmallInteger(r);\r\n        } return new BigInteger(r, sign);\r\n    }\r\n\r\n    BigInteger.prototype.subtract = function (v) {\r\n        var n = parseValue(v);\r\n        if (this.sign !== n.sign) {\r\n            return this.add(n.negate());\r\n        }\r\n        var a = this.value, b = n.value;\r\n        if (n.isSmall)\r\n            return subtractSmall(a, Math.abs(b), this.sign);\r\n        return subtractAny(a, b, this.sign);\r\n    };\r\n    BigInteger.prototype.minus = BigInteger.prototype.subtract;\r\n\r\n    SmallInteger.prototype.subtract = function (v) {\r\n        var n = parseValue(v);\r\n        var a = this.value;\r\n        if (a < 0 !== n.sign) {\r\n            return this.add(n.negate());\r\n        }\r\n        var b = n.value;\r\n        if (n.isSmall) {\r\n            return new SmallInteger(a - b);\r\n        }\r\n        return subtractSmall(b, Math.abs(a), a >= 0);\r\n    };\r\n    SmallInteger.prototype.minus = SmallInteger.prototype.subtract;\r\n\r\n    NativeBigInt.prototype.subtract = function (v) {\r\n        return new NativeBigInt(this.value - parseValue(v).value);\r\n    };\r\n    NativeBigInt.prototype.minus = NativeBigInt.prototype.subtract;\r\n\r\n    BigInteger.prototype.negate = function () {\r\n        return new BigInteger(this.value, !this.sign);\r\n    };\r\n    SmallInteger.prototype.negate = function () {\r\n        var sign = this.sign;\r\n        var small = new SmallInteger(-this.value);\r\n        small.sign = !sign;\r\n        return small;\r\n    };\r\n    NativeBigInt.prototype.negate = function () {\r\n        return new NativeBigInt(-this.value);\r\n    };\r\n\r\n    BigInteger.prototype.abs = function () {\r\n        return new BigInteger(this.value, false);\r\n    };\r\n    SmallInteger.prototype.abs = function () {\r\n        return new SmallInteger(Math.abs(this.value));\r\n    };\r\n    NativeBigInt.prototype.abs = function () {\r\n        return new NativeBigInt(this.value >= 0 ? this.value : -this.value);\r\n    };\r\n\r\n\r\n    function multiplyLong(a, b) {\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            l = a_l + b_l,\r\n            r = createArray(l),\r\n            base = BASE,\r\n            product, carry, i, a_i, b_j;\r\n        for (i = 0; i < a_l; ++i) {\r\n            a_i = a[i];\r\n            for (var j = 0; j < b_l; ++j) {\r\n                b_j = b[j];\r\n                product = a_i * b_j + r[i + j];\r\n                carry = Math.floor(product / base);\r\n                r[i + j] = product - carry * base;\r\n                r[i + j + 1] += carry;\r\n            }\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    function multiplySmall(a, b) { // assumes a is array, b is number with |b| < BASE\r\n        var l = a.length,\r\n            r = new Array(l),\r\n            base = BASE,\r\n            carry = 0,\r\n            product, i;\r\n        for (i = 0; i < l; i++) {\r\n            product = a[i] * b + carry;\r\n            carry = Math.floor(product / base);\r\n            r[i] = product - carry * base;\r\n        }\r\n        while (carry > 0) {\r\n            r[i++] = carry % base;\r\n            carry = Math.floor(carry / base);\r\n        }\r\n        return r;\r\n    }\r\n\r\n    function shiftLeft(x, n) {\r\n        var r = [];\r\n        while (n-- > 0) r.push(0);\r\n        return r.concat(x);\r\n    }\r\n\r\n    function multiplyKaratsuba(x, y) {\r\n        var n = Math.max(x.length, y.length);\r\n\r\n        if (n <= 30) return multiplyLong(x, y);\r\n        n = Math.ceil(n / 2);\r\n\r\n        var b = x.slice(n),\r\n            a = x.slice(0, n),\r\n            d = y.slice(n),\r\n            c = y.slice(0, n);\r\n\r\n        var ac = multiplyKaratsuba(a, c),\r\n            bd = multiplyKaratsuba(b, d),\r\n            abcd = multiplyKaratsuba(addAny(a, b), addAny(c, d));\r\n\r\n        var product = addAny(addAny(ac, shiftLeft(subtract(subtract(abcd, ac), bd), n)), shiftLeft(bd, 2 * n));\r\n        trim(product);\r\n        return product;\r\n    }\r\n\r\n    // The following function is derived from a surface fit of a graph plotting the performance difference\r\n    // between long multiplication and karatsuba multiplication versus the lengths of the two arrays.\r\n    function useKaratsuba(l1, l2) {\r\n        return -0.012 * l1 - 0.012 * l2 + 0.000015 * l1 * l2 > 0;\r\n    }\r\n\r\n    BigInteger.prototype.multiply = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value, b = n.value,\r\n            sign = this.sign !== n.sign,\r\n            abs;\r\n        if (n.isSmall) {\r\n            if (b === 0) return Integer[0];\r\n            if (b === 1) return this;\r\n            if (b === -1) return this.negate();\r\n            abs = Math.abs(b);\r\n            if (abs < BASE) {\r\n                return new BigInteger(multiplySmall(a, abs), sign);\r\n            }\r\n            b = smallToArray(abs);\r\n        }\r\n        if (useKaratsuba(a.length, b.length)) // Karatsuba is only faster for certain array sizes\r\n            return new BigInteger(multiplyKaratsuba(a, b), sign);\r\n        return new BigInteger(multiplyLong(a, b), sign);\r\n    };\r\n\r\n    BigInteger.prototype.times = BigInteger.prototype.multiply;\r\n\r\n    function multiplySmallAndArray(a, b, sign) { // a >= 0\r\n        if (a < BASE) {\r\n            return new BigInteger(multiplySmall(b, a), sign);\r\n        }\r\n        return new BigInteger(multiplyLong(b, smallToArray(a)), sign);\r\n    }\r\n    SmallInteger.prototype._multiplyBySmall = function (a) {\r\n        if (isPrecise(a.value * this.value)) {\r\n            return new SmallInteger(a.value * this.value);\r\n        }\r\n        return multiplySmallAndArray(Math.abs(a.value), smallToArray(Math.abs(this.value)), this.sign !== a.sign);\r\n    };\r\n    BigInteger.prototype._multiplyBySmall = function (a) {\r\n        if (a.value === 0) return Integer[0];\r\n        if (a.value === 1) return this;\r\n        if (a.value === -1) return this.negate();\r\n        return multiplySmallAndArray(Math.abs(a.value), this.value, this.sign !== a.sign);\r\n    };\r\n    SmallInteger.prototype.multiply = function (v) {\r\n        return parseValue(v)._multiplyBySmall(this);\r\n    };\r\n    SmallInteger.prototype.times = SmallInteger.prototype.multiply;\r\n\r\n    NativeBigInt.prototype.multiply = function (v) {\r\n        return new NativeBigInt(this.value * parseValue(v).value);\r\n    };\r\n    NativeBigInt.prototype.times = NativeBigInt.prototype.multiply;\r\n\r\n    function square(a) {\r\n        //console.assert(2 * BASE * BASE < MAX_INT);\r\n        var l = a.length,\r\n            r = createArray(l + l),\r\n            base = BASE,\r\n            product, carry, i, a_i, a_j;\r\n        for (i = 0; i < l; i++) {\r\n            a_i = a[i];\r\n            carry = 0 - a_i * a_i;\r\n            for (var j = i; j < l; j++) {\r\n                a_j = a[j];\r\n                product = 2 * (a_i * a_j) + r[i + j] + carry;\r\n                carry = Math.floor(product / base);\r\n                r[i + j] = product - carry * base;\r\n            }\r\n            r[i + l] = carry;\r\n        }\r\n        trim(r);\r\n        return r;\r\n    }\r\n\r\n    BigInteger.prototype.square = function () {\r\n        return new BigInteger(square(this.value), false);\r\n    };\r\n\r\n    SmallInteger.prototype.square = function () {\r\n        var value = this.value * this.value;\r\n        if (isPrecise(value)) return new SmallInteger(value);\r\n        return new BigInteger(square(smallToArray(Math.abs(this.value))), false);\r\n    };\r\n\r\n    NativeBigInt.prototype.square = function (v) {\r\n        return new NativeBigInt(this.value * this.value);\r\n    };\r\n\r\n    function divMod1(a, b) { // Left over from previous version. Performs faster than divMod2 on smaller input sizes.\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            base = BASE,\r\n            result = createArray(b.length),\r\n            divisorMostSignificantDigit = b[b_l - 1],\r\n            // normalization\r\n            lambda = Math.ceil(base / (2 * divisorMostSignificantDigit)),\r\n            remainder = multiplySmall(a, lambda),\r\n            divisor = multiplySmall(b, lambda),\r\n            quotientDigit, shift, carry, borrow, i, l, q;\r\n        if (remainder.length <= a_l) remainder.push(0);\r\n        divisor.push(0);\r\n        divisorMostSignificantDigit = divisor[b_l - 1];\r\n        for (shift = a_l - b_l; shift >= 0; shift--) {\r\n            quotientDigit = base - 1;\r\n            if (remainder[shift + b_l] !== divisorMostSignificantDigit) {\r\n                quotientDigit = Math.floor((remainder[shift + b_l] * base + remainder[shift + b_l - 1]) / divisorMostSignificantDigit);\r\n            }\r\n            // quotientDigit <= base - 1\r\n            carry = 0;\r\n            borrow = 0;\r\n            l = divisor.length;\r\n            for (i = 0; i < l; i++) {\r\n                carry += quotientDigit * divisor[i];\r\n                q = Math.floor(carry / base);\r\n                borrow += remainder[shift + i] - (carry - q * base);\r\n                carry = q;\r\n                if (borrow < 0) {\r\n                    remainder[shift + i] = borrow + base;\r\n                    borrow = -1;\r\n                } else {\r\n                    remainder[shift + i] = borrow;\r\n                    borrow = 0;\r\n                }\r\n            }\r\n            while (borrow !== 0) {\r\n                quotientDigit -= 1;\r\n                carry = 0;\r\n                for (i = 0; i < l; i++) {\r\n                    carry += remainder[shift + i] - base + divisor[i];\r\n                    if (carry < 0) {\r\n                        remainder[shift + i] = carry + base;\r\n                        carry = 0;\r\n                    } else {\r\n                        remainder[shift + i] = carry;\r\n                        carry = 1;\r\n                    }\r\n                }\r\n                borrow += carry;\r\n            }\r\n            result[shift] = quotientDigit;\r\n        }\r\n        // denormalization\r\n        remainder = divModSmall(remainder, lambda)[0];\r\n        return [arrayToSmall(result), arrayToSmall(remainder)];\r\n    }\r\n\r\n    function divMod2(a, b) { // Implementation idea shamelessly stolen from Silent Matt's library http://silentmatt.com/biginteger/\r\n        // Performs faster than divMod1 on larger input sizes.\r\n        var a_l = a.length,\r\n            b_l = b.length,\r\n            result = [],\r\n            part = [],\r\n            base = BASE,\r\n            guess, xlen, highx, highy, check;\r\n        while (a_l) {\r\n            part.unshift(a[--a_l]);\r\n            trim(part);\r\n            if (compareAbs(part, b) < 0) {\r\n                result.push(0);\r\n                continue;\r\n            }\r\n            xlen = part.length;\r\n            highx = part[xlen - 1] * base + part[xlen - 2];\r\n            highy = b[b_l - 1] * base + b[b_l - 2];\r\n            if (xlen > b_l) {\r\n                highx = (highx + 1) * base;\r\n            }\r\n            guess = Math.ceil(highx / highy);\r\n            do {\r\n                check = multiplySmall(b, guess);\r\n                if (compareAbs(check, part) <= 0) break;\r\n                guess--;\r\n            } while (guess);\r\n            result.push(guess);\r\n            part = subtract(part, check);\r\n        }\r\n        result.reverse();\r\n        return [arrayToSmall(result), arrayToSmall(part)];\r\n    }\r\n\r\n    function divModSmall(value, lambda) {\r\n        var length = value.length,\r\n            quotient = createArray(length),\r\n            base = BASE,\r\n            i, q, remainder, divisor;\r\n        remainder = 0;\r\n        for (i = length - 1; i >= 0; --i) {\r\n            divisor = remainder * base + value[i];\r\n            q = truncate(divisor / lambda);\r\n            remainder = divisor - q * lambda;\r\n            quotient[i] = q | 0;\r\n        }\r\n        return [quotient, remainder | 0];\r\n    }\r\n\r\n    function divModAny(self, v) {\r\n        var value, n = parseValue(v);\r\n        if (supportsNativeBigInt) {\r\n            return [new NativeBigInt(self.value / n.value), new NativeBigInt(self.value % n.value)];\r\n        }\r\n        var a = self.value, b = n.value;\r\n        var quotient;\r\n        if (b === 0) throw new Error(\"Cannot divide by zero\");\r\n        if (self.isSmall) {\r\n            if (n.isSmall) {\r\n                return [new SmallInteger(truncate(a / b)), new SmallInteger(a % b)];\r\n            }\r\n            return [Integer[0], self];\r\n        }\r\n        if (n.isSmall) {\r\n            if (b === 1) return [self, Integer[0]];\r\n            if (b == -1) return [self.negate(), Integer[0]];\r\n            var abs = Math.abs(b);\r\n            if (abs < BASE) {\r\n                value = divModSmall(a, abs);\r\n                quotient = arrayToSmall(value[0]);\r\n                var remainder = value[1];\r\n                if (self.sign) remainder = -remainder;\r\n                if (typeof quotient === \"number\") {\r\n                    if (self.sign !== n.sign) quotient = -quotient;\r\n                    return [new SmallInteger(quotient), new SmallInteger(remainder)];\r\n                }\r\n                return [new BigInteger(quotient, self.sign !== n.sign), new SmallInteger(remainder)];\r\n            }\r\n            b = smallToArray(abs);\r\n        }\r\n        var comparison = compareAbs(a, b);\r\n        if (comparison === -1) return [Integer[0], self];\r\n        if (comparison === 0) return [Integer[self.sign === n.sign ? 1 : -1], Integer[0]];\r\n\r\n        // divMod1 is faster on smaller input sizes\r\n        if (a.length + b.length <= 200)\r\n            value = divMod1(a, b);\r\n        else value = divMod2(a, b);\r\n\r\n        quotient = value[0];\r\n        var qSign = self.sign !== n.sign,\r\n            mod = value[1],\r\n            mSign = self.sign;\r\n        if (typeof quotient === \"number\") {\r\n            if (qSign) quotient = -quotient;\r\n            quotient = new SmallInteger(quotient);\r\n        } else quotient = new BigInteger(quotient, qSign);\r\n        if (typeof mod === \"number\") {\r\n            if (mSign) mod = -mod;\r\n            mod = new SmallInteger(mod);\r\n        } else mod = new BigInteger(mod, mSign);\r\n        return [quotient, mod];\r\n    }\r\n\r\n    BigInteger.prototype.divmod = function (v) {\r\n        var result = divModAny(this, v);\r\n        return {\r\n            quotient: result[0],\r\n            remainder: result[1]\r\n        };\r\n    };\r\n    NativeBigInt.prototype.divmod = SmallInteger.prototype.divmod = BigInteger.prototype.divmod;\r\n\r\n\r\n    BigInteger.prototype.divide = function (v) {\r\n        return divModAny(this, v)[0];\r\n    };\r\n    NativeBigInt.prototype.over = NativeBigInt.prototype.divide = function (v) {\r\n        return new NativeBigInt(this.value / parseValue(v).value);\r\n    };\r\n    SmallInteger.prototype.over = SmallInteger.prototype.divide = BigInteger.prototype.over = BigInteger.prototype.divide;\r\n\r\n    BigInteger.prototype.mod = function (v) {\r\n        return divModAny(this, v)[1];\r\n    };\r\n    NativeBigInt.prototype.mod = NativeBigInt.prototype.remainder = function (v) {\r\n        return new NativeBigInt(this.value % parseValue(v).value);\r\n    };\r\n    SmallInteger.prototype.remainder = SmallInteger.prototype.mod = BigInteger.prototype.remainder = BigInteger.prototype.mod;\r\n\r\n    BigInteger.prototype.pow = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value,\r\n            value, x, y;\r\n        if (b === 0) return Integer[1];\r\n        if (a === 0) return Integer[0];\r\n        if (a === 1) return Integer[1];\r\n        if (a === -1) return n.isEven() ? Integer[1] : Integer[-1];\r\n        if (n.sign) {\r\n            return Integer[0];\r\n        }\r\n        if (!n.isSmall) throw new Error(\"The exponent \" + n.toString() + \" is too large.\");\r\n        if (this.isSmall) {\r\n            if (isPrecise(value = Math.pow(a, b)))\r\n                return new SmallInteger(truncate(value));\r\n        }\r\n        x = this;\r\n        y = Integer[1];\r\n        while (true) {\r\n            if (b & 1 === 1) {\r\n                y = y.times(x);\r\n                --b;\r\n            }\r\n            if (b === 0) break;\r\n            b /= 2;\r\n            x = x.square();\r\n        }\r\n        return y;\r\n    };\r\n    SmallInteger.prototype.pow = BigInteger.prototype.pow;\r\n\r\n    NativeBigInt.prototype.pow = function (v) {\r\n        var n = parseValue(v);\r\n        var a = this.value, b = n.value;\r\n        var _0 = BigInt(0), _1 = BigInt(1), _2 = BigInt(2);\r\n        if (b === _0) return Integer[1];\r\n        if (a === _0) return Integer[0];\r\n        if (a === _1) return Integer[1];\r\n        if (a === BigInt(-1)) return n.isEven() ? Integer[1] : Integer[-1];\r\n        if (n.isNegative()) return new NativeBigInt(_0);\r\n        var x = this;\r\n        var y = Integer[1];\r\n        while (true) {\r\n            if ((b & _1) === _1) {\r\n                y = y.times(x);\r\n                --b;\r\n            }\r\n            if (b === _0) break;\r\n            b /= _2;\r\n            x = x.square();\r\n        }\r\n        return y;\r\n    };\r\n\r\n    BigInteger.prototype.modPow = function (exp, mod) {\r\n        exp = parseValue(exp);\r\n        mod = parseValue(mod);\r\n        if (mod.isZero()) throw new Error(\"Cannot take modPow with modulus 0\");\r\n        var r = Integer[1],\r\n            base = this.mod(mod);\r\n        if (exp.isNegative()) {\r\n            exp = exp.multiply(Integer[-1]);\r\n            base = base.modInv(mod);\r\n        }\r\n        while (exp.isPositive()) {\r\n            if (base.isZero()) return Integer[0];\r\n            if (exp.isOdd()) r = r.multiply(base).mod(mod);\r\n            exp = exp.divide(2);\r\n            base = base.square().mod(mod);\r\n        }\r\n        return r;\r\n    };\r\n    NativeBigInt.prototype.modPow = SmallInteger.prototype.modPow = BigInteger.prototype.modPow;\r\n\r\n    function compareAbs(a, b) {\r\n        if (a.length !== b.length) {\r\n            return a.length > b.length ? 1 : -1;\r\n        }\r\n        for (var i = a.length - 1; i >= 0; i--) {\r\n            if (a[i] !== b[i]) return a[i] > b[i] ? 1 : -1;\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    BigInteger.prototype.compareAbs = function (v) {\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (n.isSmall) return 1;\r\n        return compareAbs(a, b);\r\n    };\r\n    SmallInteger.prototype.compareAbs = function (v) {\r\n        var n = parseValue(v),\r\n            a = Math.abs(this.value),\r\n            b = n.value;\r\n        if (n.isSmall) {\r\n            b = Math.abs(b);\r\n            return a === b ? 0 : a > b ? 1 : -1;\r\n        }\r\n        return -1;\r\n    };\r\n    NativeBigInt.prototype.compareAbs = function (v) {\r\n        var a = this.value;\r\n        var b = parseValue(v).value;\r\n        a = a >= 0 ? a : -a;\r\n        b = b >= 0 ? b : -b;\r\n        return a === b ? 0 : a > b ? 1 : -1;\r\n    };\r\n\r\n    BigInteger.prototype.compare = function (v) {\r\n        // See discussion about comparison with Infinity:\r\n        // https://github.com/peterolson/BigInteger.js/issues/61\r\n        if (v === Infinity) {\r\n            return -1;\r\n        }\r\n        if (v === -Infinity) {\r\n            return 1;\r\n        }\r\n\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (this.sign !== n.sign) {\r\n            return n.sign ? 1 : -1;\r\n        }\r\n        if (n.isSmall) {\r\n            return this.sign ? -1 : 1;\r\n        }\r\n        return compareAbs(a, b) * (this.sign ? -1 : 1);\r\n    };\r\n    BigInteger.prototype.compareTo = BigInteger.prototype.compare;\r\n\r\n    SmallInteger.prototype.compare = function (v) {\r\n        if (v === Infinity) {\r\n            return -1;\r\n        }\r\n        if (v === -Infinity) {\r\n            return 1;\r\n        }\r\n\r\n        var n = parseValue(v),\r\n            a = this.value,\r\n            b = n.value;\r\n        if (n.isSmall) {\r\n            return a == b ? 0 : a > b ? 1 : -1;\r\n        }\r\n        if (a < 0 !== n.sign) {\r\n            return a < 0 ? -1 : 1;\r\n        }\r\n        return a < 0 ? 1 : -1;\r\n    };\r\n    SmallInteger.prototype.compareTo = SmallInteger.prototype.compare;\r\n\r\n    NativeBigInt.prototype.compare = function (v) {\r\n        if (v === Infinity) {\r\n            return -1;\r\n        }\r\n        if (v === -Infinity) {\r\n            return 1;\r\n        }\r\n        var a = this.value;\r\n        var b = parseValue(v).value;\r\n        return a === b ? 0 : a > b ? 1 : -1;\r\n    };\r\n    NativeBigInt.prototype.compareTo = NativeBigInt.prototype.compare;\r\n\r\n    BigInteger.prototype.equals = function (v) {\r\n        return this.compare(v) === 0;\r\n    };\r\n    NativeBigInt.prototype.eq = NativeBigInt.prototype.equals = SmallInteger.prototype.eq = SmallInteger.prototype.equals = BigInteger.prototype.eq = BigInteger.prototype.equals;\r\n\r\n    BigInteger.prototype.notEquals = function (v) {\r\n        return this.compare(v) !== 0;\r\n    };\r\n    NativeBigInt.prototype.neq = NativeBigInt.prototype.notEquals = SmallInteger.prototype.neq = SmallInteger.prototype.notEquals = BigInteger.prototype.neq = BigInteger.prototype.notEquals;\r\n\r\n    BigInteger.prototype.greater = function (v) {\r\n        return this.compare(v) > 0;\r\n    };\r\n    NativeBigInt.prototype.gt = NativeBigInt.prototype.greater = SmallInteger.prototype.gt = SmallInteger.prototype.greater = BigInteger.prototype.gt = BigInteger.prototype.greater;\r\n\r\n    BigInteger.prototype.lesser = function (v) {\r\n        return this.compare(v) < 0;\r\n    };\r\n    NativeBigInt.prototype.lt = NativeBigInt.prototype.lesser = SmallInteger.prototype.lt = SmallInteger.prototype.lesser = BigInteger.prototype.lt = BigInteger.prototype.lesser;\r\n\r\n    BigInteger.prototype.greaterOrEquals = function (v) {\r\n        return this.compare(v) >= 0;\r\n    };\r\n    NativeBigInt.prototype.geq = NativeBigInt.prototype.greaterOrEquals = SmallInteger.prototype.geq = SmallInteger.prototype.greaterOrEquals = BigInteger.prototype.geq = BigInteger.prototype.greaterOrEquals;\r\n\r\n    BigInteger.prototype.lesserOrEquals = function (v) {\r\n        return this.compare(v) <= 0;\r\n    };\r\n    NativeBigInt.prototype.leq = NativeBigInt.prototype.lesserOrEquals = SmallInteger.prototype.leq = SmallInteger.prototype.lesserOrEquals = BigInteger.prototype.leq = BigInteger.prototype.lesserOrEquals;\r\n\r\n    BigInteger.prototype.isEven = function () {\r\n        return (this.value[0] & 1) === 0;\r\n    };\r\n    SmallInteger.prototype.isEven = function () {\r\n        return (this.value & 1) === 0;\r\n    };\r\n    NativeBigInt.prototype.isEven = function () {\r\n        return (this.value & BigInt(1)) === BigInt(0);\r\n    };\r\n\r\n    BigInteger.prototype.isOdd = function () {\r\n        return (this.value[0] & 1) === 1;\r\n    };\r\n    SmallInteger.prototype.isOdd = function () {\r\n        return (this.value & 1) === 1;\r\n    };\r\n    NativeBigInt.prototype.isOdd = function () {\r\n        return (this.value & BigInt(1)) === BigInt(1);\r\n    };\r\n\r\n    BigInteger.prototype.isPositive = function () {\r\n        return !this.sign;\r\n    };\r\n    SmallInteger.prototype.isPositive = function () {\r\n        return this.value > 0;\r\n    };\r\n    NativeBigInt.prototype.isPositive = SmallInteger.prototype.isPositive;\r\n\r\n    BigInteger.prototype.isNegative = function () {\r\n        return this.sign;\r\n    };\r\n    SmallInteger.prototype.isNegative = function () {\r\n        return this.value < 0;\r\n    };\r\n    NativeBigInt.prototype.isNegative = SmallInteger.prototype.isNegative;\r\n\r\n    BigInteger.prototype.isUnit = function () {\r\n        return false;\r\n    };\r\n    SmallInteger.prototype.isUnit = function () {\r\n        return Math.abs(this.value) === 1;\r\n    };\r\n    NativeBigInt.prototype.isUnit = function () {\r\n        return this.abs().value === BigInt(1);\r\n    };\r\n\r\n    BigInteger.prototype.isZero = function () {\r\n        return false;\r\n    };\r\n    SmallInteger.prototype.isZero = function () {\r\n        return this.value === 0;\r\n    };\r\n    NativeBigInt.prototype.isZero = function () {\r\n        return this.value === BigInt(0);\r\n    };\r\n\r\n    BigInteger.prototype.isDivisibleBy = function (v) {\r\n        var n = parseValue(v);\r\n        if (n.isZero()) return false;\r\n        if (n.isUnit()) return true;\r\n        if (n.compareAbs(2) === 0) return this.isEven();\r\n        return this.mod(n).isZero();\r\n    };\r\n    NativeBigInt.prototype.isDivisibleBy = SmallInteger.prototype.isDivisibleBy = BigInteger.prototype.isDivisibleBy;\r\n\r\n    function isBasicPrime(v) {\r\n        var n = v.abs();\r\n        if (n.isUnit()) return false;\r\n        if (n.equals(2) || n.equals(3) || n.equals(5)) return true;\r\n        if (n.isEven() || n.isDivisibleBy(3) || n.isDivisibleBy(5)) return false;\r\n        if (n.lesser(49)) return true;\r\n        // we don't know if it's prime: let the other functions figure it out\r\n    }\r\n\r\n    function millerRabinTest(n, a) {\r\n        var nPrev = n.prev(),\r\n            b = nPrev,\r\n            r = 0,\r\n            d, i, x;\r\n        while (b.isEven()) b = b.divide(2), r++;\r\n        next: for (i = 0; i < a.length; i++) {\r\n            if (n.lesser(a[i])) continue;\r\n            x = bigInt(a[i]).modPow(b, n);\r\n            if (x.isUnit() || x.equals(nPrev)) continue;\r\n            for (d = r - 1; d != 0; d--) {\r\n                x = x.square().mod(n);\r\n                if (x.isUnit()) return false;\r\n                if (x.equals(nPrev)) continue next;\r\n            }\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    // Set \"strict\" to true to force GRH-supported lower bound of 2*log(N)^2\r\n    BigInteger.prototype.isPrime = function (strict) {\r\n        var isPrime = isBasicPrime(this);\r\n        if (isPrime !== undefined) return isPrime;\r\n        var n = this.abs();\r\n        var bits = n.bitLength();\r\n        if (bits <= 64)\r\n            return millerRabinTest(n, [2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37]);\r\n        var logN = Math.log(2) * bits.toJSNumber();\r\n        var t = Math.ceil((strict === true) ? (2 * Math.pow(logN, 2)) : logN);\r\n        for (var a = [], i = 0; i < t; i++) {\r\n            a.push(bigInt(i + 2));\r\n        }\r\n        return millerRabinTest(n, a);\r\n    };\r\n    NativeBigInt.prototype.isPrime = SmallInteger.prototype.isPrime = BigInteger.prototype.isPrime;\r\n\r\n    BigInteger.prototype.isProbablePrime = function (iterations, rng) {\r\n        var isPrime = isBasicPrime(this);\r\n        if (isPrime !== undefined) return isPrime;\r\n        var n = this.abs();\r\n        var t = iterations === undefined ? 5 : iterations;\r\n        for (var a = [], i = 0; i < t; i++) {\r\n            a.push(bigInt.randBetween(2, n.minus(2), rng));\r\n        }\r\n        return millerRabinTest(n, a);\r\n    };\r\n    NativeBigInt.prototype.isProbablePrime = SmallInteger.prototype.isProbablePrime = BigInteger.prototype.isProbablePrime;\r\n\r\n    BigInteger.prototype.modInv = function (n) {\r\n        var t = bigInt.zero, newT = bigInt.one, r = parseValue(n), newR = this.abs(), q, lastT, lastR;\r\n        while (!newR.isZero()) {\r\n            q = r.divide(newR);\r\n            lastT = t;\r\n            lastR = r;\r\n            t = newT;\r\n            r = newR;\r\n            newT = lastT.subtract(q.multiply(newT));\r\n            newR = lastR.subtract(q.multiply(newR));\r\n        }\r\n        if (!r.isUnit()) throw new Error(this.toString() + \" and \" + n.toString() + \" are not co-prime\");\r\n        if (t.compare(0) === -1) {\r\n            t = t.add(n);\r\n        }\r\n        if (this.isNegative()) {\r\n            return t.negate();\r\n        }\r\n        return t;\r\n    };\r\n\r\n    NativeBigInt.prototype.modInv = SmallInteger.prototype.modInv = BigInteger.prototype.modInv;\r\n\r\n    BigInteger.prototype.next = function () {\r\n        var value = this.value;\r\n        if (this.sign) {\r\n            return subtractSmall(value, 1, this.sign);\r\n        }\r\n        return new BigInteger(addSmall(value, 1), this.sign);\r\n    };\r\n    SmallInteger.prototype.next = function () {\r\n        var value = this.value;\r\n        if (value + 1 < MAX_INT) return new SmallInteger(value + 1);\r\n        return new BigInteger(MAX_INT_ARR, false);\r\n    };\r\n    NativeBigInt.prototype.next = function () {\r\n        return new NativeBigInt(this.value + BigInt(1));\r\n    };\r\n\r\n    BigInteger.prototype.prev = function () {\r\n        var value = this.value;\r\n        if (this.sign) {\r\n            return new BigInteger(addSmall(value, 1), true);\r\n        }\r\n        return subtractSmall(value, 1, this.sign);\r\n    };\r\n    SmallInteger.prototype.prev = function () {\r\n        var value = this.value;\r\n        if (value - 1 > -MAX_INT) return new SmallInteger(value - 1);\r\n        return new BigInteger(MAX_INT_ARR, true);\r\n    };\r\n    NativeBigInt.prototype.prev = function () {\r\n        return new NativeBigInt(this.value - BigInt(1));\r\n    };\r\n\r\n    var powersOfTwo = [1];\r\n    while (2 * powersOfTwo[powersOfTwo.length - 1] <= BASE) powersOfTwo.push(2 * powersOfTwo[powersOfTwo.length - 1]);\r\n    var powers2Length = powersOfTwo.length, highestPower2 = powersOfTwo[powers2Length - 1];\r\n\r\n    function shift_isSmall(n) {\r\n        return Math.abs(n) <= BASE;\r\n    }\r\n\r\n    BigInteger.prototype.shiftLeft = function (v) {\r\n        var n = parseValue(v).toJSNumber();\r\n        if (!shift_isSmall(n)) {\r\n            throw new Error(String(n) + \" is too large for shifting.\");\r\n        }\r\n        if (n < 0) return this.shiftRight(-n);\r\n        var result = this;\r\n        if (result.isZero()) return result;\r\n        while (n >= powers2Length) {\r\n            result = result.multiply(highestPower2);\r\n            n -= powers2Length - 1;\r\n        }\r\n        return result.multiply(powersOfTwo[n]);\r\n    };\r\n    NativeBigInt.prototype.shiftLeft = SmallInteger.prototype.shiftLeft = BigInteger.prototype.shiftLeft;\r\n\r\n    BigInteger.prototype.shiftRight = function (v) {\r\n        var remQuo;\r\n        var n = parseValue(v).toJSNumber();\r\n        if (!shift_isSmall(n)) {\r\n            throw new Error(String(n) + \" is too large for shifting.\");\r\n        }\r\n        if (n < 0) return this.shiftLeft(-n);\r\n        var result = this;\r\n        while (n >= powers2Length) {\r\n            if (result.isZero() || (result.isNegative() && result.isUnit())) return result;\r\n            remQuo = divModAny(result, highestPower2);\r\n            result = remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\r\n            n -= powers2Length - 1;\r\n        }\r\n        remQuo = divModAny(result, powersOfTwo[n]);\r\n        return remQuo[1].isNegative() ? remQuo[0].prev() : remQuo[0];\r\n    };\r\n    NativeBigInt.prototype.shiftRight = SmallInteger.prototype.shiftRight = BigInteger.prototype.shiftRight;\r\n\r\n    function bitwise(x, y, fn) {\r\n        y = parseValue(y);\r\n        var xSign = x.isNegative(), ySign = y.isNegative();\r\n        var xRem = xSign ? x.not() : x,\r\n            yRem = ySign ? y.not() : y;\r\n        var xDigit = 0, yDigit = 0;\r\n        var xDivMod = null, yDivMod = null;\r\n        var result = [];\r\n        while (!xRem.isZero() || !yRem.isZero()) {\r\n            xDivMod = divModAny(xRem, highestPower2);\r\n            xDigit = xDivMod[1].toJSNumber();\r\n            if (xSign) {\r\n                xDigit = highestPower2 - 1 - xDigit; // two's complement for negative numbers\r\n            }\r\n\r\n            yDivMod = divModAny(yRem, highestPower2);\r\n            yDigit = yDivMod[1].toJSNumber();\r\n            if (ySign) {\r\n                yDigit = highestPower2 - 1 - yDigit; // two's complement for negative numbers\r\n            }\r\n\r\n            xRem = xDivMod[0];\r\n            yRem = yDivMod[0];\r\n            result.push(fn(xDigit, yDigit));\r\n        }\r\n        var sum = fn(xSign ? 1 : 0, ySign ? 1 : 0) !== 0 ? bigInt(-1) : bigInt(0);\r\n        for (var i = result.length - 1; i >= 0; i -= 1) {\r\n            sum = sum.multiply(highestPower2).add(bigInt(result[i]));\r\n        }\r\n        return sum;\r\n    }\r\n\r\n    BigInteger.prototype.not = function () {\r\n        return this.negate().prev();\r\n    };\r\n    NativeBigInt.prototype.not = SmallInteger.prototype.not = BigInteger.prototype.not;\r\n\r\n    BigInteger.prototype.and = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a & b; });\r\n    };\r\n    NativeBigInt.prototype.and = SmallInteger.prototype.and = BigInteger.prototype.and;\r\n\r\n    BigInteger.prototype.or = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a | b; });\r\n    };\r\n    NativeBigInt.prototype.or = SmallInteger.prototype.or = BigInteger.prototype.or;\r\n\r\n    BigInteger.prototype.xor = function (n) {\r\n        return bitwise(this, n, function (a, b) { return a ^ b; });\r\n    };\r\n    NativeBigInt.prototype.xor = SmallInteger.prototype.xor = BigInteger.prototype.xor;\r\n\r\n    var LOBMASK_I = 1 << 30, LOBMASK_BI = (BASE & -BASE) * (BASE & -BASE) | LOBMASK_I;\r\n    function roughLOB(n) { // get lowestOneBit (rough)\r\n        // SmallInteger: return Min(lowestOneBit(n), 1 << 30)\r\n        // BigInteger: return Min(lowestOneBit(n), 1 << 14) [BASE=1e7]\r\n        var v = n.value,\r\n            x = typeof v === \"number\" ? v | LOBMASK_I :\r\n                typeof v === \"bigint\" ? v | BigInt(LOBMASK_I) :\r\n                    v[0] + v[1] * BASE | LOBMASK_BI;\r\n        return x & -x;\r\n    }\r\n\r\n    function integerLogarithm(value, base) {\r\n        if (base.compareTo(value) <= 0) {\r\n            var tmp = integerLogarithm(value, base.square(base));\r\n            var p = tmp.p;\r\n            var e = tmp.e;\r\n            var t = p.multiply(base);\r\n            return t.compareTo(value) <= 0 ? { p: t, e: e * 2 + 1 } : { p: p, e: e * 2 };\r\n        }\r\n        return { p: bigInt(1), e: 0 };\r\n    }\r\n\r\n    BigInteger.prototype.bitLength = function () {\r\n        var n = this;\r\n        if (n.compareTo(bigInt(0)) < 0) {\r\n            n = n.negate().subtract(bigInt(1));\r\n        }\r\n        if (n.compareTo(bigInt(0)) === 0) {\r\n            return bigInt(0);\r\n        }\r\n        return bigInt(integerLogarithm(n, bigInt(2)).e).add(bigInt(1));\r\n    };\r\n    NativeBigInt.prototype.bitLength = SmallInteger.prototype.bitLength = BigInteger.prototype.bitLength;\r\n\r\n    function max(a, b) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        return a.greater(b) ? a : b;\r\n    }\r\n    function min(a, b) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        return a.lesser(b) ? a : b;\r\n    }\r\n    function gcd(a, b) {\r\n        a = parseValue(a).abs();\r\n        b = parseValue(b).abs();\r\n        if (a.equals(b)) return a;\r\n        if (a.isZero()) return b;\r\n        if (b.isZero()) return a;\r\n        var c = Integer[1], d, t;\r\n        while (a.isEven() && b.isEven()) {\r\n            d = min(roughLOB(a), roughLOB(b));\r\n            a = a.divide(d);\r\n            b = b.divide(d);\r\n            c = c.multiply(d);\r\n        }\r\n        while (a.isEven()) {\r\n            a = a.divide(roughLOB(a));\r\n        }\r\n        do {\r\n            while (b.isEven()) {\r\n                b = b.divide(roughLOB(b));\r\n            }\r\n            if (a.greater(b)) {\r\n                t = b; b = a; a = t;\r\n            }\r\n            b = b.subtract(a);\r\n        } while (!b.isZero());\r\n        return c.isUnit() ? a : a.multiply(c);\r\n    }\r\n    function lcm(a, b) {\r\n        a = parseValue(a).abs();\r\n        b = parseValue(b).abs();\r\n        return a.divide(gcd(a, b)).multiply(b);\r\n    }\r\n    function randBetween(a, b, rng) {\r\n        a = parseValue(a);\r\n        b = parseValue(b);\r\n        var usedRNG = rng || Math.random;\r\n        var low = min(a, b), high = max(a, b);\r\n        var range = high.subtract(low).add(1);\r\n        if (range.isSmall) return low.add(Math.floor(usedRNG() * range));\r\n        var digits = toBase(range, BASE).value;\r\n        var result = [], restricted = true;\r\n        for (var i = 0; i < digits.length; i++) {\r\n            var top = restricted ? digits[i] : BASE;\r\n            var digit = truncate(usedRNG() * top);\r\n            result.push(digit);\r\n            if (digit < top) restricted = false;\r\n        }\r\n        return low.add(Integer.fromArray(result, BASE, false));\r\n    }\r\n\r\n    var parseBase = function (text, base, alphabet, caseSensitive) {\r\n        alphabet = alphabet || DEFAULT_ALPHABET;\r\n        text = String(text);\r\n        if (!caseSensitive) {\r\n            text = text.toLowerCase();\r\n            alphabet = alphabet.toLowerCase();\r\n        }\r\n        var length = text.length;\r\n        var i;\r\n        var absBase = Math.abs(base);\r\n        var alphabetValues = {};\r\n        for (i = 0; i < alphabet.length; i++) {\r\n            alphabetValues[alphabet[i]] = i;\r\n        }\r\n        for (i = 0; i < length; i++) {\r\n            var c = text[i];\r\n            if (c === \"-\") continue;\r\n            if (c in alphabetValues) {\r\n                if (alphabetValues[c] >= absBase) {\r\n                    if (c === \"1\" && absBase === 1) continue;\r\n                    throw new Error(c + \" is not a valid digit in base \" + base + \".\");\r\n                }\r\n            }\r\n        }\r\n        base = parseValue(base);\r\n        var digits = [];\r\n        var isNegative = text[0] === \"-\";\r\n        for (i = isNegative ? 1 : 0; i < text.length; i++) {\r\n            var c = text[i];\r\n            if (c in alphabetValues) digits.push(parseValue(alphabetValues[c]));\r\n            else if (c === \"<\") {\r\n                var start = i;\r\n                do { i++; } while (text[i] !== \">\" && i < text.length);\r\n                digits.push(parseValue(text.slice(start + 1, i)));\r\n            }\r\n            else throw new Error(c + \" is not a valid character\");\r\n        }\r\n        return parseBaseFromArray(digits, base, isNegative);\r\n    };\r\n\r\n    function parseBaseFromArray(digits, base, isNegative) {\r\n        var val = Integer[0], pow = Integer[1], i;\r\n        for (i = digits.length - 1; i >= 0; i--) {\r\n            val = val.add(digits[i].times(pow));\r\n            pow = pow.times(base);\r\n        }\r\n        return isNegative ? val.negate() : val;\r\n    }\r\n\r\n    function stringify(digit, alphabet) {\r\n        alphabet = alphabet || DEFAULT_ALPHABET;\r\n        if (digit < alphabet.length) {\r\n            return alphabet[digit];\r\n        }\r\n        return \"<\" + digit + \">\";\r\n    }\r\n\r\n    function toBase(n, base) {\r\n        base = bigInt(base);\r\n        if (base.isZero()) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n            throw new Error(\"Cannot convert nonzero numbers to base 0.\");\r\n        }\r\n        if (base.equals(-1)) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n            if (n.isNegative())\r\n                return {\r\n                    value: [].concat.apply([], Array.apply(null, Array(-n.toJSNumber()))\r\n                        .map(Array.prototype.valueOf, [1, 0])\r\n                    ),\r\n                    isNegative: false\r\n                };\r\n\r\n            var arr = Array.apply(null, Array(n.toJSNumber() - 1))\r\n                .map(Array.prototype.valueOf, [0, 1]);\r\n            arr.unshift([1]);\r\n            return {\r\n                value: [].concat.apply([], arr),\r\n                isNegative: false\r\n            };\r\n        }\r\n\r\n        var neg = false;\r\n        if (n.isNegative() && base.isPositive()) {\r\n            neg = true;\r\n            n = n.abs();\r\n        }\r\n        if (base.isUnit()) {\r\n            if (n.isZero()) return { value: [0], isNegative: false };\r\n\r\n            return {\r\n                value: Array.apply(null, Array(n.toJSNumber()))\r\n                    .map(Number.prototype.valueOf, 1),\r\n                isNegative: neg\r\n            };\r\n        }\r\n        var out = [];\r\n        var left = n, divmod;\r\n        while (left.isNegative() || left.compareAbs(base) >= 0) {\r\n            divmod = left.divmod(base);\r\n            left = divmod.quotient;\r\n            var digit = divmod.remainder;\r\n            if (digit.isNegative()) {\r\n                digit = base.minus(digit).abs();\r\n                left = left.next();\r\n            }\r\n            out.push(digit.toJSNumber());\r\n        }\r\n        out.push(left.toJSNumber());\r\n        return { value: out.reverse(), isNegative: neg };\r\n    }\r\n\r\n    function toBaseString(n, base, alphabet) {\r\n        var arr = toBase(n, base);\r\n        return (arr.isNegative ? \"-\" : \"\") + arr.value.map(function (x) {\r\n            return stringify(x, alphabet);\r\n        }).join('');\r\n    }\r\n\r\n    BigInteger.prototype.toArray = function (radix) {\r\n        return toBase(this, radix);\r\n    };\r\n\r\n    SmallInteger.prototype.toArray = function (radix) {\r\n        return toBase(this, radix);\r\n    };\r\n\r\n    NativeBigInt.prototype.toArray = function (radix) {\r\n        return toBase(this, radix);\r\n    };\r\n\r\n    BigInteger.prototype.toString = function (radix, alphabet) {\r\n        if (radix === undefined) radix = 10;\r\n        if (radix !== 10) return toBaseString(this, radix, alphabet);\r\n        var v = this.value, l = v.length, str = String(v[--l]), zeros = \"0000000\", digit;\r\n        while (--l >= 0) {\r\n            digit = String(v[l]);\r\n            str += zeros.slice(digit.length) + digit;\r\n        }\r\n        var sign = this.sign ? \"-\" : \"\";\r\n        return sign + str;\r\n    };\r\n\r\n    SmallInteger.prototype.toString = function (radix, alphabet) {\r\n        if (radix === undefined) radix = 10;\r\n        if (radix != 10) return toBaseString(this, radix, alphabet);\r\n        return String(this.value);\r\n    };\r\n\r\n    NativeBigInt.prototype.toString = SmallInteger.prototype.toString;\r\n\r\n    NativeBigInt.prototype.toJSON = BigInteger.prototype.toJSON = SmallInteger.prototype.toJSON = function () { return this.toString(); };\r\n\r\n    BigInteger.prototype.valueOf = function () {\r\n        return parseInt(this.toString(), 10);\r\n    };\r\n    BigInteger.prototype.toJSNumber = BigInteger.prototype.valueOf;\r\n\r\n    SmallInteger.prototype.valueOf = function () {\r\n        return this.value;\r\n    };\r\n    SmallInteger.prototype.toJSNumber = SmallInteger.prototype.valueOf;\r\n    NativeBigInt.prototype.valueOf = NativeBigInt.prototype.toJSNumber = function () {\r\n        return parseInt(this.toString(), 10);\r\n    };\r\n\r\n    function parseStringValue(v) {\r\n        if (isPrecise(+v)) {\r\n            var x = +v;\r\n            if (x === truncate(x))\r\n                return supportsNativeBigInt ? new NativeBigInt(BigInt(x)) : new SmallInteger(x);\r\n            throw new Error(\"Invalid integer: \" + v);\r\n        }\r\n        var sign = v[0] === \"-\";\r\n        if (sign) v = v.slice(1);\r\n        var split = v.split(/e/i);\r\n        if (split.length > 2) throw new Error(\"Invalid integer: \" + split.join(\"e\"));\r\n        if (split.length === 2) {\r\n            var exp = split[1];\r\n            if (exp[0] === \"+\") exp = exp.slice(1);\r\n            exp = +exp;\r\n            if (exp !== truncate(exp) || !isPrecise(exp)) throw new Error(\"Invalid integer: \" + exp + \" is not a valid exponent.\");\r\n            var text = split[0];\r\n            var decimalPlace = text.indexOf(\".\");\r\n            if (decimalPlace >= 0) {\r\n                exp -= text.length - decimalPlace - 1;\r\n                text = text.slice(0, decimalPlace) + text.slice(decimalPlace + 1);\r\n            }\r\n            if (exp < 0) throw new Error(\"Cannot include negative exponent part for integers\");\r\n            text += (new Array(exp + 1)).join(\"0\");\r\n            v = text;\r\n        }\r\n        var isValid = /^([0-9][0-9]*)$/.test(v);\r\n        if (!isValid) throw new Error(\"Invalid integer: \" + v);\r\n        if (supportsNativeBigInt) {\r\n            return new NativeBigInt(BigInt(sign ? \"-\" + v : v));\r\n        }\r\n        var r = [], max = v.length, l = LOG_BASE, min = max - l;\r\n        while (max > 0) {\r\n            r.push(+v.slice(min, max));\r\n            min -= l;\r\n            if (min < 0) min = 0;\r\n            max -= l;\r\n        }\r\n        trim(r);\r\n        return new BigInteger(r, sign);\r\n    }\r\n\r\n    function parseNumberValue(v) {\r\n        if (supportsNativeBigInt) {\r\n            return new NativeBigInt(BigInt(v));\r\n        }\r\n        if (isPrecise(v)) {\r\n            if (v !== truncate(v)) throw new Error(v + \" is not an integer.\");\r\n            return new SmallInteger(v);\r\n        }\r\n        return parseStringValue(v.toString());\r\n    }\r\n\r\n    function parseValue(v) {\r\n        if (typeof v === \"number\") {\r\n            return parseNumberValue(v);\r\n        }\r\n        if (typeof v === \"string\") {\r\n            return parseStringValue(v);\r\n        }\r\n        if (typeof v === \"bigint\") {\r\n            return new NativeBigInt(v);\r\n        }\r\n        return v;\r\n    }\r\n    // Pre-define numbers in range [-999,999]\r\n    for (var i = 0; i < 1000; i++) {\r\n        Integer[i] = parseValue(i);\r\n        if (i > 0) Integer[-i] = parseValue(-i);\r\n    }\r\n    // Backwards compatibility\r\n    Integer.one = Integer[1];\r\n    Integer.zero = Integer[0];\r\n    Integer.minusOne = Integer[-1];\r\n    Integer.max = max;\r\n    Integer.min = min;\r\n    Integer.gcd = gcd;\r\n    Integer.lcm = lcm;\r\n    Integer.isInstance = function (x) { return x instanceof BigInteger || x instanceof SmallInteger || x instanceof NativeBigInt; };\r\n    Integer.randBetween = randBetween;\r\n\r\n    Integer.fromArray = function (digits, base, isNegative) {\r\n        return parseBaseFromArray(digits.map(parseValue), parseValue(base || 10), isNegative);\r\n    };\r\n\r\n    return Integer;\r\n})();\r\n\r\n// Node.js check\r\nif (module.hasOwnProperty(\"exports\")) {\r\n    module.exports = bigInt;\r\n}\r\n});\n\nlet currentRaf = undefined;\n\nconst forceOutputFrame = () => {\n  WasmBoyLib.worker.postMessage({\n    type: WORKER_MESSAGE_TYPE.FORCE_OUTPUT_FRAME\n  });\n  WasmBoyGraphics.renderFrame();\n};\n\nconst runNumberOfFrames = async frames => {\n  await WasmBoyLib.pause(); // Set up a raf function to continually update the canvas\n\n  const rafUpdateCanvas = () => {\n    currentRaf = raf_1(() => {\n      if (currentRaf) {\n        forceOutputFrame();\n        rafUpdateCanvas();\n      }\n    });\n  };\n\n  rafUpdateCanvas();\n\n  for (let i = 0; i < frames; i++) {\n    await runWasmExport('executeFrame', []);\n  }\n\n  currentRaf = undefined;\n  forceOutputFrame();\n};\nconst runWasmExport = async (exportKey, parameters, timeout) => {\n  if (!WasmBoyLib.worker) {\n    return;\n  }\n\n  const event = await WasmBoyLib.worker.postMessage({\n    type: WORKER_MESSAGE_TYPE.RUN_WASM_EXPORT,\n    export: exportKey,\n    parameters\n  }, undefined, timeout);\n  const eventData = getEventData(event);\n  return eventData.message.response;\n};\nconst getWasmMemorySection = async (start, end) => {\n  if (!WasmBoyLib.worker) {\n    return;\n  }\n\n  const event = await WasmBoyLib.worker.postMessage({\n    type: WORKER_MESSAGE_TYPE.GET_WASM_MEMORY_SECTION,\n    start,\n    end\n  });\n  const eventData = getEventData(event);\n  return new Uint8Array(eventData.message.response);\n};\nconst getWasmConstant = async constantKey => {\n  if (!WasmBoyLib.worker) {\n    return;\n  }\n\n  const event = await WasmBoyLib.worker.postMessage({\n    type: WORKER_MESSAGE_TYPE.GET_WASM_CONSTANT,\n    constant: constantKey\n  });\n  const eventData = getEventData(event);\n  return eventData.message.response;\n};\nconst getStepsAsString = async radix => {\n  const stepsPerStepSet = await runWasmExport('getStepsPerStepSet');\n  const stepSets = await runWasmExport('getStepSets');\n  const steps = await runWasmExport('getSteps');\n  const bigSteps = BigInteger(stepsPerStepSet).multiply(stepSets).add(steps);\n\n  if (radix) {\n    return bigSteps.toString(radix);\n  }\n\n  return bigSteps.toString(10);\n};\nconst getCyclesAsString = async radix => {\n  const cyclesPerCycleSet = await runWasmExport('getCyclesPerCycleSet');\n  const cycleSets = await runWasmExport('getCycleSets');\n  const cycles = await runWasmExport('getCycles');\n  const bigCycles = BigInteger(cyclesPerCycleSet).multiply(cycleSets).add(cycles);\n\n  if (radix) {\n    return bigCycles.toString(radix);\n  }\n\n  return bigCycles.toString(10);\n};\n\n// Functions here are depedent on WasmBoyMemory state.\nconst messageRequests = {};\n\nfunction libWorkerOnMessage(event) {\n  const eventData = getEventData(event);\n\n  if (!eventData.message) {\n    return;\n  }\n\n  if (messageRequests[eventData.message.type]) {\n    messageRequests[eventData.message.type].forEach(request => request(eventData.message));\n  }\n\n  switch (eventData.message.type) {\n    case WORKER_MESSAGE_TYPE.UPDATED:\n      {\n        this.fps = eventData.message.fps;\n        return;\n      }\n\n    case WORKER_MESSAGE_TYPE.BREAKPOINT:\n      {\n        const breakpointTask = async () => {\n          await this.pause();\n\n          if (this.options.breakpointCallback) {\n            this.options.breakpointCallback();\n          }\n\n          WasmBoyPlugins.runHook({\n            key: 'breakpoint'\n          });\n        };\n\n        breakpointTask();\n        return;\n      }\n\n    case WORKER_MESSAGE_TYPE.CRASHED:\n      {\n        const crashedTask = async () => {\n          await this.pause();\n          console.log('Wasmboy Crashed!');\n          let programCounter = await runWasmExport('getProgramCounter');\n          let gameboyMemoryConstant = await getWasmConstant('GAMEBOY_INTERNAL_MEMORY_LOCATION');\n          let opcode = await getWasmMemorySection(gameboyMemoryConstant + programCounter, gameboyMemoryConstant + programCounter + 1);\n          console.log(`Program Counter: 0x${programCounter.toString(16)}`);\n          console.log(`Opcode: 0x${opcode[0].toString(16)}`);\n        };\n\n        crashedTask();\n        return;\n      }\n\n    default:\n\n  }\n}\n\n// WasmBoy Modules\nlet isWindowUnloading = false; // Our Main Orchestrator of the WasmBoy lib\n\nclass WasmBoyLibService {\n  // Start the request to our wasm module\n  constructor() {\n    this.worker = undefined;\n    this.coreType = undefined;\n    this.canvasElement = undefined;\n    this.paused = false;\n    this.ready = false;\n    this.loadedAndStarted = false;\n    this.initialized = false;\n    this.renderId = false;\n    this.loadedROM = false;\n    this.fps = 0;\n    this.speed = 1.0; // Reset our config and stateful elements that depend on it\n    // this.options is set here\n\n    this._resetConfig(); // Add some listeners for when we are put into the background\n\n\n    if (typeof window !== 'undefined') {\n      // Calling promises in the hidden visibility change\n      // On page reload, leaks memory\n      // https://bugs.chromium.org/p/chromium/issues/detail?id=932885&can=1&q=torchh2424%40gmail.com&colspec=ID%20Pri%20M%20Stars%20ReleaseBlock%20Component%20Status%20Owner%20Summary%20OS%20Modified\n      // Thus we need this hack, to get around this\n      window.addEventListener('beforeunload', function (event) {\n        isWindowUnloading = true;\n      });\n      window.document.addEventListener('visibilitychange', () => {\n        // fires when user switches tabs, apps, goes to homescreen, etc.\n        if (document.visibilityState === 'hidden') {\n          if (this.options && this.options.disablePauseOnHidden) {\n            return;\n          }\n\n          setTimeout(() => {\n            if (!isWindowUnloading) {\n              // See the comment above about the memory leak\n              // This fires off a bunch of promises, thus a leak\n              this.pause();\n            }\n          }, 0);\n        }\n      });\n    }\n  } // Function to initialize/configure Wasmboy\n\n\n  config(wasmBoyOptions, canvasElement) {\n    const configTask = async () => {\n      // Pause any currently running game\n      await this.pause(); // Get our canvas elements\n\n      await this.setCanvas(canvasElement); // Reset our config and stateful elements that depend on it\n      // If we have a new config to take its place\n\n      if (wasmBoyOptions || !this.options) {\n        this._resetConfig();\n      } // set our options\n\n\n      if (wasmBoyOptions) {\n        // Set all options\n        Object.keys(wasmBoyOptions).forEach(key => {\n          if (this.options[key] !== undefined) {\n            this.options[key] = wasmBoyOptions[key];\n          }\n        }); // Aliases\n        // Gameboy Speed / Framerate\n\n        if (wasmBoyOptions.gameboySpeed) {\n          let gameboyFrameRate = Math.floor(wasmBoyOptions.gameboySpeed * 60);\n\n          if (gameboyFrameRate <= 0) {\n            gameboyFrameRate = 1;\n          }\n\n          this.options.gameboyFrameRate = gameboyFrameRate;\n        }\n      }\n    };\n\n    return configTask();\n  } // Function to return our current configuration as an object\n\n\n  getConfig() {\n    return this.options;\n  } // Function to get/set our canvas element\n  // Useful for vaporboy\n\n\n  setCanvas(canvasElement) {\n    if (!canvasElement) {\n      return Promise.resolve();\n    }\n\n    const setCanvasTask = async () => {\n      await this.pause(); // Set our new canvas element, and re-run init on graphics to apply styles and things\n\n      this.canvasElement = canvasElement;\n      await WasmBoyGraphics.initialize(this.canvasElement, this.options.updateGraphicsCallback);\n    };\n\n    return setCanvasTask();\n  }\n\n  getCanvas() {\n    return this.canvasElement;\n  } // Finish request for wasm module, and fetch boot ROM\n\n\n  addBootROM(type, file, fetchHeaders, additionalInfo) {\n    return WasmBoyMemory.addBootROM(type, file, fetchHeaders, additionalInfo);\n  }\n\n  getBootROMs() {\n    return WasmBoyMemory.getBootROMs();\n  } // Finish request for wasm module, and fetch game\n\n\n  loadROM(ROM, fetchHeaders) {\n    const boundLoadROM = loadROMToWasmBoy.bind(this);\n    return boundLoadROM(ROM, fetchHeaders);\n  } // Function to start/resume\n\n\n  play() {\n    const playTask = async () => {\n      if (!this.ready) {\n        return;\n      }\n\n      if (!this.loadedAndStarted) {\n        this.loadedAndStarted = true;\n\n        if (this.options.onLoadedAndStarted) {\n          this.options.onLoadedAndStarted();\n        }\n\n        WasmBoyPlugins.runHook({\n          key: 'loadedAndStarted'\n        });\n      }\n\n      if (this.options.onPlay) {\n        this.options.onPlay();\n      }\n\n      WasmBoyPlugins.runHook({\n        key: 'play'\n      }); // Bless the audio, this is to fix any autoplay issues\n\n      if (!this.options.headless) {\n        WasmBoyAudio.resumeAudioContext();\n        WasmBoyAudio.resetTimeStretch();\n      } // Reset the audio queue index to stop weird pauses when trying to load a game\n\n\n      await this.worker.postMessage({\n        type: WORKER_MESSAGE_TYPE.RESET_AUDIO_QUEUE\n      }); // Undo any pause\n\n      this.paused = false;\n\n      if (!this.updateId) {\n        await this.worker.postMessage({\n          type: WORKER_MESSAGE_TYPE.PLAY\n        });\n      }\n\n      if (!this.renderId && !this.options.headless) {\n        this.renderId = raf_1(() => {\n          render.call(this);\n        });\n      }\n    };\n\n    return playTask();\n  } // Function to pause the game, returns a promise\n  // Will try to wait until the emulation sync is returned, and then will\n  // Allow any actions\n\n\n  pause() {\n    const pauseTask = async () => {\n      this.paused = true;\n\n      if (this.ready && this.options.onPause) {\n        this.options.onPause();\n      }\n\n      WasmBoyPlugins.runHook({\n        key: 'pause'\n      }); // Cancel our update and render loop\n\n      raf_1.cancel(this.renderId);\n      this.renderId = false; // Cancel any playing audio\n      // Audio played with latency may be still going on here\n\n      if (!this.options.headless) {\n        WasmBoyAudio.cancelAllAudio(true);\n      }\n\n      if (this.worker) {\n        await this.worker.postMessage({\n          type: WORKER_MESSAGE_TYPE.PAUSE\n        });\n      } // Wait a raf to ensure everything is done\n\n\n      await new Promise(resolve => {\n        raf_1(() => {\n          resolve();\n        });\n      });\n    };\n\n    return pauseTask();\n  } // Function to reset wasmBoy, with an optional set of options\n\n\n  reset(wasmBoyOptions) {\n    const resetTask = async () => {\n      this.config(wasmBoyOptions, this.canvasElement); // Reload the game if one was already loaded\n\n      if (this.loadedROM) {\n        return this.loadROM(this.loadedROM);\n      }\n    };\n\n    return resetTask();\n  }\n\n  getSavedMemory() {\n    return WasmBoyMemory.getSavedMemory();\n  }\n\n  saveLoadedCartridge(additionalInfo) {\n    return WasmBoyMemory.saveLoadedCartridge(additionalInfo);\n  }\n\n  deleteSavedCartridge(cartridge) {\n    return WasmBoyMemory.deleteSavedCartridge(cartridge);\n  }\n\n  saveState() {\n    const saveStateTask = async () => {\n      await this.pause();\n      const saveState = await WasmBoyMemory.saveState();\n      return saveState;\n    };\n\n    return saveStateTask();\n  } // Function to return the save states for the game\n\n\n  getSaveStates() {\n    const getSaveStatesTask = async () => {\n      let cartridgeObject = await WasmBoyMemory.getCartridgeObject();\n\n      if (!cartridgeObject) {\n        return [];\n      } else {\n        return cartridgeObject.saveStates;\n      }\n    };\n\n    return getSaveStatesTask();\n  }\n\n  loadState(saveState) {\n    const loadStateTask = async () => {\n      await this.pause();\n      await WasmBoyMemory.loadState(saveState);\n    };\n\n    return loadStateTask();\n  }\n\n  deleteState(saveState) {\n    const deleteStateTask = async () => {\n      await WasmBoyMemory.deleteState(saveState);\n    };\n\n    return deleteStateTask();\n  } // Simply returns the FPS we get back from the lib worker\n\n\n  getFPS() {\n    return this.fps;\n  } // Simply returns our current Core Type\n\n\n  getCoreType() {\n    return this.coreType;\n  }\n\n  getSpeed() {\n    return this.speed;\n  } // Set the speed of the emulator\n  // Should be a float. And by X times as fast\n\n\n  setSpeed(speed) {\n    if (speed <= 0) {\n      speed = 0.1;\n    }\n\n    const setSpeedTask = async () => {\n      if (this.worker) {\n        this.speed = speed;\n        WasmBoyAudio.setSpeed(speed);\n        await this.worker.postMessageIgnoreResponse({\n          type: WORKER_MESSAGE_TYPE.SET_SPEED,\n          speed\n        });\n      } // Wait a raf to ensure everything is done\n\n\n      await new Promise(resolve => {\n        raf_1(() => {\n          resolve();\n        });\n      });\n    };\n\n    setSpeedTask();\n  } // Function to return if we currently are playing as a gbc console\n\n\n  isGBC() {\n    const isGBCTask = async () => {\n      const event = await WasmBoyLib.worker.postMessage({\n        type: WORKER_MESSAGE_TYPE.IS_GBC\n      });\n      const eventData = getEventData(event);\n      return eventData.message.response;\n    };\n\n    return isGBCTask();\n  } // Private Function to reset options to default\n\n\n  _resetConfig() {\n    // Reset Fps Metering\n    this.fpsTimeStamps = [];\n    this.frameSkipCounter = 0; // Configurable Options\n    // Set callbacks to null and not undefined,\n    // For when configs are passed, we will be sure to\n    // add them as keys\n\n    this.options = {\n      headless: false,\n      disablePauseOnHidden: false,\n      isAudioEnabled: true,\n      enableAudioDebugging: false,\n      gameboyFrameRate: 60,\n      frameSkip: 0,\n      enableBootROMIfAvailable: true,\n      isGbcEnabled: true,\n      isGbcColorizationEnabled: true,\n      gbcColorizationPalette: null,\n      audioBatchProcessing: false,\n      graphicsBatchProcessing: false,\n      timersBatchProcessing: false,\n      graphicsDisableScanlineRendering: false,\n      audioAccumulateSamples: false,\n      tileRendering: false,\n      tileCaching: false,\n      maxNumberOfAutoSaveStates: 10,\n      updateGraphicsCallback: null,\n      updateAudioCallback: null,\n      saveStateCallback: null,\n      breakpointCallback: null,\n      onReady: null,\n      onPlay: null,\n      onPause: null,\n      onLoadedAndStarted: null\n    };\n  } // Function to instantiate and set up our workers\n  // This ensures we don't create workers twice\n\n\n  _instantiateWorkers() {\n    const instantiateWorkersTask = async () => {\n      if (this.worker) {\n        return;\n      } else {\n        this.worker = await instantiateWorkers();\n        this.worker.addMessageListener(libWorkerOnMessage.bind(this));\n      }\n    };\n\n    return instantiateWorkersTask();\n  }\n\n}\n\nconst WasmBoyLib = new WasmBoyLibService();\n\nvar name = \"wasmboy\";\nvar description = \"Gameboy / Gameboy Color Emulator written for Web Assembly using AssemblyScript. Shell/Debugger in Preact\";\nvar keywords = [\n\t\"web-assembly\",\n\t\"webassembly\",\n\t\"gameboy\",\n\t\"emulator\",\n\t\"emulation\",\n\t\"assemblyscript\",\n\t\"gameboy-color\"\n];\nvar author = \"Aaron Turner\";\nvar version = \"0.5.2\";\nvar license = \"GPL-3.0-or-later\";\nvar homepage = \"https://wasmboy.app\";\nvar repository = {\n\ttype: \"git\",\n\turl: \"git+https://github.com/torch2424/wasmBoy.git\"\n};\nvar bugs = {\n\turl: \"https://github.com/torch2424/wasmBoy/issues\"\n};\nvar main = \"dist/wasmboy.wasm.cjs.js\";\nvar module$1 = \"dist/wasmboy.wasm.esm.js\";\nvar browser = \"dist/wasmboy.wasm.umd.js\";\nvar iife = \"dist/wasmboy.wasm.iife.js\";\nvar scripts = {\n\tprepare: \"run-s core:build lib:build\",\n\tstart: \"concurrently --kill-others --names \\\"DEBUGGER,CORE,LIB\\\" -c \\\"bgBlue.bold,bgMagenta.bold,bgGreen.bold\\\" \\\"npm run debugger:watch\\\" \\\"npm run core:watch\\\" \\\"npm run lib:watch:wasm\\\"\",\n\t\"start:ts\": \"concurrently --kill-others --names \\\"DEBUGGER,LIBANDCORETS\\\" -c \\\"bgBlue.bold,bgGreen.bold\\\" \\\"npm run debugger:watch\\\" \\\"npm run lib:watch:ts\\\"\",\n\tdev: \"npm run start\",\n\twatch: \"npm run start\",\n\t\"dev:ts\": \"npm run start:ts\",\n\t\"watch:ts\": \"npm run start:ts\",\n\tbuild: \"run-s core:build lib:build:wasm\",\n\tdeploy: \"run-s lib:deploy demo:deploy\",\n\tprettier: \"npm run prettier:lint:fix\",\n\t\"prettier:lint\": \"run-s prettier:lint:message prettier:lint:list\",\n\t\"prettier:lint:message\": \"echo \\\"Listing unlinted files, will show nothing if everything is fine.\\\"\",\n\t\"prettier:lint:list\": \"prettier --config .prettierrc --list-different rollup.*.js preact.config.js demo/**/*.js demo/**/*.css lib/**/*.js core/**/*.ts\",\n\t\"prettier:lint:fix\": \"prettier --config .prettierrc --write rollup.*.js preact.config.js demo/**/*.js demo/**/*.css lib/**/*.js core/**/*.ts\",\n\tprecommit: \"pretty-quick --staged\",\n\t\"core:watch\": \"watch \\\"npm run core:build\\\" core\",\n\t\"core:build\": \"run-s core:build:asc core:build:dist core:build:done\",\n\t\"core:build:asc\": \"asc core/index.ts -b dist/core/core.untouched.wasm -t dist/core/core.untouched.wat -O3 --converge --sourceMap core/dist/core.untouched.wasm.map --memoryBase 0\",\n\t\"core:build:ts\": \"rollup -c --environment TS\",\n\t\"core:build:asc:measure\": \"npm run core:build:asc -- --measure --noEmit\",\n\t\"core:build:ts:measure\": \"tsc --project core/tsconfig.json --noEmit --extendedDiagnostics\",\n\t\"core:build:dist\": \"run-s core:build:dist:mkdir core:build:dist:cp\",\n\t\"core:build:dist:mkdir\": \"mkdir -p build/assets\",\n\t\"core:build:dist:cp\": \"cp dist/core/*.untouched.* build/assets\",\n\t\"core:build:done\": \"echo \\\"Built Core!\\\"\",\n\t\"lib:build\": \"run-s lib:build:wasm lib:build:ts lib:build:ts:getcoreclosure\",\n\t\"lib:watch:wasm\": \"rollup -c -w --environment WASM\",\n\t\"lib:build:wasm\": \"rollup -c --environment PROD,WASM\",\n\t\"lib:watch:ts\": \"rollup -c -w --environment TS\",\n\t\"lib:build:ts\": \"rollup -c --environment PROD,TS\",\n\t\"lib:build:ts:esnext\": \"rollup -c --environment PROD,TS,ES_NEXT\",\n\t\"lib:build:ts:getcoreclosure\": \"rollup -c --environment PROD,TS,GET_CORE_CLOSURE\",\n\t\"lib:build:ts:getcoreclosure:closuredebug\": \"rollup -c --environment PROD,TS,GET_CORE_CLOSURE,CLOSURE_DEBUG\",\n\t\"lib:deploy\": \"run-s core:build lib:build:wasm lib:build:ts lib:deploy:np\",\n\t\"lib:deploy:np\": \"np\",\n\ttest: \"npm run test:accuracy\",\n\t\"test:accuracy\": \"run-s build test:accuracy:nobuild\",\n\t\"test:accuracy:nobuild\": \"node --experimental-worker node_modules/mocha/bin/_mocha test/accuracy/accuracy-test.js --exit\",\n\t\"test:perf\": \"npm run test:performance\",\n\t\"test:performance\": \"run-s build test:performance:nobuild\",\n\t\"test:performance:nobuild\": \"node --experimental-worker node_modules/mocha/bin/_mocha test/performance/performance-test.js --exit\",\n\t\"test:integration\": \"run-s build test:integration:lib test:integration:headless\",\n\t\"test:integration:nobuild\": \"run-s test:integration:lib test:integration:headless\",\n\t\"test:integration:lib\": \"node --experimental-worker node_modules/mocha/bin/_mocha test/integration/lib-test.js --exit\",\n\t\"test:integration:headless\": \"node --experimental-worker node_modules/mocha/bin/_mocha test/integration/headless-simple.js --timeout 20000 --exit\",\n\t\"test:core\": \"run-s build test:core:savestate\",\n\t\"test:core:nobuild\": \"run-s test:core:savestate\",\n\t\"test:core:savestate\": \"node --experimental-worker node_modules/mocha/bin/_mocha test/core/save-state.js --timeout 10000 --exit\",\n\t\"debugger:dev\": \"npm run debugger:watch\",\n\t\"debugger:watch\": \"rollup -c -w --environment DEBUGGER,SERVE\",\n\t\"debugger:build\": \"rollup -c --environment DEBUGGER\",\n\t\"debugger:build:skiplib\": \"rollup -c --environment DEBUGGER,SKIP_LIB\",\n\t\"benchmark:build\": \"rollup -c --environment PROD,TS,BENCHMARK\",\n\t\"benchmark:build:skiplib\": \"rollup -c --environment PROD,TS,BENCHMARK,SKIP_LIB\",\n\t\"benchmark:dev\": \"npm run benchmark:watch\",\n\t\"benchmark:watch\": \"rollup -c -w --environment BENCHMARK,SERVE\",\n\t\"amp:build\": \"rollup -c --environment PROD,TS,AMP\",\n\t\"amp:build:skiplib\": \"rollup -c --environment PROD,TS,AMP,SKIP_LIB\",\n\t\"amp:dev\": \"npm run amp:watch\",\n\t\"amp:watch\": \"rollup -c -w --environment AMP,SERVE\",\n\t\"iframe:dev\": \"npm run iframe:watch\",\n\t\"iframe:watch\": \"rollup -c -w --environment IFRAME,SERVE\",\n\t\"iframe:serve\": \"serve build/iframe -p 8080\",\n\t\"iframe:build\": \"rollup -c --environment IFRAME\",\n\t\"iframe:build:skiplib\": \"rollup -c --environment IFRAME,SKIP_LIB\",\n\t\"demo:build\": \"run-s core:build lib:build demo:build:apps\",\n\t\"demo:build:apps\": \"run-s debugger:build:skiplib benchmark:build:skiplib amp:build:skiplib iframe:build:skiplib\",\n\t\"demo:cname\": \"echo 'wasmboy.app' > build/CNAME\",\n\t\"demo:dist\": \"cp -r dist/ build/dist\",\n\t\"demo:gh-pages\": \"gh-pages -d build\",\n\t\"demo:deploy\": \"run-s demo:build demo:dist demo:cname demo:gh-pages\",\n\t\"wasmerboy:build\": \"asc demo/wasmerboy/index.ts -b demo/wasmerboy/dist/wasmerboy.wasm -O3 --converge --use abort=wasi_abort --runtime stub --memoryBase 8324096\",\n\t\"wasmerboy:start\": \"cd demo/wasmerboy && wapm run wasmerboy --dir=tobutobugirl tobutobugirl/tobutobugirl.gb && cd ..\"\n};\nvar files = [\n\t\"dist\",\n\t\"core\",\n\t\"lib\",\n\t\"README.md\",\n\t\"LICENSE\"\n];\nvar dependencies = {\n\t\"audiobuffer-to-wav\": \"git+https://github.com/torch2424/audiobuffer-to-wav.git#es-module-rollup\",\n\tidb: \"^2.1.3\",\n\traf: \"^3.4.0\",\n\t\"responsive-gamepad\": \"1.1.0\"\n};\nvar devDependencies = {\n\t\"@ampproject/rollup-plugin-closure-compiler\": \"^0.26.0\",\n\t\"@babel/core\": \"^7.1.2\",\n\t\"@babel/plugin-proposal-class-properties\": \"^7.1.0\",\n\t\"@babel/plugin-proposal-export-default-from\": \"^7.2.0\",\n\t\"@babel/plugin-proposal-object-rest-spread\": \"^7.0.0\",\n\t\"@babel/plugin-transform-react-jsx\": \"^7.0.0\",\n\t\"@phosphor/commands\": \"^1.6.1\",\n\t\"@phosphor/default-theme\": \"^0.1.0\",\n\t\"@phosphor/messaging\": \"^1.2.2\",\n\t\"@phosphor/widgets\": \"^1.6.0\",\n\t\"@rollup/plugin-commonjs\": \"^11.0.2\",\n\t\"@rollup/plugin-node-resolve\": \"^7.1.1\",\n\t\"@wasmer/io-devices-lib-assemblyscript\": \"^0.1.3\",\n\t\"as-wasi\": \"git+https://github.com/jedisct1/as-wasi.git\",\n\tassemblyscript: \"^0.15.1\",\n\t\"babel-plugin-filter-imports\": \"^2.0.3\",\n\t\"babel-preset-env\": \"^1.6.1\",\n\t\"big-integer\": \"^1.6.38\",\n\t\"browser-detect\": \"^0.2.28\",\n\tbulma: \"^0.7.1\",\n\t\"chart.js\": \"^2.7.3\",\n\t\"chartjs-plugin-downsample\": \"^1.0.2\",\n\tchota: \"^0.5.2\",\n\tconcurrently: \"^3.5.1\",\n\t\"devtools-detect\": \"^2.2.0\",\n\t\"gb-instructions-opcodes\": \"0.0.4\",\n\t\"gh-pages\": \"^1.1.0\",\n\t\"hash-generator\": \"^0.1.0\",\n\thusky: \"^1.0.0-rc.8\",\n\t\"load-script\": \"^1.0.0\",\n\t\"markdown-table\": \"^1.1.1\",\n\tmicroseconds: \"^0.1.0\",\n\tmocha: \"^5.0.1\",\n\t\"normalize.css\": \"^8.0.1\",\n\tnp: \"^3.1.0\",\n\t\"npm-run-all\": \"^4.1.5\",\n\t\"performance-now\": \"^2.1.0\",\n\t\"pngjs-image\": \"^0.11.7\",\n\t\"postcss-import\": \"^12.0.1\",\n\tpreact: \"^8.2.1\",\n\t\"preact-compat\": \"^3.17.0\",\n\t\"preact-portal\": \"^1.1.3\",\n\t\"preact-virtual-list\": \"^0.3.1\",\n\tprettier: \"^1.12.1\",\n\t\"pretty-quick\": \"^1.6.0\",\n\tpubx: \"0.0.3\",\n\t\"recursive-readdir-sync\": \"^1.0.6\",\n\trollup: \"^0.66.1\",\n\t\"rollup-plugin-babel\": \"^4.0.3\",\n\t\"rollup-plugin-bundle-size\": \"^1.0.2\",\n\t\"rollup-plugin-commonjs\": \"^9.2.0\",\n\t\"rollup-plugin-copy-glob\": \"^0.3.1\",\n\t\"rollup-plugin-delete\": \"^0.1.2\",\n\t\"rollup-plugin-hash\": \"^1.3.0\",\n\t\"rollup-plugin-json\": \"^3.1.0\",\n\t\"rollup-plugin-livereload\": \"^1.3.0\",\n\t\"rollup-plugin-node-resolve\": \"^3.4.0\",\n\t\"rollup-plugin-postcss\": \"^1.6.2\",\n\t\"rollup-plugin-replace\": \"^2.1.0\",\n\t\"rollup-plugin-serve\": \"^0.6.0\",\n\t\"rollup-plugin-svelte\": \"^5.1.1\",\n\t\"rollup-plugin-terser\": \"^5.2.0\",\n\t\"rollup-plugin-typescript\": \"^1.0.0\",\n\t\"rollup-plugin-url\": \"^2.1.0\",\n\tserve: \"^11.3.2\",\n\t\"shared-gb\": \"git+https://github.com/torch2424/shared-gb-js.git\",\n\t\"source-map-loader\": \"^0.2.4\",\n\t\"stats-lite\": \"^2.2.0\",\n\tsvelte: \"^3.19.2\",\n\tterser: \"^4.6.6\",\n\ttraverse: \"^0.6.6\",\n\ttslib: \"^1.9.3\",\n\ttypescript: \"^3.1.3\",\n\t\"uglifyjs-webpack-plugin\": \"^1.2.3\",\n\t\"url-loader\": \"^1.0.1\",\n\tvaloo: \"^2.1.0\",\n\twatch: \"^1.0.2\",\n\t\"webpack-dev-server\": \"^3.11.0\"\n};\nvar packageJson = {\n\tname: name,\n\tdescription: description,\n\tkeywords: keywords,\n\tauthor: author,\n\tversion: version,\n\tlicense: license,\n\thomepage: homepage,\n\trepository: repository,\n\tbugs: bugs,\n\tmain: main,\n\tmodule: module$1,\n\tbrowser: browser,\n\tiife: iife,\n\tscripts: scripts,\n\tfiles: files,\n\tdependencies: dependencies,\n\tdevDependencies: devDependencies\n};\n\n// Build our public lib api\n// export an object that public exposes parts of the singleton\n// Need to bind to preserve this\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Function/bind\n\nconst WasmBoy = {\n  config: WasmBoyLib.config.bind(WasmBoyLib),\n  getCoreType: WasmBoyLib.getCoreType.bind(WasmBoyLib),\n  getConfig: WasmBoyLib.getConfig.bind(WasmBoyLib),\n  setCanvas: WasmBoyLib.setCanvas.bind(WasmBoyLib),\n  getCanvas: WasmBoyLib.getCanvas.bind(WasmBoyLib),\n  addBootROM: WasmBoyLib.addBootROM.bind(WasmBoyLib),\n  getBootROMs: WasmBoyLib.getBootROMs.bind(WasmBoyLib),\n  loadROM: WasmBoyLib.loadROM.bind(WasmBoyLib),\n  play: WasmBoyLib.play.bind(WasmBoyLib),\n  pause: WasmBoyLib.pause.bind(WasmBoyLib),\n  reset: WasmBoyLib.reset.bind(WasmBoyLib),\n  addPlugin: WasmBoyPlugins.addPlugin.bind(WasmBoyPlugins),\n  isPlaying: () => {\n    return !WasmBoyLib.paused;\n  },\n  isPaused: () => {\n    return WasmBoyLib.paused;\n  },\n  isReady: () => {\n    return WasmBoyLib.ready;\n  },\n  isLoadedAndStarted: () => {\n    return WasmBoyLib.loadedAndStarted;\n  },\n  getVersion: () => {\n    return packageJson.version;\n  },\n  getSavedMemory: WasmBoyLib.getSavedMemory.bind(WasmBoyLib),\n  saveLoadedCartridge: WasmBoyLib.saveLoadedCartridge.bind(WasmBoyLib),\n  deleteSavedCartridge: WasmBoyLib.deleteSavedCartridge.bind(WasmBoyLib),\n  saveState: WasmBoyLib.saveState.bind(WasmBoyLib),\n  getSaveStates: WasmBoyLib.getSaveStates.bind(WasmBoyLib),\n  loadState: WasmBoyLib.loadState.bind(WasmBoyLib),\n  deleteState: WasmBoyLib.deleteState.bind(WasmBoyLib),\n  getFPS: WasmBoyLib.getFPS.bind(WasmBoyLib),\n  setSpeed: WasmBoyLib.setSpeed.bind(WasmBoyLib),\n  isGBC: WasmBoyLib.isGBC.bind(WasmBoyLib),\n  ResponsiveGamepad: WasmBoyController.ResponsiveGamepad,\n  enableDefaultJoypad: WasmBoyController.enableDefaultJoypad.bind(WasmBoyController),\n  disableDefaultJoypad: WasmBoyController.disableDefaultJoypad.bind(WasmBoyController),\n  setJoypadState: WasmBoyController.setJoypadState.bind(WasmBoyController),\n  resumeAudioContext: WasmBoyAudio.resumeAudioContext.bind(WasmBoyAudio),\n  _getAudioChannels: WasmBoyAudio.getAudioChannels.bind(WasmBoyAudio),\n  _getCartridgeInfo: WasmBoyMemory.getCartridgeInfo.bind(WasmBoyMemory),\n  _runNumberOfFrames: runNumberOfFrames,\n  _runWasmExport: runWasmExport,\n  _getWasmMemorySection: getWasmMemorySection,\n  _getWasmConstant: getWasmConstant,\n  _getStepsAsString: getStepsAsString,\n  _getCyclesAsString: getCyclesAsString\n};\n\nexport { WasmBoy };\n//# sourceMappingURL=wasmboy.wasm.esm.js.map\n","<script>\n  import {isStarted, playPoster} from '../stores.js';\n  import PlayIcon from './icons/PlayIcon.svelte';\n  import {WasmBoy} from '../../../dist/wasmboy.wasm.esm.js';\n\n  function handlePlay() {\n    // Calling resume Audio Context here, as it is always touched on mobile\n    WasmBoy.resumeAudioContext();\n    isStarted.set(true);\n  }\n</script>\n\n<div class=\"play-poster\">\n  {#if $playPoster}\n    <img class=\"play-poster__image\" src={$playPoster} alt=\"Wasm boy play poster\">\n  {/if}\n\n  <div class=\"play-poster__shade\"></div>\n\n  <button class=\"play-poster__play-button\" on:click={handlePlay}>\n    <PlayIcon />\n  </button>\n</div>\n\n<style>\n  .play-poster {\n    position: relative;\n    width: 100%;\n    height: 100%;\n\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n\n  .play-poster__image {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n\n    z-index: -1;\n    object-fit: cover;\n  }\n\n  .play-poster__shade {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n\n    background-color: rgba(0,0,0,0.85);\n  }\n\n  .play-poster__play-button {\n    background-color: transparent;\n    border: none;\n\n    width: 100%;\n    height:100%;\n    max-width: 300px;\n    max-height: 300px;\n\n    z-index: 1;\n  }\n\n  .play-poster__play-button svg {\n    width: 100%;\n    height: 100%;\n  }\n</style>\n\n","<script>\n  import { onMount } from 'svelte';\n  import {isStarted, isLoaded, isPlaying, romUrl, romName, saveState, setStatus} from '../stores.js';\n  import {WasmBoy} from '../../../dist/wasmboy.wasm.esm.js';\n\n  let mountResolve;\n  let mountPromise = new Promise(resolve => {\n    mountResolve = resolve;\n  });\n  onMount(mountResolve);\n\n  let canvasStyle = 'display: none';\n\n  const loadWasmBoy = async () => {\n    await mountPromise;\n\n    const wasmBoyCanvas = document.querySelector('.canvas-container > canvas');\n\n    const EmbedPlugin = {\n      name: 'EmbedPlugin',\n      saveState: saveStateObject => {\n        if (wasmBoyCanvas) {\n          saveStateObject.screenshotCanvasDataURL = wasmBoyCanvas.toDataURL();\n        }\n      },\n      play: () => isPlaying.set(true),\n      pause: () => {\n        isPlaying.set(false);\n        setStatus('Paused', -1);\n      }\n    };\n\n    await WasmBoy.config({\n      isGbcEnabled: true,\n      isGbcColorizationEnabled: true,\n      isAudioEnabled: true,\n      gameboyFrameRate: 60,\n      maxNumberOfAutoSaveStates: 3\n    });\n\n    await WasmBoy.setCanvas(wasmBoyCanvas);\n    WasmBoy.addPlugin(EmbedPlugin);\n    await WasmBoy.loadROM($romUrl);\n    await WasmBoy.play();\n\n    canvasStyle = 'display: block';\n    isLoaded.set(true)\n    isPlaying.set(true);\n  }\n  const wasmBoyPromise = loadWasmBoy().catch(error => {\n    console.error(error);\n    throw error;\n  });\n\n  isPlaying.subscribe(async (value) => {\n    if(!WasmBoy.isPlaying() && value) {\n      await WasmBoy.play();\n    } else if (WasmBoy.isPlaying() && !value) {\n      await WasmBoy.pause();\n    }\n  });\n\n  saveState.subscribe(() => {\n    if ($isStarted && $isLoaded) {\n      WasmBoy.saveState().then(() => {\n        WasmBoy.play();\n        setStatus('State Saved!');\n      }).catch(() => {\n        setStatus('Error saving the state...')\n      });\n    }\n  });\n</script>\n\n<div class=\"canvas-container\" style={canvasStyle}>\n  <canvas />\n</div>\n\n{#if $isLoaded === false}\n<div class=\"status\">\n  {#await wasmBoyPromise}\n    {#if $romName}\n      <h2>Loading {$romName} ...</h2>\n    {:else}\n      <h2>Loading...</h2>\n    {/if}\n    <div class=\"donut\"></div>\n  {:catch error}\n    <div class=\"error\">\n      {#if $romName}\n        <h2>Error loading {$romName} ...</h2>\n      {:else}\n        <h3>Error!</h3>\n      {/if}\n      <h3>{error.message}</h3>\n    </div>\n  {/await}\n</div>\n{/if}\n\n<style>\n  .canvas-container {\n    width: 100%;\n    height: 100%;\n\n    background-color: #000;\n  }\n\n  .canvas-container > canvas {\n    width: 100%;\n    height: 100%;\n  }\n\n  :global(.touchpad-visible.portrait) .canvas-container > canvas {\n    width: 100%;\n    height: 300px;\n  }\n\n  :global(.touchpad-visible.landscape) .canvas-container > canvas {\n    width: 100%;\n    height: calc(100% - 50px);\n  }\n\n  .status {\n    width: 100%;\n    height: 100%;\n\n    text-align: center;\n\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n  }\n</style>\n","<script>\n  import {WasmBoy} from '../../../dist/wasmboy.wasm.esm.js'; \n  import {setStatus, hideModal} from '../stores.js';\n\n  const wasmBoySaveStates = WasmBoy.getSaveStates()\n    .then(saveStates => {\n      // Sort by date\n      saveStates.sort((a, b) => {\n        if (a.date > b.date) {\n          return -1;\n        }\n        if (a.date < b.date) {\n          return 1;\n        }\n        return 0;\n      });\n      return Promise.resolve(saveStates);\n    })\n    .catch(error => {\n    console.error(error);\n    throw error;\n  });\n\n  const handleLoadState = async (saveState) => {\n    await WasmBoy.loadState(saveState);\n    await WasmBoy.play();\n    hideModal();\n    setStatus('State Loaded!');\n  }\n</script>\n\n{#await wasmBoySaveStates}\n  <div class=\"donut\"></div>\n{:then saveStates}\n  <ul>\n    {#each saveStates as saveState}\n    <li>\n      <button on:click={e => handleLoadState(saveState)}>\n        <img src={saveState.screenshotCanvasDataURL} alt=\"Save State Screenshot\" />\n        <div>\n          <h2>{(new Date(saveState.date)).toLocaleString()}</h2>\n          <h4>{saveState.isAuto ? 'Auto Save' : 'Manual Save'}</h4>\n        </div>\n      </button>\n    </li>\n    {/each}\n  </ul>\n{:catch error}\n  <p style=\"color: red\">{error.message}</p>\n{/await}\n\n<style>\n  ul {\n    margin: 0px;\n    padding: 0px;\n    list-style-type: none;\n  }\n\n  li {\n    margin: 10px;\n    padding: 10px;\n\n    border-bottom: 2px solid #fff;\n  }\n\n  li:last-child {\n    border-bottom: none;\n  }\n\n  button {\n    width: 100%;\n    height: 100px;\n    background-color: transparent;\n    border: none;\n\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n\n    color: #fff;\n  }\n\n  button > img {\n    height: 100px;\n    width: 100px;\n\n    object-fit: cover;\n  }\n\n  button > div {\n    flex: 1;\n    width: 100%;\n\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: flex-start;\n\n    margin-left: 10px;\n  }\n</style>\n","<script>\n  import {playPoster, romName, romUrl} from '../stores.js';\n  import packageJson from \"../../../package.json\";\n</script>\n\n<div class=\"about\">\n\n  <h1>WasmBoy Embed Player</h1>\n  <p>This is a dynamic GameBoy / GameBoy color ROM player powered by WasmBoy. WasmBoy is a Game Boy / Game Boy Color emulation library, 🎮written for WebAssembly using <a href=\"https://github.com/AssemblyScript/assemblyscript\" target=\"_blank\">AssemblyScript</a>. 🚀 This embed is built with <a href=\"https://svelte.dev/\" target=\"_blank\">Svelte</a>, and input is handled by <a href=\"https://github.com/torch2424/responsive-gamepad\" target=\"_blank\">Responsive Gamepad</a>. WasmBoy is written by <a href=\"https://github.com/torch2424\" target=\"_blank\">Aaron Turner (torch2424)</a>, and Licensed under <a href=\"https://github.com/torch2424/wasmboy/blob/master/LICENSE\" target=\"_blank\">GPL 3.0</a>. Also, shoutout to fred-dim ikenna (evillizard) for requesting this feature for WasmBoy, and helping with the general direction!</p>\n  <div>WasmBoy Version: {packageJson.version}</div>\n  <h1>WasmBoy Links</h1>\n  <ul>\n    <li><a href=\"https://github.com/torch2424/wasmboy\" target=\"_blank\">Github Repo</a></li> \n    <li><a href=\"https://www.npmjs.com/package/wasmboy\" target=\"_blank\">NPM Package</a></li>\n  </ul>\n  <h1>Embed Configuration</h1>\n  <ul>\n    {#if $romName}\n      <li><b>ROM Name:</b> {$romName}</li>\n    {/if}\n    {#if $romUrl}\n      <li><b>ROM URL:</b> <a href={$romUrl} target=\"_blank\">{$romUrl}</a></li>\n    {/if}\n    {#if $playPoster}\n      <li><b>Play Poster:</b> <a href={$playPoster} target=\"_blank\">{$playPoster}</a></li>\n    {/if}\n  </ul>\n  <h1>Help</h1>\n  <h2>Controls</h2>\n  <p>This player supports Keyboard and Gamepad input per the default <a href=\"https://github.com/torch2424/responsive-gamepad\" target=\"_blank\">Responsive Gamepad</a> configuration. For keyboard controls: Directional (Dpad) controls are handled by the arrows keys, or WASD on your keyboard. The A button is controlled by the \"Z\" key. The B button is controlled by the \"X\" key. Start is handled by the \"Enter\" key. Select is handled by the \"Shift\" key.</p>\n  <h2>Saves States / Loading States</h2>\n  <p>Save states can be made by clicking the save icon in the control bar at the bottom of the page. Save states will also be made whenever you navigate away from the running iframe, or when the page is refreshed. Save states can be loaded by clicking the load icon in the control bar, and choosing the appropiate save state represented by the screenshot, and time at which the save states was made. Save states are stored locally in your browser in the IndexedDB API. Meaning they are not backed up to a server, and can be accidentally deleted when clearing your browser cache.</p>\n  <h2>Reporting Bugs / Making Suggestions</h2>\n  <p>Please feel free to file any bugs, suggestions, issues, etc.. At the <a href=\"https://github.com/torch2424/wasmboy\" target=\"_blank\">WasmBoy Github repo</a>.</p>\n</div>\n\n\n<style>\n  .about {\n    color: #fff;\n    font-size: 1.15em;\n  }\n\n  .about a, .about a:visited {\n    color: #b5cbfc;\n    word-break: break-all;\n  }\n</style>\n","<script>\n  import {modalStore, hideModal} from '../stores';\n  import LoadState from './LoadState.svelte';\n  import About from './About.svelte';\n  import CloseIcon from './icons/CloseIcon.svelte';\n\n  const handleClose = () => {\n    hideModal();\n  }\n</script>\n\n{#if $modalStore > 0}\n  <dialog>\n\n  <div class=\"modal-header\">\n      {#if $modalStore === 1}\n        <h2>Load State</h2>\n      {:else if $modalStore === 2}\n        <h2>About</h2>\n      {/if}\n\n      <button class=\"icon-button\" on:click={handleClose}>\n        <CloseIcon />\n      </button>\n    </div>\n\n    <div class=\"modal-content\">\n      {#if $modalStore === 1}\n        <LoadState />\n      {:else if $modalStore === 2}\n        <About />\n      {/if}\n    </div>\n  </dialog>\n{/if}\n\n<style>\n  dialog {\n    width: calc(100% - 50px);\n    height: 800px;\n    max-width: 800px;\n    max-height: calc(100% - 100px);\n    margin-top: 10px;\n    margin-left: auto;\n    margin-right: auto;\n\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 2;\n\n    display: flex;\n    flex-direction: column;\n    justify-content: flex-start;\n    align-items: center;\n\n    background-color: rgba(0,0,0,0.85);\n\n    border-radius: 5px;\n  }\n\n  .modal-header {\n    width: 100%;\n    display: flex;\n    justify-content: flex-end;\n    align-items: center;\n  }\n\n  .modal-header > h2 {\n    margin-right: auto;\n    color: #fff;\n  }\n\n  .modal-content {\n    width: 100%;\n    height: 100%;\n    flex: 1;\n\n    overflow-y: auto;\n  }\n</style>\n","<script>\n  import {\n    isPlaying, \n    setStatus, \n    status, \n    triggerSaveState, \n    showLoadState, \n    showAbout, \n    isTouchPadVisible,\n    isFullScreen\n  } from '../stores.js';\n  import PlayIcon from './icons/PlayIcon.svelte';\n  import PauseIcon from './icons/PauseIcon.svelte';\n  import SaveIcon from './icons/SaveIcon.svelte';\n  import LoadIcon from './icons/LoadIcon.svelte';\n  import AboutIcon from './icons/AboutIcon.svelte';\n  import ShowGamePadIcon from './icons/ShowGamePadIcon.svelte';\n  import HideGamePadIcon from './icons/HideGamePadIcon.svelte';\n  import FullScreenIcon from './icons/FullScreenIcon.svelte';\n  import ExitFullScreenIcon from './icons/ExitFullScreenIcon.svelte';\n\n  // Subscribe to our current status\n  let displayStatus = false;\n  let statusTimeout;\n  // Subscribe to status changes, and show the status message\n  // on changes\n  status.subscribe(value => {\n\n    if (statusTimeout) {\n      clearTimeout(statusTimeout);\n    }\n\n    displayStatus = true;\n\n    if (value.timeout < 0) {\n      return false;\n    }\n\n    statusTimeout = setTimeout(() => {\n      displayStatus = false;\n      statusTimeout = undefined;\n    }, value.timeout)\n  });\n\n  const handlePlayPause = () => {\n    if ($isPlaying) {\n      isPlaying.set(false);\n      setStatus('Paused', -1);\n    } else {\n      isPlaying.set(true);\n      setStatus('Playing!');\n    }\n  };\n\n  const handleSave = () => {\n    triggerSaveState();\n  };\n\n  const handleLoad = () => {\n    showLoadState();\n  };\n\n  const handleGamePad = () => {\n    if ($isTouchPadVisible) {\n      isTouchPadVisible.set(false);\n    } else {\n      isTouchPadVisible.set(true);\n    }\n  };\n\n  const handleAbout = () => {\n    showAbout();\n  };\n\n  const handleFullScreen = async () => {\n    if ($isFullScreen) {\n      isFullScreen.set(false);\n      document.exitFullscreen();\n    } else {\n      try {\n        await document.documentElement.requestFullscreen();\n        isFullScreen.set(true);\n      } catch(e) {\n        console.error(e);\n        setStatus('Error, could not fullscreen!');\n      } \n    }\n  };\n</script>\n\n<footer class=\"controls-bar\">\n  {#if displayStatus}\n    <div class=\"status\">{$status.message}</div>\n  {/if}\n\n  <ul class=\"controls-buttons\">\n    <li>\n      <button class=\"icon-button\" on:click={handlePlayPause}>\n        {#if $isPlaying}\n          <PauseIcon />\n        {:else}\n          <PlayIcon />\n        {/if}\n      </button>\n    </li>\n\n    <li>\n      <button class=\"icon-button\" on:click={handleSave}>\n        <SaveIcon />\n      </button>\n    </li>\n\n    <li>\n      <button class=\"icon-button\" on:click={handleLoad}>\n        <LoadIcon />\n      </button>\n    </li>\n\n    <li>\n      <button class=\"icon-button\" on:click={handleGamePad}>\n        {#if $isTouchPadVisible}\n          <HideGamePadIcon />\n        {:else}\n          <ShowGamePadIcon />\n        {/if}\n      </button>\n    </li>\n\n    <li>\n      <button class=\"icon-button\" on:click={handleAbout}>\n        <AboutIcon />\n      </button>\n    </li>\n\n    <li>\n      <button class=\"icon-button\" on:click={handleFullScreen}>\n        {#if $isFullScreen}\n          <FullScreenIcon />\n        {:else}\n          <ExitFullScreenIcon />\n        {/if}\n      </button>\n    </li>\n  </ul>\n</footer>\n\n<style>\n\n  .controls-bar {\n    position: fixed;\n    bottom: 0;\n    right: 0;\n    width: 100%;\n    height: 100%;\n\n    transform: translateY(0px);\n    transition: transform 0.5s;\n  }\n\n  :global(html):hover .controls-bar, \n  :global(body):hover .controls-bar, \n  :global(.touchpad-visible) .controls-bar {\n    transform: translateY(-50px);\n  }\n\n  .status, .controls-buttons {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    background-color: rgba(0,0,0,0.85);\n  }\n\n  .status {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    text-align: center;\n\n    padding: 20px;\n\n    color: #fff;\n\n    z-index: 1;\n  }\n\n  .controls-buttons {\n    display: flex;\n    justify-content: space-around;\n    align-items: center;\n\n    list-style-type: none;\n\n    transform: translateY(50px);\n    height: 50px;\n    width: 100%;\n    margin: 0px;\n    padding: 0px;\n  }\n</style>\n","<script>\n  export let content = '';\n</script>\n\n<svg viewBox=\"0 0 100 100\" xmlns=\"http://www.w3.org/2000/svg\">\n  <defs>\n  <radialGradient id=\"ButtonBackgroundFill\" cx=\"0.5\" cy=\"0.5\" r=\"0.75\" fx=\"0.5\" fy=\"0.95\">\n  <stop offset=\"0%\" stop-color=\"rgba(255, 255, 255, 0.5)\" stop-opacity=\"0.5\" />\n  <stop offset=\"100%\" stop-color=\"rgba(255, 255, 255, 0.5)\" stop-opacity=\"0.5\" />\n  </radialGradient>\n  <radialGradient id=\"ButtonLetterFill\" cx=\"0.5\" cy=\"0.5\" r=\"0.75\" fx=\"0.5\" fy=\"0.95\">\n  <stop offset=\"0%\" stop-color=\"rgba(150, 150, 150, 0.25)\" stop-opacity=\"0.25\" />\n  <stop offset=\"100%\" stop-color=\"rgba(150, 150, 150, 0.25)\" stop-opacity=\"0.25\" />\n  </radialGradient>\n  <radialGradient id=\"ButtonLetterStroke\" cx=\"0.5\" cy=\"0.5\" r=\"0.75\" fx=\"0.5\" fy=\"0.75\">\n  <stop offset=\"0%\" stop-color=\"rgba(200, 200, 200, 0.25)\" stop-opacity=\"0.25\" />\n  <stop offset=\"75%\" stop-color=\"rgba(200, 200, 200, 0.25)\" stop-opacity=\"0.25\" />\n  <stop offset=\"100%\" stop-color=\"rgba(200, 200, 200, 0.25)\" stop-opacity=\"0.25\" />\n  </radialGradient>\n  </defs>\n  <rect x=\"0\" y=\"0\" width=\"100\" height=\"100\" rx=\"50%\" ry=\"50%\" fill=\"url(#ButtonBackgroundFill)\" />\n  <text x=\"25\" y=\"80\" fill=\"url(#ButtonLetterFill)\" stroke=\"url(#ButtonLetterStroke)\">\n  {content}\n  </text>\n</svg>\n\n<style>\n  svg {\n    width: 100%;\n    height: 100%;\n  }\n</style>\n","<script>\n  export let content = '';\n</script>\n\n<svg viewBox=\"0 0 100 100\" xmlns=\"http://www.w3.org/2000/svg\">\n  <defs>\n  <radialGradient id=\"ButtonBackgroundFill\" cx=\"0.5\" cy=\"0.5\" r=\"0.75\" fx=\"0.5\" fy=\"0.95\">\n  <stop offset=\"0%\" stop-color=\"rgba(255, 255, 255, 0.5)\" stop-opacity=\"0.5\" />\n  <stop offset=\"100%\" stop-color=\"rgba(255, 255, 255, 0.5)\" stop-opacity=\"0.5\" />\n  </radialGradient>\n  <radialGradient id=\"ButtonLetterFill\" cx=\"0.5\" cy=\"0.5\" r=\"0.75\" fx=\"0.5\" fy=\"0.95\">\n  <stop offset=\"0%\" stop-color=\"rgba(150, 150, 150, 0.25)\" stop-opacity=\"0.25\" />\n  <stop offset=\"100%\" stop-color=\"rgba(150, 150, 150, 0.25)\" stop-opacity=\"0.25\" />\n  </radialGradient>\n  <radialGradient id=\"ButtonLetterStroke\" cx=\"0.5\" cy=\"0.5\" r=\"0.75\" fx=\"0.5\" fy=\"0.75\">\n  <stop offset=\"0%\" stop-color=\"rgba(200, 200, 200, 0.25)\" stop-opacity=\"0.25\" />\n  <stop offset=\"75%\" stop-color=\"rgba(200, 200, 200, 0.25)\" stop-opacity=\"0.25\" />\n  <stop offset=\"100%\" stop-color=\"rgba(200, 200, 200, 0.25)\" stop-opacity=\"0.25\" />\n  </radialGradient>\n  </defs>\n  <rect x=\"0\" y=\"50\" width=\"100\" height=\"50\" rx=\"50%\" ry=\"50%\" fill=\"url(#ButtonBackgroundFill)\" />\n  <text x=\"20\" y=\"85\" fill=\"url(#ButtonLetterFill)\" stroke=\"url(#ButtonLetterStroke)\">\n  {content}\n  </text>\n</svg>\n\n\n<style>\n  svg {\n    width: 100%;\n    height: 100%;\n  }\n</style>\n","<script>\n  import { onMount, onDestroy } from 'svelte';\n  import {modalStore, isTouchPadVisible} from '../../stores.js';\n\n  import GameBoyDpad from './GameBoyDpad.svelte'; \n  import GameBoyLetterButton from './GameBoyLetterButton.svelte';\n  import GameBoyWordButton from './GameBoyWordButton.svelte';\n\n  import {WasmBoy} from '../../../../dist/wasmboy.wasm.esm.js';\n\n  let mountResolve;\n  let mountPromise = new Promise(resolve => {\n    mountResolve = resolve;\n  });\n  onMount(mountResolve);\n\n  // Subscribe to whether or not the touchpad is shown\n  isTouchPadVisible.subscribe((value) => {\n    // Get our document class list\n    const documentClassList = document.documentElement.classList;\n    \n    if (value) {\n      documentClassList.add('touchpad-visible');\n    } else {\n      documentClassList.remove('touchpad-visible');\n    }\n  });\n\n\n  const removeInputCallbacks = [];\n  const addWasmBoyInputs = async () => {\n\n    // Wait to mount\n    await mountPromise;\n\n    // Get our touch input elements\n    const dpadElement = document.querySelector('#gameboy-dpad');\n    const startElement = document.querySelector('#gameboy-start');\n    const selectElement = document.querySelector('#gameboy-select');\n    const aElement = document.querySelector('#gameboy-a');\n    const bElement = document.querySelector('#gameboy-b');\n\n    // Add touch controls\n    removeInputCallbacks.push(\n      WasmBoy.ResponsiveGamepad.TouchInput.addDpadInput(dpadElement, {\n        allowMultipleDirections: false\n      })\n    );\n    removeInputCallbacks.push(\n      WasmBoy.ResponsiveGamepad.TouchInput.addButtonInput(aElement, WasmBoy.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.A)\n    );\n    removeInputCallbacks.push(\n      WasmBoy.ResponsiveGamepad.TouchInput.addButtonInput(bElement, WasmBoy.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.B)\n    );\n    removeInputCallbacks.push(\n      WasmBoy.ResponsiveGamepad.TouchInput.addButtonInput(startElement, WasmBoy.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.START)\n    );\n    removeInputCallbacks.push(\n      WasmBoy.ResponsiveGamepad.TouchInput.addButtonInput(selectElement, WasmBoy.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.SELECT)\n    );\n  };\n  addWasmBoyInputs();\n\n  onDestroy(() => {\n    removeInputCallbacks.forEach(callback => callback());\n  })\n</script>\n\n<div class=\"mobile-controls\" style={$modalStore === 0 && $isTouchPadVisible === true ? '': 'display: none'}>\n  <div class=\"gameboy-input\">\n    <div id=\"gameboy-dpad\"><GameBoyDpad /></div>\n    <div id=\"gameboy-a\"><GameBoyLetterButton content=\"A\" /></div>\n    <div id=\"gameboy-b\"><GameBoyLetterButton content=\"B\" /></div>\n    <div id=\"gameboy-start\"><GameBoyWordButton content=\"start\" /></div>\n    <div id=\"gameboy-select\"><GameBoyWordButton content=\"select\" /></div>\n  </div>\n</div>\n\n<style>\n  /*GENERAL*/\n  .mobile-controls {\n    position: fixed;\n    top: 0;\n    left: 0;\n\n    width: 100%;\n    /* - px to make room for controls bar*/\n    height: calc(100% - 50px);\n\n    z-index: 3;\n  }\n\n  .gameboy-input {\n    position: relative;\n    top: 0;\n    left: 0;\n\n    height: 100%;\n    width: 100%;\n  }\n\n  .gameboy-input :global(svg) {\n    width: 100%;\n    height: 100%;\n\n    padding: 3px;\n    overflow: visible;\n    cursor: pointer;\n  }\n\n  .gameboy-input :global(svg) :global(path),\n  .gameboy-input :global(svg) :global(rect) {\n    stroke: #000;\n    stroke-width: 2px;\n  }\n\n  .gameboy-input :global(svg) :global(text),\n  .gameboy-input :global(svg) :global(polygon) {\n    stroke: #000;\n    stroke-width: 1px;\n  }\n\n  .gameboy-input :global(svg) :global(text) {\n    font-size: 80px;\n    font-weight: 700;\n    text-transform: capitalize;\n  }\n\n  #gameboy-select :global(svg) :global(text),\n  #gameboy-start :global(svg) :global(text) {\n    font-size: 23px;\n  }\n\n  /*PORTRAIT*/\n  :global(html.portrait) #gameboy-dpad {\n    width: 37vw;\n    height: 37vw;\n    max-width: 170px;\n    max-height: 170px;\n\n    position: absolute;\n    z-index: 1;\n    bottom: 27.5%;\n    left: 5%;\n  }\n\n  :global(html.portrait) #gameboy-b {\n    width: 20vw;\n    height: 20vw;\n    max-width: 95px;\n    max-height: 95px;\n\n    position: absolute;\n    z-index: 1;\n    bottom: 27.5%;\n    right: 21%;\n  }\n\n  :global(html.portrait) #gameboy-a {\n    width: 20vw;\n    height: 20vw;\n    max-width: 95px;\n    max-height: 95px;\n\n    position: absolute;\n    z-index: 1;\n    bottom: 37.5%;\n    right: 3%;\n  }\n\n  :global(html.portrait) #gameboy-select {\n    width: 19.5vw;\n    height: 19.5vw;\n    max-width: 100px;\n    max-height: 100px;\n\n    position: absolute;\n    z-index: 1;\n    left: 25.5%;\n    bottom: 13%;\n  }\n\n  :global(html.portrait) #gameboy-start {\n    width: 19.5vw;\n    height: 19.5vw;\n    max-width: 100px;\n    max-height: 100px;\n\n    position: absolute;\n    z-index: 1;\n    left: 51.5%;\n    bottom: 13%;\n  }\n\n  /*LANDSCAPE*/\n  :global(html.landscape) #gameboy-dpad {\n    width: 20vw;\n    height: 20vw;\n    position: absolute;\n    z-index: 1;\n    top: calc(50% - 13vw);\n    left: 3%;\n  }\n\n  :global(html.landscape) #gameboy-b {\n    width: 12vw;\n    height: 12vw;\n    position: absolute;\n    z-index: 1;\n    top: calc(50% - 5vw);\n    right: 18%;\n  }\n\n  :global(html.landscape) #gameboy-a {\n    width: 12vw;\n    height: 12vw;\n    position: absolute;\n    z-index: 1;\n    top: calc(50% - 13vw);\n    right: 3%;\n  }\n\n  :global(html.landscape) #gameboy-select {\n    width: 22.5vh;\n    height: 22.5vh;\n    position: absolute;\n    z-index: 1;\n    left: 30.5%;\n    bottom: 7%;\n  }\n\n  :global(html.landscape) #gameboy-start {\n    width: 22.5vh;\n    height: 22.5vh;\n    position: absolute;\n    z-index: 1;\n    left: 54.5%;\n    bottom: 7%;\n  }\n</style>\n","/* eslint-disable spaced-comment */\n/*!\n\tdevtools-detect\n\tDetect if DevTools is open\n\thttps://github.com/sindresorhus/devtools-detect\n\tby Sindre Sorhus\n\tMIT License\n*/\n(function () {\n\t'use strict';\n\tvar devtools = {\n\t\topen: false,\n\t\torientation: null\n\t};\n\tvar threshold = 160;\n\tvar emitEvent = function (state, orientation) {\n\t\twindow.dispatchEvent(new CustomEvent('devtoolschange', {\n\t\t\tdetail: {\n\t\t\t\topen: state,\n\t\t\t\torientation: orientation\n\t\t\t}\n\t\t}));\n\t};\n\n\tsetInterval(function () {\n\t\tvar widthThreshold = window.outerWidth - window.innerWidth > threshold;\n\t\tvar heightThreshold = window.outerHeight - window.innerHeight > threshold;\n\t\tvar orientation = widthThreshold ? 'vertical' : 'horizontal';\n\n\t\tif (!(heightThreshold && widthThreshold) &&\n      ((window.Firebug && window.Firebug.chrome && window.Firebug.chrome.isInitialized) || widthThreshold || heightThreshold)) {\n\t\t\tif (!devtools.open || devtools.orientation !== orientation) {\n\t\t\t\temitEvent(true, orientation);\n\t\t\t}\n\n\t\t\tdevtools.open = true;\n\t\t\tdevtools.orientation = orientation;\n\t\t} else {\n\t\t\tif (devtools.open) {\n\t\t\t\temitEvent(false, null);\n\t\t\t}\n\n\t\t\tdevtools.open = false;\n\t\t\tdevtools.orientation = null;\n\t\t}\n\t}, 500);\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tmodule.exports = devtools;\n\t} else {\n\t\twindow.devtools = devtools;\n\t}\n})();\n","import devtoolsDetect from 'devtools-detect';\n\n// Add all of our layout events\nlet layoutChangeThrottle = undefined;\n\nexport const setupLayoutChange = () => {\n  // devtools change for mobile\n  // uses devtools-detect\n  window.addEventListener('devtoolschange', e => {\n    handleLayoutChange();\n  });\n\n  window.addEventListener('resize', () => {\n    if (layoutChangeThrottle) {\n      return;\n    }\n\n    layoutChangeThrottle = setTimeout(() => {\n      handleLayoutChange();\n      layoutChangeThrottle = undefined;\n    }, 500);\n  });\n\n  window.addEventListener('orientationchange', () => {\n    if (layoutChangeThrottle) {\n      return;\n    }\n\n    layoutChangeThrottle = setTimeout(() => {\n      handleLayoutChange();\n      layoutChangeThrottle = undefined;\n    }, 500);\n  });\n};\n\nconst handleLayoutChange = () => {\n  const isDevtoolsOpen = devtoolsDetect.open;\n\n  let isWide = window.matchMedia('(max-width: 500px)').matches;\n\n  if (!isDevtoolsOpen) {\n    isWide = window.matchMedia('(max-width: 1024px)').matches;\n  }\n\n  let landscape = window.matchMedia('screen and (orientation: landscape)').matches;\n  let portrait = window.matchMedia('screen and (orientation: portrait)').matches;\n\n  // Get our document class list\n  const documentClassList = document.documentElement.classList;\n\n  // Add all Media query based on mobile vs desktop\n  documentClassList.add('mobile');\n\n  if (landscape) {\n    documentClassList.add('landscape');\n    documentClassList.remove('portrait');\n  } else if (portrait) {\n    documentClassList.add('portrait');\n    documentClassList.remove('landscape');\n  }\n\n  if (!landscape && !portrait && isWide) {\n    documentClassList.add('landscape');\n    documentClassList.remove('portrait');\n  }\n};\n// Handle the layoutchange onn load\nhandleLayoutChange();\n","import { WasmBoy } from '../../../dist/wasmboy.wasm.esm.js';\nimport { setStatus } from '../stores.js';\n\nlet quickSpeed = false;\nexport const setupHotkeys = () => {\n  WasmBoy.ResponsiveGamepad.onInputsChange(\n    [\n      WasmBoy.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.LEFT_TRIGGER,\n      WasmBoy.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.RIGHT_TRIGGER,\n      WasmBoy.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.SPECIAL\n    ],\n    state => {\n      // Quick Speed\n      if (!quickSpeed && state.LEFT_TRIGGER) {\n        WasmBoy.setSpeed(3.0);\n        quickSpeed = true;\n        setStatus('Quick Speed Hotkey!');\n      } else if (quickSpeed && !state.LEFT_TRIGGER) {\n        WasmBoy.setSpeed(1.0);\n        quickSpeed = false;\n      }\n\n      // Play / Pause\n      if (WasmBoy.isPlaying() && state.SPECIAL) {\n        WasmBoy.pause();\n      } else if (!WasmBoy.isPlaying() && state.SPECIAL) {\n        WasmBoy.play();\n      }\n    }\n  );\n};\n","\nmodule.exports = function load (src, opts, cb) {\n  var head = document.head || document.getElementsByTagName('head')[0]\n  var script = document.createElement('script')\n\n  if (typeof opts === 'function') {\n    cb = opts\n    opts = {}\n  }\n\n  opts = opts || {}\n  cb = cb || function() {}\n\n  script.type = opts.type || 'text/javascript'\n  script.charset = opts.charset || 'utf8';\n  script.async = 'async' in opts ? !!opts.async : true\n  script.src = src\n\n  if (opts.attrs) {\n    setAttributes(script, opts.attrs)\n  }\n\n  if (opts.text) {\n    script.text = '' + opts.text\n  }\n\n  var onend = 'onload' in script ? stdOnEnd : ieOnEnd\n  onend(script, cb)\n\n  // some good legacy browsers (firefox) fail the 'in' detection above\n  // so as a fallback we always set onload\n  // old IE will ignore this and new IE will set onload\n  if (!script.onload) {\n    stdOnEnd(script, cb);\n  }\n\n  head.appendChild(script)\n}\n\nfunction setAttributes(script, attrs) {\n  for (var attr in attrs) {\n    script.setAttribute(attr, attrs[attr]);\n  }\n}\n\nfunction stdOnEnd (script, cb) {\n  script.onload = function () {\n    this.onerror = this.onload = null\n    cb(null, script)\n  }\n  script.onerror = function () {\n    // this.onload = null here is necessary\n    // because even IE9 works not like others\n    this.onerror = this.onload = null\n    cb(new Error('Failed to load ' + this.src), script)\n  }\n}\n\nfunction ieOnEnd (script, cb) {\n  script.onreadystatechange = function () {\n    if (this.readyState != 'complete' && this.readyState != 'loaded') return\n    this.onreadystatechange = null\n    cb(null, script) // there is no way to catch loading errors in IE8\n  }\n}\n","import loadScript from 'load-script';\n\n// Load our analytics\nexport const loadAnalytics = () => {\n  if (typeof window !== 'undefined') {\n    loadScript('https://www.googletagmanager.com/gtag/js?id=UA-125276735-3', (err, script) => {\n      if (err) {\n        console.error(err);\n        return;\n      }\n\n      window.dataLayer = window.dataLayer || [];\n      function gtag() {\n        window.dataLayer.push(arguments);\n      }\n      gtag('js', new Date());\n      gtag('config', 'UA-125276735-3');\n    });\n  }\n};\n","<script>\n  import PlayPoster from './components/PlayPoster.svelte'; \n  import WasmBoy from './components/WasmBoy.svelte'; \n  import Modal from './components/Modal.svelte';\n  import ControlsBar from './components/ControlsBar.svelte';\n  import GameBoyTouchPad from './components/touchpad/GameBoyTouchPad.svelte';\n  import {isStarted, isLoaded} from './stores.js';\n\n  import {setupLayoutChange} from './scripts/layout-change.js';\n  import {setupHotkeys} from './scripts/hotkeys.js';\n  import {loadAnalytics} from './scripts/load-analytics.js';\n\n  setupLayoutChange();\n  setupHotkeys();\n  loadAnalytics();\n</script>\n\n<main class=\"app\">\n  {#if $isStarted === false}\n    <PlayPoster />\n  {:else}\n    <WasmBoy />\n    {#if $isLoaded}\n      <Modal />\n      <ControlsBar />\n      <GameBoyTouchPad />\n    {/if}\n  {/if}\n</main>\n\n<style>\n  .app {\n    width: 100%;\n    height: 100%;\n  }\n\n  :global(.icon-button) {\n    width: 50px;\n    height: 50px;\n    background-color: transparent;\n    border: none;\n    cursor: pointer;\n  }\n\n  /* https://www.30secondsofcode.org/css/s/donut-spinner/ */\n  @keyframes donut-spin {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n\n  :global(.donut) {\n    display: inline-block;\n    border: 4px solid rgba(0, 0, 0, 0.1);\n    border-left-color: #654ff0;\n    border-radius: 50%;\n    width: 50px;\n    height: 50px;\n    animation: donut-spin 1.2s linear infinite;\n  }\n\n  :global(.error) {\n    color: red;\n  }\n</style>\n","import App from './App.svelte';\n\nconst app = new App({\n  target: document.body\n});\n\nexport default app;\n"],"names":["noop","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","component_subscribe","component","store","callback","$$","on_destroy","push","callbacks","unsub","subscribe","unsubscribe","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","element","name","document","createElement","svg_element","createElementNS","text","data","createTextNode","space","empty","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","value","removeAttribute","getAttribute","setAttribute","set_data","wholeText","current_component","set_current_component","get_current_component","Error","onMount","on_mount","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","flushing","seen_callbacks","Set","flush","i","length","update","pop","has","add","clear","fragment","before_update","dirty","p","ctx","after_update","outroing","outros","group_outros","r","c","check_outros","transition_in","block","local","delete","transition_out","o","d","handle_promise","promise","info","token","type","index","key","resolved","child_ctx","undefined","slice","current","needs_flush","blocks","m","mount","then","error","catch","hasCatch","pending","create_component","mount_component","new_on_destroy","map","filter","destroy_component","detaching","make_dirty","fill","init","instance","create_fragment","not_equal","props","parent_component","prop_values","bound","context","Map","skip_bound","ready","ret","rest","hydrate","nodes","Array","from","childNodes","children","l","intro","SvelteComponent","[object Object]","this","$destroy","indexOf","splice","$$props","obj","$$set","keys","subscriber_queue","writable","start","stop","subscribers","set","new_value","run_queue","s","invalidate","subscriber","isStarted","isLoaded","isPlaying","modalStore","hideModal","saveState","statusReadableSet","status","message","statusMessage","timeout","statusTimeout","setStatus","params","URLSearchParams","location","search","substring","playPoster","get","romUrl","romName","isTouchPadVisible","test","navigator","userAgent","isFullScreen","WASMBOY_PLUGIN","graphics","rgbaArray","audio","audioContext","headAudioNode","channelId","saveStateObject","canvas","canvasElement","canvasContext","canvasImageData","breakpoint","play","pause","loadedAndStarted","WasmBoyPlugins","plugins","pluginIdCounter","pluginObject","id","removePlugin","hookConfig","pluginKey","plugin","hookResponse","apply","e","console","WORKER_MESSAGE_TYPE","WORKER_ID","MEMORY_TYPE","getEventData","WasmBoyGraphics","worker","updateGraphicsCallback","frameQueue","frameQueueRenderPromise","imageDataArray","imageDataArrayChanged","async","getContext","width","height","createImageData","style","clearRect","runHook","response","postMessage","initializeTask","addMessageListener","eventData","Uint8ClampedArray","imageDataArrayBuffer","putImageData","buffer","opt","numChannels","numberOfChannels","sampleRate","format","float32","bitDepth","samples","bytesPerSample","blockAlign","ArrayBuffer","view","DataView","writeString","setUint32","setUint16","output","offset","input","Math","max","min","setInt16","floatTo16BitPCM","setFloat32","writeFloat32","encodeWAV","inputL","inputR","result","Float32Array","inputIndex","interleave","getChannelData","string","setUint8","charCodeAt","GbChannelWebAudio","audioBuffer","audioPlaytime","audioSources","gainNode","muted","libMuted","recording","recordingLeftBuffers","recordingRightBuffers","recordingAudioBuffer","recordingAnchor","window","AudioContext","webkitAudioContext","createGain","createAudioContextIfNone","currentTime","state","resume","numberOfSamples","leftChannelBuffer","rightChannelBuffer","playbackRate","updateAudioCallback","leftChannelBufferAsFloat","rightChannelBufferAsFloat","createBuffer","_setSamplesToAudioBuffer","source","createBufferSource","setValueAtTime","finalNode","responseNode","connect","destination","audioContextCurrentTime","audioContextCurrentTimeWithLatency","DEFAULT_AUDIO_LATENCY_IN_MILLI","cancelAllAudio","sourcePlaybackLength","playtime","playTime","timeUntilSourceEnds","setTimeout","shift","stopCurrentAudio","_setGain","createBufferFromBuffers","buffers","totalLength","totalBuffer","currentLength","totalLeftBuffer","totalRightBuffer","recordingLeftBuffer","recordingRightBuffer","filename","body","wav","blob","Blob","url","URL","createObjectURL","downloadName","href","Date","toLocaleDateString","month","day","year","hour","minute","second","download","click","revokeObjectURL","_arrayBufferToBase64","gain","leftChannelSamples","rightChannelSamples","copyToChannel","binary","bytes","Uint8Array","len","byteLength","String","fromCharCode","btoa","WasmBoyAudio","gbChannels","master","channel1","channel2","channel3","channel4","_createAudioContextIfNone","_libMute","averageTimeStretchFps","speed","WASMBOY_SOUND_OUTPUT_LOCATION","WASMBOY_CHANNEL_1_OUTPUT_LOCATION","WASMBOY_CHANNEL_2_OUTPUT_LOCATION","WASMBOY_CHANNEL_3_OUTPUT_LOCATION","WASMBOY_CHANNEL_4_OUTPUT_LOCATION","playAudio","latency","getCurrentTime","getPlayTime","postMessageIgnoreResponse","resetTimeStretch","audioMessage","currentFps","fps","allowFastSpeedStretching","fpsDifference","abs","floor","SLOW_TIME_STRETCH_MIN_FPS","reduce","accumulator","currentValue","left","right","channelNumber","playingAllChannels","unmute","mute","_libUnmute","_applyOnAllChannels","functionKey","argsArray","gbChannelKey","_defineProperty","defineProperty","enumerable","configurable","ownKeys","object","enumerableOnly","getOwnPropertySymbols","symbols","sym","getOwnPropertyDescriptor","_objectSpread2","arguments","getOwnPropertyDescriptors","defineProperties","commonjsGlobal","globalThis","global","self","createCommonjsModule","module","exports","idb","toArray","arr","prototype","call","promisifyRequest","request","reject","onsuccess","onerror","promisifyRequestCall","method","args","promisifyCursorRequestCall","Cursor","proxyProperties","ProxyClass","targetProp","properties","prop","val","proxyRequestMethods","Constructor","proxyMethods","proxyCursorRequestMethods","Index","_index","cursor","_cursor","_request","ObjectStore","_store","Transaction","idbTransaction","_tx","complete","oncomplete","onabort","UpgradeDB","db","oldVersion","transaction","_db","DB","IDBIndex","IDBCursor","methodName","createIndex","IDBObjectStore","objectStore","IDBTransaction","createObjectStore","IDBDatabase","funcName","replace","nativeObject","getAll","query","count","items","iterateCursor","continue","exp","open","version","upgradeCallback","indexedDB","onupgradeneeded","default","keyval","dbPromise","upgradeDB","tx","put","iterateKeyCursor","idbKeyval","UZIP","uzip","buf","rUs","bin","readUshort","rUi","readUint","out","eocd","cnu","coffs","csize","usize","nl","el","cl","roff","_readLocal","cmpr","nlen","elen","readUTF8","file","inflateRaw","F","inflate","byteOffset","deflate","opts","level","off","deflateRaw","crc","adler","encode","tot","wUi","writeUint","wUs","writeUshort","zpd","cpr","_noNeed","sizeUTF8","fof","_writeHeader","ioff","ext","split","toLowerCase","t","writeUTF8","table","tab","Uint32Array","n","k","end","eend","buff","readASCII","writeASCII","pad","ns","toString","decodeURIComponent","str","strl","ci","code","opos","lvl","U","goodIndex","_goodIndex","putsE","_hash","_putsE","pos","cvrd","dlen","_copyExact","lits","strt","prev","li","lc","bs","ebits","nc","ii","_writeBlock","mch","_bestMatch","dst","lgi","of0","lhst","dgi","df0","dhst","exb","dxb","nice","chain","pi","dif","tl","td","dlim","_howLong","maxd","j","ei","curd","oi","saved","BFINAL","o0","l0","T","ML","MD","MH","numl","numd","numh","lset","dset","putsF","_putsF","getTrees","cstSize","fxdSize","contSize","fltree","fdtree","dynSize","ltree","dtree","itree","ihst","BTYPE","makeCodes","revCodes","ordr","_codeTiny","si","qb","_writeLit","qc","p8","_hufTree","_lenCodes","getSecond","nonZero","tree","hst","rst","rsl","nxt","nnxt","prv","lz","zc","MAXL","list","hl","lit","f","l2","sort","i0","i1","i2","maxl","setDepth","restrictDepth","dps","bCost","dbt","od","log","v","ch","bitsF","_bitsF","bitsE","_bitsE","decodeTiny","_decodeTiny","codes2map","get17","_get17","noBuf","lmap","dmap","HLIT","HDIST","HCLEN","_check","flmap","fdmap","imap","ml","md","ebs","ldef","dcode","dlit","dbs","ddef","bl","nbuf","LL","mx","ll","ni","MAX_BITS","bits","max_code","bl_count","next_code","r15","rev15","imb","dt","_get25","Uint16Array","x","fetchROMAsByteArray","ROM","loadOptions","isView","constructor","size","byteArray","getROMFromFileReaderAsByteArray","endsWith","parseByteArrayAsZip","fetchHeaders","headers","fetch","ok","arrayBuffer","fileName","fetchROMAsByteArrayTask","fileReader","FileReader","onload","readAsArrayBuffer","unzipObject","parse","foundROM","some","lowercaseKey","includes","WASMBOY_SAVE_STATE_SCHEMA","wasmboyMemory","wasmBoyInternalState","wasmBoyPaletteMemory","gameBoyMemory","cartridgeRam","date","isAuto","getSaveState","assign","internalState","paletteMemory","gameboyMemory","now","saveStateCallback","_prepareAndStoreAutoSave","bind","saveStateMemoryKeys","localStorage","setItem","WASMBOY_UNLOAD_STORAGE","JSON","stringify","header","cartridgeHeader","_findAndCommitAutoSave","unloadStorage","getItem","unloadStorageObject","removeItem","saveCartridgeRam","findAndCommitAutoSaveTask","initializeAutoSave","visibilityState","WasmBoyMemory","maxNumberOfAutoSaveStates","loadedCartridgeMemoryState","RAM","BOOT","bootRom","cartridgeRom","cartridgeRomFileName","WASMBOY_GAME_BYTES_LOCATION","WASMBOY_GAME_RAM_BANKS_LOCATION","WASMBOY_INTERNAL_STATE_SIZE","WASMBOY_INTERNAL_STATE_LOCATION","WASMBOY_INTERNAL_MEMORY_SIZE","WASMBOY_INTERNAL_MEMORY_LOCATION","WASMBOY_PALETTE_MEMORY_SIZE","WASMBOY_PALETTE_MEMORY_LOCATION","SUPPORTED_BOOT_ROM_TYPES","GB","GBC","headless","_initializeConstants","memoryTypes","memory","cartridgeObject","getSavedMemoryTask","bootROMTypeKey","additionalInfo","toUpperCase","isValidBootROMType","fetchROMObject","bootROMObject","bootROMs","bootROMType","workerMemoryObject","loadTask","cartridgeInfo","getCartridgeInfo","saveLoadedCartridgeRomTask","cartridge","deleteLoadedCartridgeTask","passedHeader","passedCartridgeRam","saveCartridgeRamTask","loadCartridgeRamTask","passedSaveState","saveStates","autoSaveStates","savedState","autoSaveState","saveStateIndex","_indexOfSaveStateIndexInSaveStates","saveStateTask","saverState","loadStateTask","deleteStateTask","nintendoLogo","title","titleAsString","manufacturerCode","CGBFlag","newLicenseeCode","SGBFlag","cartridgeType","ROMSize","RAMSize","destinationCode","oldLicenseeCode","maskROMVersionNumber","headerChecksum","globalChecksum","getCartridgeInfoTask","keysCheck","dateCheck","autoCheck","concat","g","DPAD_UP","DPAD_RIGHT","DPAD_DOWN","DPAD_LEFT","LEFT_ANALOG_HORIZONTAL_AXIS","LEFT_ANALOG_VERTICAL_AXIS","LEFT_ANALOG_UP","LEFT_ANALOG_RIGHT","LEFT_ANALOG_DOWN","LEFT_ANALOG_LEFT","RIGHT_ANALOG_HORIZONTAL_AXIS","RIGHT_ANALOG_VERTICAL_AXIS","RIGHT_ANALOG_UP","RIGHT_ANALOG_RIGHT","RIGHT_ANALOG_DOWN","RIGHT_ANALOG_LEFT","A","B","X","Y","LEFT_TRIGGER","LEFT_BUMPER","RIGHT_TRIGGER","RIGHT_BUMPER","SELECT","START","SPECIAL","h","super","keymap","enableIgnoreWhenInputElementFocused","enableIgnoreWhenModifierState","_boundUpdateKeymapValues","_updateKeymapValues","ignoreWhenInputElementFocused","ignoreOnModifierState","activeElement","tagName","getModifierState","_isFocusedOnInputElement","_isInModifierState","preventDefault","gamepadAnalogStickDeadZone","_getGamepads","buttons","_isButtonPressed","axis","_getAnalogStickAxis","axes","pressed","getGamepads","q","listeners","_addTouchStyles","boundingClientRect","_updateElementBoundingClientRect","active","boundUpdateElementRect","boundTouchEvent","_touchEvent","_removeTouchStyles","stopListening","touches","_updateActiveStatus","_updateTouchStyles","onTouchEvent","getBoundingClientRect","userSelect","classList","remove","rectCenterX","rectCenterY","bottom","top","touchX","clientX","touchY","clientY","u","config","allowMultipleDirections","_resetState","setHorizontalState","setVerticalState","HORIZONTAL_AXIS","VERTICAL_AXIS","UP","RIGHT","DOWN","LEFT","transform","deadzone","w","y","enabled","dpads","leftAnalogs","rightAnalogs","addAnalogInput","ResponsiveGamepad","RESPONSIVE_GAMEPAD_INPUTS","_enabled","_multipleDirectionInput","Keyboard","Gamepad","TouchInput","setKeysToResponsiveGamepadInput","setGamepadButtonsToResponsiveGamepadInput","setGamepadAxisToResponsiveGamepadInput","inputChangeMap","inputChangeOldState","cancelInputChangeListener","enable","_startInputChangeInterval","disable","onAddPlugin","onRemovePlugin","getState","onGetState","codes","setInterval","_inputChangeIntervalHandler","clearInterval","WasmBoyController","isEnabled","addPlugin","gamepadA","gamepadB","enableDefaultJoypad","controllerState","setJoypadState","setJoypadStateParamsAsArray","idCounter","generateId","randomId","random","substr","getSmartWorkerMessage","messageId","workerId","SmartWorker","workerUrl","messageListeners","Worker","onmessage","_onMessageHandler","transfer","messageObject","messageIdListener","messageDroppedTimeout","warn","removeMessageListener","responseMessage","messageListener","clearTimeout","messageListenerIndex","initialize","initialized","_instantiateWorkers","coreType","clearMemory","loadROMToWasmBoy","loadROMAndConfigTask","getLoadedCartridgeMemoryState","loadCartridgeRom","enableBootROMIfAvailable","loadBootROMIfAvailable","loadedROM","isGbcEnabled","audioBatchProcessing","graphicsBatchProcessing","timersBatchProcessing","graphicsDisableScanlineRendering","audioAccumulateSamples","tileRendering","tileCaching","enableAudioDebugging","gameboyFrameRate","isAudioEnabled","isGbcColorizationEnabled","gbcColorizationPalette","frameSkip","onReady","all","loadCartridgeRam","loadROMTask","performanceNow","getNanoSeconds","hrtime","loadTime","moduleLoadTime","nodeLoadTime","upTime","performance","process","hr","uptime","getTime","root","vendors","suffix","raf","caf","last","id$1","queue","_now","next","cp","cancelled","round","handle","raf_1","render","paused","shouldSkipRenderingFrame","frameSkipCounter","renderFrame","updateController","renderId","cancel","polyfill","requestAnimationFrame","cancelAnimationFrame","BigInteger","bigInt","BASE","MAX_INT","MAX_INT_ARR","smallToArray","supportsNativeBigInt","BigInt","Integer","radix","alphabet","caseSensitive","parseBase","parseValue","sign","isSmall","SmallInteger","NativeBigInt","isPrecise","arrayToSmall","trim","compareAbs","createArray","truncate","ceil","sum","l_a","l_b","carry","base","addAny","addSmall","subtract","difference","a_l","b_l","borrow","subtractSmall","multiplyLong","product","a_i","multiplySmall","shiftLeft","multiplySmallAndArray","square","divModSmall","lambda","remainder","divisor","quotient","divModAny","negate","comparison","quotientDigit","divisorMostSignificantDigit","divMod1","guess","xlen","highx","highy","check","part","unshift","reverse","divMod2","qSign","mod","mSign","isBasicPrime","isUnit","equals","isEven","isDivisibleBy","lesser","millerRabinTest","nPrev","divide","modPow","plus","subtractAny","minus","small","multiply","l1","multiplyKaratsuba","ac","bd","abcd","times","_multiplyBySmall","divmod","over","pow","_0","_1","_2","isNegative","isZero","modInv","isPositive","isOdd","compare","Infinity","compareTo","eq","notEquals","neq","greater","gt","lt","greaterOrEquals","geq","lesserOrEquals","leq","isPrime","strict","bitLength","logN","toJSNumber","isProbablePrime","iterations","rng","randBetween","lastT","lastR","zero","newT","one","newR","powersOfTwo","powers2Length","highestPower2","shift_isSmall","bitwise","xSign","ySign","xRem","not","yRem","xDigit","yDigit","xDivMod","yDivMod","shiftRight","remQuo","and","or","xor","roughLOB","gcd","integerLogarithm","tmp","absBase","alphabetValues","digits","parseBaseFromArray","toBase","valueOf","neg","Number","digit","toBaseString","join","parseStringValue","decimalPlace","parseNumberValue","toJSON","parseInt","minusOne","lcm","isInstance","usedRNG","low","range","restricted","fromArray","hasOwnProperty","currentRaf","forceOutputFrame","WasmBoyLib","runWasmExport","exportKey","parameters","export","getWasmMemorySection","getWasmConstant","constant","constantKey","messageRequests","libWorkerOnMessage","breakpointCallback","breakpointTask","programCounter","gameboyMemoryConstant","opcode","crashedTask","isWindowUnloading","_resetConfig","disablePauseOnHidden","wasmBoyOptions","setCanvas","gameboySpeed","configTask","setCanvasTask","addBootROM","getBootROMs","boundLoadROM","onLoadedAndStarted","onPlay","resumeAudioContext","updateId","playTask","onPause","pauseTask","loadROM","resetTask","getSavedMemory","saveLoadedCartridge","deleteSavedCartridge","getCartridgeObject","getSaveStatesTask","loadState","deleteState","setSpeed","setSpeedTask","isGBCTask","fpsTimeStamps","libWorkerUrl","libWorker","graphicsWorker","audioWorker","controllerWorker","memoryWorker","workerReadyPromises","childWorker","messageChannel","MessageChannel","workerReadyPromise","messagesReceived","tryResolveWorkerReady","ports","port1","port2","setWorker","instantiateWorkers","instantiateWorkersTask","packageJson","WasmBoy","getCoreType","getConfig","getCanvas","reset","isPaused","isReady","isLoadedAndStarted","getVersion","getSaveStates","getFPS","isGBC","disableDefaultJoypad","_getAudioChannels","getAudioChannels","_getCartridgeInfo","_runNumberOfFrames","rafUpdateCanvas","frames","_runWasmExport","_getWasmMemorySection","_getWasmConstant","_getStepsAsString","stepsPerStepSet","stepSets","steps","bigSteps","_getCyclesAsString","cyclesPerCycleSet","cycleSets","cycles","bigCycles","mountResolve","mountPromise","canvasStyle","wasmBoyPromise","wasmBoyCanvas","querySelector","EmbedPlugin","screenshotCanvasDataURL","toDataURL","$romUrl","loadWasmBoy","$isStarted","$isLoaded","important","setProperty","toLocaleString","wasmBoySaveStates","handleLoadState","displayStatus","$isPlaying","$isTouchPadVisible","$isFullScreen","exitFullscreen","documentElement","requestFullscreen","content","documentClassList","removeInputCallbacks","dpadElement","startElement","selectElement","aElement","bElement","addDpadInput","addButtonInput","addWasmBoyInputs","devtools","emitEvent","orientation","dispatchEvent","CustomEvent","detail","widthThreshold","outerWidth","innerWidth","heightThreshold","outerHeight","innerHeight","Firebug","chrome","isInitialized","layoutChangeThrottle","handleLayoutChange","isDevtoolsOpen","devtoolsDetect","isWide","matchMedia","matches","landscape","portrait","quickSpeed","stdOnEnd","script","cb","src","ieOnEnd","onreadystatechange","readyState","loadAnalytics","head","err","gtag","dataLayer","getElementsByTagName","charset","attrs","setAttributes","onInputsChange"],"mappings":"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"}