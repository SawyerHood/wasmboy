var WasmBoyIframe=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function s(t,n,r){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function a(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function u(e){e.parentNode.removeChild(e)}function c(e){return document.createElement(e)}function d(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function h(e){return document.createTextNode(e)}function p(){return h(" ")}function f(){return h("")}function g(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function m(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function y(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}let v;function b(e){v=e}function w(){if(!v)throw new Error("Function called outside component initialization");return v}function A(e){w().$$.on_mount.push(e)}const _=[],S=[],T=[],E=[],O=Promise.resolve();let R=!1;function I(e){T.push(e)}let C=!1;const L=new Set;function M(){if(!C){C=!0;do{for(let e=0;e<_.length;e+=1){const t=_[e];b(t),k(t.$$)}for(b(null),_.length=0;S.length;)S.pop()();for(let e=0;e<T.length;e+=1){const t=T[e];L.has(t)||(L.add(t),t())}T.length=0}while(_.length);for(;E.length;)E.pop()();R=!1,C=!1,L.clear()}}function k(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(I)}}const G=new Set;let x;function N(){x={r:0,c:[],p:x}}function B(){x.r||r(x.c),x=x.p}function P(e,t){e&&e.i&&(G.delete(e),e.i(t))}function F(e,t,n,r){if(e&&e.o){if(G.has(e))return;G.add(e),x.c.push(()=>{G.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}function D(e,t){const n=t.token={};function r(e,r,o,i){if(t.token!==n)return;t.resolved=i;let s=t.ctx;void 0!==o&&(s=s.slice(),s[o]=i);const a=e&&(t.current=e)(s);let l=!1;t.block&&(t.blocks?t.blocks.forEach((e,n)=>{n!==r&&e&&(N(),F(e,1,1,()=>{t.blocks[n]=null}),B())}):t.block.d(1),a.c(),P(a,1),a.m(t.mount(),t.anchor),l=!0),t.block=a,t.blocks&&(t.blocks[r]=a),l&&M()}if((o=e)&&"object"==typeof o&&"function"==typeof o.then){const n=w();if(e.then(e=>{b(n),r(t.then,1,t.value,e),b(null)},e=>{if(b(n),r(t.catch,2,t.error,e),b(null),!t.hasCatch)throw e}),t.current!==t.pending)return r(t.pending,0),!0}else{if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}var o}function U(e){e&&e.c()}function $(e,n,i){const{fragment:s,on_mount:a,on_destroy:l,after_update:u}=e.$$;s&&s.m(n,i),I(()=>{const n=a.map(t).filter(o);l?l.push(...n):r(n),e.$$.on_mount=[]}),u.forEach(I)}function H(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function z(e,t){-1===e.$$.dirty[0]&&(_.push(e),R||(R=!0,O.then(M)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function j(t,o,i,s,a,l,c=[-1]){const d=v;b(t);const h=o.props||{},p=t.$$={fragment:null,ctx:null,props:l,update:e,not_equal:a,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(d?d.$$.context:[]),callbacks:n(),dirty:c,skip_bound:!1};let f=!1;if(p.ctx=i?i(t,h,(e,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&a(p.ctx[e],p.ctx[e]=o)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](o),f&&z(t,e)),n}):[],p.update(),f=!0,r(p.before_update),p.fragment=!!s&&s(p.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);p.fragment&&p.fragment.l(e),e.forEach(u)}else p.fragment&&p.fragment.c();o.intro&&P(t.$$.fragment),$(t,o.target,o.anchor),M()}b(d)}class W{$destroy(){H(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const K=[];function q(t,n=e){let r;const o=[];function s(e){if(i(t,e)&&(t=e,r)){const e=!K.length;for(let e=0;e<o.length;e+=1){const n=o[e];n[1](),K.push(n,t)}if(e){for(let e=0;e<K.length;e+=2)K[e][0](K[e+1]);K.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(i,a=e){const l=[i,a];return o.push(l),1===o.length&&(r=n(s)||e),i(t),()=>{const e=o.indexOf(l);-1!==e&&o.splice(e,1),0===o.length&&(r(),r=null)}}}}const V=q(!1),Y=q(!1),Z=q(!1),X=q(0),J=()=>X.set(0),Q=q(0);let ee;const te={subscribe:q({message:void 0,timeout:void 0},e=>(ee=e,()=>{})).subscribe};const ne=(e,t)=>{t||(t=2e3),ee&&ee({message:e,timeout:t})},re=new URLSearchParams(document.location.search.substring(1)),oe=q(re.get("play-poster")),ie=q(re.get("rom-url")),se=q(re.get("rom-name")),ae=q(!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),le=q(!1);function ue(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M8 5v14l11-7z"),m(r,"fill","#fff"),m(o,"d","M0 0h24v24H0z"),m(o,"fill","none"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class ce extends W{constructor(e){super(),j(this,e,null,ue,i,{})}}const de={name:"wasmboy-plugin REQUIRED",graphics:e=>{},audio:(e,t,n)=>{},saveState:e=>{},canvas:(e,t,n)=>{},breakpoint:()=>{},ready:()=>{},play:()=>{},pause:()=>{},loadedAndStarted:()=>{}};const he=new class{constructor(){this.plugins={},this.pluginIdCounter=0}addPlugin(e){if(!e&&"object"!=typeof e)throw new Error("Invalid Plugin Object");if(!e.name)throw new Error('Added plugin must have a "name" property');const t=this.pluginIdCounter;return this.plugins[this.pluginIdCounter]=e,this.pluginIdCounter++,()=>{this.removePlugin(t)}}removePlugin(e){delete this.plugins[e]}runHook(e){if(!de[e.key]||"function"!=typeof de[e.key])throw new Error("No such hook as "+e.key);Object.keys(this.plugins).forEach(t=>{const n=this.plugins[t];if(n[e.key]){let t=void 0;try{t=n[e.key].apply(null,e.params)}catch(t){console.error(`There was an error running the '${e.key}' hook, on the ${n.name} plugin.`),console.error(t)}e.callback&&e.callback(t)}})}},pe="CONNECT",fe="INSTANTIATE_WASM",ge="CLEAR_MEMORY",me="GET_MEMORY",ye="SET_MEMORY",ve="GET_CONSTANTS",be="CONFIG",we="RESET_AUDIO_QUEUE",Ae="PLAY",_e="BREAKPOINT",Se="PAUSE",Te="UPDATED",Ee="CRASHED",Oe="SET_JOYPAD_STATE",Re="AUDIO_LATENCY",Ie="RUN_WASM_EXPORT",Ce="GET_WASM_MEMORY_SECTION",Le="GET_WASM_CONSTANT",Me="FORCE_OUTPUT_FRAME",ke="SET_SPEED",Ge="IS_GBC",xe="LIB",Ne="GRAPHICS",Be="MEMORY",Pe="CONTROLLER",Fe="AUDIO",De="BOOT_ROM",Ue="CARTRIDGE_RAM",$e="CARTRIDGE_ROM",He="CARTRIDGE_HEADER",ze="GAMEBOY_MEMORY",je="PALETTE_MEMORY",We="INTERNAL_STATE";function Ke(e){return e.data?e.data:e}const qe=new class{constructor(){this.worker=void 0,this.updateGraphicsCallback=void 0,this.frameQueue=void 0,this.frameQueueRenderPromise=void 0,this.canvasElement=void 0,this.canvasContext=void 0,this.canvasImageData=void 0,this.imageDataArray=void 0,this.imageDataArrayChanged=!1}initialize(e,t){this.updateGraphicsCallback=t,this.frameQueue=[];return(async()=>{this.canvasElement=e,this.canvasContext=this.canvasElement.getContext("2d"),this.canvasElement.width=160,this.canvasElement.height=144,this.canvasImageData=this.canvasContext.createImageData(this.canvasElement.width,this.canvasElement.height),this.canvasElement.style="\n        image-rendering: optimizeSpeed;\n        image-rendering: -moz-crisp-edges;\n        image-rendering: -webkit-optimize-contrast;\n        image-rendering: -o-crisp-edges;\n        image-rendering: pixelated;\n        -ms-interpolation-mode: nearest-neighbor;\n      ",this.canvasContext.clearRect(0,0,this.canvasElement.width,this.canvasElement.height),he.runHook({key:"canvas",params:[this.canvasElement,this.canvasContext,this.canvasImageData],callback:e=>{e&&(e.canvasElement&&(this.canvasElement=e.canvasElement),e.canvasContext&&(this.canvasContext=e.canvasContext),e.canvasImageData&&(this.canvasImageData=e.canvasImageData))}}),this.worker&&await this.worker.postMessage({type:ve})})()}setWorker(e){this.worker=e,this.worker.addMessageListener(e=>{const t=Ke(e);switch(t.message.type){case Te:return this.imageDataArray=new Uint8ClampedArray(t.message.imageDataArrayBuffer),void(this.imageDataArrayChanged=!0)}})}renderFrame(){this.imageDataArrayChanged&&(this.imageDataArrayChanged=!1,this.updateGraphicsCallback&&this.updateGraphicsCallback(this.imageDataArray),he.runHook({key:"graphics",params:[this.imageDataArray],callback:e=>{e&&(this.imageDataArray=e)}}),this.canvasImageData.data.set(this.imageDataArray),this.canvasContext.clearRect(0,0,this.canvasElement.width,this.canvasElement.height),this.canvasContext.putImageData(this.canvasImageData,0,0))}};function Ve(e,t){t=t||{};var n=e.numberOfChannels,r=e.sampleRate,o=t.float32?3:1,i=3===o?32:16;return function(e,t,n,r,o){var i=o/8,s=r*i,a=new ArrayBuffer(44+e.length*i),l=new DataView(a);Ye(l,0,"RIFF"),l.setUint32(4,36+e.length*i,!0),Ye(l,8,"WAVE"),Ye(l,12,"fmt "),l.setUint32(16,16,!0),l.setUint16(20,t,!0),l.setUint16(22,r,!0),l.setUint32(24,n,!0),l.setUint32(28,n*s,!0),l.setUint16(32,s,!0),l.setUint16(34,o,!0),Ye(l,36,"data"),l.setUint32(40,e.length*i,!0),1===t?function(e,t,n){for(var r=0;r<n.length;r++,t+=2){var o=Math.max(-1,Math.min(1,n[r]));e.setInt16(t,o<0?32768*o:32767*o,!0)}}(l,44,e):function(e,t,n){for(var r=0;r<n.length;r++,t+=4)e.setFloat32(t,n[r],!0)}(l,44,e);return a}(2===n?function(e,t){var n=e.length+t.length,r=new Float32Array(n),o=0,i=0;for(;o<n;)r[o++]=e[i],r[o++]=t[i],i++;return r}(e.getChannelData(0),e.getChannelData(1)):e.getChannelData(0),o,r,n,i)}function Ye(e,t,n){for(var r=0;r<n.length;r++)e.setUint8(t+r,n.charCodeAt(r))}class Ze{constructor(e){this.id=e,this.audioContext=void 0,this.audioBuffer=void 0,this.audioPlaytime=void 0,this.audioSources=[],this.gainNode=void 0,this.muted=!1,this.libMuted=!1,this.recording=!1,this.recordingLeftBuffers=void 0,this.recordingRightBuffers=void 0,this.recordingAudioBuffer=void 0,this.recordingAnchor=void 0}createAudioContextIfNone(){this.audioContext||"undefined"==typeof window||(this.audioContext=new(window.AudioContext||window.webkitAudioContext),!0==!!this.audioContext&&(this.gainNode=this.audioContext.createGain()))}getCurrentTime(){if(this.createAudioContextIfNone(),this.audioContext)return this.audioContext.currentTime}getPlayTime(){return this.audioPlaytime}resumeAudioContext(){this.createAudioContextIfNone(),this.audioContext&&"suspended"===this.audioContext.state&&(this.audioContext.resume(),this.audioPlaytime=this.audioContext.currentTime)}playAudio(e,t,n,r,o){if(!this.audioContext)return;const i=new Float32Array(t),s=new Float32Array(n);this.audioBuffer=this.audioContext.createBuffer(2,e,44100),this._setSamplesToAudioBuffer(this.audioBuffer,i,s),this.recording&&(this.recordingLeftBuffers.push(i),this.recordingRightBuffers.push(s));let a=this.audioContext.createBufferSource();a.buffer=this.audioBuffer,a.playbackRate.setValueAtTime(r,this.audioContext.currentTime);let l=a;if(o){const e=o(this.audioContext,l,this.id);e&&(l=e)}he.runHook({key:"audio",params:[this.audioContext,l,this.id],callback:e=>{e&&(l.connect(e),l=e)}}),this.gainNode&&(l.connect(this.gainNode),l=this.gainNode),l.connect(this.audioContext.destination);let u=this.audioContext.currentTime,c=u+.1;this.audioPlaytime=this.audioPlaytime||c,this.audioPlaytime<u&&(this.cancelAllAudio(),this.audioPlaytime=c),a.start(this.audioPlaytime);const d=e/(44100*r);for(this.audioPlaytime=this.audioPlaytime+d;this.audioSources[this.audioSources.length-1]&&this.audioSources[this.audioSources.length-1].playtime<=this.audioPlaytime;)this.audioSources[this.audioSources.length-1].source.stop(),this.audioSources.pop();this.audioSources.push({source:a,playTime:this.audioPlaytime});const h=this.audioPlaytime-this.audioContext.currentTime+500;setTimeout(()=>{this.audioSources.shift()},h)}cancelAllAudio(e){if(this.audioContext){for(let t=0;t<this.audioSources.length;t++)(e||this.audioSources[t].playTime>this.audioPlaytime)&&this.audioSources[t].source.stop();this.audioSources=[],this.audioPlaytime=this.audioContext.currentTime+.1}}mute(){this.muted||(this._setGain(0),this.muted=!0)}unmute(){this.muted&&(this._setGain(1),this.muted=!1)}hasRecording(){return!!this.recordingAudioBuffer}startRecording(){this.recording||(this.recording=!0,this.recordingLeftBuffers=[],this.recordingRightBuffers=[],this.recordingAudioBuffer=void 0)}stopRecording(){if(!this.recording)return;this.recording=!1;const e=e=>{let t=0;e.forEach(e=>{t+=e.length});const n=new Float32Array(t);let r=0;return e.forEach(e=>{n.set(e,r),r+=e.length}),n},t=e(this.recordingLeftBuffers),n=e(this.recordingRightBuffers);this.recordingAudioBuffer=this.audioContext.createBuffer(2,t.length,44100),this._setSamplesToAudioBuffer(this.recordingAudioBuffer,t,n),this.recordingLeftBuffer=void 0,this.recordingRightBuffer=void 0}downloadRecordingAsWav(e){if(!this.recordingAudioBuffer)return;this.recordingAnchor||(this.recordingAnchor=document.createElement("a"),document.body.appendChild(this.recordingAnchor),this.recordingAnchor.style="display: none");const t=Ve(this.recordingAudioBuffer),n=new window.Blob([new DataView(t)],{type:"audio/wav"}),r=window.URL.createObjectURL(n);let o;if(this.recordingAnchor.href=r,e)o=e+".wav";else{o=`wasmboy-${(new Date).toLocaleDateString(void 0,{month:"2-digit",day:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}.wav`}this.recordingAnchor.download=o,this.recordingAnchor.click(),window.URL.revokeObjectURL(r)}getRecordingAsWavBase64EncodedString(){if(!this.recordingAudioBuffer)return;const e=Ve(this.recordingAudioBuffer);return"data:audio/wav;base64,"+this._arrayBufferToBase64(e)}getRecordingAsAudioBuffer(){return this.recordingAudioBuffer}_libMute(){this._setGain(0),this.libMuted=!0}_libUnmute(){this.libMuted&&(this._setGain(1),this.libMuted=!1)}_setGain(e){this.createAudioContextIfNone(),this.gainNode&&this.gainNode.gain.setValueAtTime(e,this.audioContext.currentTime)}_setSamplesToAudioBuffer(e,t,n){e.copyToChannel?(e.copyToChannel(t,0,0),e.copyToChannel(n,1,0)):(e.getChannelData(0).set(t),e.getChannelData(1).set(n))}_arrayBufferToBase64(e){let t="",n=new Uint8Array(e),r=n.byteLength;for(var o=0;o<r;o++)t+=String.fromCharCode(n[o]);return window.btoa(t)}}const Xe=new class{constructor(){this.worker=void 0,this.updateAudioCallback=void 0,this.gbChannels={master:new Ze("master"),channel1:new Ze("channel1"),channel2:new Ze("channel2"),channel3:new Ze("channel3"),channel4:new Ze("channel4")},this._createAudioContextIfNone(),"undefined"!=typeof window&&(this.gbChannels.channel1._libMute(),this.gbChannels.channel2._libMute(),this.gbChannels.channel3._libMute(),this.gbChannels.channel4._libMute()),this.averageTimeStretchFps=[],this.speed=1,this.WASMBOY_SOUND_OUTPUT_LOCATION=0,this.WASMBOY_CHANNEL_1_OUTPUT_LOCATION=0,this.WASMBOY_CHANNEL_2_OUTPUT_LOCATION=0,this.WASMBOY_CHANNEL_3_OUTPUT_LOCATION=0,this.WASMBOY_CHANNEL_4_OUTPUT_LOCATION=0}initialize(e){return(async()=>(this.updateAudioCallback=e,this.averageTimeStretchFps=[],this.speed=1,this._createAudioContextIfNone(),this.cancelAllAudio(),this.worker.postMessage({type:ve})))()}setWorker(e){this.worker=e,this.worker.addMessageListener(e=>{const t=Ke(e);switch(t.message.type){case Te:{this.playAudio(t.message);let e=0,n=this.gbChannels.master.getCurrentTime(),r=this.gbChannels.master.getPlayTime();return n&&n>0&&(e=r-n),void this.worker.postMessageIgnoreResponse({type:Re,latency:e})}}})}getAudioChannels(){return this.gbChannels}setSpeed(e){this.speed=e,this.cancelAllAudio(!0),this.resetTimeStretch()}resetTimeStretch(){this.averageTimeStretchFps=[]}playAudio(e){let t=e.fps,n=e.allowFastSpeedStretching,r=e.numberOfSamples,o=t||60;const i=Math.abs(t-this.averageTimeStretchFps[this.averageTimeStretchFps.length-1]);i&&i>=15&&this.resetTimeStretch(),this.averageTimeStretchFps.push(t),this.averageTimeStretchFps.length>Math.floor(171)&&this.averageTimeStretchFps.shift(),this.averageTimeStretchFps.length>=57&&(o=this.averageTimeStretchFps.reduce((e,t)=>e+t),o=Math.floor(o/this.averageTimeStretchFps.length));let s=1;(o<57||n)&&1===this.speed&&(s*=o/60,s<=0&&(s=.01)),s*=this.speed,this.gbChannels.master.playAudio(r,e.audioBuffer.left,e.audioBuffer.right,s,this.updateAudioCallback);for(let t=0;t<4;t++){let n=t+1;e[`channel${n}Buffer`]&&this.gbChannels["channel"+n].playAudio(r,e[`channel${n}Buffer`].left,e[`channel${n}Buffer`].right,s,this.updateAudioCallback)}let a=!(this.gbChannels.channel1.muted||this.gbChannels.channel2.muted||this.gbChannels.channel3.muted||this.gbChannels.channel4.muted);this.gbChannels.master.muted&&a?(this.gbChannels.master.unmute(),this.gbChannels.channel1._libMute(),this.gbChannels.channel2._libMute(),this.gbChannels.channel3._libMute(),this.gbChannels.channel4._libMute()):this.gbChannels.master.muted||a||(this.gbChannels.master.mute(),this.gbChannels.channel1._libUnmute(),this.gbChannels.channel2._libUnmute(),this.gbChannels.channel3._libUnmute(),this.gbChannels.channel4._libUnmute())}resumeAudioContext(){this._applyOnAllChannels("resumeAudioContext")}cancelAllAudio(e){this._applyOnAllChannels("cancelAllAudio",[e])}_createAudioContextIfNone(){this._applyOnAllChannels("createAudioContextIfNone")}_applyOnAllChannels(e,t){Object.keys(this.gbChannels).forEach(n=>{this.gbChannels[n][e].apply(this.gbChannels[n],t)})}};function Je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){Je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function nt(e,t){return e(t={exports:{}},t.exports),t.exports}var rt=nt((function(e){!function(){function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function r(e,t,r){var o,i=new Promise((function(i,s){n(o=e[t].apply(e,r)).then(i,s)}));return i.request=o,i}function o(e,t,n){var o=r(e,t,n);return o.then((function(e){if(e)return new c(e,o.request)}))}function i(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function s(e,t,n,o){o.forEach((function(o){o in n.prototype&&(e.prototype[o]=function(){return r(this[t],o,arguments)})}))}function a(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function l(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return o(this[t],r,arguments)})}))}function u(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function d(e){this._store=e}function h(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new h(n)}function f(e){this._db=e}i(u,"_index",["name","keyPath","multiEntry","unique"]),s(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),l(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),i(c,"_cursor",["direction","key","primaryKey","value"]),s(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(c.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then((function(e){if(e)return new c(e,t._request)}))}))})})),d.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},d.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},i(d,"_store",["name","keyPath","indexNames","autoIncrement"]),s(d,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),l(d,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(d,"_store",IDBObjectStore,["deleteIndex"]),h.prototype.objectStore=function(){return new d(this._tx.objectStore.apply(this._tx,arguments))},i(h,"_tx",["objectStoreNames","mode"]),a(h,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new d(this._db.createObjectStore.apply(this._db,arguments))},i(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new h(this._db.transaction.apply(this._db,arguments))},i(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[d,u].forEach((function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],o=this._store||this._index,i=o[e].apply(o,n.slice(0,-1));i.onsuccess=function(){r(i.result)}})}))})),[u,d].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(o){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():o(r)):o(r)}))}))})}));var g={open:function(e,t,n){var o=r(indexedDB,"open",[e,t]),i=o.request;return i&&(i.onupgradeneeded=function(e){n&&n(new p(i.result,e.oldVersion,i.transaction))}),o.then((function(e){return new f(e)}))},delete:function(e){return r(indexedDB,"deleteDatabase",[e])}};e.exports=g,e.exports.default=e.exports}()})),ot=nt((function(e){"undefined"!=typeof indexedDB?e.exports=rt:e.exports={open:function(){return Promise.reject("IDB requires a browser environment")},delete:function(){return Promise.reject("IDB requires a browser environment")}}}));ot.open;let it=!1;if("undefined"!=typeof window){const e=ot.open("wasmboy",1,e=>{e.createObjectStore("keyval")});it={get:t=>e.then(e=>e.transaction("keyval").objectStore("keyval").get(t)),set:(t,n)=>e.then(e=>{const r=e.transaction("keyval","readwrite");return r.objectStore("keyval").put(n,t),r.complete}),delete:t=>e.then(e=>{const n=e.transaction("keyval","readwrite");return n.objectStore("keyval").delete(t),n.complete}),clear:()=>e.then(e=>{const t=e.transaction("keyval","readwrite");return t.objectStore("keyval").clear(),t.complete}),keys:()=>e.then(e=>{const t=e.transaction("keyval"),n=[],r=t.objectStore("keyval");return(r.iterateKeyCursor||r.iterateCursor).call(r,e=>{e&&(n.push(e.key),e.continue())}),t.complete.then(()=>n)})}}else it={get:()=>{},set:()=>{},delete:()=>{},clear:()=>{},keys:()=>{}};const st=it;let at={};const lt=at;at.parse=function(e){let t=at.bin.readUshort,n=at.bin.readUint,r=0,o={},i=new Uint8Array(e),s=i.length-4;for(;101010256!=n(i,s);)s--;r=s,r+=4,r+=4;let a=t(i,r);r+=2;t(i,r);r+=2;n(i,r);r+=4;let l=n(i,r);r+=4,r=l;for(let e=0;e<a;e++){n(i,r);r+=4,r+=4,r+=4,r+=4;n(i,r);r+=4;let e=n(i,r);r+=4;let s=n(i,r);r+=4;let a=t(i,r),l=t(i,r+2),u=t(i,r+4);r+=6,r+=8;let c=n(i,r);r+=4,r+=a+l+u,at._readLocal(i,c,o,e,s)}return o},at._readLocal=function(e,t,n,r,o){let i=at.bin.readUshort,s=at.bin.readUint,a=(s(e,t),i(e,t+=4),i(e,t+=2),i(e,t+=2));s(e,t+=2),s(e,t+=4);t+=4;let l=i(e,t+=8),u=i(e,t+=2);t+=2;let c=at.bin.readUTF8(e,t,l);t+=l,t+=u;let d=new Uint8Array(e.buffer,t);if(0==a)n[c]=new Uint8Array(d.buffer.slice(t,t+r));else{if(8!=a)throw"unknown compression method: "+a;{let e=new Uint8Array(o);at.inflateRaw(d,e),n[c]=e}}},at.inflateRaw=function(e,t){return at.F.inflate(e,t)},at.inflate=function(e,t){e[0],e[1];return at.inflateRaw(new Uint8Array(e.buffer,e.byteOffset+2,e.length-6),t)},at.deflate=function(e,t){null==t&&(t={level:6});let n=0,r=new Uint8Array(50+Math.floor(1.1*e.length));r[n]=120,r[n+1]=156,n+=2,n=at.F.deflateRaw(e,r,n,t.level);let o=at.adler(e,0,e.length);return r[n+0]=o>>>24&255,r[n+1]=o>>>16&255,r[n+2]=o>>>8&255,r[n+3]=o>>>0&255,new Uint8Array(r.buffer,0,n+4)},at.deflateRaw=function(e,t){null==t&&(t={level:6});let n,r=new Uint8Array(50+Math.floor(1.1*e.length));return n=at.F.deflateRaw(e,r,n,t.level),new Uint8Array(r.buffer,0,n)},at.encode=function(e){let t=0,n=at.bin.writeUint,r=at.bin.writeUshort,o={};for(let t in e){let n=!at._noNeed(t),r=e[t],i=at.crc.crc(r,0,r.length);o[t]={cpr:n,usize:r.length,crc:i,file:n?at.deflateRaw(r):r}}for(let e in o)t+=o[e].file.length+30+46+2*at.bin.sizeUTF8(e);t+=22;let i=new Uint8Array(t),s=0,a=[];for(let e in o){let t=o[e];a.push(s),s=at._writeHeader(i,s,e,t,0)}let l=0,u=s;for(let e in o){let t=o[e];a.push(s),s=at._writeHeader(i,s,e,t,1,a[l++])}let c=s-u;return n(i,s,101010256),s+=4,s+=4,r(i,s,l),s+=2,r(i,s,l),s+=2,n(i,s,c),s+=4,n(i,s,u),s+=4,s+=2,i.buffer},at._noNeed=function(e){let t=e.split(".").pop().toLowerCase();return-1!="png,jpg,jpeg,zip".indexOf(t)},at._writeHeader=function(e,t,n,r,o,i){let s=at.bin.writeUint,a=at.bin.writeUshort,l=r.file;return s(e,t,0==o?67324752:33639248),t+=4,1==o&&(t+=2),a(e,t,20),a(e,t+=2,0),a(e,t+=2,r.cpr?8:0),s(e,t+=2,0),s(e,t+=4,r.crc),s(e,t+=4,l.length),s(e,t+=4,r.usize),a(e,t+=4,at.bin.sizeUTF8(n)),a(e,t+=2,0),t+=2,1==o&&(t+=2,t+=2,s(e,t+=6,i),t+=4),t+=at.bin.writeUTF8(e,t,n),0==o&&(e.set(l,t),t+=l.length),t},at.crc={table:function(){let e=new Uint32Array(256);for(let t=0;t<256;t++){let n=t;for(let e=0;e<8;e++)1&n?n=3988292384^n>>>1:n>>>=1;e[t]=n}return e}(),update:function(e,t,n,r){for(let o=0;o<r;o++)e=at.crc.table[255&(e^t[n+o])]^e>>>8;return e},crc:function(e,t,n){return 4294967295^at.crc.update(4294967295,e,t,n)}},at.adler=function(e,t,n){let r=1,o=0,i=t,s=t+n;for(;i<s;){let t=Math.min(i+5552,s);for(;i<t;)r+=e[i++],o+=r;r%=65521,o%=65521}return o<<16|r},at.bin={readUshort:function(e,t){return e[t]|e[t+1]<<8},writeUshort:function(e,t,n){e[t]=255&n,e[t+1]=n>>8&255},readUint:function(e,t){return 16777216*e[t+3]+(e[t+2]<<16|e[t+1]<<8|e[t])},writeUint:function(e,t,n){e[t]=255&n,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},readASCII:function(e,t,n){let r="";for(let o=0;o<n;o++)r+=String.fromCharCode(e[t+o]);return r},writeASCII:function(e,t,n){for(let r=0;r<n.length;r++)e[t+r]=n.charCodeAt(r)},pad:function(e){return e.length<2?"0"+e:e},readUTF8:function(e,t,n){let r,o="";for(let r=0;r<n;r++)o+="%"+at.bin.pad(e[t+r].toString(16));try{r=decodeURIComponent(o)}catch(r){return at.bin.readASCII(e,t,n)}return r},writeUTF8:function(e,t,n){let r=n.length,o=0;for(let i=0;i<r;i++){let r=n.charCodeAt(i);if(0==(4294967168&r))e[t+o]=r,o++;else if(0==(4294965248&r))e[t+o]=192|r>>6,e[t+o+1]=128|r>>0&63,o+=2;else if(0==(4294901760&r))e[t+o]=224|r>>12,e[t+o+1]=128|r>>6&63,e[t+o+2]=128|r>>0&63,o+=3;else{if(0!=(4292870144&r))throw"e";e[t+o]=240|r>>18,e[t+o+1]=128|r>>12&63,e[t+o+2]=128|r>>6&63,e[t+o+3]=128|r>>0&63,o+=4}}return o},sizeUTF8:function(e){let t=e.length,n=0;for(let r=0;r<t;r++){let t=e.charCodeAt(r);if(0==(4294967168&t))n++;else if(0==(4294965248&t))n+=2;else if(0==(4294901760&t))n+=3;else{if(0!=(4292870144&t))throw"e";n+=4}}return n}},at.F={},at.F.deflateRaw=function(e,t,n,r){let o=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][r],i=at.F.U,s=at.F._goodIndex,a=(at.F._hash,at.F._putsE),l=0,u=n<<3,c=0,d=e.length;if(0==r){for(;l<d;){let n=Math.min(65535,d-l);a(t,u,l+n==d?1:0),u=at.F._copyExact(e,l,n,t,u+8),l+=n}return u>>>3}let h=i.lits,p=i.strt,f=i.prev,g=0,m=0,y=0,v=0,b=0,w=0;for(d>2&&(w=at.F._hash(e,0),p[w]=0),l=0;l<d;l++){if(b=w,l+1<d-2){w=at.F._hash(e,l+1);let t=l+1&32767;f[t]=p[w],p[w]=t}if(c<=l){(g>14e3||m>26697)&&(c<l&&(h[g]=l-c,g+=2,c=l),u=at.F._writeBlock(l==d-1||c==d?1:0,h,g,v,e,y,l-y,t,u),g=m=v=0,y=l);let n=0;if(l<d-2&&(n=at.F._bestMatch(e,l,f,b,Math.min(o[2],d-l),o[3])),0!=n){let e=n>>>16,t=65535&n,r=s(e,i.of0);i.lhst[257+r]++;let o=s(t,i.df0);i.dhst[o]++,v+=i.exb[r]+i.dxb[o],h[g]=e<<23|l-c,h[g+1]=t<<16|r<<8|o,g+=2,c=l+e}else i.lhst[e[l]]++;m++}}for(y==l&&0!=e.length||(c<l&&(h[g]=l-c,g+=2,c=l),u=at.F._writeBlock(1,h,g,v,e,y,l-y,t,u),g=0,m=0,g=m=v=0,y=l);0!=(7&u);)u++;return u>>>3},at.F._bestMatch=function(e,t,n,r,o,i){let s=32767&t,a=n[s],l=s-a+32768&32767;if(a==s||r!=at.F._hash(e,t-l))return 0;let u=0,c=0,d=Math.min(32767,t);for(;l<=d&&0!=--i&&a!=s;){if(0==u||e[t+u]==e[t+u-l]){let r=at.F._howLong(e,t,l);if(r>u){if(u=r,c=l,u>=o)break;l+2<r&&(r=l+2);let e=0;for(let o=0;o<r-2;o++){let r=t-l+o+32768&32767,i=r-n[r]+32768&32767;i>e&&(e=i,a=r)}}}s=a,a=n[s],l+=s-a+32768&32767}return u<<16|c},at.F._howLong=function(e,t,n){if(e[t]!=e[t-n]||e[t+1]!=e[t+1-n]||e[t+2]!=e[t+2-n])return 0;let r=t,o=Math.min(e.length,t+258);for(t+=3;t<o&&e[t]==e[t-n];)t++;return t-r},at.F._hash=function(e,t){return(e[t]<<8|e[t+1])+(e[t+2]<<4)&65535},at.saved=0,at.F._writeBlock=function(e,t,n,r,o,i,s,a,l){let u,c,d,h,p,f,g,m,y,v=at.F.U,b=at.F._putsF,w=at.F._putsE;v.lhst[256]++,u=at.F.getTrees(),c=u[0],d=u[1],h=u[2],p=u[3],f=u[4],g=u[5],m=u[6],y=u[7];let A=32+(0==(l+3&7)?0:8-(l+3&7))+(s<<3),_=r+at.F.contSize(v.fltree,v.lhst)+at.F.contSize(v.fdtree,v.dhst),S=r+at.F.contSize(v.ltree,v.lhst)+at.F.contSize(v.dtree,v.dhst);S+=14+3*g+at.F.contSize(v.itree,v.ihst)+(2*v.ihst[16]+3*v.ihst[17]+7*v.ihst[18]);for(let e=0;e<286;e++)v.lhst[e]=0;for(let e=0;e<30;e++)v.dhst[e]=0;for(let e=0;e<19;e++)v.ihst[e]=0;let T=A<_&&A<S?0:_<S?1:2;if(b(a,l,e),b(a,l+1,T),l+=3,0==T){for(;0!=(7&l);)l++;l=at.F._copyExact(o,i,s,a,l)}else{let e,r;if(1==T&&(e=v.fltree,r=v.fdtree),2==T){at.F.makeCodes(v.ltree,c),at.F.revCodes(v.ltree,c),at.F.makeCodes(v.dtree,d),at.F.revCodes(v.dtree,d),at.F.makeCodes(v.itree,h),at.F.revCodes(v.itree,h),e=v.ltree,r=v.dtree,w(a,l,p-257),w(a,l+=5,f-1),w(a,l+=5,g-4),l+=4;for(let e=0;e<g;e++)w(a,l+3*e,v.itree[1+(v.ordr[e]<<1)]);l+=3*g,l=at.F._codeTiny(m,v.itree,a,l),l=at.F._codeTiny(y,v.itree,a,l)}let s=i;for(let i=0;i<n;i+=2){let n=t[i],u=n>>>23,c=s+(8388607&n);for(;s<c;)l=at.F._writeLit(o[s++],e,a,l);if(0!=u){let n=t[i+1],o=n>>16,c=n>>8&255,d=255&n;w(a,l=at.F._writeLit(257+c,e,a,l),u-v.of0[c]),l+=v.exb[c],b(a,l=at.F._writeLit(d,r,a,l),o-v.df0[d]),l+=v.dxb[d],s+=u}}l=at.F._writeLit(256,e,a,l)}return l},at.F._copyExact=function(e,t,n,r,o){let i=o>>>3;return r[i]=n,r[i+1]=n>>>8,r[i+2]=255-r[i],r[i+3]=255-r[i+1],i+=4,r.set(new Uint8Array(e.buffer,t,n),i),o+(n+4<<3)},at.F.getTrees=function(){let e=at.F.U,t=at.F._hufTree(e.lhst,e.ltree,15),n=at.F._hufTree(e.dhst,e.dtree,15),r=[],o=at.F._lenCodes(e.ltree,r),i=[],s=at.F._lenCodes(e.dtree,i);for(let t=0;t<r.length;t+=2)e.ihst[r[t]]++;for(let t=0;t<i.length;t+=2)e.ihst[i[t]]++;let a=at.F._hufTree(e.ihst,e.itree,7),l=19;for(;l>4&&0==e.itree[1+(e.ordr[l-1]<<1)];)l--;return[t,n,a,o,s,l,r,i]},at.F.getSecond=function(e){let t=[];for(let n=0;n<e.length;n+=2)t.push(e[n+1]);return t},at.F.nonZero=function(e){let t="";for(let n=0;n<e.length;n+=2)0!=e[n+1]&&(t+=(n>>1)+",");return t},at.F.contSize=function(e,t){let n=0;for(let r=0;r<t.length;r++)n+=t[r]*e[1+(r<<1)];return n},at.F._codeTiny=function(e,t,n,r){for(let o=0;o<e.length;o+=2){let i=e[o],s=e[o+1];r=at.F._writeLit(i,t,n,r);let a=16==i?2:17==i?3:7;i>15&&(at.F._putsE(n,r,s,a),r+=a)}return r},at.F._lenCodes=function(e,t){let n=e.length;for(;2!=n&&0==e[n-1];)n-=2;for(let r=0;r<n;r+=2){let o=e[r+1],i=r+3<n?e[r+3]:-1,s=r+5<n?e[r+5]:-1,a=0==r?-1:e[r-1];if(0==o&&i==o&&s==o){let i=r+5;for(;i+2<n&&e[i+2]==o;)i+=2;let s=Math.min(i+1-r>>>1,138);s<11?t.push(17,s-3):t.push(18,s-11),r+=2*s-2}else if(o==a&&i==o&&s==o){let i=r+5;for(;i+2<n&&e[i+2]==o;)i+=2;let s=Math.min(i+1-r>>>1,6);t.push(16,s-3),r+=2*s-2}else t.push(o,0)}return n>>>1},at.F._hufTree=function(e,t,n){let r=[],o=e.length,i=t.length,s=0;for(s=0;s<i;s+=2)t[s]=0,t[s+1]=0;for(s=0;s<o;s++)0!=e[s]&&r.push({lit:s,f:e[s]});let a=r.length,l=r.slice(0);if(0==a)return 0;if(1==a){let e=r[0].lit,n=0==e?1:0;return t[1+(e<<1)]=1,t[1+(n<<1)]=1,1}r.sort((function(e,t){return e.f-t.f}));let u=r[0],c=r[1],d=0,h=1,p=2;for(r[0]={lit:-1,f:u.f+c.f,l:u,r:c,d:0};h!=a-1;)u=d!=h&&(p==a||r[d].f<r[p].f)?r[d++]:r[p++],c=d!=h&&(p==a||r[d].f<r[p].f)?r[d++]:r[p++],r[h++]={lit:-1,f:u.f+c.f,l:u,r:c};let f=at.F.setDepth(r[h-1],0);for(f>n&&(at.F.restrictDepth(l,n,f),f=n),s=0;s<a;s++)t[1+(l[s].lit<<1)]=l[s].d;return f},at.F.setDepth=function(e,t){return-1!=e.lit?(e.d=t,t):Math.max(at.F.setDepth(e.l,t+1),at.F.setDepth(e.r,t+1))},at.F.restrictDepth=function(e,t,n){let r=0,o=1<<n-t,i=0;for(e.sort((function(e,t){return t.d==e.d?e.f-t.f:t.d-e.d})),r=0;r<e.length&&e[r].d>t;r++){let s=e[r].d;e[r].d=t,i+=o-(1<<n-s)}for(i>>>=n-t;i>0;){let n=e[r].d;n<t?(e[r].d++,i-=1<<t-n-1):r++}for(;r>=0;r--)e[r].d==t&&i<0&&(e[r].d--,i++);0!=i&&console.log("debt left")},at.F._goodIndex=function(e,t){let n=0;return t[16|n]<=e&&(n|=16),t[8|n]<=e&&(n|=8),t[4|n]<=e&&(n|=4),t[2|n]<=e&&(n|=2),t[1|n]<=e&&(n|=1),n},at.F._writeLit=function(e,t,n,r){return at.F._putsF(n,r,t[e<<1]),r+t[1+(e<<1)]},at.F.inflate=function(e,t){if(3==e[0]&&0==e[1])return t||new Uint8Array(0);let n=at.F,r=n._bitsF,o=n._bitsE,i=n._decodeTiny,s=n.makeCodes,a=n.codes2map,l=n._get17,u=n.U,c=null==t;c&&(t=new Uint8Array(e.length>>2<<3));let d,h,p=0,f=0,g=0,m=0,y=0,v=0,b=0,w=0,A=0;for(;0==p;)if(p=r(e,A,1),f=r(e,A+1,2),A+=3,0!=f){if(c&&(t=at.F._check(t,w+(1<<17))),1==f&&(d=u.flmap,h=u.fdmap,v=511,b=31),2==f){g=o(e,A,5)+257,m=o(e,A+5,5)+1,y=o(e,A+10,4)+4,A+=14;for(let e=0;e<38;e+=2)u.itree[e]=0,u.itree[e+1]=0;let t=1;for(let n=0;n<y;n++){let r=o(e,A+3*n,3);u.itree[1+(u.ordr[n]<<1)]=r,r>t&&(t=r)}A+=3*y,s(u.itree,t),a(u.itree,t,u.imap),d=u.lmap,h=u.dmap;let n=i(u.imap,(1<<t)-1,g,e,A,u.ltree);v=(1<<(n>>>24))-1,A+=16777215&n,s(u.ltree,n>>>24),a(u.ltree,n>>>24,d);let r=i(u.imap,(1<<t)-1,m,e,A,u.dtree);b=(1<<(r>>>24))-1,A+=16777215&r,s(u.dtree,r>>>24),a(u.dtree,r>>>24,h)}for(;;){let n=d[l(e,A)&v];A+=15&n;let i=n>>>4;if(i>>>8==0)t[w++]=i;else{if(256==i)break;{let n=w+i-254;if(i>264){let t=u.ldef[i-257];n=w+(t>>>3)+o(e,A,7&t),A+=7&t}let s=h[l(e,A)&b];A+=15&s;let a=s>>>4,c=u.ddef[a],d=(c>>>4)+r(e,A,15&c);for(A+=15&c;w<n;)t[w]=t[w++-d],t[w]=t[w++-d],t[w]=t[w++-d],t[w]=t[w++-d];w=n}}}}else{0!=(7&A)&&(A+=8-(7&A));let n=4+(A>>>3),r=e[n-4]|e[n-3]<<8;c&&(t=at.F._check(t,w+r)),t.set(new Uint8Array(e.buffer,e.byteOffset+n,r),w),A=n+r<<3,w+=r}return t.length==w?t:t.slice(0,w)},at.F._check=function(e,t){let n=e.length;if(t<=n)return e;let r=new Uint8Array(n<<1);for(let t=0;t<n;t+=4)r[t]=e[t],r[t+1]=e[t+1],r[t+2]=e[t+2],r[t+3]=e[t+3];return r},at.F._decodeTiny=function(e,t,n,r,o,i){let s=o,a=at.F._bitsE,l=at.F._get17,u=n<<1,c=0,d=0;for(;c<u;){let n=e[l(r,o)&t];o+=15&n;let s=n>>>4;if(s<=15)i[c]=0,i[c+1]=s,s>d&&(d=s),c+=2;else{let e=0,t=0;16==s?(t=3+a(r,o,2)<<1,o+=2,e=i[c-1]):17==s?(t=3+a(r,o,3)<<1,o+=3):18==s&&(t=11+a(r,o,7)<<1,o+=7);let n=c+t;for(;c<n;)i[c]=0,i[c+1]=e,c+=2}}let h=i.length;for(;c<h;)i[c+1]=0,c+=2;return d<<24|o-s},at.F.makeCodes=function(e,t){let n,r,o,i,s,a=at.F.U,l=e.length,u=a.bl_count;for(let e=0;e<=t;e++)u[e]=0;for(i=1;i<l;i+=2)u[e[i]]++;let c=a.next_code;for(n=0,u[0]=0,r=1;r<=t;r++)n=n+u[r-1]<<1,c[r]=n;for(o=0;o<l;o+=2)s=e[o+1],0!=s&&(e[o]=c[s],c[s]++)},at.F.codes2map=function(e,t,n){let r=e.length,o=at.F.U.rev15;for(let i=0;i<r;i+=2)if(0!=e[i+1]){let r=i>>1,s=e[i+1],a=r<<4|s,l=t-s,u=e[i]<<l,c=u+(1<<l);for(;u!=c;){n[o[u]>>>15-t]=a,u++}}},at.F.revCodes=function(e,t){let n=at.F.U.rev15,r=15-t;for(let o=0;o<e.length;o+=2){let i=e[o]<<t-e[o+1];e[o]=n[i]>>>r}},at.F._putsE=function(e,t,n){n<<=7&t;let r=t>>>3;e[r]|=n,e[r+1]|=n>>>8},at.F._putsF=function(e,t,n){n<<=7&t;let r=t>>>3;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},at.F._bitsE=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<n)-1},at.F._bitsF=function(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<n)-1},at.F._get17=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)},at.F._get25=function(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16|e[3+(t>>>3)]<<24)>>>(7&t)},at.F.U={next_code:new Uint16Array(16),bl_count:new Uint16Array(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new Uint16Array(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new Uint32Array(32),flmap:new Uint16Array(512),fltree:[],fdmap:new Uint16Array(32),fdtree:[],lmap:new Uint16Array(32768),ltree:[],dmap:new Uint16Array(32768),dtree:[],imap:new Uint16Array(512),itree:[],rev15:new Uint16Array(32768),lhst:new Uint32Array(286),dhst:new Uint32Array(30),ihst:new Uint32Array(19),lits:new Uint32Array(15e3),strt:new Uint16Array(65536),prev:new Uint16Array(32768)},function(){let e=at.F.U;for(let t=0;t<32768;t++){let n=t;n=(2863311530&n)>>>1|(1431655765&n)<<1,n=(3435973836&n)>>>2|(858993459&n)<<2,n=(4042322160&n)>>>4|(252645135&n)<<4,n=(4278255360&n)>>>8|(16711935&n)<<8,e.rev15[t]=(n>>>16|n<<16)>>>17}for(let t=0;t<32;t++)e.ldef[t]=e.of0[t]<<3|e.exb[t],e.ddef[t]=e.df0[t]<<4|e.dxb[t];let t=0;for(;t<=143;t++)e.fltree.push(0,8);for(;t<=255;t++)e.fltree.push(0,9);for(;t<=279;t++)e.fltree.push(0,7);for(;t<=287;t++)e.fltree.push(0,8);for(at.F.makeCodes(e.fltree,9),at.F.codes2map(e.fltree,9,e.flmap),at.F.revCodes(e.fltree,9),t=0;t<32;t++)e.fdtree.push(0,5);at.F.makeCodes(e.fdtree,5),at.F.codes2map(e.fdtree,5,e.fdmap),at.F.revCodes(e.fdtree,5);for(let t=0;t<19;t++)e.itree.push(0,0);for(let t=0;t<286;t++)e.ltree.push(0,0);for(let t=0;t<30;t++)e.dtree.push(0,0)}();const ut=(e,t)=>(async()=>{if(ArrayBuffer.isView(e)&&e.constructor===Uint8Array)return{ROM:e};if("object"==typeof e&&e.size){let t=await ct(e);return e.name.toLowerCase().endsWith(".zip")&&(t=await dt(t)),{ROM:t,name:e.name}}{const n={};t&&t.headers&&(n.headers=t.headers);let r=await fetch(e,n).then(e=>e.ok?e.arrayBuffer():Promise.reject(e)),o=e;t&&t.fileName&&(o=t.fileName);let i=new Uint8Array(r);return o.toLowerCase().endsWith(".zip")&&(i=await dt(i)),{ROM:i,name:o}}})(),ct=async e=>await new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{const e=new Uint8Array(r.result);t(e)},r.readAsArrayBuffer(e)}),dt=async e=>{const t=await lt.parse(e);let n=!1;if(Object.keys(t).some(e=>{const r=e.toLowerCase();return!!(r.includes(".gb")||r.includes(".gbc")||r.includes(".bin"))&&(n=t[e],!0)}),!n)throw new Error("Could not find a ROM in zip...");return n},ht={wasmboyMemory:{wasmBoyInternalState:[],wasmBoyPaletteMemory:[],gameBoyMemory:[],cartridgeRam:[]},date:void 0,isAuto:void 0};function pt(){let e=Object.assign({},ht);return e.wasmboyMemory.wasmBoyInternalState=this.internalState,e.wasmboyMemory.wasmBoyPaletteMemory=this.paletteMemory,e.wasmboyMemory.gameBoyMemory=this.gameboyMemory,e.wasmboyMemory.cartridgeRam=this.cartridgeRam,e.date=Date.now(),e.isAuto=!1,this.saveStateCallback&&this.saveStateCallback(e),he.runHook({key:"saveState",params:[e]}),e}function ft(){if(!this.internalState)return null;const e=pt.bind(this)(),t=Object.keys(e.wasmboyMemory);for(let n=0;n<t.length;n++)e.wasmboyMemory[t[n]]=Array.prototype.slice.call(e.wasmboyMemory[t[n]]);return e.isAuto=!0,localStorage.setItem(this.WASMBOY_UNLOAD_STORAGE,JSON.stringify({header:Array.prototype.slice.call(this.cartridgeHeader),cartridgeRam:Array.prototype.slice.call(this.cartridgeRam),saveState:e})),null}function gt(){return(async()=>{const e=localStorage.getItem(this.WASMBOY_UNLOAD_STORAGE);if(e){const t=JSON.parse(e);localStorage.removeItem(this.WASMBOY_UNLOAD_STORAGE);const n=new Uint8Array(t.header),r=new Uint8Array(t.cartridgeRam),o=t.saveState;if(o){const e=Object.keys(o.wasmboyMemory);for(let t=0;t<e.length;t++)o.wasmboyMemory[e[t]]=new Uint8Array(o.wasmboyMemory[e[t]])}await this.saveCartridgeRam(n,r),await this.saveState(n,o)}})()}function mt(){return window.addEventListener("beforeunload",()=>{ft.bind(this)()},!1),window.addEventListener("unload",()=>{ft.bind(this)()},!1),window.addEventListener("pagehide",()=>{ft.bind(this)()},!1),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&ft.bind(this)()}),gt.bind(this)()}const yt=new class{constructor(){this.worker=void 0,this.maxNumberOfAutoSaveStates=void 0,this.saveStateCallback=void 0,this.loadedCartridgeMemoryState={ROM:!1,RAM:!1,BOOT:!1},this.bootRom=void 0,this.cartridgeRom=void 0,this.cartridgeRomFileName=void 0,this.cartridgeHeader=void 0,this.cartridgeRam=void 0,this.gameboyMemory=void 0,this.paletteMemory=void 0,this.internalState=void 0,this.WASMBOY_UNLOAD_STORAGE="WASMBOY_UNLOAD_STORAGE",this.WASMBOY_GAME_BYTES_LOCATION=0,this.WASMBOY_GAME_RAM_BANKS_LOCATION=0,this.WASMBOY_INTERNAL_STATE_SIZE=0,this.WASMBOY_INTERNAL_STATE_LOCATION=0,this.WASMBOY_INTERNAL_MEMORY_SIZE=0,this.WASMBOY_INTERNAL_MEMORY_LOCATION=0,this.WASMBOY_PALETTE_MEMORY_SIZE=0,this.WASMBOY_PALETTE_MEMORY_LOCATION=0,this.SUPPORTED_BOOT_ROM_TYPES={GB:"GB",GBC:"GBC"}}initialize(e,t,n){this.maxNumberOfAutoSaveStates=t,this.saveStateCallback=n;return(async()=>{await this._initializeConstants(),e||await mt.call(this)})()}setWorker(e){this.worker=e,this.worker.addMessageListener(e=>{const t=Ke(e);switch(t.message.type){case Te:{const e=Object.keys(t.message);return delete e.type,e.includes(De)&&(this.bootRom=new Uint8Array(t.message[De])),e.includes($e)&&(this.cartridgeRom=new Uint8Array(t.message[$e])),e.includes(Ue)&&(this.cartridgeRam=new Uint8Array(t.message[Ue])),e.includes(ze)&&(this.gameboyMemory=new Uint8Array(t.message[ze])),e.includes(je)&&(this.paletteMemory=new Uint8Array(t.message[je])),void(e.includes(We)&&(this.internalState=new Uint8Array(t.message[We])))}}})}getSavedMemory(){return(async()=>{const e=[],t=await st.keys();for(let n=0;n<t.length;n++){const r=await st.get(t[n]);e.push(r)}return e})()}getLoadedCartridgeMemoryState(){return this.loadedCartridgeMemoryState}clearMemory(){return this.worker.postMessage({type:ge}).then(e=>{this.loadedCartridgeMemoryState.ROM=!1,this.loadedCartridgeMemoryState.RAM=!1,this.cartridgeRom=void 0,this.cartridgeHeader=void 0,this.cartridgeRam=void 0,this.gameboyMemory=void 0,this.paletteMemory=void 0,this.internalState=void 0})}isValidBootROMType(e){return Object.keys(this.SUPPORTED_BOOT_ROM_TYPES).some(t=>this.SUPPORTED_BOOT_ROM_TYPES[t]===e)}async addBootROM(e,t,n,r){if(e=e.toUpperCase(),!this.isValidBootROMType(e))throw new Error("Invalid Boot ROM type");const o=await ut(t,n);r&&(delete r.name,delete r.ROM);let i="Game Boy";this.SUPPORTED_BOOT_ROM_TYPES.GBC===e&&(i="Game Boy Color");const s=et({ROM:o.ROM,name:i,type:e,date:Date.now()},r);await st.set("boot-rom-"+e,s)}async getBootROMs(){const e=[];for(let t in this.SUPPORTED_BOOT_ROM_TYPES){const n=await st.get("boot-rom-"+t);n&&e.push(n)}return e}async loadBootROMIfAvailable(e){if(!st)return;if(e=e.toUpperCase(),!this.isValidBootROMType(e))throw new Error("Invalid Boot ROM type");const t=await st.get("boot-rom-"+e);if(!t)return;const n={};n[De]=t.ROM.buffer,await this.worker.postMessage(et({type:ye},n)).then(e=>{this.loadedCartridgeMemoryState.BOOT=!0}),await this.worker.postMessage({type:me,memoryTypes:[De]}).then(e=>{const t=Ke(e);this.bootRom=new Uint8Array(t.message[De])})}loadCartridgeRom(e,t){return(async()=>{const n={};n[$e]=e.buffer,await this.worker.postMessage(et({type:ye},n)).then(e=>{this.loadedCartridgeMemoryState.ROM=!0}),await this.worker.postMessage({type:me,memoryTypes:[$e,He]}).then(e=>{const n=Ke(e);this.cartridgeRom=new Uint8Array(n.message[$e]),this.cartridgeRomFileName=t,this.cartridgeHeader=new Uint8Array(n.message[He])})})()}saveLoadedCartridge(e){return(async()=>{if(!this.cartridgeHeader)throw new Error("Error parsing the cartridge header");let t=await st.get(this.cartridgeHeader);t||(t={});const n=await this.getCartridgeInfo();e&&(delete e.ROM,delete e.header);let r=this.cartridgeRomFileName||"Unknown";return t.cartridgeRom=et({ROM:this.cartridgeRom,header:this.cartridgeHeader,fileName:r,date:Date.now()},e),t.cartridgeInfo=n,this.cartridgeRam&&await this.saveCartridgeRam(),await st.set(this.cartridgeHeader,t),t})()}deleteSavedCartridge(e){return(async()=>{const t=e.cartridgeInfo.header;if(!t)throw new Error("Error parsing the cartridge header");let n=await st.get(t);if(!n)throw new Error("Could not find the passed cartridge");return delete n.cartridgeRom,await st.set(t,n),n})()}saveCartridgeRam(e,t){return(async()=>{let n,r;if(e&&t?(n=e,r=t):(n=this.cartridgeHeader,r=this.cartridgeRam),!n||!r)throw new Error("Error parsing the cartridgeRam or cartridge header");let o=await st.get(n);o||(o={}),o.cartridgeRam=r,await st.set(n,o)})()}loadCartridgeRam(){return(async()=>{const e=this.cartridgeHeader;if(!e)throw new Error("Error parsing the cartridge header");const t=await st.get(e);if(!t||!t.cartridgeRam)return;const n={};n[Ue]=t.cartridgeRam.buffer,await this.worker.postMessage(et({type:ye},n)).then(e=>{this.loadedCartridgeMemoryState.RAM=!0,this.cartridgeRam=t.cartridgeRam})})()}saveState(e,t){return(async()=>{let n,r;if(e&&t?(n=t,r=e):(n=pt.call(this),r=this.cartridgeHeader),!r)throw new Error("Error parsing the cartridge header");let o=await st.get(r);if(o||(o={}),o.saveStates||(o.saveStates=[]),n.isAuto&&this.maxNumberOfAutoSaveStates&&this.maxNumberOfAutoSaveStates>0){const e=[];for(o.saveStates.forEach(t=>{t.isAuto&&e.push(t)}),e.sort((e,t)=>e.date<t.date?-1:e.date>t.date?1:0);e.length>0&&e.length+1>this.maxNumberOfAutoSaveStates;){const t=e.shift(),n=this._indexOfSaveStateIndexInSaveStates(t,o.saveStates);o.saveStates.splice(n,1)}this.maxNumberOfAutoSaveStates>0&&o.saveStates.push(n)}else o.saveStates.push(n);return await st.set(r,o),n})()}loadState(e){return(async()=>{const t=this.cartridgeHeader;if(!t)throw new Error("Error getting the cartridge header");if(!e){const e=await st.get(t);if(!e||!e.saveStates)throw new Error("No Save State passed, and no cartridge object found");saverState=e.saveStates[0]}const n={};n[Ue]=e.wasmboyMemory.cartridgeRam.buffer,n[ze]=e.wasmboyMemory.gameBoyMemory.buffer,n[je]=e.wasmboyMemory.wasmBoyPaletteMemory.buffer,n[We]=e.wasmboyMemory.wasmBoyInternalState.buffer,await this.worker.postMessage(et({type:ye},n),[n[Ue],n[ze],n[je],n[We]]),await this.worker.postMessage({type:me,memoryTypes:[Ue,ze,je,We]}).then(e=>{const t=Ke(e);this.cartridgeRam=t.message[Ue],this.gameboyMemory=t.message[ze],this.paletteMemory=t.message[je],this.internalState=t.message[We]})})()}deleteState(e,t){return(async()=>{if(!e)throw new Error("You must provide a save state to delete");let n;if(t?n=t:this.cartridgeHeader&&(n=this.cartridgeHeader),!n)throw new Error("Please load a ROM, or pass a Cartridge header...");let r=await st.get(n);if(!r||!r.saveStates)throw new Error("No save states found for the Cartridge...");const o=this._indexOfSaveStateIndexInSaveStates(e,r.saveStates);if(o<0)throw new Error("Could not find the passed save state for the related cartridge...");return r.saveStates.splice(o,1),await st.set(n,r),e})()}getCartridgeObject(){return st.get(this.cartridgeHeader)}getCartridgeInfo(){if(!this.loadedCartridgeMemoryState.ROM)return Promise.reject("No ROM has been loaded");return(async()=>{const e={};return e.header=this.cartridgeHeader,e.ROM=this.cartridgeRom,e.RAM=this.cartridgeRam,e.nintendoLogo=e.ROM.slice(260,308),e.title=e.ROM.slice(308,324),e.titleAsString=String.fromCharCode.apply(null,e.title),e.manufacturerCode=e.ROM.slice(319,323),e.CGBFlag=e.ROM[323],e.newLicenseeCode=e.ROM.slice(324,326),e.SGBFlag=e.ROM[326],e.cartridgeType=e.ROM[327],e.ROMSize=e.ROM[328],e.RAMSize=e.ROM[329],e.destinationCode=e.ROM[330],e.oldLicenseeCode=e.ROM[331],e.maskROMVersionNumber=e.ROM[332],e.headerChecksum=e.ROM[333],e.globalChecksum=e.ROM.slice(334,336),e})()}_initializeConstants(){return this.worker.postMessage({type:ve}).then(e=>{const t=Ke(e);Object.keys(this).forEach(e=>{void 0!==t.message[e]&&(this[e]=t.message[e])})})}_indexOfSaveStateIndexInSaveStates(e,t){let n=t.indexOf(e);if(n<0){const r=(e,t)=>JSON.stringify(Object.keys(e))===JSON.stringify(Object.keys(t)),o=(e,t)=>e.date===t.date,i=(e,t)=>e.isAuto===t.isAuto;t.some((t,s)=>!!(r(e,t)&&o(e,t)&&i(e,t))&&(n=s,!0))}return n}};function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){var r=n[t];t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}))}return e}let bt={DPAD_UP:"DPAD_UP",DPAD_RIGHT:"DPAD_RIGHT",DPAD_DOWN:"DPAD_DOWN",DPAD_LEFT:"DPAD_LEFT",LEFT_ANALOG_HORIZONTAL_AXIS:"LEFT_ANALOG_HORIZONTAL_AXIS",LEFT_ANALOG_VERTICAL_AXIS:"LEFT_ANALOG_VERTICAL_AXIS",LEFT_ANALOG_UP:"LEFT_ANALOG_UP",LEFT_ANALOG_RIGHT:"LEFT_ANALOG_RIGHT",LEFT_ANALOG_DOWN:"LEFT_ANALOG_DOWN",LEFT_ANALOG_LEFT:"LEFT_ANALOG_LEFT",RIGHT_ANALOG_HORIZONTAL_AXIS:"RIGHT_ANALOG_HORIZONTAL_AXIS",RIGHT_ANALOG_VERTICAL_AXIS:"RIGHT_ANALOG_VERTICAL_AXIS",RIGHT_ANALOG_UP:"RIGHT_ANALOG_UP",RIGHT_ANALOG_RIGHT:"RIGHT_ANALOG_RIGHT",RIGHT_ANALOG_DOWN:"RIGHT_ANALOG_DOWN",RIGHT_ANALOG_LEFT:"RIGHT_ANALOG_LEFT",A:"A",B:"B",X:"X",Y:"Y",LEFT_TRIGGER:"LEFT_TRIGGER",LEFT_BUMPER:"LEFT_BUMPER",RIGHT_TRIGGER:"RIGHT_TRIGGER",RIGHT_BUMPER:"RIGHT_BUMPER",SELECT:"SELECT",START:"START",SPECIAL:"SPECIAL"};class wt{constructor(){}enable(){throw Error("enable() must be overridden")}disable(){throw Error("disable() must be overridden")}getState(){throw Error("getState() must be overridden")}}let At="input textarea button select option optgroup label datalist".split(" "),_t=["Alt","Control","Meta","OS"];class St extends wt{constructor(){super(),this.keymap={},Object.keys(bt).forEach(e=>{this.keymap[e]={keys:[],value:void 0}}),this.enableIgnoreWhenInputElementFocused(),this.enableIgnoreWhenModifierState(),this._boundUpdateKeymapValues=this._updateKeymapValues.bind(this)}enable(){if("undefined"==typeof window)throw Error("Keyboard can only be used with a browser environment");window.addEventListener("keyup",this._boundUpdateKeymapValues),window.addEventListener("keydown",this._boundUpdateKeymapValues)}disable(){if("undefined"==typeof window)throw Error("Keyboard can only be used with a browser environment");window.removeEventListener("keyup",this._boundUpdateKeymapValues),window.removeEventListener("keydown",this._boundUpdateKeymapValues)}getState(){let e=vt({},bt);return Object.keys(this.keymap).forEach(t=>{e[t]=this.keymap[t].value}),Object.keys(e).forEach(t=>{"string"==typeof e[t]&&delete e[t]}),e}enableIgnoreWhenInputElementFocused(){this.ignoreWhenInputElementFocused=!0}disableIgnoreWhenInputElementFocused(){this.ignoreWhenInputElementFocused=!1}enableIgnoreWhenModifierState(){this.ignoreOnModifierState=!0}disableIgnoreWhenModifierState(){this.ignoreOnModifierState=!1}setKeysToResponsiveGamepadInput(e,t){if(!e||!t||0===e.length)throw Error("Could not set the specificed keyboard keys to input");"string"==typeof e&&(e=[e]),this.keymap[t].keys=e}_isFocusedOnInputElement(){return At.some(e=>!(!document.activeElement||document.activeElement.tagName.toLowerCase()!==e.toLowerCase()))}_isInModifierState(e){return _t.some(t=>e.getModifierState(t)||e.code===t)}_updateKeymapValues(e){this.ignoreWhenInputElementFocused&&this._isFocusedOnInputElement()||this.ignoreOnModifierState&&this._isInModifierState(e)||(e.preventDefault(),Object.keys(this.keymap).some(t=>this.keymap[t].keys.some(n=>n===e.code&&(this.keymap[t].value="keydown"===e.type,!0))))}}class Tt extends wt{constructor(){super(),this.gamepadAnalogStickDeadZone=.25,this.keymap={}}enable(){}disable(){}getState(e){e||(e=0);let t=this._getGamepads()[e];if(!t)return!1;Object.keys(this.keymap).forEach(e=>{if(this.keymap[e].buttons)this.keymap[e].value=this.keymap[e].buttons.some(e=>this._isButtonPressed(t,e));else if(this.keymap[e].axis){let n=this._getAnalogStickAxis(t,this.keymap[e].axis);this.keymap[e].value=n}});let n=vt({},bt);return Object.keys(this.keymap).forEach(e=>{n[e]=this.keymap[e].value}),n[bt.LEFT_ANALOG_DOWN]=n.LEFT_ANALOG_VERTICAL_AXIS>this.gamepadAnalogStickDeadZone,n[bt.LEFT_ANALOG_UP]=n.LEFT_ANALOG_VERTICAL_AXIS<-1*this.gamepadAnalogStickDeadZone,n[bt.LEFT_ANALOG_RIGHT]=n.LEFT_ANALOG_HORIZONTAL_AXIS>this.gamepadAnalogStickDeadZone,n[bt.LEFT_ANALOG_LEFT]=n.LEFT_ANALOG_HORIZONTAL_AXIS<-1*this.gamepadAnalogStickDeadZone,n[bt.RIGHT_ANALOG_DOWN]=n.RIGHT_ANALOG_VERTICAL_AXIS>this.gamepadAnalogStickDeadZone,n[bt.RIGHT_ANALOG_UP]=n.RIGHT_ANALOG_VERTICAL_AXIS<-1*this.gamepadAnalogStickDeadZone,n[bt.RIGHT_ANALOG_RIGHT]=n.RIGHT_ANALOG_HORIZONTAL_AXIS>this.gamepadAnalogStickDeadZone,n[bt.RIGHT_ANALOG_LEFT]=n.RIGHT_ANALOG_HORIZONTAL_AXIS<-1*this.gamepadAnalogStickDeadZone,Object.keys(n).forEach(e=>{"string"==typeof n[e]&&delete n[e]}),n}setGamepadButtonsToResponsiveGamepadInput(e,t){if(!e||!t||0===e.length)throw Error("Could not set the specificed buttons to input");"number"==typeof e&&(e=[e]),this.keymap[t]={},this.keymap[t].buttons=e}setGamepadAxisToResponsiveGamepadInput(e,t){if(void 0===e||!t)throw Error("Could not set the specificed buttons to input");if("number"==typeof axes)throw Error("Must pass in an axis id");this.keymap[t]={},this.keymap[t].axis=e}_isButtonPressed(e,t){return!!e.buttons[t]&&e.buttons[t].pressed}_getGamepads(){return navigator.getGamepads?navigator.getGamepads():[]}_getAnalogStickAxis(e,t){return e&&e.axes[t]||0}}let Et="touchstart touchmove touchend mousedown mousemove mouseup mouseleave".split(" ");class Ot{constructor(e){if(!e)throw Error("Touch inputs require an element.");this.listeners=[],this.element=e,this._addTouchStyles(),this.boundingClientRect=void 0,this._updateElementBoundingClientRect(),this.active=!1,this.boundUpdateElementRect=this._updateElementBoundingClientRect.bind(this),this.boundTouchEvent=this._touchEvent.bind(this)}remove(){this._removeTouchStyles(),this.stopListening(),this.element=void 0}listen(){if(!this.element)throw Error("You must supply an element first with add()");window.addEventListener("resize",this.boundUpdateElementRect),Et.forEach(e=>{this.element.addEventListener(e,this.boundTouchEvent)})}stopListening(){if(!this.element)throw Error("You must supply an element first with add()");window.removeEventListener("resize",this.boundUpdateElementRect),Et.forEach(e=>{this.element.removeEventListener(e,this.boundTouchEvent)})}_touchEvent(e){if(e&&(!e.type.includes("touch")||e.touches)){e.preventDefault();var t="touchstart"===e.type||"touchmove"===e.type||"mousedown"===e.type,n="mousemove"===e.type,r=!t&&!n;this._updateActiveStatus(t,r),this._updateTouchStyles(t,n,r),this.onTouchEvent&&this.onTouchEvent(e,t,n,r)}}_updateElementBoundingClientRect(){this.boundingClientRect=this.element.getBoundingClientRect()}_addTouchStyles(){this.element.style.userSelect="none"}_removeTouchStyles(){this.element.style.userSelect=""}_updateTouchStyles(e,t){t||(e?this.element.classList.add("active"):this.element.classList.remove("active"))}_updateActiveStatus(e,t){this.active&&t?this.active=!1:!this.active&&e&&(this.active=!0)}}function Rt(e,t){let n;return e.type.includes("touch")?n=e.touches[0]:e.type.includes("mouse")&&(n=e),{rectCenterX:(t.right-t.left)/2,rectCenterY:(t.bottom-t.top)/2,touchX:n.clientX-t.left,touchY:n.clientY-t.top}}class It extends Ot{constructor(e,t){super(e),this.config=t||{allowMultipleDirections:!1},this._resetState()}_resetState(){this.state={DPAD_UP:!1,DPAD_RIGHT:!1,DPAD_DOWN:!1,DPAD_LEFT:!1}}onTouchEvent(e){if(this.active){var{rectCenterX:e,rectCenterY:t,touchX:n,touchY:r}=Rt(e,this.boundingClientRect);if(!(n>e+this.boundingClientRect.width/2+50)){this._resetState();var o=this.boundingClientRect.width/20,i=this.boundingClientRect.height/20;this.config.allowMultipleDirections?(this.setHorizontalState(n,o),this.setVerticalState(r,i)):Math.abs(e-n)+this.boundingClientRect.width/8>Math.abs(t-r)?this.setHorizontalState(n,o):this.setVerticalState(r)}}else this._resetState()}setHorizontalState(e,t){t&&Math.abs(this.boundingClientRect.width/2-e)<=t||(e<this.boundingClientRect.width/2?this.state.DPAD_LEFT=!0:this.state.DPAD_RIGHT=!0)}setVerticalState(e,t){t&&Math.abs(this.boundingClientRect.height/2-e)<t||(e<this.boundingClientRect.height/2?this.state.DPAD_UP=!0:this.state.DPAD_DOWN=!0)}}class Ct extends Ot{constructor(e){super(e),this._resetState()}_resetState(){this.state={HORIZONTAL_AXIS:0,VERTICAL_AXIS:0,UP:!1,RIGHT:!1,DOWN:!1,LEFT:!1},this.element.style.transform="translate(0px, 0px)",this.deadzone=.5}onTouchEvent(e){if(this.active){var{rectCenterX:e,rectCenterY:t,touchX:n,touchY:r}=Rt(e,this.boundingClientRect);1<(n=(n-e)/e)?n=1:-1>n&&(n=-1),1<(r=(r-t)/t)?r=1:-1>r&&(r=-1),this.element.style.transform=`translate(${e*n/2}px, ${t*r/2}px)`,this.state.HORIZONTAL_AXIS=n,this.state.VERTICAL_AXIS=r,this.state.UP=!1,this.state.RIGHT=!1,this.state.DOWN=!1,this.state.LEFT=!1,Math.abs(n)>this.deadzone&&(0<n?this.state.RIGHT=!0:0>n&&(this.state.LEFT=!0)),Math.abs(r)>this.deadzone&&(0<r?this.state.DOWN=!0:0>r&&(this.state.UP=!0))}else this._resetState()}}class Lt extends Ot{constructor(e,t){super(e),this.input=t}}let Mt="LEFT",kt="RIGHT";class Gt extends wt{constructor(){super(),this.enabled=!1,this.dpads=[],this.leftAnalogs=[],this.rightAnalogs=[],this.buttons=[]}enable(){if("undefined"==typeof window)throw Error("TouchInput can only be used with a browser environment");this.enabled=!0,this.dpads.forEach(e=>e.listen()),this.leftAnalogs.forEach(e=>e.listen()),this.rightAnalogs.forEach(e=>e.listen()),this.buttons.forEach(e=>e.listen())}disable(){if("undefined"==typeof window)throw Error("TouchInput can only be used with a browser environment");this.enabled=!1,this.dpads.forEach(e=>e.stopListening()),this.leftAnalogs.forEach(e=>e.stopListening()),this.rightAnalogs.forEach(e=>e.stopListening()),this.buttons.forEach(e=>e.stopListening())}getState(){let e=vt({},bt);return this.buttons.forEach(t=>{e[t.input]=t.active}),this.dpads.forEach(t=>{Object.keys(t.state).forEach(n=>{e[n]=t.state[n]||e[n]})}),0<this.leftAnalogs.length&&(e.LEFT_ANALOG_HORIZONTAL_AXIS=this.leftAnalogs[0].state.HORIZONTAL_AXIS,e.LEFT_ANALOG_VERTICAL_AXIS=this.leftAnalogs[0].state.VERTICAL_AXIS,e.LEFT_ANALOG_UP=this.leftAnalogs[0].state.UP,e.LEFT_ANALOG_RIGHT=this.leftAnalogs[0].state.RIGHT,e.LEFT_ANALOG_DOWN=this.leftAnalogs[0].state.DOWN,e.LEFT_ANALOG_LEFT=this.leftAnalogs[0].state.LEFT),0<this.rightAnalogs.length&&(e.RIGHT_ANALOG_HORIZONTAL_AXIS=this.rightAnalogs[0].state.HORIZONTAL_AXIS,e.RIGHT_ANALOG_VERTICAL_AXIS=this.rightAnalogs[0].state.VERTICAL_AXIS,e.RIGHT_ANALOG_UP=this.rightAnalogs[0].state.UP,e.RIGHT_ANALOG_RIGHT=this.rightAnalogs[0].state.RIGHT,e.RIGHT_ANALOG_DOWN=this.rightAnalogs[0].state.DOWN,e.RIGHT_ANALOG_LEFT=this.rightAnalogs[0].state.LEFT),Object.keys(e).forEach(t=>{"string"==typeof e[t]&&delete e[t]}),e}addButtonInput(e,t){let n=new Lt(e,t);return this.enabled&&n.listen(),this.buttons.push(n),()=>{n.stopListening(),this.buttons.splice(this.buttons.indexOf(n),1)}}addDpadInput(e,t){let n=new It(e,t);return this.enabled&&n.listen(),this.dpads.push(n),()=>{n.stopListening(),this.dpads.splice(this.dpads.indexOf(n),1)}}addLeftAnalogInput(e){this.addAnalogInput(e,Mt)}addRightAnalogInput(e){this.addAnalogInput(e,kt)}addAnalogInput(e,t){let n=new Ct(e);return this.enabled&&n.listen(),t===Mt?(this.leftAnalogs.push(n),()=>{n.stopListening(),this.leftAnalogs.splice(this.leftAnalogs.indexOf(n),1)}):(this.rightAnalogs.push(n),()=>{n.stopListening(),this.rightAnalogs.splice(this.rightAnalogs.indexOf(n),1)})}}var xt=new class{constructor(){this.RESPONSIVE_GAMEPAD_INPUTS=bt,this._enabled=!1,this._multipleDirectionInput=!0,this.Keyboard=new St,this.Gamepad=new Tt,this.TouchInput=new Gt,this.Keyboard.setKeysToResponsiveGamepadInput(["ArrowUp","Numpad8"],bt.DPAD_UP),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyW"],bt.LEFT_ANALOG_UP),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyI"],bt.RIGHT_ANALOG_UP),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([12],bt.DPAD_UP),this.Keyboard.setKeysToResponsiveGamepadInput(["ArrowRight","Numpad6"],bt.DPAD_RIGHT),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyD"],bt.LEFT_ANALOG_RIGHT),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyL"],bt.RIGHT_ANALOG_RIGHT),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([15],bt.DPAD_RIGHT),this.Keyboard.setKeysToResponsiveGamepadInput(["ArrowDown","Numpad5","Numpad2"],bt.DPAD_DOWN),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyS"],bt.LEFT_ANALOG_DOWN),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyK"],bt.RIGHT_ANALOG_DOWN),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([13],bt.DPAD_DOWN),this.Keyboard.setKeysToResponsiveGamepadInput(["ArrowLeft","Numpad4"],bt.DPAD_LEFT),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyA"],bt.LEFT_ANALOG_LEFT),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyJ"],bt.RIGHT_ANALOG_LEFT),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([14],bt.DPAD_LEFT),this.Gamepad.setGamepadAxisToResponsiveGamepadInput([0],bt.LEFT_ANALOG_HORIZONTAL_AXIS),this.Gamepad.setGamepadAxisToResponsiveGamepadInput([1],bt.LEFT_ANALOG_VERTICAL_AXIS),this.Gamepad.setGamepadAxisToResponsiveGamepadInput([2],bt.RIGHT_ANALOG_HORIZONTAL_AXIS),this.Gamepad.setGamepadAxisToResponsiveGamepadInput([3],bt.RIGHT_ANALOG_VERTICAL_AXIS),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyX","Semicolon","Numpad7"],bt.A),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([0],bt.A),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyZ","Escape","Quote","Backspace","Numpad9"],bt.B),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([1],bt.B),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyC"],bt.X),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([2],bt.X),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyV"],bt.Y),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([3],bt.Y),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyQ"],bt.LEFT_TRIGGER),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([6],bt.LEFT_TRIGGER),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyE"],bt.LEFT_BUMPER),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([4],bt.LEFT_BUMPER),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyU"],bt.RIGHT_TRIGGER),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([7],bt.RIGHT_TRIGGER),this.Keyboard.setKeysToResponsiveGamepadInput(["KeyO"],bt.RIGHT_BUMPER),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([5],bt.RIGHT_BUMPER),this.Keyboard.setKeysToResponsiveGamepadInput(["Enter","Numpad3"],bt.START),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([9],bt.START),this.Keyboard.setKeysToResponsiveGamepadInput(["ShiftRight","ShiftLeft","Tab","Numpad1"],bt.SELECT),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([8],bt.SELECT),this.Keyboard.setKeysToResponsiveGamepadInput(["Space","Backslash","Backquote"],bt.SPECIAL),this.Gamepad.setGamepadButtonsToResponsiveGamepadInput([16],bt.SPECIAL),this.plugins=[],this.inputChangeMap={},this.inputChangeOldState={},this.cancelInputChangeListener=void 0}getVersion(){return"1.0.0"}enable(){this.Keyboard.enable(),this.Gamepad.enable(),this.TouchInput.enable(),0<Object.keys(this.inputChangeMap).length&&this._startInputChangeInterval(),this._enabled=!0}disable(){this.Keyboard.disable(),this.Gamepad.disable(),this.TouchInput.disable(),this.cancelInputChangeListener&&(this.cancelInputChangeListener(),this.cancelInputChangeListener=void 0),this._enabled=!1}isEnabled(){return this._enabled}addPlugin(e){return this.plugins.push(e),e.onAddPlugin&&e.onAddPlugin(),()=>{e.onRemovePlugin&&e.onRemovePlugin(),this.plugins.splice(this.plugins.indexOf(e),1)}}getState(){if(!this._enabled)return{};let e=vt({},bt),t=this.Gamepad.getState(),n=this.TouchInput.getState(),r=this.Keyboard.getState();return e=vt({},bt),Object.keys(e).forEach(o=>{e[o]=t[o]||n[o]||r[o]}),["LEFT","RIGHT"].forEach(t=>{[bt[t+"_ANALOG_HORIZONTAL_AXIS"],bt[t+"_ANALOG_VERTICAL_AXIS"]].forEach((n,r)=>{"number"!=typeof e[n]&&(0!==r&&2!==r||(e[n]=e[bt[t+"_ANALOG_RIGHT"]]?1:e[bt[t+"_ANALOG_LEFT"]]?-1:0),1!==r&&3!==r||(e[n]=e[bt[t+"_ANALOG_UP"]]?-1:e[bt[t+"_ANALOG_DOWN"]]?1:0))})}),e.UP=e.DPAD_UP||e.LEFT_ANALOG_UP,e.RIGHT=e.DPAD_RIGHT||e.LEFT_ANALOG_RIGHT,e.DOWN=e.DPAD_DOWN||e.LEFT_ANALOG_DOWN,e.LEFT=e.DPAD_LEFT||e.LEFT_ANALOG_LEFT,Object.keys(e).forEach(t=>{void 0!==e[t]&&"string"!=typeof e[t]||(e[t]=!1)}),this.plugins.forEach(t=>{t.onGetState&&(t=t.onGetState(e))&&(this.state=t)}),e}onInputsChange(e,t){return"string"==typeof e&&(e=[e]),this.inputChangeMap[e]={codes:e,callback:t},this.cancelInputChangeListener||this._startInputChangeInterval(),()=>{delete this.inputChangeMap[e]}}_startInputChangeInterval(){let e=setInterval(this._inputChangeIntervalHandler.bind(this),16);this.cancelInputChangeListener=()=>clearInterval(e)}_inputChangeIntervalHandler(){let e=this.getState(),t=[];Object.keys(e).forEach(n=>{e[n]!==this.inputChangeOldState[n]&&t.push(n)}),Object.keys(this.inputChangeMap).forEach(n=>{this.inputChangeMap[n].codes.some(e=>t.includes(e))&&this.inputChangeMap[n].callback(e)}),this.inputChangeOldState=e}};const Nt=new class{constructor(){this.worker=void 0,this.isEnabled=!1,this.ResponsiveGamepad=xt,xt.addPlugin({onGetState:e=>{const t=e.A,n=e.B;return e.A=t||e.X,e.B=n||e.Y,e}})}initialize(){return this.isEnabled||this.enableDefaultJoypad(),Promise.resolve()}setWorker(e){this.worker=e}updateController(){if(!this.isEnabled)return{};const e=xt.getState();return this.setJoypadState(e),e}setJoypadState(e){const t=[e.UP?1:0,e.RIGHT?1:0,e.DOWN?1:0,e.LEFT?1:0,e.A?1:0,e.B?1:0,e.SELECT?1:0,e.START?1:0];this.worker.postMessageIgnoreResponse({type:Oe,setJoypadStateParamsAsArray:t})}enableDefaultJoypad(){this.isEnabled=!0,xt.enable()}disableDefaultJoypad(){this.isEnabled=!1,xt.disable()}};let Bt=0;const Pt=()=>{const e=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10);Bt++;const t=`${e}-${Bt}`;return Bt>1e5&&(Bt=0),t};function Ft(e,t,n){return t||(t=Pt()),{workerId:n,messageId:t,message:e}}class Dt{constructor(e,t){this.id=Pt(),t&&(this.id=t),this.messageListeners=[],this.worker=new Worker(e),this.worker.onmessage=this._onMessageHandler.bind(this)}postMessageIgnoreResponse(e,t){const n=Ft(e,void 0,this.id);this.worker.postMessage(n,t)}postMessage(e,t,n){n||(n=1e3);const r=Ft(e,void 0,this.id),o=r.messageId,i=new Promise((t,r)=>{let i=setTimeout(()=>{console.warn("Message dropped",e),this.removeMessageListener(o),r()},n);this.addMessageListener((e,n)=>{const r=Ke(e);r.messageId===o&&(clearTimeout(i),i=void 0,this.removeMessageListener(n.id),t(r))})});return this.worker.postMessage(r,t),i}addMessageListener(e){this.messageListeners.push({id:Pt(),callback:e})}removeMessageListener(e){let t;this.messageListeners.some((n,r)=>n.id===e&&(t=r,!0)),void 0!==t&&this.messageListeners.splice(t,1)}_onMessageHandler(e){this.messageListeners.forEach(t=>{t.callback(e,t)})}}async function Ut(){if(this.initialized)return;this.ready=!1,this.loadedAndStarted=!1,await this._instantiateWorkers();const e=await this.worker.postMessage({type:fe});this.coreType=e.message.type,await yt.initialize(this.options.headless,this.options.maxNumberOfAutoSaveStates,this.options.saveStateCallback),await yt.clearMemory(),this.initialized=!0}function $t(e,t){const n=async()=>{!this.options.headless&&yt.getLoadedCartridgeMemoryState().RAM&&await yt.saveCartridgeRam();const n=await ut(e,t);if(await yt.loadCartridgeRom(n.ROM,n.name),this.options.enableBootROMIfAvailable){(await yt.getCartridgeInfo()).CGBFlag?await yt.loadBootROMIfAvailable(yt.SUPPORTED_BOOT_ROM_TYPES.GBC):await yt.loadBootROMIfAvailable(yt.SUPPORTED_BOOT_ROM_TYPES.GB)}this.loadedROM=e,await this.worker.postMessage({type:be,config:[yt.loadedCartridgeMemoryState.BOOT?1:0,this.options.isGbcEnabled?1:0,this.options.audioBatchProcessing?1:0,this.options.graphicsBatchProcessing?1:0,this.options.timersBatchProcessing?1:0,this.options.graphicsDisableScanlineRendering?1:0,this.options.audioAccumulateSamples?1:0,this.options.tileRendering?1:0,this.options.tileCaching?1:0,this.options.enableAudioDebugging?1:0],options:{gameboyFrameRate:this.options.gameboyFrameRate,headless:this.options.headless,isAudioEnabled:this.options.isAudioEnabled,isGbcColorizationEnabled:this.options.isGbcColorizationEnabled,gbcColorizationPalette:this.options.gbcColorizationPalette,enableAudioDebugging:this.options.enableAudioDebugging,frameSkip:this.options.frameSkip}})};return(async()=>{await this.pause(),await Ut.bind(this)(),this.options.headless?(await n(),this.ready=!0,this.options.onReady&&this.options.onReady(),he.runHook({key:"ready"})):(await Promise.all([qe.initialize(this.canvasElement,this.options.updateGraphicsCallback),Xe.initialize(this.options.updateAudioCallback),Nt.initialize()]),await n(),await yt.loadCartridgeRam(),this.ready=!0,this.options.onReady&&this.options.onReady(),he.runHook({key:"ready"}))})()}for(var Ht=nt((function(e){(function(){var t,n,r,o,i,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:"undefined"!=typeof process&&null!==process&&process.hrtime?(e.exports=function(){return(t()-i)/1e6},n=process.hrtime,o=(t=function(){var e;return 1e9*(e=n())[0]+e[1]})(),s=1e9*process.uptime(),i=o-s):Date.now?(e.exports=function(){return Date.now()-r},r=Date.now()):(e.exports=function(){return(new Date).getTime()-r},r=(new Date).getTime())}).call(tt)})),zt="undefined"==typeof window?tt:window,jt=["moz","webkit"],Wt="AnimationFrame",Kt=zt["request"+Wt],qt=zt["cancel"+Wt]||zt["cancelRequest"+Wt],Vt=0;!Kt&&Vt<jt.length;Vt++)Kt=zt[jt[Vt]+"Request"+Wt],qt=zt[jt[Vt]+"Cancel"+Wt]||zt[jt[Vt]+"CancelRequest"+Wt];if(!Kt||!qt){var Yt=0,Zt=0,Xt=[];Kt=function(e){if(0===Xt.length){var t=Ht(),n=Math.max(0,1e3/60-(t-Yt));Yt=n+t,setTimeout((function(){var e=Xt.slice(0);Xt.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(Yt)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return Xt.push({handle:++Zt,callback:e,cancelled:!1}),Zt},qt=function(e){for(var t=0;t<Xt.length;t++)Xt[t].handle===e&&(Xt[t].cancelled=!0)}}var Jt=function(e){return Kt.call(zt,e)};function Qt(){if(this.paused)return!0;let e=!1;this.frameSkip&&this.frameSkip>0&&(this.frameSkipCounter++,this.frameSkipCounter<this.frameSkip?e=!0:this.frameSkipCounter=0),e||qe.renderFrame(),Nt.updateController(),this.renderId=Jt(()=>{Qt.call(this)})}Jt.cancel=function(){qt.apply(zt,arguments)},Jt.polyfill=function(e){e||(e=zt),e.requestAnimationFrame=Kt,e.cancelAnimationFrame=qt};var en=nt((function(e){var t=function(e){var n=1e7,r=9007199254740992,o=d(r),i="function"==typeof BigInt;function s(e,t,n,r){return void 0===e?s[0]:void 0!==t&&(10!=+t||n)?U(e,t,n,r):W(e)}function a(e,t){this.value=e,this.sign=t,this.isSmall=!1}function l(e){this.value=e,this.sign=e<0,this.isSmall=!0}function u(e){this.value=e}function c(e){return-r<e&&e<r}function d(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function h(e){p(e);var t=e.length;if(t<4&&I(e,o)<0)switch(t){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*n;default:return e[0]+(e[1]+e[2]*n)*n}return e}function p(e){for(var t=e.length;0===e[--t];);e.length=t+1}function f(e){for(var t=new Array(e),n=-1;++n<e;)t[n]=0;return t}function g(e){return e>0?Math.floor(e):Math.ceil(e)}function m(e,t){var r,o,i=e.length,s=t.length,a=new Array(i),l=0,u=n;for(o=0;o<s;o++)l=(r=e[o]+t[o]+l)>=u?1:0,a[o]=r-l*u;for(;o<i;)l=(r=e[o]+l)===u?1:0,a[o++]=r-l*u;return l>0&&a.push(l),a}function y(e,t){return e.length>=t.length?m(e,t):m(t,e)}function v(e,t){var r,o,i=e.length,s=new Array(i),a=n;for(o=0;o<i;o++)r=e[o]-a+t,t=Math.floor(r/a),s[o]=r-t*a,t+=1;for(;t>0;)s[o++]=t%a,t=Math.floor(t/a);return s}function b(e,t){var n,r,o=e.length,i=t.length,s=new Array(o),a=0;for(n=0;n<i;n++)(r=e[n]-a-t[n])<0?(r+=1e7,a=1):a=0,s[n]=r;for(n=i;n<o;n++){if(!((r=e[n]-a)<0)){s[n++]=r;break}r+=1e7,s[n]=r}for(;n<o;n++)s[n]=e[n];return p(s),s}function w(e,t,n){var r,o,i=e.length,s=new Array(i),u=-t;for(r=0;r<i;r++)o=e[r]+u,u=Math.floor(o/1e7),o%=1e7,s[r]=o<0?o+1e7:o;return"number"==typeof(s=h(s))?(n&&(s=-s),new l(s)):new a(s,n)}function A(e,t){var n,r,o,i,s=e.length,a=t.length,l=f(s+a);for(o=0;o<s;++o){i=e[o];for(var u=0;u<a;++u)n=i*t[u]+l[o+u],r=Math.floor(n/1e7),l[o+u]=n-1e7*r,l[o+u+1]+=r}return p(l),l}function _(e,t){var r,o,i=e.length,s=new Array(i),a=n,l=0;for(o=0;o<i;o++)r=e[o]*t+l,l=Math.floor(r/a),s[o]=r-l*a;for(;l>0;)s[o++]=l%a,l=Math.floor(l/a);return s}function S(e,t){for(var n=[];t-- >0;)n.push(0);return n.concat(e)}function T(e,t,r){return new a(e<n?_(t,e):A(t,d(e)),r)}function E(e){var t,n,r,o,i=e.length,s=f(i+i);for(r=0;r<i;r++){n=0-(o=e[r])*o;for(var a=r;a<i;a++)t=o*e[a]*2+s[r+a]+n,n=Math.floor(t/1e7),s[r+a]=t-1e7*n;s[r+i]=n}return p(s),s}function O(e,t){var n,r,o,i,s=e.length,a=f(s);for(o=0,n=s-1;n>=0;--n)o=(i=1e7*o+e[n])-(r=g(i/t))*t,a[n]=0|r;return[a,0|o]}function R(e,t){var r,o=W(t);if(i)return[new u(e.value/o.value),new u(e.value%o.value)];var c,m=e.value,y=o.value;if(0===y)throw new Error("Cannot divide by zero");if(e.isSmall)return o.isSmall?[new l(g(m/y)),new l(m%y)]:[s[0],e];if(o.isSmall){if(1===y)return[e,s[0]];if(-1==y)return[e.negate(),s[0]];var v=Math.abs(y);if(v<n){c=h((r=O(m,v))[0]);var w=r[1];return e.sign&&(w=-w),"number"==typeof c?(e.sign!==o.sign&&(c=-c),[new l(c),new l(w)]):[new a(c,e.sign!==o.sign),new l(w)]}y=d(v)}var A=I(m,y);if(-1===A)return[s[0],e];if(0===A)return[s[e.sign===o.sign?1:-1],s[0]];c=(r=m.length+y.length<=200?function(e,t){var r,o,i,s,a,l,u,c=e.length,d=t.length,p=n,g=f(t.length),m=t[d-1],y=Math.ceil(p/(2*m)),v=_(e,y),b=_(t,y);for(v.length<=c&&v.push(0),b.push(0),m=b[d-1],o=c-d;o>=0;o--){for(r=p-1,v[o+d]!==m&&(r=Math.floor((v[o+d]*p+v[o+d-1])/m)),i=0,s=0,l=b.length,a=0;a<l;a++)i+=r*b[a],u=Math.floor(i/p),s+=v[o+a]-(i-u*p),i=u,s<0?(v[o+a]=s+p,s=-1):(v[o+a]=s,s=0);for(;0!==s;){for(r-=1,i=0,a=0;a<l;a++)(i+=v[o+a]-p+b[a])<0?(v[o+a]=i+p,i=0):(v[o+a]=i,i=1);s+=i}g[o]=r}return v=O(v,y)[0],[h(g),h(v)]}(m,y):function(e,t){for(var n,r,o,i,s,a=e.length,l=t.length,u=[],c=[];a;)if(c.unshift(e[--a]),p(c),I(c,t)<0)u.push(0);else{o=1e7*c[(r=c.length)-1]+c[r-2],i=1e7*t[l-1]+t[l-2],r>l&&(o=1e7*(o+1)),n=Math.ceil(o/i);do{if(I(s=_(t,n),c)<=0)break;n--}while(n);u.push(n),c=b(c,s)}return u.reverse(),[h(u),h(c)]}(m,y))[0];var S=e.sign!==o.sign,T=r[1],E=e.sign;return"number"==typeof c?(S&&(c=-c),c=new l(c)):c=new a(c,S),"number"==typeof T?(E&&(T=-T),T=new l(T)):T=new a(T,E),[c,T]}function I(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var n=e.length-1;n>=0;n--)if(e[n]!==t[n])return e[n]>t[n]?1:-1;return 0}function C(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function L(e,n){for(var r,o,i,s=e.prev(),a=s,l=0;a.isEven();)a=a.divide(2),l++;e:for(o=0;o<n.length;o++)if(!e.lesser(n[o])&&!(i=t(n[o]).modPow(a,e)).isUnit()&&!i.equals(s)){for(r=l-1;0!=r;r--){if((i=i.square().mod(e)).isUnit())return!1;if(i.equals(s))continue e}return!1}return!0}a.prototype=Object.create(s.prototype),l.prototype=Object.create(s.prototype),u.prototype=Object.create(s.prototype),a.prototype.add=function(e){var t=W(e);if(this.sign!==t.sign)return this.subtract(t.negate());var n=this.value,r=t.value;return t.isSmall?new a(v(n,Math.abs(r)),this.sign):new a(y(n,r),this.sign)},a.prototype.plus=a.prototype.add,l.prototype.add=function(e){var t=W(e),n=this.value;if(n<0!==t.sign)return this.subtract(t.negate());var r=t.value;if(t.isSmall){if(c(n+r))return new l(n+r);r=d(Math.abs(r))}return new a(v(r,Math.abs(n)),n<0)},l.prototype.plus=l.prototype.add,u.prototype.add=function(e){return new u(this.value+W(e).value)},u.prototype.plus=u.prototype.add,a.prototype.subtract=function(e){var t=W(e);if(this.sign!==t.sign)return this.add(t.negate());var n=this.value,r=t.value;return t.isSmall?w(n,Math.abs(r),this.sign):function(e,t,n){var r;return I(e,t)>=0?r=b(e,t):(r=b(t,e),n=!n),"number"==typeof(r=h(r))?(n&&(r=-r),new l(r)):new a(r,n)}(n,r,this.sign)},a.prototype.minus=a.prototype.subtract,l.prototype.subtract=function(e){var t=W(e),n=this.value;if(n<0!==t.sign)return this.add(t.negate());var r=t.value;return t.isSmall?new l(n-r):w(r,Math.abs(n),n>=0)},l.prototype.minus=l.prototype.subtract,u.prototype.subtract=function(e){return new u(this.value-W(e).value)},u.prototype.minus=u.prototype.subtract,a.prototype.negate=function(){return new a(this.value,!this.sign)},l.prototype.negate=function(){var e=this.sign,t=new l(-this.value);return t.sign=!e,t},u.prototype.negate=function(){return new u(-this.value)},a.prototype.abs=function(){return new a(this.value,!1)},l.prototype.abs=function(){return new l(Math.abs(this.value))},u.prototype.abs=function(){return new u(this.value>=0?this.value:-this.value)},a.prototype.multiply=function(e){var t,r,o,i=W(e),l=this.value,u=i.value,c=this.sign!==i.sign;if(i.isSmall){if(0===u)return s[0];if(1===u)return this;if(-1===u)return this.negate();if((t=Math.abs(u))<n)return new a(_(l,t),c);u=d(t)}return r=l.length,o=u.length,new a(-.012*r-.012*o+15e-6*r*o>0?function e(t,n){var r=Math.max(t.length,n.length);if(r<=30)return A(t,n);r=Math.ceil(r/2);var o=t.slice(r),i=t.slice(0,r),s=n.slice(r),a=n.slice(0,r),l=e(i,a),u=e(o,s),c=e(y(i,o),y(a,s)),d=y(y(l,S(b(b(c,l),u),r)),S(u,2*r));return p(d),d}(l,u):A(l,u),c)},a.prototype.times=a.prototype.multiply,l.prototype._multiplyBySmall=function(e){return c(e.value*this.value)?new l(e.value*this.value):T(Math.abs(e.value),d(Math.abs(this.value)),this.sign!==e.sign)},a.prototype._multiplyBySmall=function(e){return 0===e.value?s[0]:1===e.value?this:-1===e.value?this.negate():T(Math.abs(e.value),this.value,this.sign!==e.sign)},l.prototype.multiply=function(e){return W(e)._multiplyBySmall(this)},l.prototype.times=l.prototype.multiply,u.prototype.multiply=function(e){return new u(this.value*W(e).value)},u.prototype.times=u.prototype.multiply,a.prototype.square=function(){return new a(E(this.value),!1)},l.prototype.square=function(){var e=this.value*this.value;return c(e)?new l(e):new a(E(d(Math.abs(this.value))),!1)},u.prototype.square=function(e){return new u(this.value*this.value)},a.prototype.divmod=function(e){var t=R(this,e);return{quotient:t[0],remainder:t[1]}},u.prototype.divmod=l.prototype.divmod=a.prototype.divmod,a.prototype.divide=function(e){return R(this,e)[0]},u.prototype.over=u.prototype.divide=function(e){return new u(this.value/W(e).value)},l.prototype.over=l.prototype.divide=a.prototype.over=a.prototype.divide,a.prototype.mod=function(e){return R(this,e)[1]},u.prototype.mod=u.prototype.remainder=function(e){return new u(this.value%W(e).value)},l.prototype.remainder=l.prototype.mod=a.prototype.remainder=a.prototype.mod,a.prototype.pow=function(e){var t,n,r,o=W(e),i=this.value,a=o.value;if(0===a)return s[1];if(0===i)return s[0];if(1===i)return s[1];if(-1===i)return o.isEven()?s[1]:s[-1];if(o.sign)return s[0];if(!o.isSmall)throw new Error("The exponent "+o.toString()+" is too large.");if(this.isSmall&&c(t=Math.pow(i,a)))return new l(g(t));for(n=this,r=s[1];!0&a&&(r=r.times(n),--a),0!==a;)a/=2,n=n.square();return r},l.prototype.pow=a.prototype.pow,u.prototype.pow=function(e){var t=W(e),n=this.value,r=t.value,o=BigInt(0),i=BigInt(1),a=BigInt(2);if(r===o)return s[1];if(n===o)return s[0];if(n===i)return s[1];if(n===BigInt(-1))return t.isEven()?s[1]:s[-1];if(t.isNegative())return new u(o);for(var l=this,c=s[1];(r&i)===i&&(c=c.times(l),--r),r!==o;)r/=a,l=l.square();return c},a.prototype.modPow=function(e,t){if(e=W(e),(t=W(t)).isZero())throw new Error("Cannot take modPow with modulus 0");var n=s[1],r=this.mod(t);for(e.isNegative()&&(e=e.multiply(s[-1]),r=r.modInv(t));e.isPositive();){if(r.isZero())return s[0];e.isOdd()&&(n=n.multiply(r).mod(t)),e=e.divide(2),r=r.square().mod(t)}return n},u.prototype.modPow=l.prototype.modPow=a.prototype.modPow,a.prototype.compareAbs=function(e){var t=W(e),n=this.value,r=t.value;return t.isSmall?1:I(n,r)},l.prototype.compareAbs=function(e){var t=W(e),n=Math.abs(this.value),r=t.value;return t.isSmall?n===(r=Math.abs(r))?0:n>r?1:-1:-1},u.prototype.compareAbs=function(e){var t=this.value,n=W(e).value;return(t=t>=0?t:-t)===(n=n>=0?n:-n)?0:t>n?1:-1},a.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=W(e),n=this.value,r=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:I(n,r)*(this.sign?-1:1)},a.prototype.compareTo=a.prototype.compare,l.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=W(e),n=this.value,r=t.value;return t.isSmall?n==r?0:n>r?1:-1:n<0!==t.sign?n<0?-1:1:n<0?1:-1},l.prototype.compareTo=l.prototype.compare,u.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,n=W(e).value;return t===n?0:t>n?1:-1},u.prototype.compareTo=u.prototype.compare,a.prototype.equals=function(e){return 0===this.compare(e)},u.prototype.eq=u.prototype.equals=l.prototype.eq=l.prototype.equals=a.prototype.eq=a.prototype.equals,a.prototype.notEquals=function(e){return 0!==this.compare(e)},u.prototype.neq=u.prototype.notEquals=l.prototype.neq=l.prototype.notEquals=a.prototype.neq=a.prototype.notEquals,a.prototype.greater=function(e){return this.compare(e)>0},u.prototype.gt=u.prototype.greater=l.prototype.gt=l.prototype.greater=a.prototype.gt=a.prototype.greater,a.prototype.lesser=function(e){return this.compare(e)<0},u.prototype.lt=u.prototype.lesser=l.prototype.lt=l.prototype.lesser=a.prototype.lt=a.prototype.lesser,a.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},u.prototype.geq=u.prototype.greaterOrEquals=l.prototype.geq=l.prototype.greaterOrEquals=a.prototype.geq=a.prototype.greaterOrEquals,a.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},u.prototype.leq=u.prototype.lesserOrEquals=l.prototype.leq=l.prototype.lesserOrEquals=a.prototype.leq=a.prototype.lesserOrEquals,a.prototype.isEven=function(){return 0==(1&this.value[0])},l.prototype.isEven=function(){return 0==(1&this.value)},u.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},a.prototype.isOdd=function(){return 1==(1&this.value[0])},l.prototype.isOdd=function(){return 1==(1&this.value)},u.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},a.prototype.isPositive=function(){return!this.sign},l.prototype.isPositive=function(){return this.value>0},u.prototype.isPositive=l.prototype.isPositive,a.prototype.isNegative=function(){return this.sign},l.prototype.isNegative=function(){return this.value<0},u.prototype.isNegative=l.prototype.isNegative,a.prototype.isUnit=function(){return!1},l.prototype.isUnit=function(){return 1===Math.abs(this.value)},u.prototype.isUnit=function(){return this.abs().value===BigInt(1)},a.prototype.isZero=function(){return!1},l.prototype.isZero=function(){return 0===this.value},u.prototype.isZero=function(){return this.value===BigInt(0)},a.prototype.isDivisibleBy=function(e){var t=W(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},u.prototype.isDivisibleBy=l.prototype.isDivisibleBy=a.prototype.isDivisibleBy,a.prototype.isPrime=function(e){var n=C(this);if(void 0!==n)return n;var r=this.abs(),o=r.bitLength();if(o<=64)return L(r,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var i=Math.log(2)*o.toJSNumber(),s=Math.ceil(!0===e?2*Math.pow(i,2):i),a=[],l=0;l<s;l++)a.push(t(l+2));return L(r,a)},u.prototype.isPrime=l.prototype.isPrime=a.prototype.isPrime,a.prototype.isProbablePrime=function(e,n){var r=C(this);if(void 0!==r)return r;for(var o=this.abs(),i=void 0===e?5:e,s=[],a=0;a<i;a++)s.push(t.randBetween(2,o.minus(2),n));return L(o,s)},u.prototype.isProbablePrime=l.prototype.isProbablePrime=a.prototype.isProbablePrime,a.prototype.modInv=function(e){for(var n,r,o,i=t.zero,s=t.one,a=W(e),l=this.abs();!l.isZero();)n=a.divide(l),r=i,o=a,i=s,a=l,s=r.subtract(n.multiply(s)),l=o.subtract(n.multiply(l));if(!a.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return-1===i.compare(0)&&(i=i.add(e)),this.isNegative()?i.negate():i},u.prototype.modInv=l.prototype.modInv=a.prototype.modInv,a.prototype.next=function(){var e=this.value;return this.sign?w(e,1,this.sign):new a(v(e,1),this.sign)},l.prototype.next=function(){var e=this.value;return e+1<r?new l(e+1):new a(o,!1)},u.prototype.next=function(){return new u(this.value+BigInt(1))},a.prototype.prev=function(){var e=this.value;return this.sign?new a(v(e,1),!0):w(e,1,this.sign)},l.prototype.prev=function(){var e=this.value;return e-1>-r?new l(e-1):new a(o,!0)},u.prototype.prev=function(){return new u(this.value-BigInt(1))};for(var M=[1];2*M[M.length-1]<=n;)M.push(2*M[M.length-1]);var k=M.length,G=M[k-1];function x(e){return Math.abs(e)<=n}function N(e,n,r){n=W(n);for(var o=e.isNegative(),i=n.isNegative(),s=o?e.not():e,a=i?n.not():n,l=0,u=0,c=null,d=null,h=[];!s.isZero()||!a.isZero();)l=(c=R(s,G))[1].toJSNumber(),o&&(l=G-1-l),u=(d=R(a,G))[1].toJSNumber(),i&&(u=G-1-u),s=c[0],a=d[0],h.push(r(l,u));for(var p=0!==r(o?1:0,i?1:0)?t(-1):t(0),f=h.length-1;f>=0;f-=1)p=p.multiply(G).add(t(h[f]));return p}a.prototype.shiftLeft=function(e){var t=W(e).toJSNumber();if(!x(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var n=this;if(n.isZero())return n;for(;t>=k;)n=n.multiply(G),t-=k-1;return n.multiply(M[t])},u.prototype.shiftLeft=l.prototype.shiftLeft=a.prototype.shiftLeft,a.prototype.shiftRight=function(e){var t,n=W(e).toJSNumber();if(!x(n))throw new Error(String(n)+" is too large for shifting.");if(n<0)return this.shiftLeft(-n);for(var r=this;n>=k;){if(r.isZero()||r.isNegative()&&r.isUnit())return r;r=(t=R(r,G))[1].isNegative()?t[0].prev():t[0],n-=k-1}return(t=R(r,M[n]))[1].isNegative()?t[0].prev():t[0]},u.prototype.shiftRight=l.prototype.shiftRight=a.prototype.shiftRight,a.prototype.not=function(){return this.negate().prev()},u.prototype.not=l.prototype.not=a.prototype.not,a.prototype.and=function(e){return N(this,e,(function(e,t){return e&t}))},u.prototype.and=l.prototype.and=a.prototype.and,a.prototype.or=function(e){return N(this,e,(function(e,t){return e|t}))},u.prototype.or=l.prototype.or=a.prototype.or,a.prototype.xor=function(e){return N(this,e,(function(e,t){return e^t}))},u.prototype.xor=l.prototype.xor=a.prototype.xor;function B(e){var t=e.value,r="number"==typeof t?t|1<<30:"bigint"==typeof t?t|BigInt(1<<30):t[0]+t[1]*n|1073758208;return r&-r}function P(e,t){return e=W(e),t=W(t),e.greater(t)?e:t}function F(e,t){return e=W(e),t=W(t),e.lesser(t)?e:t}function D(e,t){if(e=W(e).abs(),t=W(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var n,r,o=s[1];e.isEven()&&t.isEven();)n=F(B(e),B(t)),e=e.divide(n),t=t.divide(n),o=o.multiply(n);for(;e.isEven();)e=e.divide(B(e));do{for(;t.isEven();)t=t.divide(B(t));e.greater(t)&&(r=t,t=e,e=r),t=t.subtract(e)}while(!t.isZero());return o.isUnit()?e:e.multiply(o)}a.prototype.bitLength=function(){var e=this;return e.compareTo(t(0))<0&&(e=e.negate().subtract(t(1))),0===e.compareTo(t(0))?t(0):t(function e(n,r){if(r.compareTo(n)<=0){var o=e(n,r.square(r)),i=o.p,s=o.e,a=i.multiply(r);return a.compareTo(n)<=0?{p:a,e:2*s+1}:{p:i,e:2*s}}return{p:t(1),e:0}}(e,t(2)).e).add(t(1))},u.prototype.bitLength=l.prototype.bitLength=a.prototype.bitLength;var U=function(e,t,n,r){n=n||"0123456789abcdefghijklmnopqrstuvwxyz",e=String(e),r||(e=e.toLowerCase(),n=n.toLowerCase());var o,i=e.length,s=Math.abs(t),a={};for(o=0;o<n.length;o++)a[n[o]]=o;for(o=0;o<i;o++){if("-"!==(c=e[o])&&(c in a&&a[c]>=s)){if("1"===c&&1===s)continue;throw new Error(c+" is not a valid digit in base "+t+".")}}t=W(t);var l=[],u="-"===e[0];for(o=u?1:0;o<e.length;o++){var c;if((c=e[o])in a)l.push(W(a[c]));else{if("<"!==c)throw new Error(c+" is not a valid character");var d=o;do{o++}while(">"!==e[o]&&o<e.length);l.push(W(e.slice(d+1,o)))}}return $(l,t,u)};function $(e,t,n){var r,o=s[0],i=s[1];for(r=e.length-1;r>=0;r--)o=o.add(e[r].times(i)),i=i.times(t);return n?o.negate():o}function H(e,n){if((n=t(n)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(n.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var o=!1;if(e.isNegative()&&n.isPositive()&&(o=!0,e=e.abs()),n.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:o};for(var i,s=[],a=e;a.isNegative()||a.compareAbs(n)>=0;){i=a.divmod(n),a=i.quotient;var l=i.remainder;l.isNegative()&&(l=n.minus(l).abs(),a=a.next()),s.push(l.toJSNumber())}return s.push(a.toJSNumber()),{value:s.reverse(),isNegative:o}}function z(e,t,n){var r=H(e,t);return(r.isNegative?"-":"")+r.value.map((function(e){return function(e,t){return e<(t=t||"0123456789abcdefghijklmnopqrstuvwxyz").length?t[e]:"<"+e+">"}(e,n)})).join("")}function j(e){if(c(+e)){var t=+e;if(t===g(t))return i?new u(BigInt(t)):new l(t);throw new Error("Invalid integer: "+e)}var n="-"===e[0];n&&(e=e.slice(1));var r=e.split(/e/i);if(r.length>2)throw new Error("Invalid integer: "+r.join("e"));if(2===r.length){var o=r[1];if("+"===o[0]&&(o=o.slice(1)),(o=+o)!==g(o)||!c(o))throw new Error("Invalid integer: "+o+" is not a valid exponent.");var s=r[0],d=s.indexOf(".");if(d>=0&&(o-=s.length-d-1,s=s.slice(0,d)+s.slice(d+1)),o<0)throw new Error("Cannot include negative exponent part for integers");e=s+=new Array(o+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(i)return new u(BigInt(n?"-"+e:e));for(var h=[],f=e.length,m=f-7;f>0;)h.push(+e.slice(m,f)),(m-=7)<0&&(m=0),f-=7;return p(h),new a(h,n)}function W(e){return"number"==typeof e?function(e){if(i)return new u(BigInt(e));if(c(e)){if(e!==g(e))throw new Error(e+" is not an integer.");return new l(e)}return j(e.toString())}(e):"string"==typeof e?j(e):"bigint"==typeof e?new u(e):e}a.prototype.toArray=function(e){return H(this,e)},l.prototype.toArray=function(e){return H(this,e)},u.prototype.toArray=function(e){return H(this,e)},a.prototype.toString=function(e,t){if(void 0===e&&(e=10),10!==e)return z(this,e,t);for(var n,r=this.value,o=r.length,i=String(r[--o]);--o>=0;)n=String(r[o]),i+="0000000".slice(n.length)+n;return(this.sign?"-":"")+i},l.prototype.toString=function(e,t){return void 0===e&&(e=10),10!=e?z(this,e,t):String(this.value)},u.prototype.toString=l.prototype.toString,u.prototype.toJSON=a.prototype.toJSON=l.prototype.toJSON=function(){return this.toString()},a.prototype.valueOf=function(){return parseInt(this.toString(),10)},a.prototype.toJSNumber=a.prototype.valueOf,l.prototype.valueOf=function(){return this.value},l.prototype.toJSNumber=l.prototype.valueOf,u.prototype.valueOf=u.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var K=0;K<1e3;K++)s[K]=W(K),K>0&&(s[-K]=W(-K));return s.one=s[1],s.zero=s[0],s.minusOne=s[-1],s.max=P,s.min=F,s.gcd=D,s.lcm=function(e,t){return e=W(e).abs(),t=W(t).abs(),e.divide(D(e,t)).multiply(t)},s.isInstance=function(e){return e instanceof a||e instanceof l||e instanceof u},s.randBetween=function(e,t,r){e=W(e),t=W(t);var o=r||Math.random,i=F(e,t),a=P(e,t).subtract(i).add(1);if(a.isSmall)return i.add(Math.floor(o()*a));for(var l=H(a,n).value,u=[],c=!0,d=0;d<l.length;d++){var h=c?l[d]:n,p=g(o()*h);u.push(p),p<h&&(c=!1)}return i.add(s.fromArray(u,n,!1))},s.fromArray=function(e,t,n){return $(e.map(W),W(t||10),n)},s}();e.hasOwnProperty("exports")&&(e.exports=t)}));let tn=void 0;const nn=()=>{cn.worker.postMessage({type:Me}),qe.renderFrame()},rn=async(e,t,n)=>{if(!cn.worker)return;return Ke(await cn.worker.postMessage({type:Ie,export:e,parameters:t},void 0,n)).message.response},on=async(e,t)=>{if(!cn.worker)return;const n=Ke(await cn.worker.postMessage({type:Ce,start:e,end:t}));return new Uint8Array(n.message.response)},sn=async e=>{if(!cn.worker)return;return Ke(await cn.worker.postMessage({type:Le,constant:e})).message.response},an={};function ln(e){const t=Ke(e);if(t.message)switch(an[t.message.type]&&an[t.message.type].forEach(e=>e(t.message)),t.message.type){case Te:return void(this.fps=t.message.fps);case _e:return void(async()=>{await this.pause(),this.options.breakpointCallback&&this.options.breakpointCallback(),he.runHook({key:"breakpoint"})})();case Ee:return void(async()=>{await this.pause(),console.log("Wasmboy Crashed!");let e=await rn("getProgramCounter"),t=await sn("GAMEBOY_INTERNAL_MEMORY_LOCATION"),n=await on(t+e,t+e+1);console.log("Program Counter: 0x"+e.toString(16)),console.log("Opcode: 0x"+n[0].toString(16))})()}}let un=!1;const cn=new class{constructor(){this.worker=void 0,this.coreType=void 0,this.canvasElement=void 0,this.paused=!1,this.ready=!1,this.loadedAndStarted=!1,this.initialized=!1,this.renderId=!1,this.loadedROM=!1,this.fps=0,this.speed=1,this._resetConfig(),"undefined"!=typeof window&&(window.addEventListener("beforeunload",(function(e){un=!0})),window.document.addEventListener("visibilitychange",()=>{if("hidden"===document.visibilityState){if(this.options&&this.options.disablePauseOnHidden)return;setTimeout(()=>{un||this.pause()},0)}}))}config(e,t){return(async()=>{if(await this.pause(),await this.setCanvas(t),!e&&this.options||this._resetConfig(),e&&(Object.keys(e).forEach(t=>{void 0!==this.options[t]&&(this.options[t]=e[t])}),e.gameboySpeed)){let t=Math.floor(60*e.gameboySpeed);t<=0&&(t=1),this.options.gameboyFrameRate=t}})()}getConfig(){return this.options}setCanvas(e){if(!e)return Promise.resolve();return(async()=>{await this.pause(),this.canvasElement=e,await qe.initialize(this.canvasElement,this.options.updateGraphicsCallback)})()}getCanvas(){return this.canvasElement}addBootROM(e,t,n,r){return yt.addBootROM(e,t,n,r)}getBootROMs(){return yt.getBootROMs()}loadROM(e,t){return $t.bind(this)(e,t)}play(){return(async()=>{this.ready&&(this.loadedAndStarted||(this.loadedAndStarted=!0,this.options.onLoadedAndStarted&&this.options.onLoadedAndStarted(),he.runHook({key:"loadedAndStarted"})),this.options.onPlay&&this.options.onPlay(),he.runHook({key:"play"}),this.options.headless||(Xe.resumeAudioContext(),Xe.resetTimeStretch()),await this.worker.postMessage({type:we}),this.paused=!1,this.updateId||await this.worker.postMessage({type:Ae}),this.renderId||this.options.headless||(this.renderId=Jt(()=>{Qt.call(this)})))})()}pause(){return(async()=>{this.paused=!0,this.ready&&this.options.onPause&&this.options.onPause(),he.runHook({key:"pause"}),Jt.cancel(this.renderId),this.renderId=!1,this.options.headless||Xe.cancelAllAudio(!0),this.worker&&await this.worker.postMessage({type:Se}),await new Promise(e=>{Jt(()=>{e()})})})()}reset(e){return(async()=>{if(this.config(e,this.canvasElement),this.loadedROM)return this.loadROM(this.loadedROM)})()}getSavedMemory(){return yt.getSavedMemory()}saveLoadedCartridge(e){return yt.saveLoadedCartridge(e)}deleteSavedCartridge(e){return yt.deleteSavedCartridge(e)}saveState(){return(async()=>{await this.pause();return await yt.saveState()})()}getSaveStates(){return(async()=>{let e=await yt.getCartridgeObject();return e?e.saveStates:[]})()}loadState(e){return(async()=>{await this.pause(),await yt.loadState(e)})()}deleteState(e){return(async()=>{await yt.deleteState(e)})()}getFPS(){return this.fps}getCoreType(){return this.coreType}getSpeed(){return this.speed}setSpeed(e){e<=0&&(e=.1);(async()=>{this.worker&&(this.speed=e,Xe.setSpeed(e),await this.worker.postMessageIgnoreResponse({type:ke,speed:e})),await new Promise(e=>{Jt(()=>{e()})})})()}isGBC(){return(async()=>Ke(await cn.worker.postMessage({type:Ge})).message.response)()}_resetConfig(){this.fpsTimeStamps=[],this.frameSkipCounter=0,this.options={headless:!1,disablePauseOnHidden:!1,isAudioEnabled:!0,enableAudioDebugging:!1,gameboyFrameRate:60,frameSkip:0,enableBootROMIfAvailable:!0,isGbcEnabled:!0,isGbcColorizationEnabled:!0,gbcColorizationPalette:null,audioBatchProcessing:!1,graphicsBatchProcessing:!1,timersBatchProcessing:!1,graphicsDisableScanlineRendering:!1,audioAccumulateSamples:!1,tileRendering:!1,tileCaching:!1,maxNumberOfAutoSaveStates:10,updateGraphicsCallback:null,updateAudioCallback:null,saveStateCallback:null,breakpointCallback:null,onReady:null,onPlay:null,onPause:null,onLoadedAndStarted:null}}_instantiateWorkers(){return(async()=>{this.worker||(this.worker=await(async()=>{let e;e="worker/wasmboy.wasm.worker.js";const t=new Dt("worker/wasmboy.wasm.worker.js",xe),n=new Dt("worker/graphics.worker.js",Ne),r=new Dt("worker/audio.worker.js",Fe),o=new Dt("worker/controller.worker.js",Pe),i=new Dt("worker/memory.worker.js",Be),s=[];return[n,r,o,i].forEach(e=>{const n=new MessageChannel,r=new Promise(r=>{let o=0;const i=()=>{o++,o>=2&&r()};t.postMessage({type:pe,workerId:e.id,ports:[n.port1]},[n.port1]).then(()=>{i()}),e.postMessage({type:pe,workerId:t.id,ports:[n.port2]},[n.port2]).then(()=>{i()})});s.push(r)}),await Promise.all(s),qe.setWorker(n),Xe.setWorker(r),Nt.setWorker(o),yt.setWorker(i),t})(),this.worker.addMessageListener(ln.bind(this)))})()}};var dn="0.5.2";const hn={config:cn.config.bind(cn),getCoreType:cn.getCoreType.bind(cn),getConfig:cn.getConfig.bind(cn),setCanvas:cn.setCanvas.bind(cn),getCanvas:cn.getCanvas.bind(cn),addBootROM:cn.addBootROM.bind(cn),getBootROMs:cn.getBootROMs.bind(cn),loadROM:cn.loadROM.bind(cn),play:cn.play.bind(cn),pause:cn.pause.bind(cn),reset:cn.reset.bind(cn),addPlugin:he.addPlugin.bind(he),isPlaying:()=>!cn.paused,isPaused:()=>cn.paused,isReady:()=>cn.ready,isLoadedAndStarted:()=>cn.loadedAndStarted,getVersion:()=>dn,getSavedMemory:cn.getSavedMemory.bind(cn),saveLoadedCartridge:cn.saveLoadedCartridge.bind(cn),deleteSavedCartridge:cn.deleteSavedCartridge.bind(cn),saveState:cn.saveState.bind(cn),getSaveStates:cn.getSaveStates.bind(cn),loadState:cn.loadState.bind(cn),deleteState:cn.deleteState.bind(cn),getFPS:cn.getFPS.bind(cn),setSpeed:cn.setSpeed.bind(cn),isGBC:cn.isGBC.bind(cn),ResponsiveGamepad:Nt.ResponsiveGamepad,enableDefaultJoypad:Nt.enableDefaultJoypad.bind(Nt),disableDefaultJoypad:Nt.disableDefaultJoypad.bind(Nt),setJoypadState:Nt.setJoypadState.bind(Nt),resumeAudioContext:Xe.resumeAudioContext.bind(Xe),_getAudioChannels:Xe.getAudioChannels.bind(Xe),_getCartridgeInfo:yt.getCartridgeInfo.bind(yt),_runNumberOfFrames:async e=>{await cn.pause();const t=()=>{tn=Jt(()=>{tn&&(nn(),t())})};t();for(let t=0;t<e;t++)await rn("executeFrame",[]);tn=void 0,nn()},_runWasmExport:rn,_getWasmMemorySection:on,_getWasmConstant:sn,_getStepsAsString:async e=>{const t=await rn("getStepsPerStepSet"),n=await rn("getStepSets"),r=await rn("getSteps"),o=en(t).multiply(n).add(r);return e?o.toString(e):o.toString(10)},_getCyclesAsString:async e=>{const t=await rn("getCyclesPerCycleSet"),n=await rn("getCycleSets"),r=await rn("getCycles"),o=en(t).multiply(n).add(r);return e?o.toString(e):o.toString(10)}};function pn(e){let t,n;return{c(){t=c("img"),m(t,"class","play-poster__image svelte-4p8uqe"),t.src!==(n=e[0])&&m(t,"src",n),m(t,"alt","Wasm boy play poster")},m(e,n){l(e,t,n)},p(e,r){1&r&&t.src!==(n=e[0])&&m(t,"src",n)},d(e){e&&u(t)}}}function fn(e){let t,n,r,o,i,s,d,h,f,y=e[0]&&pn(e);return s=new ce({}),{c(){t=c("div"),y&&y.c(),n=p(),r=c("div"),o=p(),i=c("button"),U(s.$$.fragment),m(r,"class","play-poster__shade svelte-4p8uqe"),m(i,"class","play-poster__play-button svelte-4p8uqe"),m(t,"class","play-poster svelte-4p8uqe")},m(u,c){l(u,t,c),y&&y.m(t,null),a(t,n),a(t,r),a(t,o),a(t,i),$(s,i,null),d=!0,h||(f=g(i,"click",e[1]),h=!0)},p(e,[r]){e[0]?y?y.p(e,r):(y=pn(e),y.c(),y.m(t,n)):y&&(y.d(1),y=null)},i(e){d||(P(s.$$.fragment,e),d=!0)},o(e){F(s.$$.fragment,e),d=!1},d(e){e&&u(t),y&&y.d(),H(s),h=!1,f()}}}function gn(e,t,n){let r;return s(e,oe,e=>n(0,r=e)),[r,function(){hn.resumeAudioContext(),V.set(!0)}]}class mn extends W{constructor(e){super(),j(this,e,gn,fn,i,{})}}function yn(e){let t,n,r={ctx:e,current:null,token:null,hasCatch:!0,pending:_n,then:An,catch:vn,error:9};return D(n=e[3],r),{c(){t=c("div"),r.block.c(),m(t,"class","status svelte-5yaxli")},m(e,n){l(e,t,n),r.block.m(t,r.anchor=null),r.mount=()=>t,r.anchor=null},p(t,n){{const o=(e=t).slice();o[9]=r.resolved,r.block.p(o,n)}},d(e){e&&u(t),r.block.d(),r.token=null,r=null}}}function vn(e){let t,n,r,o,i=e[9].message+"";function s(e,t){return e[2]?wn:bn}let d=s(e),f=d(e);return{c(){t=c("div"),f.c(),n=p(),r=c("h3"),o=h(i),m(t,"class","error")},m(e,i){l(e,t,i),f.m(t,null),a(t,n),a(t,r),a(r,o)},p(e,r){d===(d=s(e))&&f?f.p(e,r):(f.d(1),f=d(e),f&&(f.c(),f.m(t,n)))},d(e){e&&u(t),f.d()}}}function bn(t){let n;return{c(){n=c("h3"),n.textContent="Error!"},m(e,t){l(e,n,t)},p:e,d(e){e&&u(n)}}}function wn(e){let t,n,r,o;return{c(){t=c("h2"),n=h("Error loading "),r=h(e[2]),o=h(" ...")},m(e,i){l(e,t,i),a(t,n),a(t,r),a(t,o)},p(e,t){4&t&&y(r,e[2])},d(e){e&&u(t)}}}function An(t){return{c:e,m:e,p:e,d:e}}function _n(e){let t,n;function r(e,t){return e[2]?Tn:Sn}let o=r(e),i=o(e);return{c(){i.c(),t=p(),n=c("div"),m(n,"class","donut")},m(e,r){i.m(e,r),l(e,t,r),l(e,n,r)},p(e,n){o===(o=r(e))&&i?i.p(e,n):(i.d(1),i=o(e),i&&(i.c(),i.m(t.parentNode,t)))},d(e){i.d(e),e&&u(t),e&&u(n)}}}function Sn(t){let n;return{c(){n=c("h2"),n.textContent="Loading..."},m(e,t){l(e,n,t)},p:e,d(e){e&&u(n)}}}function Tn(e){let t,n,r,o;return{c(){t=c("h2"),n=h("Loading "),r=h(e[2]),o=h(" ...")},m(e,i){l(e,t,i),a(t,n),a(t,r),a(t,o)},p(e,t){4&t&&y(r,e[2])},d(e){e&&u(t)}}}function En(t){let n,r,o,i,s=!1===t[1]&&yn(t);return{c(){n=c("div"),r=c("canvas"),o=p(),s&&s.c(),i=f(),m(r,"class","svelte-5yaxli"),m(n,"class","canvas-container svelte-5yaxli"),m(n,"style",t[0])},m(e,t){l(e,n,t),a(n,r),l(e,o,t),s&&s.m(e,t),l(e,i,t)},p(e,[t]){1&t&&m(n,"style",e[0]),!1===e[1]?s?s.p(e,t):(s=yn(e),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i:e,o:e,d(e){e&&u(n),e&&u(o),s&&s.d(e),e&&u(i)}}}function On(e,t,n){let r,o,i,a,l;s(e,ie,e=>n(5,r=e)),s(e,V,e=>n(6,o=e)),s(e,Y,e=>n(1,i=e)),s(e,se,e=>n(2,a=e));let u=new Promise(e=>{l=e});A(l);let c="display: none";const d=(async()=>{await u;const e=document.querySelector(".canvas-container > canvas"),t={name:"EmbedPlugin",saveState:t=>{e&&(t.screenshotCanvasDataURL=e.toDataURL())},play:()=>Z.set(!0),pause:()=>{Z.set(!1),ne("Paused",-1)}};await hn.config({isGbcEnabled:!0,isGbcColorizationEnabled:!0,isAudioEnabled:!0,gameboyFrameRate:60,maxNumberOfAutoSaveStates:3}),await hn.setCanvas(e),hn.addPlugin(t),await hn.loadROM(r),await hn.play(),n(0,c="display: block"),Y.set(!0),Z.set(!0)})().catch(e=>{throw console.error(e),e});return Z.subscribe(async e=>{!hn.isPlaying()&&e?await hn.play():hn.isPlaying()&&!e&&await hn.pause()}),Q.subscribe(()=>{o&&i&&hn.saveState().then(()=>{hn.play(),ne("State Saved!")}).catch(()=>{ne("Error saving the state...")})}),[c,i,a,d]}class Rn extends W{constructor(e){super(),j(this,e,On,En,i,{})}}function In(e,t,n){const r=e.slice();return r[4]=t[n],r}function Cn(t){let n,r,o=t[7].message+"";return{c(){n=c("p"),r=h(o),function(e,t,n,r){e.style.setProperty(t,n,r?"important":"")}(n,"color","red")},m(e,t){l(e,n,t),a(n,r)},p:e,d(e){e&&u(n)}}}function Ln(e){let t,n=e[3],r=[];for(let t=0;t<n.length;t+=1)r[t]=Mn(In(e,n,t));return{c(){t=c("ul");for(let e=0;e<r.length;e+=1)r[e].c();m(t,"class","svelte-17y6lo8")},m(e,n){l(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,o){if(3&o){let i;for(n=e[3],i=0;i<n.length;i+=1){const s=In(e,n,i);r[i]?r[i].p(s,o):(r[i]=Mn(s),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},d(e){e&&u(t),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(r,e)}}}function Mn(e){let t,n,r,o,i,s,d,f,y,v,b,w,A,_,S=new Date(e[4].date).toLocaleString()+"",T=e[4].isAuto?"Auto Save":"Manual Save";function E(...t){return e[2](e[4],...t)}return{c(){t=c("li"),n=c("button"),r=c("img"),i=p(),s=c("div"),d=c("h2"),f=h(S),y=p(),v=c("h4"),b=h(T),w=p(),r.src!==(o=e[4].screenshotCanvasDataURL)&&m(r,"src",o),m(r,"alt","Save State Screenshot"),m(r,"class","svelte-17y6lo8"),m(s,"class","svelte-17y6lo8"),m(n,"class","svelte-17y6lo8"),m(t,"class","svelte-17y6lo8")},m(e,o){l(e,t,o),a(t,n),a(n,r),a(n,i),a(n,s),a(s,d),a(d,f),a(s,y),a(s,v),a(v,b),a(t,w),A||(_=g(n,"click",E),A=!0)},p(t,n){e=t},d(e){e&&u(t),A=!1,_()}}}function kn(t){let n;return{c(){n=c("div"),m(n,"class","donut")},m(e,t){l(e,n,t)},p:e,d(e){e&&u(n)}}}function Gn(t){let n,r,o={ctx:t,current:null,token:null,hasCatch:!0,pending:kn,then:Ln,catch:Cn,value:3,error:7};return D(r=t[0],o),{c(){n=f(),o.block.c()},m(e,t){l(e,n,t),o.block.m(e,o.anchor=t),o.mount=()=>n.parentNode,o.anchor=n},p(e,[n]){{const r=(t=e).slice();r[3]=r[7]=o.resolved,o.block.p(r,n)}},i:e,o:e,d(e){e&&u(n),o.block.d(e),o.token=null,o=null}}}function xn(e){const t=hn.getSaveStates().then(e=>(e.sort((e,t)=>e.date>t.date?-1:e.date<t.date?1:0),Promise.resolve(e))).catch(e=>{throw console.error(e),e}),n=async e=>{await hn.loadState(e),await hn.play(),J(),ne("State Loaded!")};return[t,n,(e,t)=>n(e)]}class Nn extends W{constructor(e){super(),j(this,e,xn,Gn,i,{})}}var Bn="0.5.2";function Pn(e){let t,n,r,o;return{c(){t=c("li"),n=c("b"),n.textContent="ROM Name:",r=p(),o=h(e[0])},m(e,i){l(e,t,i),a(t,n),a(t,r),a(t,o)},p(e,t){1&t&&y(o,e[0])},d(e){e&&u(t)}}}function Fn(e){let t,n,r,o,i;return{c(){t=c("li"),n=c("b"),n.textContent="ROM URL:",r=p(),o=c("a"),i=h(e[1]),m(o,"href",e[1]),m(o,"target","_blank"),m(o,"class","svelte-13hhxga")},m(e,s){l(e,t,s),a(t,n),a(t,r),a(t,o),a(o,i)},p(e,t){2&t&&y(i,e[1]),2&t&&m(o,"href",e[1])},d(e){e&&u(t)}}}function Dn(e){let t,n,r,o,i;return{c(){t=c("li"),n=c("b"),n.textContent="Play Poster:",r=p(),o=c("a"),i=h(e[2]),m(o,"href",e[2]),m(o,"target","_blank"),m(o,"class","svelte-13hhxga")},m(e,s){l(e,t,s),a(t,n),a(t,r),a(t,o),a(o,i)},p(e,t){4&t&&y(i,e[2]),4&t&&m(o,"href",e[2])},d(e){e&&u(t)}}}function Un(t){let n,r,o,i,s,d,h,f,g,y,v,b,w,A,_,S,T,E,O,R,I,C,L,M,k,G,x,N,B,P,F=t[0]&&Pn(t),D=t[1]&&Fn(t),U=t[2]&&Dn(t);return{c(){n=c("div"),r=c("h1"),r.textContent="WasmBoy Embed Player",o=p(),i=c("p"),i.innerHTML='This is a dynamic GameBoy / GameBoy color ROM player powered by WasmBoy. WasmBoy is a Game Boy / Game Boy Color emulation library, 🎮written for WebAssembly using <a href="https://github.com/AssemblyScript/assemblyscript" target="_blank" class="svelte-13hhxga">AssemblyScript</a>. 🚀 This embed is built with <a href="https://svelte.dev/" target="_blank" class="svelte-13hhxga">Svelte</a>, and input is handled by <a href="https://github.com/torch2424/responsive-gamepad" target="_blank" class="svelte-13hhxga">Responsive Gamepad</a>. WasmBoy is written by <a href="https://github.com/torch2424" target="_blank" class="svelte-13hhxga">Aaron Turner (torch2424)</a>, and Licensed under <a href="https://github.com/torch2424/wasmboy/blob/master/LICENSE" target="_blank" class="svelte-13hhxga">GPL 3.0</a>. Also, shoutout to fred-dim ikenna (evillizard) for requesting this feature for WasmBoy, and helping with the general direction!',s=p(),d=c("div"),d.textContent="WasmBoy Version: "+Bn,h=p(),f=c("h1"),f.textContent="WasmBoy Links",g=p(),y=c("ul"),y.innerHTML='<li><a href="https://github.com/torch2424/wasmboy" target="_blank" class="svelte-13hhxga">Github Repo</a></li>  \n    <li><a href="https://www.npmjs.com/package/wasmboy" target="_blank" class="svelte-13hhxga">NPM Package</a></li>',v=p(),b=c("h1"),b.textContent="Embed Configuration",w=p(),A=c("ul"),F&&F.c(),_=p(),D&&D.c(),S=p(),U&&U.c(),T=p(),E=c("h1"),E.textContent="Help",O=p(),R=c("h2"),R.textContent="Controls",I=p(),C=c("p"),C.innerHTML='This player supports Keyboard and Gamepad input per the default <a href="https://github.com/torch2424/responsive-gamepad" target="_blank" class="svelte-13hhxga">Responsive Gamepad</a> configuration. For keyboard controls: Directional (Dpad) controls are handled by the arrows keys, or WASD on your keyboard. The A button is controlled by the &quot;Z&quot; key. The B button is controlled by the &quot;X&quot; key. Start is handled by the &quot;Enter&quot; key. Select is handled by the &quot;Shift&quot; key.',L=p(),M=c("h2"),M.textContent="Saves States / Loading States",k=p(),G=c("p"),G.textContent="Save states can be made by clicking the save icon in the control bar at the bottom of the page. Save states will also be made whenever you navigate away from the running iframe, or when the page is refreshed. Save states can be loaded by clicking the load icon in the control bar, and choosing the appropiate save state represented by the screenshot, and time at which the save states was made. Save states are stored locally in your browser in the IndexedDB API. Meaning they are not backed up to a server, and can be accidentally deleted when clearing your browser cache.",x=p(),N=c("h2"),N.textContent="Reporting Bugs / Making Suggestions",B=p(),P=c("p"),P.innerHTML='Please feel free to file any bugs, suggestions, issues, etc.. At the <a href="https://github.com/torch2424/wasmboy" target="_blank" class="svelte-13hhxga">WasmBoy Github repo</a>.',m(n,"class","about svelte-13hhxga")},m(e,t){l(e,n,t),a(n,r),a(n,o),a(n,i),a(n,s),a(n,d),a(n,h),a(n,f),a(n,g),a(n,y),a(n,v),a(n,b),a(n,w),a(n,A),F&&F.m(A,null),a(A,_),D&&D.m(A,null),a(A,S),U&&U.m(A,null),a(n,T),a(n,E),a(n,O),a(n,R),a(n,I),a(n,C),a(n,L),a(n,M),a(n,k),a(n,G),a(n,x),a(n,N),a(n,B),a(n,P)},p(e,[t]){e[0]?F?F.p(e,t):(F=Pn(e),F.c(),F.m(A,_)):F&&(F.d(1),F=null),e[1]?D?D.p(e,t):(D=Fn(e),D.c(),D.m(A,S)):D&&(D.d(1),D=null),e[2]?U?U.p(e,t):(U=Dn(e),U.c(),U.m(A,null)):U&&(U.d(1),U=null)},i:e,o:e,d(e){e&&u(n),F&&F.d(),D&&D.d(),U&&U.d()}}}function $n(e,t,n){let r,o,i;return s(e,se,e=>n(0,r=e)),s(e,ie,e=>n(1,o=e)),s(e,oe,e=>n(2,i=e)),[r,o,i]}class Hn extends W{constructor(e){super(),j(this,e,$n,Un,i,{})}}function zn(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"),m(r,"fill","#fff"),m(o,"d","M0 0h24v24H0z"),m(o,"fill","none"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class jn extends W{constructor(e){super(),j(this,e,null,zn,i,{})}}function Wn(e){let t,n,r,o,i,s,d,h,f,y,v,b;function w(e,t){return 1===e[0]?qn:2===e[0]?Kn:void 0}let A=w(e),_=A&&A(e);i=new jn({});const S=[Yn,Vn],T=[];function E(e,t){return 1===e[0]?0:2===e[0]?1:-1}return~(h=E(e))&&(f=T[h]=S[h](e)),{c(){t=c("dialog"),n=c("div"),_&&_.c(),r=p(),o=c("button"),U(i.$$.fragment),s=p(),d=c("div"),f&&f.c(),m(o,"class","icon-button"),m(n,"class","modal-header svelte-1fd8e55"),m(d,"class","modal-content svelte-1fd8e55"),m(t,"class","svelte-1fd8e55")},m(u,c){l(u,t,c),a(t,n),_&&_.m(n,null),a(n,r),a(n,o),$(i,o,null),a(t,s),a(t,d),~h&&T[h].m(d,null),y=!0,v||(b=g(o,"click",e[1]),v=!0)},p(e,t){A!==(A=w(e))&&(_&&_.d(1),_=A&&A(e),_&&(_.c(),_.m(n,r)));let o=h;h=E(e),h!==o&&(f&&(N(),F(T[o],1,1,()=>{T[o]=null}),B()),~h?(f=T[h],f||(f=T[h]=S[h](e),f.c()),P(f,1),f.m(d,null)):f=null)},i(e){y||(P(i.$$.fragment,e),P(f),y=!0)},o(e){F(i.$$.fragment,e),F(f),y=!1},d(e){e&&u(t),_&&_.d(),H(i),~h&&T[h].d(),v=!1,b()}}}function Kn(e){let t;return{c(){t=c("h2"),t.textContent="About",m(t,"class","svelte-1fd8e55")},m(e,n){l(e,t,n)},d(e){e&&u(t)}}}function qn(e){let t;return{c(){t=c("h2"),t.textContent="Load State",m(t,"class","svelte-1fd8e55")},m(e,n){l(e,t,n)},d(e){e&&u(t)}}}function Vn(e){let t,n;return t=new Hn({}),{c(){U(t.$$.fragment)},m(e,r){$(t,e,r),n=!0},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function Yn(e){let t,n;return t=new Nn({}),{c(){U(t.$$.fragment)},m(e,r){$(t,e,r),n=!0},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function Zn(e){let t,n,r=e[0]>0&&Wn(e);return{c(){r&&r.c(),t=f()},m(e,o){r&&r.m(e,o),l(e,t,o),n=!0},p(e,[n]){e[0]>0?r?(r.p(e,n),1&n&&P(r,1)):(r=Wn(e),r.c(),P(r,1),r.m(t.parentNode,t)):r&&(N(),F(r,1,1,()=>{r=null}),B())},i(e){n||(P(r),n=!0)},o(e){F(r),n=!1},d(e){r&&r.d(e),e&&u(t)}}}function Xn(e,t,n){let r;s(e,X,e=>n(0,r=e));return[r,()=>{J()}]}class Jn extends W{constructor(e){super(),j(this,e,Xn,Zn,i,{})}}function Qn(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M0 0h24v24H0z"),m(r,"fill","none"),m(o,"d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14H9V8h2v8zm4 0h-2V8h2v8z"),m(o,"fill","#fff"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class er extends W{constructor(e){super(),j(this,e,null,Qn,i,{})}}function tr(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M0 0h24v24H0z"),m(r,"fill","none"),m(o,"d","M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"),m(o,"fill","#fff"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class nr extends W{constructor(e){super(),j(this,e,null,tr,i,{})}}function rr(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"),m(r,"fill","#fff"),m(o,"d","M0 0h24v24H0z"),m(o,"fill","none"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class or extends W{constructor(e){super(),j(this,e,null,rr,i,{})}}function ir(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M0 0h24v24H0z"),m(r,"fill","none"),m(o,"d","M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"),m(o,"fill","#fff"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class sr extends W{constructor(e){super(),j(this,e,null,ir,i,{})}}function ar(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M0 0h24v24H0z"),m(r,"fill","none"),m(o,"d","M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H8v3H6v-3H3v-2h3V8h2v3h3v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"),m(o,"fill","#fff"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class lr extends W{constructor(e){super(),j(this,e,null,ar,i,{})}}function ur(t){let n,r,o,i;return{c(){n=d("svg"),r=d("path"),o=d("path"),i=d("path"),m(r,"d","M0 0h24v24H0z"),m(r,"fill","none"),m(o,"d","M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H8v3H6v-3H3v-2h3V8h2v3h3v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"),m(o,"fill","#fff"),m(i,"d","M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"),m(i,"fill","#ff0000"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o),a(n,i)},p:e,i:e,o:e,d(e){e&&u(n)}}}class cr extends W{constructor(e){super(),j(this,e,null,ur,i,{})}}function dr(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M0 0h24v24H0z"),m(r,"fill","none"),m(o,"d","M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z"),m(o,"fill","#fff"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class hr extends W{constructor(e){super(),j(this,e,null,dr,i,{})}}function pr(t){let n,r,o;return{c(){n=d("svg"),r=d("path"),o=d("path"),m(r,"d","M0 0h24v24H0z"),m(r,"fill","none"),m(o,"d","M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"),m(o,"fill","#fff"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"height","24"),m(n,"viewBox","0 0 24 24"),m(n,"width","24"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}class fr extends W{constructor(e){super(),j(this,e,null,pr,i,{})}}function gr(e){let t,n,r=e[4].message+"";return{c(){t=c("div"),n=h(r),m(t,"class","status svelte-acjdtv")},m(e,r){l(e,t,r),a(t,n)},p(e,t){16&t&&r!==(r=e[4].message+"")&&y(n,r)},d(e){e&&u(t)}}}function mr(e){let t,n;return t=new ce({}),{c(){U(t.$$.fragment)},m(e,r){$(t,e,r),n=!0},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function yr(e){let t,n;return t=new er({}),{c(){U(t.$$.fragment)},m(e,r){$(t,e,r),n=!0},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function vr(e){let t,n;return t=new lr({}),{c(){U(t.$$.fragment)},m(e,r){$(t,e,r),n=!0},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function br(e){let t,n;return t=new cr({}),{c(){U(t.$$.fragment)},m(e,r){$(t,e,r),n=!0},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function wr(e){let t,n;return t=new fr({}),{c(){U(t.$$.fragment)},m(e,r){$(t,e,r),n=!0},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function Ar(e){let t,n;return t=new hr({}),{c(){U(t.$$.fragment)},m(e,r){$(t,e,r),n=!0},i(e){n||(P(t.$$.fragment,e),n=!0)},o(e){F(t.$$.fragment,e),n=!1},d(e){H(t,e)}}}function _r(e){let t,n,o,i,s,d,h,f,y,v,b,w,A,_,S,T,E,O,R,I,C,L,M,k,G,x,D,z,j,W,K,q,V=e[0]&&gr(e);const Y=[yr,mr],Z=[];function X(e,t){return e[1]?0:1}d=X(e),h=Z[d]=Y[d](e),b=new nr({}),S=new or({});const J=[br,vr],Q=[];function ee(e,t){return e[2]?0:1}R=ee(e),I=Q[R]=J[R](e),k=new sr({});const te=[Ar,wr],ne=[];function re(e,t){return e[3]?0:1}return z=re(e),j=ne[z]=te[z](e),{c(){t=c("footer"),V&&V.c(),n=p(),o=c("ul"),i=c("li"),s=c("button"),h.c(),f=p(),y=c("li"),v=c("button"),U(b.$$.fragment),w=p(),A=c("li"),_=c("button"),U(S.$$.fragment),T=p(),E=c("li"),O=c("button"),I.c(),C=p(),L=c("li"),M=c("button"),U(k.$$.fragment),G=p(),x=c("li"),D=c("button"),j.c(),m(s,"class","icon-button"),m(v,"class","icon-button"),m(_,"class","icon-button"),m(O,"class","icon-button"),m(M,"class","icon-button"),m(D,"class","icon-button"),m(o,"class","controls-buttons svelte-acjdtv"),m(t,"class","controls-bar svelte-acjdtv")},m(r,u){l(r,t,u),V&&V.m(t,null),a(t,n),a(t,o),a(o,i),a(i,s),Z[d].m(s,null),a(o,f),a(o,y),a(y,v),$(b,v,null),a(o,w),a(o,A),a(A,_),$(S,_,null),a(o,T),a(o,E),a(E,O),Q[R].m(O,null),a(o,C),a(o,L),a(L,M),$(k,M,null),a(o,G),a(o,x),a(x,D),ne[z].m(D,null),W=!0,K||(q=[g(s,"click",e[5]),g(v,"click",e[6]),g(_,"click",e[7]),g(O,"click",e[8]),g(M,"click",e[9]),g(D,"click",e[10])],K=!0)},p(e,[r]){e[0]?V?V.p(e,r):(V=gr(e),V.c(),V.m(t,n)):V&&(V.d(1),V=null);let o=d;d=X(e),d!==o&&(N(),F(Z[o],1,1,()=>{Z[o]=null}),B(),h=Z[d],h||(h=Z[d]=Y[d](e),h.c()),P(h,1),h.m(s,null));let i=R;R=ee(e),R!==i&&(N(),F(Q[i],1,1,()=>{Q[i]=null}),B(),I=Q[R],I||(I=Q[R]=J[R](e),I.c()),P(I,1),I.m(O,null));let a=z;z=re(e),z!==a&&(N(),F(ne[a],1,1,()=>{ne[a]=null}),B(),j=ne[z],j||(j=ne[z]=te[z](e),j.c()),P(j,1),j.m(D,null))},i(e){W||(P(h),P(b.$$.fragment,e),P(S.$$.fragment,e),P(I),P(k.$$.fragment,e),P(j),W=!0)},o(e){F(h),F(b.$$.fragment,e),F(S.$$.fragment,e),F(I),F(k.$$.fragment,e),F(j),W=!1},d(e){e&&u(t),V&&V.d(),Z[d].d(),H(b),H(S),Q[R].d(),H(k),ne[z].d(),K=!1,r(q)}}}function Sr(e,t,n){let r,o,i,a;s(e,Z,e=>n(1,r=e)),s(e,ae,e=>n(2,o=e)),s(e,le,e=>n(3,i=e)),s(e,te,e=>n(4,a=e));let l,u=!1;te.subscribe(e=>{if(l&&clearTimeout(l),n(0,u=!0),e.timeout<0)return!1;l=setTimeout(()=>{n(0,u=!1),l=void 0},e.timeout)});return[u,r,o,i,a,()=>{r?(Z.set(!1),ne("Paused",-1)):(Z.set(!0),ne("Playing!"))},()=>{Q.update(e=>e+1)},()=>{X.set(1)},()=>{o?ae.set(!1):ae.set(!0)},()=>{X.set(2)},async()=>{if(i)le.set(!1),document.exitFullscreen();else try{await document.documentElement.requestFullscreen(),le.set(!0)}catch(e){console.error(e),ne("Error, could not fullscreen!")}}]}class Tr extends W{constructor(e){super(),j(this,e,Sr,_r,i,{})}}function Er(t){let n,r,o,i,s,c,h,p,f,g,y,v,b,w,A,_,S,T,E,O,R,I,C,L;return{c(){n=d("svg"),r=d("defs"),o=d("radialGradient"),i=d("stop"),s=d("stop"),c=d("linearGradient"),h=d("stop"),p=d("stop"),f=d("linearGradient"),g=d("stop"),y=d("stop"),v=d("linearGradient"),b=d("stop"),w=d("stop"),A=d("stop"),_=d("linearGradient"),S=d("stop"),T=d("stop"),E=d("stop"),O=d("path"),R=d("polygon"),I=d("polygon"),C=d("polygon"),L=d("polygon"),m(i,"offset","0%"),m(i,"stop-color","rgba(255, 255, 255, 0.5)"),m(i,"stop-opacity","0.5"),m(s,"offset","100%"),m(s,"stop-color","rgba(255, 255, 255, 0.5)"),m(s,"stop-opacity","0.5"),m(o,"id","ButtonBackgroundFill"),m(o,"cx","0.5"),m(o,"cy","0.5"),m(o,"r","0.75"),m(o,"fx","0.5"),m(o,"fy","0.95"),m(h,"offset","0%"),m(h,"stop-color","rgba(175, 175, 175, 0.25)"),m(h,"stop-opacity","0.25"),m(p,"offset","100%"),m(p,"stop-color","rgba(175, 175, 175, 0.25)"),m(p,"stop-opacity","0.25"),m(c,"id","ButtonTriangleFillUp"),m(c,"x2","0%"),m(c,"y2","100%"),m(g,"offset","0%"),m(g,"stop-color","rgba(175, 175, 175, 0.25)"),m(g,"stop-opacity","0.25"),m(y,"offset","100%"),m(y,"stop-color","rgba(175, 175, 175, 0.25)"),m(y,"stop-opacity","0.25"),m(f,"id","ButtonTriangleFillDown"),m(f,"x2","0%"),m(f,"y2","100%"),m(b,"offset","0%"),m(b,"stop-color","rgba(175, 175, 175, 0.25)"),m(b,"stop-opacity","0.25"),m(w,"offset","75%"),m(w,"stop-color","rgba(175, 175, 175, 0.25)"),m(w,"stop-opacity","0.25"),m(A,"offset","100%"),m(A,"stop-color","rgba(175, 175, 175, 0.25)"),m(A,"stop-opacity","0.25"),m(v,"id","ButtonTriangleFillHorizontal"),m(v,"x2","0%"),m(v,"y2","100%"),m(S,"offset","0%"),m(S,"stop-color","rgba(175, 175, 175, 0.25)"),m(S,"stop-opacity","0.25"),m(T,"offset","75%"),m(T,"stop-color","rgba(175, 175, 175, 0.25)"),m(T,"stop-opacity","0.25"),m(E,"offset","100%"),m(E,"stop-color","rgba(175, 175, 175, 0.25)"),m(E,"stop-opacity","0.25"),m(_,"id","ButtonTriangleStroke"),m(_,"x2","0%"),m(_,"y2","100%"),m(O,"d","M58,58 L58,8.00037538 C58,3.5859394 61.5833386,0 66.0036109,0 L122.996389,0 C127.417239,0 131,3.58189007 131,8.00037538 L131,58 L180.999625,58 C185.414061,58 189,61.5833386 189,66.0036109 L189,122.996389 C189,127.417239 185.41811,131 180.999625,131 L131,131 L131,180.999625 C131,185.414061 127.416661,189 122.996389,189 L66.0036109,189 C61.5827606,189 58,185.41811 58,180.999625 L58,131 L8.00037538,131 C3.5859394,131 0,127.416661 0,122.996389 L0,66.0036109 C0,61.5827606 3.58189007,58 8.00037538,58 L58,58 Z"),m(O,"fill","url(#ButtonBackgroundFill)"),m(R,"points","75,45 115,45 95,10"),m(R,"fill","url(#ButtonTriangleFillUp)"),m(R,"stroke","url(#ButtonTriangleStroke)"),m(I,"points","75,145 115,145 95,180"),m(I,"fill","url(#ButtonTriangleFillDown)"),m(I,"stroke","url(#ButtonTriangleStroke)"),m(C,"points","10,95 46.5,115 45,75"),m(C,"fill","url(#ButtonTriangleFillHorizontal)"),m(C,"stroke","url(#ButtonTriangleStroke)"),m(L,"points","180,95 143.5,115 145,75"),m(L,"fill","url(#ButtonTriangleFillHorizontal)"),m(L,"stroke","url(#ButtonTriangleStroke)"),m(n,"viewBox","0 0 189 189"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(r,o),a(o,i),a(o,s),a(r,c),a(c,h),a(c,p),a(r,f),a(f,g),a(f,y),a(r,v),a(v,b),a(v,w),a(v,A),a(r,_),a(_,S),a(_,T),a(_,E),a(n,O),a(n,R),a(n,I),a(n,C),a(n,L)},p:e,i:e,o:e,d(e){e&&u(n)}}}class Or extends W{constructor(e){super(),j(this,e,null,Er,i,{})}}function Rr(t){let n,r,o,i,s,c,p,f,g,v,b,w,A,_,S;return{c(){n=d("svg"),r=d("defs"),o=d("radialGradient"),i=d("stop"),s=d("stop"),c=d("radialGradient"),p=d("stop"),f=d("stop"),g=d("radialGradient"),v=d("stop"),b=d("stop"),w=d("stop"),A=d("rect"),_=d("text"),S=h(t[0]),m(i,"offset","0%"),m(i,"stop-color","rgba(255, 255, 255, 0.5)"),m(i,"stop-opacity","0.5"),m(s,"offset","100%"),m(s,"stop-color","rgba(255, 255, 255, 0.5)"),m(s,"stop-opacity","0.5"),m(o,"id","ButtonBackgroundFill"),m(o,"cx","0.5"),m(o,"cy","0.5"),m(o,"r","0.75"),m(o,"fx","0.5"),m(o,"fy","0.95"),m(p,"offset","0%"),m(p,"stop-color","rgba(150, 150, 150, 0.25)"),m(p,"stop-opacity","0.25"),m(f,"offset","100%"),m(f,"stop-color","rgba(150, 150, 150, 0.25)"),m(f,"stop-opacity","0.25"),m(c,"id","ButtonLetterFill"),m(c,"cx","0.5"),m(c,"cy","0.5"),m(c,"r","0.75"),m(c,"fx","0.5"),m(c,"fy","0.95"),m(v,"offset","0%"),m(v,"stop-color","rgba(200, 200, 200, 0.25)"),m(v,"stop-opacity","0.25"),m(b,"offset","75%"),m(b,"stop-color","rgba(200, 200, 200, 0.25)"),m(b,"stop-opacity","0.25"),m(w,"offset","100%"),m(w,"stop-color","rgba(200, 200, 200, 0.25)"),m(w,"stop-opacity","0.25"),m(g,"id","ButtonLetterStroke"),m(g,"cx","0.5"),m(g,"cy","0.5"),m(g,"r","0.75"),m(g,"fx","0.5"),m(g,"fy","0.75"),m(A,"x","0"),m(A,"y","0"),m(A,"width","100"),m(A,"height","100"),m(A,"rx","50%"),m(A,"ry","50%"),m(A,"fill","url(#ButtonBackgroundFill)"),m(_,"x","25"),m(_,"y","80"),m(_,"fill","url(#ButtonLetterFill)"),m(_,"stroke","url(#ButtonLetterStroke)"),m(n,"viewBox","0 0 100 100"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(r,o),a(o,i),a(o,s),a(r,c),a(c,p),a(c,f),a(r,g),a(g,v),a(g,b),a(g,w),a(n,A),a(n,_),a(_,S)},p(e,[t]){1&t&&y(S,e[0])},i:e,o:e,d(e){e&&u(n)}}}function Ir(e,t,n){let{content:r=""}=t;return e.$$set=e=>{"content"in e&&n(0,r=e.content)},[r]}class Cr extends W{constructor(e){super(),j(this,e,Ir,Rr,i,{content:0})}}function Lr(t){let n,r,o,i,s,c,p,f,g,v,b,w,A,_,S;return{c(){n=d("svg"),r=d("defs"),o=d("radialGradient"),i=d("stop"),s=d("stop"),c=d("radialGradient"),p=d("stop"),f=d("stop"),g=d("radialGradient"),v=d("stop"),b=d("stop"),w=d("stop"),A=d("rect"),_=d("text"),S=h(t[0]),m(i,"offset","0%"),m(i,"stop-color","rgba(255, 255, 255, 0.5)"),m(i,"stop-opacity","0.5"),m(s,"offset","100%"),m(s,"stop-color","rgba(255, 255, 255, 0.5)"),m(s,"stop-opacity","0.5"),m(o,"id","ButtonBackgroundFill"),m(o,"cx","0.5"),m(o,"cy","0.5"),m(o,"r","0.75"),m(o,"fx","0.5"),m(o,"fy","0.95"),m(p,"offset","0%"),m(p,"stop-color","rgba(150, 150, 150, 0.25)"),m(p,"stop-opacity","0.25"),m(f,"offset","100%"),m(f,"stop-color","rgba(150, 150, 150, 0.25)"),m(f,"stop-opacity","0.25"),m(c,"id","ButtonLetterFill"),m(c,"cx","0.5"),m(c,"cy","0.5"),m(c,"r","0.75"),m(c,"fx","0.5"),m(c,"fy","0.95"),m(v,"offset","0%"),m(v,"stop-color","rgba(200, 200, 200, 0.25)"),m(v,"stop-opacity","0.25"),m(b,"offset","75%"),m(b,"stop-color","rgba(200, 200, 200, 0.25)"),m(b,"stop-opacity","0.25"),m(w,"offset","100%"),m(w,"stop-color","rgba(200, 200, 200, 0.25)"),m(w,"stop-opacity","0.25"),m(g,"id","ButtonLetterStroke"),m(g,"cx","0.5"),m(g,"cy","0.5"),m(g,"r","0.75"),m(g,"fx","0.5"),m(g,"fy","0.75"),m(A,"x","0"),m(A,"y","50"),m(A,"width","100"),m(A,"height","50"),m(A,"rx","50%"),m(A,"ry","50%"),m(A,"fill","url(#ButtonBackgroundFill)"),m(_,"x","20"),m(_,"y","85"),m(_,"fill","url(#ButtonLetterFill)"),m(_,"stroke","url(#ButtonLetterStroke)"),m(n,"viewBox","0 0 100 100"),m(n,"xmlns","http://www.w3.org/2000/svg"),m(n,"class","svelte-1cmb9l6")},m(e,t){l(e,n,t),a(n,r),a(r,o),a(o,i),a(o,s),a(r,c),a(c,p),a(c,f),a(r,g),a(g,v),a(g,b),a(g,w),a(n,A),a(n,_),a(_,S)},p(e,[t]){1&t&&y(S,e[0])},i:e,o:e,d(e){e&&u(n)}}}function Mr(e,t,n){let{content:r=""}=t;return e.$$set=e=>{"content"in e&&n(0,r=e.content)},[r]}class kr extends W{constructor(e){super(),j(this,e,Mr,Lr,i,{content:0})}}function Gr(e){let t,n,r,o,i,s,d,h,f,g,y,v,b,w,A,_,S,T;return o=new Or({}),d=new Cr({props:{content:"A"}}),g=new Cr({props:{content:"B"}}),b=new kr({props:{content:"start"}}),_=new kr({props:{content:"select"}}),{c(){t=c("div"),n=c("div"),r=c("div"),U(o.$$.fragment),i=p(),s=c("div"),U(d.$$.fragment),h=p(),f=c("div"),U(g.$$.fragment),y=p(),v=c("div"),U(b.$$.fragment),w=p(),A=c("div"),U(_.$$.fragment),m(r,"id","gameboy-dpad"),m(r,"class","svelte-1d45dd1"),m(s,"id","gameboy-a"),m(s,"class","svelte-1d45dd1"),m(f,"id","gameboy-b"),m(f,"class","svelte-1d45dd1"),m(v,"id","gameboy-start"),m(v,"class","svelte-1d45dd1"),m(A,"id","gameboy-select"),m(A,"class","svelte-1d45dd1"),m(n,"class","gameboy-input svelte-1d45dd1"),m(t,"class","mobile-controls svelte-1d45dd1"),m(t,"style",S=0===e[0]&&!0===e[1]?"":"display: none")},m(e,u){l(e,t,u),a(t,n),a(n,r),$(o,r,null),a(n,i),a(n,s),$(d,s,null),a(n,h),a(n,f),$(g,f,null),a(n,y),a(n,v),$(b,v,null),a(n,w),a(n,A),$(_,A,null),T=!0},p(e,[n]){(!T||3&n&&S!==(S=0===e[0]&&!0===e[1]?"":"display: none"))&&m(t,"style",S)},i(e){T||(P(o.$$.fragment,e),P(d.$$.fragment,e),P(g.$$.fragment,e),P(b.$$.fragment,e),P(_.$$.fragment,e),T=!0)},o(e){F(o.$$.fragment,e),F(d.$$.fragment,e),F(g.$$.fragment,e),F(b.$$.fragment,e),F(_.$$.fragment,e),T=!1},d(e){e&&u(t),H(o),H(d),H(g),H(b),H(_)}}}function xr(e,t,n){let r,o,i;s(e,X,e=>n(0,r=e)),s(e,ae,e=>n(1,o=e));let a=new Promise(e=>{i=e});A(i),ae.subscribe(e=>{const t=document.documentElement.classList;e?t.add("touchpad-visible"):t.remove("touchpad-visible")});const l=[];var u;return(async()=>{await a;const e=document.querySelector("#gameboy-dpad"),t=document.querySelector("#gameboy-start"),n=document.querySelector("#gameboy-select"),r=document.querySelector("#gameboy-a"),o=document.querySelector("#gameboy-b");l.push(hn.ResponsiveGamepad.TouchInput.addDpadInput(e,{allowMultipleDirections:!1})),l.push(hn.ResponsiveGamepad.TouchInput.addButtonInput(r,hn.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.A)),l.push(hn.ResponsiveGamepad.TouchInput.addButtonInput(o,hn.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.B)),l.push(hn.ResponsiveGamepad.TouchInput.addButtonInput(t,hn.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.START)),l.push(hn.ResponsiveGamepad.TouchInput.addButtonInput(n,hn.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.SELECT))})(),u=()=>{l.forEach(e=>e())},w().$$.on_destroy.push(u),[r,o]}class Nr extends W{constructor(e){super(),j(this,e,xr,Gr,i,{})}}var Br=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){
/*!
    	devtools-detect
    	Detect if DevTools is open
    	https://github.com/sindresorhus/devtools-detect
    	by Sindre Sorhus
    	MIT License
    */
var t,n;t={open:!1,orientation:null},n=function(e,t){window.dispatchEvent(new CustomEvent("devtoolschange",{detail:{open:e,orientation:t}}))},setInterval((function(){var e=window.outerWidth-window.innerWidth>160,r=window.outerHeight-window.innerHeight>160,o=e?"vertical":"horizontal";r&&e||!(window.Firebug&&window.Firebug.chrome&&window.Firebug.chrome.isInitialized||e||r)?(t.open&&n(!1,null),t.open=!1,t.orientation=null):(t.open&&t.orientation===o||n(!0,o),t.open=!0,t.orientation=o)}),500),e.exports?e.exports=t:window.devtools=t}));let Pr=void 0;const Fr=()=>{const e=Br.open;let t=window.matchMedia("(max-width: 500px)").matches;e||(t=window.matchMedia("(max-width: 1024px)").matches);let n=window.matchMedia("screen and (orientation: landscape)").matches,r=window.matchMedia("screen and (orientation: portrait)").matches;const o=document.documentElement.classList;o.add("mobile"),n?(o.add("landscape"),o.remove("portrait")):r&&(o.add("portrait"),o.remove("landscape")),n||r||!t||(o.add("landscape"),o.remove("portrait"))};Fr();let Dr=!1;function Ur(e,t){e.onload=function(){this.onerror=this.onload=null,t(null,e)},e.onerror=function(){this.onerror=this.onload=null,t(new Error("Failed to load "+this.src),e)}}function $r(e,t){e.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,t(null,e))}}const Hr=()=>{var e,t,n,r,o;"undefined"!=typeof window&&(e="https://www.googletagmanager.com/gtag/js?id=UA-125276735-3",t=(e,t)=>{function n(){window.dataLayer.push(arguments)}e?console.error(e):(window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","UA-125276735-3"))},r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("script"),"function"==typeof t&&(n=t,t={}),t=t||{},n=n||function(){},o.type=t.type||"text/javascript",o.charset=t.charset||"utf8",o.async=!("async"in t)||!!t.async,o.src=e,t.attrs&&function(e,t){for(var n in t)e.setAttribute(n,t[n])}(o,t.attrs),t.text&&(o.text=""+t.text),("onload"in o?Ur:$r)(o,n),o.onload||Ur(o,n),r.appendChild(o))};function zr(e){let t,n,r,o;t=new Rn({});let i=e[1]&&Wr(e);return{c(){U(t.$$.fragment),n=p(),i&&i.c(),r=f()},m(e,s){$(t,e,s),l(e,n,s),i&&i.m(e,s),l(e,r,s),o=!0},p(e,t){e[1]?i?2&t&&P(i,1):(i=Wr(e),i.c(),P(i,1),i.m(r.parentNode,r)):i&&(N(),F(i,1,1,()=>{i=null}),B())},i(e){o||(P(t.$$.fragment,e),P(i),o=!0)},o(e){F(t.$$.fragment,e),F(i),o=!1},d(e){H(t,e),e&&u(n),i&&i.d(e),e&&u(r)}}}function jr(t){let n,r;return n=new mn({}),{c(){U(n.$$.fragment)},m(e,t){$(n,e,t),r=!0},p:e,i(e){r||(P(n.$$.fragment,e),r=!0)},o(e){F(n.$$.fragment,e),r=!1},d(e){H(n,e)}}}function Wr(e){let t,n,r,o,i,s;return t=new Jn({}),r=new Tr({}),i=new Nr({}),{c(){U(t.$$.fragment),n=p(),U(r.$$.fragment),o=p(),U(i.$$.fragment)},m(e,a){$(t,e,a),l(e,n,a),$(r,e,a),l(e,o,a),$(i,e,a),s=!0},i(e){s||(P(t.$$.fragment,e),P(r.$$.fragment,e),P(i.$$.fragment,e),s=!0)},o(e){F(t.$$.fragment,e),F(r.$$.fragment,e),F(i.$$.fragment,e),s=!1},d(e){H(t,e),e&&u(n),H(r,e),e&&u(o),H(i,e)}}}function Kr(e){let t,n,r,o;const i=[jr,zr],s=[];function a(e,t){return!1===e[0]?0:1}return n=a(e),r=s[n]=i[n](e),{c(){t=c("main"),r.c(),m(t,"class","app svelte-16eszze")},m(e,r){l(e,t,r),s[n].m(t,null),o=!0},p(e,[o]){let l=n;n=a(e),n===l?s[n].p(e,o):(N(),F(s[l],1,1,()=>{s[l]=null}),B(),r=s[n],r||(r=s[n]=i[n](e),r.c()),P(r,1),r.m(t,null))},i(e){o||(P(r),o=!0)},o(e){F(r),o=!1},d(e){e&&u(t),s[n].d()}}}function qr(e,t,n){let r,o;return s(e,V,e=>n(0,r=e)),s(e,Y,e=>n(1,o=e)),window.addEventListener("devtoolschange",e=>{Fr()}),window.addEventListener("resize",()=>{Pr||(Pr=setTimeout(()=>{Fr(),Pr=void 0},500))}),window.addEventListener("orientationchange",()=>{Pr||(Pr=setTimeout(()=>{Fr(),Pr=void 0},500))}),hn.ResponsiveGamepad.onInputsChange([hn.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.LEFT_TRIGGER,hn.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.RIGHT_TRIGGER,hn.ResponsiveGamepad.RESPONSIVE_GAMEPAD_INPUTS.SPECIAL],e=>{!Dr&&e.LEFT_TRIGGER?(hn.setSpeed(3),Dr=!0,ne("Quick Speed Hotkey!")):Dr&&!e.LEFT_TRIGGER&&(hn.setSpeed(1),Dr=!1),hn.isPlaying()&&e.SPECIAL?hn.pause():!hn.isPlaying()&&e.SPECIAL&&hn.play()}),Hr(),[r,o]}return new class extends W{constructor(e){super(),j(this,e,qr,Kr,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.zsvxv0b1wq.js.map
