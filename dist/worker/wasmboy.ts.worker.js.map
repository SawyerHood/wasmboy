{"version":3,"file":"wasmboy.ts.worker.js","sources":["../../lib/worker/util.js","../../lib/worker/workerapi.js","../../lib/worker/constants.js","../../lib/worker/smartworker.js","../../lib/wasmboy/worker/graphics/onmessage.js","../../lib/wasmboy/worker/audio/onmessage.js","../../lib/wasmboy/worker/controller/onmessage.js","../../lib/wasmboy/worker/memory/rom.js","../../lib/wasmboy/worker/memory/ram.js","../../lib/wasmboy/worker/memory/header.js","../../lib/wasmboy/worker/memory/gameboymemory.js","../../lib/wasmboy/worker/memory/palettememory.js","../../lib/wasmboy/worker/memory/internalstate.js","../../lib/wasmboy/worker/memory/onmessage.js","../core/getWasmBoyTsCore.esm.js","../../lib/common/common.js","../../lib/wasmboy/worker/timestamp.js","../../lib/wasmboy/worker/graphics/transfer.js","../../lib/wasmboy/worker/update.js","../../lib/wasmboy/worker/wasmboy.worker.js"],"sourcesContent":["export function getEventData(event) {\n  if (event.data) {\n    return event.data;\n  }\n\n  return event;\n}\n\nexport const isInBrowser = typeof self !== 'undefined';\n\n// Function to read a base64 string as a buffer\nexport function readBase64String(base64String) {\n  if (isInBrowser) {\n    return base64String;\n  } else {\n    return readBase64Buffer(base64String).toString('utf8');\n  }\n}\n\nexport function readBase64Buffer(base64String) {\n  return Buffer.from(base64String.split(',')[1], 'base64');\n}\n","// Isomorphic worker api to be imported by web workers\n// https://medium.com/dailyjs/threads-in-node-10-5-0-a-practical-intro-3b85a0a3c953\n\n// Initilize some of our isomorphic values\nimport { isInBrowser } from './util';\n\nlet parentPort;\nif (!isInBrowser) {\n  parentPort = require('worker_threads').parentPort;\n}\n\n// https://nodejs.org/api/worker_threads.html#worker_threads_worker_postmessage_value_transferlist\n// https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage\nexport function postMessage(message, transferArray) {\n  // Can't bind parentPort.postMessage, so we need to kinda copy code here :p\n  if (isInBrowser) {\n    self.postMessage(message, transferArray);\n  } else {\n    parentPort.postMessage(message, transferArray);\n  }\n}\n\n// https://nodejs.org/api/worker_threads.html#worker_threads_worker_parentport\n// https://developer.mozilla.org/en-US/docs/Web/API/Worker/onmessage\nexport function onMessage(callback, port) {\n  if (!callback) {\n    console.error('workerapi: No callback was provided to onMessage!');\n  }\n\n  // If we passed a port, use that\n  if (port) {\n    if (isInBrowser) {\n      // We are in the browser\n      port.onmessage = callback;\n    } else {\n      // We are in Node\n      port.on('message', callback);\n    }\n    return;\n  }\n\n  if (isInBrowser) {\n    // We are in the browser\n    self.onmessage = callback;\n  } else {\n    // We are in Node\n    parentPort.on('message', callback);\n  }\n}\n","export const WORKER_MESSAGE_TYPE = {\n  CONNECT: 'CONNECT',\n  INSTANTIATE_WASM: 'INSTANTIATE_WASM',\n  CLEAR_MEMORY: 'CLEAR_MEMORY',\n  CLEAR_MEMORY_DONE: 'CLEAR_MEMORY_DONE',\n  GET_MEMORY: 'GET_MEMORY',\n  SET_MEMORY: 'SET_MEMORY',\n  SET_MEMORY_DONE: 'SET_MEMORY_DONE',\n  GET_CONSTANTS: 'GET_CONSTANTS',\n  GET_CONSTANTS_DONE: 'GET_CONSTANTS_DONE',\n  CONFIG: 'CONFIG',\n  RESET_AUDIO_QUEUE: 'RESET_AUDIO_QUEUE',\n  PLAY: 'PLAY',\n  BREAKPOINT: 'BREAKPOINT',\n  PAUSE: 'PAUSE',\n  UPDATED: 'UPDATED',\n  CRASHED: 'CRASHED',\n  SET_JOYPAD_STATE: 'SET_JOYPAD_STATE',\n  AUDIO_LATENCY: 'AUDIO_LATENCY',\n  RUN_WASM_EXPORT: 'RUN_WASM_EXPORT',\n  GET_WASM_MEMORY_SECTION: 'GET_WASM_MEMORY_SECTION',\n  GET_WASM_CONSTANT: 'GET_WASM_CONSTANT',\n  FORCE_OUTPUT_FRAME: 'FORCE_OUTPUT_FRAME',\n  SET_SPEED: 'SET_SPEED',\n  IS_GBC: 'IS_GBC'\n};\n\nexport const WORKER_ID = {\n  LIB: 'LIB',\n  GRAPHICS: 'GRAPHICS',\n  MEMORY: 'MEMORY',\n  CONTROLLER: 'CONTROLLER',\n  AUDIO: 'AUDIO'\n};\n\nexport const MEMORY_TYPE = {\n  CARTRIDGE_RAM: 'CARTRIDGE_RAM',\n  CARTRIDGE_ROM: 'CARTRIDGE_ROM',\n  CARTRIDGE_HEADER: 'CARTRIDGE_HEADER',\n  GAMEBOY_MEMORY: 'GAMEBOY_MEMORY',\n  PALETTE_MEMORY: 'PALETTE_MEMORY',\n  INTERNAL_STATE: 'INTERNAL_STATE'\n};\n","// Smarter workers.\n// Workers with ids, pub sub, etc...\n// https://medium.com/dailyjs/threads-in-node-10-5-0-a-practical-intro-3b85a0a3c953\n\n/*ROLLUP_REPLACE_NODE\nconst { Worker } = require('worker_threads');\nROLLUP_REPLACE_NODE*/\n\nimport { getEventData, readBase64String } from './util';\n\n// Generate ids. Use a counter to help against possible collisions.\nlet idCounter = 0;\nconst generateId = () => {\n  const randomId = Math.random()\n    .toString(36)\n    .replace(/[^a-z]+/g, '')\n    .substr(2, 10);\n  idCounter++;\n  const id = `${randomId}-${idCounter}`;\n  if (idCounter > 100000) {\n    idCounter = 0;\n  }\n  return id;\n};\n\nexport function getSmartWorkerMessage(message, messageId, workerId) {\n  if (!messageId) {\n    messageId = generateId();\n  }\n  return {\n    workerId,\n    messageId,\n    message\n  };\n}\n\nexport class SmartWorker {\n  constructor(workerUrl, id) {\n    this.id = generateId();\n    if (id) {\n      this.id = id;\n    }\n    this.messageListeners = [];\n\n    /*ROLLUP_REPLACE_PROD_BROWSER\n    \n    // Can't load base63 data string directly because safari\n    // https://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\n\n    let workerJs = atob(workerUrl.split(',')[1]);\n    let blob;\n    try {\n      blob = new Blob([workerJs], {type: 'application/javascript'});\n    } catch (e) {\n      // Legacy\n      window.BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder;\n      blob = new BlobBuilder();\n      blob.append(workerJs);\n      blob = blob.getBlob();\n    }\n    this.worker = new Worker(URL.createObjectURL(blob));\n\n\n    this.worker.onmessage = this._onMessageHandler.bind(this);\n    \n    ROLLUP_REPLACE_PROD_BROWSER*/\n\n    /*ROLLUP_REPLACE_DEV_BROWSER\n\n    this.worker = new Worker(workerUrl);\n    this.worker.onmessage = this._onMessageHandler.bind(this);\n\n    ROLLUP_REPLACE_DEV_BROWSER*/\n\n    /*ROLLUP_REPLACE_NODE\n\n    // Split by Comma, to remove the file header from the base 64 string\n    const workerAsString = readBase64String(workerUrl);\n    this.worker = new Worker(workerAsString, {\n      eval: true\n    });\n    this.worker.on('message', this._onMessageHandler.bind(this))\n\n    ROLLUP_REPLACE_NODE*/\n  }\n\n  postMessageIgnoreResponse(message, transfer) {\n    const messageObject = getSmartWorkerMessage(message, undefined, this.id);\n    this.worker.postMessage(messageObject, transfer);\n  }\n\n  postMessage(message, transfer) {\n    const messageObject = getSmartWorkerMessage(message, undefined, this.id);\n    const messageId = messageObject.messageId;\n\n    const messageIdListener = new Promise((resolve, reject) => {\n      // Set a timeout before killing the message listener\n      let messageDroppedTimeout = setTimeout(() => {\n        console.warn('Message dropped', message);\n        this.removeMessageListener(messageId);\n        reject();\n      }, 500);\n\n      // Listen for a message with the same message id to be returned\n      this.addMessageListener((responseMessage, messageListener) => {\n        const eventData = getEventData(responseMessage);\n        if (eventData.messageId === messageId) {\n          clearTimeout(messageDroppedTimeout);\n          messageDroppedTimeout = undefined;\n          this.removeMessageListener(messageListener.id);\n          resolve(eventData);\n        }\n      });\n    });\n\n    this.worker.postMessage(messageObject, transfer);\n\n    return messageIdListener;\n  }\n\n  addMessageListener(callback) {\n    this.messageListeners.push({\n      id: generateId(),\n      callback: callback\n    });\n  }\n\n  removeMessageListener(id) {\n    let messageListenerIndex;\n    this.messageListeners.some((messageListener, index) => {\n      if (messageListener.id === id) {\n        messageListenerIndex = index;\n        return true;\n      }\n\n      return false;\n    });\n\n    if (messageListenerIndex !== undefined) {\n      this.messageListeners.splice(messageListenerIndex, 1);\n    }\n  }\n\n  _onMessageHandler(message) {\n    this.messageListeners.forEach(messageListener => {\n      messageListener.callback(message, messageListener);\n    });\n  }\n}\n","import { postMessage, onMessage } from '../../../worker/workerapi';\nimport { WORKER_MESSAGE_TYPE } from '../../../worker/constants';\nimport { getEventData } from '../../../worker/util';\nimport { getSmartWorkerMessage } from '../../../worker/smartworker';\n\n// Function to handle on message from graphics worker\n// to the lib worker\nexport function graphicsWorkerOnMessage(libWorker, event) {\n  // Handle our messages from the main thread\n  const eventData = getEventData(event);\n\n  switch (eventData.message.type) {\n    case WORKER_MESSAGE_TYPE.GET_CONSTANTS: {\n      libWorker.WASMBOY_CURRENT_FRAME_OUTPUT_LOCATION = libWorker.wasmInstance.exports.FRAME_LOCATION.valueOf();\n      libWorker.WASMBOY_CURRENT_FRAME_SIZE = libWorker.wasmInstance.exports.FRAME_SIZE.valueOf();\n      // Forward to our lib worker\n      libWorker.graphicsWorkerPort.postMessage(\n        getSmartWorkerMessage(\n          {\n            type: WORKER_MESSAGE_TYPE.GET_CONSTANTS_DONE,\n            WASMBOY_CURRENT_FRAME_OUTPUT_LOCATION: libWorker.wasmInstance.exports.FRAME_LOCATION.valueOf()\n          },\n          eventData.messageId\n        )\n      );\n      return;\n    }\n  }\n}\n","import { postMessage, onMessage } from '../../../worker/workerapi';\nimport { WORKER_MESSAGE_TYPE } from '../../../worker/constants';\nimport { getEventData } from '../../../worker/util';\nimport { getSmartWorkerMessage } from '../../../worker/smartworker';\n\n// Function to handler audio worker on message to the libWorker\nexport function audioWorkerOnMessage(libWorker, event) {\n  // Handle our messages from the main thread\n  const eventData = getEventData(event);\n\n  switch (eventData.message.type) {\n    case WORKER_MESSAGE_TYPE.GET_CONSTANTS: {\n      libWorker.WASMBOY_SOUND_OUTPUT_LOCATION = libWorker.wasmInstance.exports.AUDIO_BUFFER_LOCATION.valueOf();\n      libWorker.WASMBOY_CHANNEL_1_OUTPUT_LOCATION = libWorker.wasmInstance.exports.CHANNEL_1_BUFFER_LOCATION.valueOf();\n      libWorker.WASMBOY_CHANNEL_2_OUTPUT_LOCATION = libWorker.wasmInstance.exports.CHANNEL_2_BUFFER_LOCATION.valueOf();\n      libWorker.WASMBOY_CHANNEL_3_OUTPUT_LOCATION = libWorker.wasmInstance.exports.CHANNEL_3_BUFFER_LOCATION.valueOf();\n      libWorker.WASMBOY_CHANNEL_4_OUTPUT_LOCATION = libWorker.wasmInstance.exports.CHANNEL_4_BUFFER_LOCATION.valueOf();\n\n      // Forward to our lib worker\n      libWorker.audioWorkerPort.postMessage(\n        getSmartWorkerMessage(\n          {\n            type: WORKER_MESSAGE_TYPE.GET_CONSTANTS_DONE,\n            WASMBOY_SOUND_OUTPUT_LOCATION: libWorker.wasmInstance.exports.AUDIO_BUFFER_LOCATION.valueOf()\n          },\n          eventData.messageId\n        )\n      );\n      return;\n    }\n\n    case WORKER_MESSAGE_TYPE.AUDIO_LATENCY: {\n      libWorker.currentAudioLatencyInSeconds = eventData.message.latency;\n      return;\n    }\n  }\n}\n","import { postMessage, onMessage } from '../../../worker/workerapi';\nimport { WORKER_MESSAGE_TYPE } from '../../../worker/constants';\nimport { getEventData } from '../../../worker/util';\nimport { getSmartWorkerMessage } from '../../../worker/smartworker';\n\n// Handler for when the controller worker posts to the libWorker\nexport function controllerWorkerOnMessage(libWorker, event) {\n  // Handle our messages from the main thread\n  const eventData = getEventData(event);\n\n  switch (eventData.message.type) {\n    case WORKER_MESSAGE_TYPE.SET_JOYPAD_STATE: {\n      // Config will come in as an array, pass in values using apply\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply\n      const setJoypadStateParamsAsArray = eventData.message.setJoypadStateParamsAsArray;\n      libWorker.wasmInstance.exports.setJoypadState.apply(libWorker, setJoypadStateParamsAsArray);\n      return;\n    }\n  }\n}\n","// Private function to get the caretridge rom\nexport function getCartridgeRom(libWorker) {\n  if (!libWorker.wasmByteMemory) {\n    return new Uint8Array();\n  }\n\n  // Depening on the rom type, we will have different rom sizes.\n  // Due memory restrictions described in:\n  // https://developers.google.com/web/fundamentals/instant-and-offline/web-storage/offline-for-pwa\n  // We will make sure to only store as much as we need per ROM :)\n\n  // Similar to `initializeCartridgeType()` in `wasm/memory/memory.ts`\n  // We will determine our cartridge type\n  // Get our game MBC type from the cartridge header\n  // http://gbdev.gg8.se/wiki/articles/The_Cartridge_Header\n  let cartridgeType = libWorker.wasmByteMemory[libWorker.WASMBOY_GAME_BYTES_LOCATION + 0x0147];\n\n  let romSize = undefined;\n  if (cartridgeType === 0x00) {\n    // ROM only, 32KB\n    romSize = 0x8000;\n  } else if (cartridgeType >= 0x01 && cartridgeType <= 0x03) {\n    // MBC1 2MB of ROM\n    romSize = 0x200000;\n  } else if (cartridgeType >= 0x05 && cartridgeType <= 0x06) {\n    // MBC2 256KB ROM\n    romSize = 0x40000;\n  } else if (cartridgeType >= 0x0f && cartridgeType <= 0x13) {\n    // MBC3 2MB of ROM\n    romSize = 0x200000;\n  } else if (cartridgeType >= 0x19 && cartridgeType <= 0x1e) {\n    // MBC5 8MB of ROM\n    romSize = 0x800000;\n  }\n\n  if (!romSize) {\n    return new Uint8Array();\n  }\n\n  // Finally fill our cartridgeRam from the ram in memory\n  const cartridgeRom = libWorker.wasmByteMemory.slice(\n    libWorker.WASMBOY_GAME_BYTES_LOCATION,\n    libWorker.WASMBOY_GAME_BYTES_LOCATION + romSize\n  );\n  return cartridgeRom;\n}\n","// Private function to get the cartridge ram\nexport function getCartridgeRam(libWorker) {\n  if (!libWorker.wasmByteMemory) {\n    return new Uint8Array();\n  }\n\n  // Depening on the rom type, we will have different ram sizes.\n  // Due memory restrictions described in:\n  // https://developers.google.com/web/fundamentals/instant-and-offline/web-storage/offline-for-pwa\n  // We will make sure to only store as much as we need per ROM :)\n\n  // Similar to `initializeCartridgeType()` in `wasm/memory/memory.ts`\n  // We will determine our cartridge type\n  // Get our game MBC type from the cartridge header\n  // http://gbdev.gg8.se/wiki/articles/The_Cartridge_Header\n  let cartridgeType = libWorker.wasmByteMemory[libWorker.WASMBOY_GAME_BYTES_LOCATION + 0x0147];\n\n  let ramSize = undefined;\n  if (cartridgeType === 0x00) {\n    // No memory for this rom type\n    return new Uint8Array();\n  } else if (cartridgeType >= 0x01 && cartridgeType <= 0x03) {\n    // MBC1 32KB of Ram\n    ramSize = 0x8000;\n  } else if (cartridgeType >= 0x05 && cartridgeType <= 0x06) {\n    // MBC2 512X4 Bytes, 2KB\n    ramSize = 0x800;\n  } else if (cartridgeType >= 0x0f && cartridgeType <= 0x13) {\n    // MBC3 32KB of Ram\n    ramSize = 0x8000;\n  } else if (cartridgeType >= 0x19 && cartridgeType <= 0x1e) {\n    // MBC5 128KB of Ram\n    ramSize = 0x20000;\n  }\n\n  if (!ramSize) {\n    return new Uint8Array();\n  }\n\n  // Finally fill our cartridgeRam from the ram in memory\n  const cartridgeRam = libWorker.wasmByteMemory.slice(\n    libWorker.WASMBOY_GAME_RAM_BANKS_LOCATION,\n    libWorker.WASMBOY_GAME_RAM_BANKS_LOCATION + ramSize\n  );\n  return cartridgeRam;\n}\n","// Function to get the cartridge header\nexport function getCartridgeHeader(libWorker) {\n  if (!libWorker.wasmByteMemory) {\n    return new Uint8Array();\n  }\n\n  // Header is at 0x0134 - 0x014F\n  // http://gbdev.gg8.se/wiki/articles/The_Cartridge_Header\n  const headerLength = 0x014f - 0x0134;\n  const headerLocation = libWorker.WASMBOY_GAME_BYTES_LOCATION + 0x0134;\n  const headerArray = libWorker.wasmByteMemory.slice(headerLocation, headerLocation + headerLength);\n\n  return headerArray;\n}\n","// Returns the standard 0xFFFF gameboy memory\n// You will normally see in gameboy docs.\n// This is returned from the core, and represents\n// This wasmboy gameboy state\nexport function getGameBoyMemory(libWorker) {\n  return libWorker.wasmByteMemory.slice(\n    libWorker.WASMBOY_INTERNAL_MEMORY_LOCATION,\n    libWorker.WASMBOY_INTERNAL_MEMORY_LOCATION + libWorker.WASMBOY_INTERNAL_MEMORY_SIZE\n  );\n}\n","// Function to get the current palette data for\n// GBC in memory. This is needed to load state with\n// The correct colors\nexport function getPaletteMemory(libWorker) {\n  return libWorker.wasmByteMemory.slice(\n    libWorker.WASMBOY_PALETTE_MEMORY_LOCATION,\n    libWorker.WASMBOY_PALETTE_MEMORY_LOCATION + libWorker.WASMBOY_PALETTE_MEMORY_SIZE\n  );\n}\n","// Returns the internal savestate of the wasmboy core,\n// To save all soft values held in memory\nexport function getInternalState(libWorker) {\n  libWorker.wasmInstance.exports.saveState();\n  return libWorker.wasmByteMemory.slice(\n    libWorker.WASMBOY_INTERNAL_STATE_LOCATION,\n    libWorker.WASMBOY_INTERNAL_STATE_LOCATION + libWorker.WASMBOY_INTERNAL_STATE_SIZE\n  );\n}\n","import { postMessage, onMessage } from '../../../worker/workerapi';\nimport { WORKER_MESSAGE_TYPE, MEMORY_TYPE } from '../../../worker/constants';\nimport { getEventData } from '../../../worker/util';\nimport { getSmartWorkerMessage } from '../../../worker/smartworker';\n\n// Our memory getters\nimport { getCartridgeRom } from './rom';\nimport { getCartridgeRam } from './ram';\nimport { getCartridgeHeader } from './header';\nimport { getGameBoyMemory } from './gameboymemory';\nimport { getPaletteMemory } from './palettememory';\nimport { getInternalState } from './internalstate';\n\n// On message handler for when memory worker\n// posts to lib Worker\nexport function memoryWorkerOnMessage(libWorker, event) {\n  // Handle our messages from the main thread\n  const eventData = getEventData(event);\n\n  switch (eventData.message.type) {\n    case WORKER_MESSAGE_TYPE.CLEAR_MEMORY: {\n      // Clear Wasm memory\n      // https://docs.google.com/spreadsheets/d/17xrEzJk5-sCB9J2mMJcVnzhbE-XH_NvczVSQH9OHvRk/edit?usp=sharing\n      for (let i = 0; i <= libWorker.wasmByteMemory.length; i++) {\n        libWorker.wasmByteMemory[i] = 0;\n      }\n\n      const wasmByteMemory = libWorker.wasmByteMemory.slice(0);\n      libWorker.memoryWorkerPort.postMessage(\n        getSmartWorkerMessage(\n          {\n            type: WORKER_MESSAGE_TYPE.CLEAR_MEMORY_DONE,\n            wasmByteMemory: wasmByteMemory.buffer\n          },\n          eventData.messageId\n        ),\n        [wasmByteMemory.buffer]\n      );\n      return;\n    }\n\n    case WORKER_MESSAGE_TYPE.GET_CONSTANTS: {\n      libWorker.WASMBOY_GAME_BYTES_LOCATION = libWorker.wasmInstance.exports.CARTRIDGE_ROM_LOCATION.valueOf();\n      (libWorker.WASMBOY_GAME_RAM_BANKS_LOCATION = libWorker.wasmInstance.exports.CARTRIDGE_RAM_LOCATION.valueOf()),\n        (libWorker.WASMBOY_INTERNAL_STATE_SIZE = libWorker.wasmInstance.exports.WASMBOY_STATE_SIZE.valueOf()),\n        (libWorker.WASMBOY_INTERNAL_STATE_LOCATION = libWorker.wasmInstance.exports.WASMBOY_STATE_LOCATION.valueOf()),\n        (libWorker.WASMBOY_INTERNAL_MEMORY_SIZE = libWorker.wasmInstance.exports.GAMEBOY_INTERNAL_MEMORY_SIZE.valueOf()),\n        (libWorker.WASMBOY_INTERNAL_MEMORY_LOCATION = libWorker.wasmInstance.exports.GAMEBOY_INTERNAL_MEMORY_LOCATION.valueOf()),\n        (libWorker.WASMBOY_PALETTE_MEMORY_SIZE = libWorker.wasmInstance.exports.GBC_PALETTE_SIZE.valueOf()),\n        (libWorker.WASMBOY_PALETTE_MEMORY_LOCATION = libWorker.wasmInstance.exports.GBC_PALETTE_LOCATION.valueOf());\n\n      // Forward to our lib worker\n      libWorker.memoryWorkerPort.postMessage(\n        getSmartWorkerMessage(\n          {\n            type: WORKER_MESSAGE_TYPE.GET_CONSTANTS_DONE,\n            WASMBOY_GAME_BYTES_LOCATION: libWorker.wasmInstance.exports.CARTRIDGE_ROM_LOCATION.valueOf(),\n            WASMBOY_GAME_RAM_BANKS_LOCATION: libWorker.wasmInstance.exports.CARTRIDGE_RAM_LOCATION.valueOf(),\n            WASMBOY_INTERNAL_STATE_SIZE: libWorker.wasmInstance.exports.WASMBOY_STATE_SIZE.valueOf(),\n            WASMBOY_INTERNAL_STATE_LOCATION: libWorker.wasmInstance.exports.WASMBOY_STATE_LOCATION.valueOf(),\n            WASMBOY_INTERNAL_MEMORY_SIZE: libWorker.wasmInstance.exports.GAMEBOY_INTERNAL_MEMORY_SIZE.valueOf(),\n            WASMBOY_INTERNAL_MEMORY_LOCATION: libWorker.wasmInstance.exports.GAMEBOY_INTERNAL_MEMORY_LOCATION.valueOf(),\n            WASMBOY_PALETTE_MEMORY_SIZE: libWorker.wasmInstance.exports.GBC_PALETTE_SIZE.valueOf(),\n            WASMBOY_PALETTE_MEMORY_LOCATION: libWorker.wasmInstance.exports.GBC_PALETTE_LOCATION.valueOf()\n          },\n          eventData.messageId\n        )\n      );\n      return;\n    }\n\n    case WORKER_MESSAGE_TYPE.SET_MEMORY: {\n      const memoryKeys = Object.keys(eventData.message);\n\n      if (memoryKeys.includes(MEMORY_TYPE.CARTRIDGE_ROM)) {\n        libWorker.wasmByteMemory.set(new Uint8Array(eventData.message[MEMORY_TYPE.CARTRIDGE_ROM]), libWorker.WASMBOY_GAME_BYTES_LOCATION);\n      }\n      if (memoryKeys.includes(MEMORY_TYPE.CARTRIDGE_RAM)) {\n        libWorker.wasmByteMemory.set(\n          new Uint8Array(eventData.message[MEMORY_TYPE.CARTRIDGE_RAM]),\n          libWorker.WASMBOY_GAME_RAM_BANKS_LOCATION\n        );\n      }\n      if (memoryKeys.includes(MEMORY_TYPE.GAMEBOY_MEMORY)) {\n        libWorker.wasmByteMemory.set(\n          new Uint8Array(eventData.message[MEMORY_TYPE.GAMEBOY_MEMORY]),\n          libWorker.WASMBOY_INTERNAL_MEMORY_LOCATION\n        );\n      }\n      if (memoryKeys.includes(MEMORY_TYPE.PALETTE_MEMORY)) {\n        libWorker.wasmByteMemory.set(\n          new Uint8Array(eventData.message[MEMORY_TYPE.PALETTE_MEMORY]),\n          libWorker.WASMBOY_PALETTE_MEMORY_LOCATION\n        );\n      }\n      if (memoryKeys.includes(MEMORY_TYPE.INTERNAL_STATE)) {\n        libWorker.wasmByteMemory.set(\n          new Uint8Array(eventData.message[MEMORY_TYPE.INTERNAL_STATE]),\n          libWorker.WASMBOY_INTERNAL_STATE_LOCATION\n        );\n        libWorker.wasmInstance.exports.loadState();\n      }\n\n      libWorker.memoryWorkerPort.postMessage(\n        getSmartWorkerMessage(\n          {\n            type: WORKER_MESSAGE_TYPE.SET_MEMORY_DONE\n          },\n          eventData.messageId\n        )\n      );\n\n      return;\n    }\n\n    case WORKER_MESSAGE_TYPE.GET_MEMORY: {\n      // Construct our data object\n      const responseMemory = {\n        type: WORKER_MESSAGE_TYPE.GET_MEMORY\n      };\n      const responseTransferrables = [];\n\n      const memoryTypes = eventData.message.memoryTypes;\n\n      if (memoryTypes.includes(MEMORY_TYPE.CARTRIDGE_ROM)) {\n        const cartridgeRom = getCartridgeRom(libWorker).buffer;\n        responseMemory[MEMORY_TYPE.CARTRIDGE_ROM] = cartridgeRom;\n        responseTransferrables.push(cartridgeRom);\n      }\n      if (memoryTypes.includes(MEMORY_TYPE.CARTRIDGE_RAM)) {\n        const cartridgeRam = getCartridgeRam(libWorker).buffer;\n        responseMemory[MEMORY_TYPE.CARTRIDGE_RAM] = cartridgeRam;\n        responseTransferrables.push(cartridgeRam);\n      }\n      if (memoryTypes.includes(MEMORY_TYPE.CARTRIDGE_HEADER)) {\n        const cartridgeHeader = getCartridgeHeader(libWorker).buffer;\n        responseMemory[MEMORY_TYPE.CARTRIDGE_HEADER] = cartridgeHeader;\n        responseTransferrables.push(cartridgeHeader);\n      }\n      if (memoryTypes.includes(MEMORY_TYPE.GAMEBOY_MEMORY)) {\n        const gameboyMemory = getGameBoyMemory(libWorker).buffer;\n        responseMemory[MEMORY_TYPE.GAMEBOY_MEMORY] = gameboyMemory;\n        responseTransferrables.push(gameboyMemory);\n      }\n      if (memoryTypes.includes(MEMORY_TYPE.PALETTE_MEMORY)) {\n        const paletteMemory = getPaletteMemory(libWorker).buffer;\n        responseMemory[MEMORY_TYPE.PALETTE_MEMORY] = paletteMemory;\n        responseTransferrables.push(paletteMemory);\n      }\n      if (memoryTypes.includes(MEMORY_TYPE.INTERNAL_STATE)) {\n        libWorker.wasmInstance.exports.saveState();\n        const internalState = getInternalState(libWorker).buffer;\n        responseMemory[MEMORY_TYPE.INTERNAL_STATE] = internalState;\n        responseTransferrables.push(internalState);\n      }\n\n      libWorker.memoryWorkerPort.postMessage(getSmartWorkerMessage(responseMemory, eventData.messageId), responseTransferrables);\n\n      return;\n    }\n  }\n}\n","// Banner placed by rollup to mock out some items on our esm build\n// This is useful for things like wasmmemory\nconst wasmboyMemorySize = 0x8b0000; // Simply initialized to the size we need\n\nconst wasmByteMemory = new Uint8ClampedArray(wasmboyMemorySize); // Memory mock\n\nconst memory = {\n  size: () => {\n    return wasmboyMemorySize;\n  },\n  grow: () => {},\n  wasmByteMemory: wasmByteMemory\n};\n\nconst load = offset => {\n  return wasmByteMemory[offset];\n};\n\nconst store = (offset, value) => {\n  wasmByteMemory[offset] = value;\n};\n\nconst abs = value => {\n  return Math.abs(value);\n};\n\nconst ceil = value => {\n  return Math.ceil(value);\n}; // Constants that will be shared by the wasm core of the emulator\n// And libraries built around the wasm (such as the official JS), or @CryZe wasmboy-rs\n// ----------------------------------\n// Wasmboy Memory Map\n// https://docs.google.com/spreadsheets/d/17xrEzJk5-sCB9J2mMJcVnzhbE-XH_NvczVSQH9OHvRk/edit?usp=sharing\n// ----------------------------------\n// AssemblyScript\n\n\nvar ASSEMBLYSCRIPT_MEMORY_LOCATION = 0x000000;\nvar ASSEMBLYSCRIPT_MEMORY_SIZE = 0x000400; // WasmBoy States\n\nvar WASMBOY_STATE_LOCATION = ASSEMBLYSCRIPT_MEMORY_LOCATION + ASSEMBLYSCRIPT_MEMORY_SIZE;\nvar WASMBOY_STATE_SIZE = 0x000400; // Gameboy Internal Memory\n\nvar VIDEO_RAM_LOCATION = WASMBOY_STATE_LOCATION + WASMBOY_STATE_SIZE;\nvar VIDEO_RAM_SIZE = 0x004000;\nvar WORK_RAM_LOCATION = VIDEO_RAM_LOCATION + VIDEO_RAM_SIZE;\nvar WORK_RAM_SIZE = 0x008000;\nvar OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION = WORK_RAM_LOCATION + WORK_RAM_SIZE;\nvar OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE = 0x004000; // General Gameboy Internal Memory\n\nvar GAMEBOY_INTERNAL_MEMORY_LOCATION = VIDEO_RAM_LOCATION;\nvar GAMEBOY_INTERNAL_MEMORY_SIZE = OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION - VIDEO_RAM_LOCATION + OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE; // Graphics Output\n\nvar GBC_PALETTE_LOCATION = OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION + OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE;\nvar GBC_PALETTE_SIZE = 0x000080;\nvar BG_PRIORITY_MAP_LOCATION = GBC_PALETTE_LOCATION + GBC_PALETTE_SIZE;\nvar BG_PRIORITY_MAP_SIZE = 0x005c00;\nvar FRAME_LOCATION = BG_PRIORITY_MAP_LOCATION + BG_PRIORITY_MAP_SIZE;\nvar FRAME_SIZE = 0x016c00;\nvar BACKGROUND_MAP_LOCATION = FRAME_LOCATION + FRAME_SIZE;\nvar BACKGROUND_MAP_SIZE = 0x030000;\nvar TILE_DATA_LOCATION = BACKGROUND_MAP_LOCATION + BACKGROUND_MAP_SIZE;\nvar TILE_DATA_SIZE = 0x024000;\nvar OAM_TILES_LOCATION = TILE_DATA_LOCATION + TILE_DATA_SIZE;\nvar OAM_TILES_SIZE = 0x003c00; // General Graphics Output\n\nvar GRAPHICS_OUTPUT_LOCATION = GBC_PALETTE_LOCATION;\nvar GRAPHICS_OUTPUT_SIZE = OAM_TILES_LOCATION - GBC_PALETTE_LOCATION + OAM_TILES_SIZE; // Audio Output\n\nvar CHANNEL_1_BUFFER_LOCATION = OAM_TILES_LOCATION + OAM_TILES_SIZE;\nvar CHANNEL_1_BUFFER_SIZE = 0x020000;\nvar CHANNEL_2_BUFFER_LOCATION = CHANNEL_1_BUFFER_LOCATION + CHANNEL_1_BUFFER_SIZE;\nvar CHANNEL_2_BUFFER_SIZE = 0x020000;\nvar CHANNEL_3_BUFFER_LOCATION = CHANNEL_2_BUFFER_LOCATION + CHANNEL_2_BUFFER_SIZE;\nvar CHANNEL_3_BUFFER_SIZE = 0x020000;\nvar CHANNEL_4_BUFFER_LOCATION = CHANNEL_3_BUFFER_LOCATION + CHANNEL_3_BUFFER_SIZE;\nvar CHANNEL_4_BUFFER_SIZE = 0x020000;\nvar AUDIO_BUFFER_LOCATION = CHANNEL_4_BUFFER_LOCATION + CHANNEL_4_BUFFER_SIZE;\nvar AUDIO_BUFFER_SIZE = 0x020000; // Catridge Memory\n\nvar CARTRIDGE_RAM_LOCATION = AUDIO_BUFFER_LOCATION + AUDIO_BUFFER_SIZE;\nvar CARTRIDGE_RAM_SIZE = 0x020000;\nvar CARTRIDGE_ROM_LOCATION = CARTRIDGE_RAM_LOCATION + CARTRIDGE_RAM_SIZE;\nvar CARTRIDGE_ROM_SIZE = 0x7e0400; // Debug Memory\n\nvar DEBUG_GAMEBOY_MEMORY_LOCATION = CARTRIDGE_ROM_LOCATION + CARTRIDGE_ROM_SIZE;\nvar DEBUG_GAMEBOY_MEMORY_SIZE = 0xffff; // Final General Size\n\nvar WASMBOY_MEMORY_LOCATION = 0x000000;\nvar WASMBOY_MEMORY_SIZE = DEBUG_GAMEBOY_MEMORY_LOCATION + DEBUG_GAMEBOY_MEMORY_SIZE + 1;\nvar WASMBOY_WASM_PAGES = ceil(WASMBOY_MEMORY_SIZE / 1024 / 64) + 1;\n\nvar Config =\n/** @class */\nfunction () {\n  function Config() {} // Boot Rom\n\n\n  Config.enableBootRom = false; // GBC Options\n\n  Config.useGbcWhenAvailable = true; // Batch Processing\n\n  Config.audioBatchProcessing = false;\n  Config.graphicsBatchProcessing = false;\n  Config.timersBatchProcessing = false; // Scanline Rendering\n\n  Config.graphicsDisableScanlineRendering = false; // Acumulate Sound Samples\n\n  Config.audioAccumulateSamples = false; // Tile Rednering\n\n  Config.tileRendering = false;\n  Config.tileCaching = false; // Audio Debugging\n\n  Config.enableAudioDebugging = false;\n  return Config;\n}(); // Portable Code for JS Wasm Benchmarking\n// https://github.com/AssemblyScript/assemblyscript/wiki/Writing-portable-code\n// https://github.com/AssemblyScript/assemblyscript/blob/master/std/portable/index.js\n\n\nfunction u8Portable(param) {\n  return param & 0xff;\n}\n\nfunction u16Portable(param) {\n  return param & 0xffff;\n}\n\nfunction i8Portable(param) {\n  return param << 24 >> 24;\n}\n\nfunction i32Portable(param) {\n  return param | 0;\n} // Set flag bit on on register F. For instance set zero flag to zero -> (7, 0)\n\n\nfunction setFlagBit(flagBit, flagValue) {\n  var bitwiseOperand = u8Portable(1 << flagBit);\n\n  if (flagValue > 0) {\n    Cpu.registerF = Cpu.registerF | bitwiseOperand;\n  } else {\n    // XOR out the two ones\n    bitwiseOperand = 0xff ^ bitwiseOperand;\n    Cpu.registerF = Cpu.registerF & bitwiseOperand;\n  }\n\n  return Cpu.registerF;\n} // Overload the set flag bit for ease of use\n\n\nfunction setZeroFlag$$1(value) {\n  setFlagBit(7, value);\n}\n\nfunction setSubtractFlag(value) {\n  setFlagBit(6, value);\n}\n\nfunction setHalfCarryFlag(value) {\n  setFlagBit(5, value);\n}\n\nfunction setCarryFlag(value) {\n  setFlagBit(4, value);\n} // Getters for flags\n\n\nfunction getZeroFlag$$1() {\n  return Cpu.registerF >> 7 & 0x01;\n}\n\nfunction getSubtractFlag() {\n  return Cpu.registerF >> 6 & 0x01;\n}\n\nfunction getHalfCarryFlag() {\n  return Cpu.registerF >> 5 & 0x01;\n}\n\nfunction getCarryFlag$$1() {\n  return Cpu.registerF >> 4 & 0x01;\n} // Must be run before the register actually performs the add\n// amountToAdd i16, since max number can be an u8\n\n\nfunction checkAndSetEightBitHalfCarryFlag(value, amountToAdd) {\n  if (amountToAdd >= 0) {\n    // https://robdor.com/2016/08/10/gameboy-emulator-half-carry-flag/\n    var result = u8Portable((value & 0x0f) + (amountToAdd & 0x0f)) & 0x10;\n    setHalfCarryFlag(result !== 0x00);\n  } else {\n    // From: https://github.com/djhworld/gomeboycolor/blob/master/src/cpu/index.go\n    // CTRL+F \"subBytes(a, b byte)\"\n    setHalfCarryFlag((abs(amountToAdd) & 0x0f) > (value & 0x0f));\n  }\n}\n\nfunction checkAndSetEightBitCarryFlag(value, amountToAdd) {\n  if (amountToAdd >= 0) {\n    var result = u8Portable(value + amountToAdd);\n    setCarryFlag(value > result);\n  } else {\n    setCarryFlag(abs(amountToAdd) > value);\n  }\n} // Function to handle 16 bit addition overflow, and set the carry flags accordingly\n// i32 on valueTwo to support passing signed immedaite values\n\n\nfunction checkAndSetSixteenBitFlagsAddOverflow(valueOne, valueTwo, useStackPointerBits) {\n  // need to differentiate between HL and SP\n  // HL carries are at 11 and 15, SP carries are at 3 and 7 :p\n  if (useStackPointerBits) {\n    // Logic from : https://github.com/nakardo/node-gameboy/blob/master/lib/cpu/opcodes.js\n    // CTRL+F add_sp_n\n    // using the stack pointer bits means we can safely assume the value is signed\n    var signedValueOne = valueOne;\n    var result = signedValueOne + valueTwo;\n    var flagXor = signedValueOne ^ valueTwo ^ result;\n    setHalfCarryFlag((flagXor & 0x10) !== 0);\n    setCarryFlag((flagXor & 0x100) !== 0);\n  } else {\n    // Logic from: https://github.com/djhworld/gomeboycolor/blob/master/src/cpu/index.go\n    // CTRL+F addWords\n    // Value two is not signed\n    var result = u16Portable(valueOne + valueTwo); // Check the carry flag by allowing the overflow\n\n    setCarryFlag(result < valueOne); // To check for half carry flag (bit 15), by XOR'ing valyes, and and'ing the bit in question\n\n    var halfCarryXor = valueOne ^ valueTwo ^ result;\n    var halfCarryAnd = u16Portable(halfCarryXor & 0x1000);\n    setHalfCarryFlag(halfCarryAnd !== 0x00);\n  }\n} // File for all of the colors for different GB Palletes\n// https://i.imgur.com/HupBY.png\n// https://www.libretro.com/index.php/gambatte-progress-report/\n// https://tcrf.net/Notes:Game_Boy_Color_Bootstrap_ROM\n// Our default wasmboy gb colors\n\n\nvar WasmBoyGBColors =\n/** @class */\nfunction () {\n  function WasmBoyGBColors() {} //Bg\n\n\n  WasmBoyGBColors.bgWhite = 0xf2f2f2;\n  WasmBoyGBColors.bgLightGrey = 0xa0a0a0;\n  WasmBoyGBColors.bgDarkGrey = 0x585858;\n  WasmBoyGBColors.bgBlack = 0x080808; // Obj 0\n\n  WasmBoyGBColors.obj0White = 0xf2f2f2;\n  WasmBoyGBColors.obj0LightGrey = 0xa0a0a0;\n  WasmBoyGBColors.obj0DarkGrey = 0x585858;\n  WasmBoyGBColors.obj0Black = 0x080808; // Obj1\n\n  WasmBoyGBColors.obj1White = 0xf2f2f2;\n  WasmBoyGBColors.obj1LightGrey = 0xa0a0a0;\n  WasmBoyGBColors.obj1DarkGrey = 0x585858;\n  WasmBoyGBColors.obj1Black = 0x080808;\n  return WasmBoyGBColors;\n}(); // Action Button: Right\n\n\nvar GreenColors =\n/** @class */\nfunction () {\n  function GreenColors() {} //Bg\n\n\n  GreenColors.bgWhite = 0xffffff;\n  GreenColors.bgLightGrey = 0x52ff00;\n  GreenColors.bgDarkGrey = 0xff4200;\n  GreenColors.bgBlack = 0x000000; // Obj 0\n\n  GreenColors.obj0White = 0xffffff;\n  GreenColors.obj0LightGrey = 0x52ff00;\n  GreenColors.obj0DarkGrey = 0xff4200;\n  GreenColors.obj0Black = 0x000000; // Obj1\n\n  GreenColors.obj1White = 0xffffff;\n  GreenColors.obj1LightGrey = 0x52ff00;\n  GreenColors.obj1DarkGrey = 0xff4200;\n  GreenColors.obj1Black = 0x000000;\n  return GreenColors;\n}(); // Action Button: A + Down\n\n\nvar OrangeColors =\n/** @class */\nfunction () {\n  function OrangeColors() {} //Bg\n\n\n  OrangeColors.bgWhite = 0xffffff;\n  OrangeColors.bgLightGrey = 0xffff00;\n  OrangeColors.bgDarkGrey = 0xff0000;\n  OrangeColors.bgBlack = 0x000000; // Obj 0\n\n  OrangeColors.obj0White = 0xffffff;\n  OrangeColors.obj0LightGrey = 0xffff00;\n  OrangeColors.obj0DarkGrey = 0xff0000;\n  OrangeColors.obj0Black = 0x000000; // Obj1\n\n  OrangeColors.obj1White = 0xffffff;\n  OrangeColors.obj1LightGrey = 0xffff00;\n  OrangeColors.obj1DarkGrey = 0xff0000;\n  OrangeColors.obj1Black = 0x000000;\n  return OrangeColors;\n}(); // Action Button: Up\n\n\nvar BrownColors =\n/** @class */\nfunction () {\n  function BrownColors() {} //Bg\n\n\n  BrownColors.bgWhite = 0xffffff;\n  BrownColors.bgLightGrey = 0xffad63;\n  BrownColors.bgDarkGrey = 0x843100;\n  BrownColors.bgBlack = 0x000000; // Obj 0\n\n  BrownColors.obj0White = 0xffffff;\n  BrownColors.obj0LightGrey = 0xffad63;\n  BrownColors.obj0DarkGrey = 0x843100;\n  BrownColors.obj0Black = 0x000000; // Obj1\n\n  BrownColors.obj1White = 0xffffff;\n  BrownColors.obj1LightGrey = 0xffad63;\n  BrownColors.obj1DarkGrey = 0x843100;\n  BrownColors.obj1Black = 0x000000;\n  return BrownColors;\n}(); // Action Button: B + Right\n\n\nvar InvertedColors =\n/** @class */\nfunction () {\n  function InvertedColors() {} //Bg\n\n\n  InvertedColors.bgWhite = 0x000000;\n  InvertedColors.bgLightGrey = 0x008484;\n  InvertedColors.bgDarkGrey = 0xffde00;\n  InvertedColors.bgBlack = 0xffffff; // Obj 0\n\n  InvertedColors.obj0White = 0x000000;\n  InvertedColors.obj0LightGrey = 0x008484;\n  InvertedColors.obj0DarkGrey = 0xffde00;\n  InvertedColors.obj0Black = 0xffffff; // Obj1\n\n  InvertedColors.obj1White = 0x000000;\n  InvertedColors.obj1LightGrey = 0x008484;\n  InvertedColors.obj1DarkGrey = 0xffde00;\n  InvertedColors.obj1Black = 0xffffff;\n  return InvertedColors;\n}(); // Action Button: B + Left\n\n\nvar GrayscaleColors =\n/** @class */\nfunction () {\n  function GrayscaleColors() {} //Bg\n\n\n  GrayscaleColors.bgWhite = 0xffffff;\n  GrayscaleColors.bgLightGrey = 0xa5a5a5;\n  GrayscaleColors.bgDarkGrey = 0x525252;\n  GrayscaleColors.bgBlack = 0x000000; // Obj 0\n\n  GrayscaleColors.obj0White = 0xffffff;\n  GrayscaleColors.obj0LightGrey = 0xa5a5a5;\n  GrayscaleColors.obj0DarkGrey = 0x525252;\n  GrayscaleColors.obj0Black = 0x000000; // Obj1\n\n  GrayscaleColors.obj1White = 0xffffff;\n  GrayscaleColors.obj1LightGrey = 0xa5a5a5;\n  GrayscaleColors.obj1DarkGrey = 0x525252;\n  GrayscaleColors.obj1Black = 0x000000;\n  return GrayscaleColors;\n}(); // Action Button: Down\n\n\nvar PastelMixColors =\n/** @class */\nfunction () {\n  function PastelMixColors() {} //Bg\n\n\n  PastelMixColors.bgWhite = 0xffffa5;\n  PastelMixColors.bgLightGrey = 0xff9494;\n  PastelMixColors.bgDarkGrey = 0x9494ff;\n  PastelMixColors.bgBlack = 0x000000; // Obj 0\n\n  PastelMixColors.obj0White = 0xffffa5;\n  PastelMixColors.obj0LightGrey = 0xff9494;\n  PastelMixColors.obj0DarkGrey = 0x9494ff;\n  PastelMixColors.obj0Black = 0x000000; // Obj1\n\n  PastelMixColors.obj1White = 0xffffa5;\n  PastelMixColors.obj1LightGrey = 0xff9494;\n  PastelMixColors.obj1DarkGrey = 0x9494ff;\n  PastelMixColors.obj1Black = 0x000000;\n  return PastelMixColors;\n}(); // Action Button: B + Up\n\n\nvar DarkBrownColors =\n/** @class */\nfunction () {\n  function DarkBrownColors() {} //Bg\n\n\n  DarkBrownColors.bgWhite = 0xffe6c5;\n  DarkBrownColors.bgLightGrey = 0xce9c84;\n  DarkBrownColors.bgDarkGrey = 0x846b29;\n  DarkBrownColors.bgBlack = 0x5a3108; // Obj 0\n\n  DarkBrownColors.obj0White = 0xffffff;\n  DarkBrownColors.obj0LightGrey = 0xffad63;\n  DarkBrownColors.obj0DarkGrey = 0x843100;\n  DarkBrownColors.obj0Black = 0x000000; // Obj1\n\n  DarkBrownColors.obj1White = 0xffffff;\n  DarkBrownColors.obj1LightGrey = 0xffad63;\n  DarkBrownColors.obj1DarkGrey = 0x843100;\n  DarkBrownColors.obj1Black = 0x000000;\n  return DarkBrownColors;\n}(); // Action Button: A + Right\n\n\nvar DarkGreenColors =\n/** @class */\nfunction () {\n  function DarkGreenColors() {} //Bg\n\n\n  DarkGreenColors.bgWhite = 0xffffff;\n  DarkGreenColors.bgLightGrey = 0x7bff31;\n  DarkGreenColors.bgDarkGrey = 0x0063c5;\n  DarkGreenColors.bgBlack = 0x000000; // Obj 0\n\n  DarkGreenColors.obj0White = 0xffffff;\n  DarkGreenColors.obj0LightGrey = 0xff8484;\n  DarkGreenColors.obj0DarkGrey = 0x943a3a;\n  DarkGreenColors.obj0Black = 0x000000; // Obj1\n\n  DarkGreenColors.obj1White = 0xffffff;\n  DarkGreenColors.obj1LightGrey = 0xff8484;\n  DarkGreenColors.obj1DarkGrey = 0x943a3a;\n  DarkGreenColors.obj1Black = 0x000000;\n  return DarkGreenColors;\n}(); // Action Button: A + Left\n\n\nvar DarkBlueColors =\n/** @class */\nfunction () {\n  function DarkBlueColors() {} //Bg\n\n\n  DarkBlueColors.bgWhite = 0xffffff;\n  DarkBlueColors.bgLightGrey = 0x8c8cde;\n  DarkBlueColors.bgDarkGrey = 0x52528c;\n  DarkBlueColors.bgBlack = 0x000000; // Obj 0\n\n  DarkBlueColors.obj0White = 0xffffff;\n  DarkBlueColors.obj0LightGrey = 0xff8484;\n  DarkBlueColors.obj0DarkGrey = 0x943a3a;\n  DarkBlueColors.obj0Black = 0x000000; // Obj1\n\n  DarkBlueColors.obj1White = 0xffffff;\n  DarkBlueColors.obj1LightGrey = 0xffad63;\n  DarkBlueColors.obj1DarkGrey = 0x843100;\n  DarkBlueColors.obj1Black = 0x000000;\n  return DarkBlueColors;\n}(); // Action Button: A + Up\n\n\nvar RedColors =\n/** @class */\nfunction () {\n  function RedColors() {} //Bg\n\n\n  RedColors.bgWhite = 0xffffff;\n  RedColors.bgLightGrey = 0xff8484;\n  RedColors.bgDarkGrey = 0x943a3a;\n  RedColors.bgBlack = 0x000000; // Obj 0\n\n  RedColors.obj0White = 0xffffff;\n  RedColors.obj0LightGrey = 0x7bff31;\n  RedColors.obj0DarkGrey = 0x008400;\n  RedColors.obj0Black = 0x000000; // Obj1\n\n  RedColors.obj1White = 0xffffff;\n  RedColors.obj1LightGrey = 0x63a5ff;\n  RedColors.obj1DarkGrey = 0x0000ff;\n  RedColors.obj1Black = 0x000000;\n  return RedColors;\n}(); // Action Button: Left\n\n\nvar BlueColors =\n/** @class */\nfunction () {\n  function BlueColors() {} //Bg\n\n\n  BlueColors.bgWhite = 0xffffff;\n  BlueColors.bgLightGrey = 0x63a5ff;\n  BlueColors.bgDarkGrey = 0x0000ff;\n  BlueColors.bgBlack = 0x000000; // Obj 0\n\n  BlueColors.obj0White = 0xffffff;\n  BlueColors.obj0LightGrey = 0xff8484;\n  BlueColors.obj0DarkGrey = 0x943a3a;\n  BlueColors.obj0Black = 0x000000; // Obj1\n\n  BlueColors.obj1White = 0xffffff;\n  BlueColors.obj1LightGrey = 0x7bff31;\n  BlueColors.obj1DarkGrey = 0x008400;\n  BlueColors.obj1Black = 0x000000;\n  return BlueColors;\n}(); // Action Button: B + Down\n\n\nvar YellowColors =\n/** @class */\nfunction () {\n  function YellowColors() {} //Bg\n\n\n  YellowColors.bgWhite = 0xffffff;\n  YellowColors.bgLightGrey = 0xffff00;\n  YellowColors.bgDarkGrey = 0x7b4a00;\n  YellowColors.bgBlack = 0x000000; // Obj 0\n\n  YellowColors.obj0White = 0xffffff;\n  YellowColors.obj0LightGrey = 0x63a5ff;\n  YellowColors.obj0DarkGrey = 0x0000ff;\n  YellowColors.obj0Black = 0x000000; // Obj1\n\n  YellowColors.obj1White = 0xffffff;\n  YellowColors.obj1LightGrey = 0x7bff31;\n  YellowColors.obj1DarkGrey = 0x008400;\n  YellowColors.obj1Black = 0x000000;\n  return YellowColors;\n}(); // Assigned Color Palettes\n// Alleyway\n\n\nvar Table00Entry08Colors =\n/** @class */\nfunction () {\n  function Table00Entry08Colors() {} //Bg\n\n\n  Table00Entry08Colors.bgWhite = 0xa59cff;\n  Table00Entry08Colors.bgLightGrey = 0xffff00;\n  Table00Entry08Colors.bgDarkGrey = 0x006300;\n  Table00Entry08Colors.bgBlack = 0x000000; // Obj 0\n\n  Table00Entry08Colors.obj0White = 0xa59cff;\n  Table00Entry08Colors.obj0LightGrey = 0xffff00;\n  Table00Entry08Colors.obj0DarkGrey = 0x006300;\n  Table00Entry08Colors.obj0Black = 0x000000; // Obj1\n\n  Table00Entry08Colors.obj1White = 0xa59cff;\n  Table00Entry08Colors.obj1LightGrey = 0xffff00;\n  Table00Entry08Colors.obj1DarkGrey = 0x006300;\n  Table00Entry08Colors.obj1Black = 0x000000;\n  return Table00Entry08Colors;\n}(); // Pokemon Blue\n\n\nvar Table01Entry0BColors =\n/** @class */\nfunction () {\n  function Table01Entry0BColors() {} //Bg\n\n\n  Table01Entry0BColors.bgWhite = 0xffffff;\n  Table01Entry0BColors.bgLightGrey = 0x63a5ff;\n  Table01Entry0BColors.bgDarkGrey = 0x0000ff;\n  Table01Entry0BColors.bgBlack = 0x000000; // Obj 0\n\n  Table01Entry0BColors.obj0White = 0xffffff;\n  Table01Entry0BColors.obj0LightGrey = 0xff8484;\n  Table01Entry0BColors.obj0DarkGrey = 0x943a3a;\n  Table01Entry0BColors.obj0Black = 0x000000; // Obj1\n\n  Table01Entry0BColors.obj1White = 0xffffff;\n  Table01Entry0BColors.obj1LightGrey = 0x63a5ff;\n  Table01Entry0BColors.obj1DarkGrey = 0x0000ff;\n  Table01Entry0BColors.obj1Black = 0x000000;\n  return Table01Entry0BColors;\n}(); // Pokemon Red\n\n\nvar Table01Entry10Colors =\n/** @class */\nfunction () {\n  function Table01Entry10Colors() {} //Bg\n\n\n  Table01Entry10Colors.bgWhite = 0xffffff;\n  Table01Entry10Colors.bgLightGrey = 0xff8484;\n  Table01Entry10Colors.bgDarkGrey = 0x943a3a;\n  Table01Entry10Colors.bgBlack = 0x000000; // Obj 0\n\n  Table01Entry10Colors.obj0White = 0xffffff;\n  Table01Entry10Colors.obj0LightGrey = 0x7bff31;\n  Table01Entry10Colors.obj0DarkGrey = 0x008400;\n  Table01Entry10Colors.obj0Black = 0x000000; // Obj1\n\n  Table01Entry10Colors.obj1White = 0xffffff;\n  Table01Entry10Colors.obj1LightGrey = 0xff8484;\n  Table01Entry10Colors.obj1DarkGrey = 0x943a3a;\n  Table01Entry10Colors.obj1Black = 0x000000;\n  return Table01Entry10Colors;\n}(); // Super Mario Land\n\n\nvar Table03Entry0AColors =\n/** @class */\nfunction () {\n  function Table03Entry0AColors() {} //Bg\n\n\n  Table03Entry0AColors.bgWhite = 0xb5b5ff;\n  Table03Entry0AColors.bgLightGrey = 0xffff94;\n  Table03Entry0AColors.bgDarkGrey = 0xad5a42;\n  Table03Entry0AColors.bgBlack = 0x000000; // Obj 0\n\n  Table03Entry0AColors.obj0White = 0x000000;\n  Table03Entry0AColors.obj0LightGrey = 0xffffff;\n  Table03Entry0AColors.obj0DarkGrey = 0xff8484;\n  Table03Entry0AColors.obj0Black = 0x943a3a; // Obj1\n\n  Table03Entry0AColors.obj1White = 0x000000;\n  Table03Entry0AColors.obj1LightGrey = 0xffffff;\n  Table03Entry0AColors.obj1DarkGrey = 0xff8484;\n  Table03Entry0AColors.obj1Black = 0x943a3a;\n  return Table03Entry0AColors;\n}(); // Super Mario Land 3 - WarioLand\n\n\nvar Table05Entry00Colors =\n/** @class */\nfunction () {\n  function Table05Entry00Colors() {} //Bg\n\n\n  Table05Entry00Colors.bgWhite = 0xffffff;\n  Table05Entry00Colors.bgLightGrey = 0xadad84;\n  Table05Entry00Colors.bgDarkGrey = 0x42737b;\n  Table05Entry00Colors.bgBlack = 0x000000; // Obj 0\n\n  Table05Entry00Colors.obj0White = 0xffffff;\n  Table05Entry00Colors.obj0LightGrey = 0xff7300;\n  Table05Entry00Colors.obj0DarkGrey = 0x944200;\n  Table05Entry00Colors.obj0Black = 0x000000; // Obj1\n\n  Table05Entry00Colors.obj1White = 0xffffff;\n  Table05Entry00Colors.obj1LightGrey = 0x5abdff;\n  Table05Entry00Colors.obj1DarkGrey = 0xff0000;\n  Table05Entry00Colors.obj1Black = 0x0000ff;\n  return Table05Entry00Colors;\n}(); // Donkey Kong\n\n\nvar Table05Entry01Colors =\n/** @class */\nfunction () {\n  function Table05Entry01Colors() {} //Bg\n\n\n  Table05Entry01Colors.bgWhite = 0xffff9c;\n  Table05Entry01Colors.bgLightGrey = 0x94b5ff;\n  Table05Entry01Colors.bgDarkGrey = 0x639473;\n  Table05Entry01Colors.bgBlack = 0x003a3a; // Obj 0\n\n  Table05Entry01Colors.obj0White = 0xffc542;\n  Table05Entry01Colors.obj0LightGrey = 0xffd600;\n  Table05Entry01Colors.obj0DarkGrey = 0x943a00;\n  Table05Entry01Colors.obj0Black = 0x4a0000; // Obj1\n\n  Table05Entry01Colors.obj1White = 0xffffff;\n  Table05Entry01Colors.obj1LightGrey = 0xff8484;\n  Table05Entry01Colors.obj1DarkGrey = 0x943a3a;\n  Table05Entry01Colors.obj1Black = 0x000000;\n  return Table05Entry01Colors;\n}(); // Tennis\n\n\nvar Table05Entry02Colors =\n/** @class */\nfunction () {\n  function Table05Entry02Colors() {} //Bg\n\n\n  Table05Entry02Colors.bgWhite = 0x6bff00;\n  Table05Entry02Colors.bgLightGrey = 0xffffff;\n  Table05Entry02Colors.bgDarkGrey = 0xff524a;\n  Table05Entry02Colors.bgBlack = 0x000000; // Obj 0\n\n  Table05Entry02Colors.obj0White = 0xffffff;\n  Table05Entry02Colors.obj0LightGrey = 0xffffff;\n  Table05Entry02Colors.obj0DarkGrey = 0x63a5ff;\n  Table05Entry02Colors.obj0Black = 0x0000ff; // Obj1\n\n  Table05Entry02Colors.obj1White = 0xffffff;\n  Table05Entry02Colors.obj1LightGrey = 0xffad63;\n  Table05Entry02Colors.obj1DarkGrey = 0x843100;\n  Table05Entry02Colors.obj1Black = 0x000000;\n  return Table05Entry02Colors;\n}(); // Kirby's Dream Land\n\n\nvar Table05Entry08Colors =\n/** @class */\nfunction () {\n  function Table05Entry08Colors() {} //Bg\n\n\n  Table05Entry08Colors.bgWhite = 0xa59cff;\n  Table05Entry08Colors.bgLightGrey = 0xffff00;\n  Table05Entry08Colors.bgDarkGrey = 0x006300;\n  Table05Entry08Colors.bgBlack = 0x000000; // Obj 0\n\n  Table05Entry08Colors.obj0White = 0xff6352;\n  Table05Entry08Colors.obj0LightGrey = 0xd60000;\n  Table05Entry08Colors.obj0DarkGrey = 0x630000;\n  Table05Entry08Colors.obj0Black = 0x000000; // Obj1\n\n  Table05Entry08Colors.obj1White = 0x0000ff;\n  Table05Entry08Colors.obj1LightGrey = 0xffffff;\n  Table05Entry08Colors.obj1DarkGrey = 0xffff7b;\n  Table05Entry08Colors.obj1Black = 0x0084ff;\n  return Table05Entry08Colors;\n}(); // Super Mario Land 2 BAYYYBEEE\n\n\nvar Table05Entry09Colors =\n/** @class */\nfunction () {\n  function Table05Entry09Colors() {} //Bg\n\n\n  Table05Entry09Colors.bgWhite = 0xffffce;\n  Table05Entry09Colors.bgLightGrey = 0x63efef;\n  Table05Entry09Colors.bgDarkGrey = 0x9c8431;\n  Table05Entry09Colors.bgBlack = 0x5a5a5a; // Obj 0\n\n  Table05Entry09Colors.obj0White = 0xffffff;\n  Table05Entry09Colors.obj0LightGrey = 0xff7300;\n  Table05Entry09Colors.obj0DarkGrey = 0x944200;\n  Table05Entry09Colors.obj0Black = 0x000000; // Obj1\n\n  Table05Entry09Colors.obj1White = 0xffffff;\n  Table05Entry09Colors.obj1LightGrey = 0x63a5ff;\n  Table05Entry09Colors.obj1DarkGrey = 0x0000ff;\n  Table05Entry09Colors.obj1Black = 0x000000;\n  return Table05Entry09Colors;\n}(); // Link's Awakening\n\n\nvar Table05Entry11Colors =\n/** @class */\nfunction () {\n  function Table05Entry11Colors() {} // Bg\n\n\n  Table05Entry11Colors.bgWhite = 0xffffff;\n  Table05Entry11Colors.bgLightGrey = 0xff8484;\n  Table05Entry11Colors.bgDarkGrey = 0x943a3a;\n  Table05Entry11Colors.bgBlack = 0x000000; // Obj 0\n\n  Table05Entry11Colors.obj0White = 0xffffff;\n  Table05Entry11Colors.obj0LightGrey = 0x00ff00;\n  Table05Entry11Colors.obj0DarkGrey = 0x318400;\n  Table05Entry11Colors.obj0Black = 0x004a00; // Obj1\n\n  Table05Entry11Colors.obj1White = 0xffffff;\n  Table05Entry11Colors.obj1LightGrey = 0x63a5ff;\n  Table05Entry11Colors.obj1DarkGrey = 0x0000ff;\n  Table05Entry11Colors.obj1Black = 0x000000;\n  return Table05Entry11Colors;\n}(); // Metroid 2\n\n\nvar Table05Entry14Colors =\n/** @class */\nfunction () {\n  function Table05Entry14Colors() {} //Bg\n\n\n  Table05Entry14Colors.bgWhite = 0xffffff;\n  Table05Entry14Colors.bgLightGrey = 0x63a5ff;\n  Table05Entry14Colors.bgDarkGrey = 0x0000ff;\n  Table05Entry14Colors.bgBlack = 0x000000; // Obj 0\n\n  Table05Entry14Colors.obj0White = 0xffff00;\n  Table05Entry14Colors.obj0LightGrey = 0xff0000;\n  Table05Entry14Colors.obj0DarkGrey = 0x630000;\n  Table05Entry14Colors.obj0Black = 0x000000; // Obj1\n\n  Table05Entry14Colors.obj1White = 0xffffff;\n  Table05Entry14Colors.obj1LightGrey = 0x7bff31;\n  Table05Entry14Colors.obj1DarkGrey = 0x008400;\n  Table05Entry14Colors.obj1Black = 0x000000;\n  return Table05Entry14Colors;\n}(); // WarioLand 2\n\n\nvar Table05Entry15Colors =\n/** @class */\nfunction () {\n  function Table05Entry15Colors() {} //Bg\n\n\n  Table05Entry15Colors.bgWhite = 0xffffff;\n  Table05Entry15Colors.bgLightGrey = 0xadad84;\n  Table05Entry15Colors.bgDarkGrey = 0x42737b;\n  Table05Entry15Colors.bgBlack = 0x000000; // Obj 0\n\n  Table05Entry15Colors.obj0White = 0xffffff;\n  Table05Entry15Colors.obj0LightGrey = 0xffad63;\n  Table05Entry15Colors.obj0DarkGrey = 0xffad63;\n  Table05Entry15Colors.obj0Black = 0x000000; // Obj1\n\n  Table05Entry15Colors.obj1White = 0xffffff;\n  Table05Entry15Colors.obj1LightGrey = 0x63a5ff;\n  Table05Entry15Colors.obj1DarkGrey = 0x0000ff;\n  Table05Entry15Colors.obj1Black = 0x000000;\n  return Table05Entry15Colors;\n}(); // File for all of the logic of setting gameboy color plaettes\n// Current / exported color\n\n\nvar Colors =\n/** @class */\nfunction () {\n  function Colors() {} //Bg\n\n\n  Colors.bgWhite = WasmBoyGBColors.bgWhite;\n  Colors.bgLightGrey = WasmBoyGBColors.bgLightGrey;\n  Colors.bgDarkGrey = WasmBoyGBColors.bgDarkGrey;\n  Colors.bgBlack = WasmBoyGBColors.bgBlack; // Obj 0\n\n  Colors.obj0White = WasmBoyGBColors.obj0White;\n  Colors.obj0LightGrey = WasmBoyGBColors.obj0LightGrey;\n  Colors.obj0DarkGrey = WasmBoyGBColors.obj0DarkGrey;\n  Colors.obj0Black = WasmBoyGBColors.obj0Black; // Obj1\n\n  Colors.obj1White = WasmBoyGBColors.obj1White;\n  Colors.obj1LightGrey = WasmBoyGBColors.obj1LightGrey;\n  Colors.obj1DarkGrey = WasmBoyGBColors.obj1DarkGrey;\n  Colors.obj1Black = WasmBoyGBColors.obj1Black;\n  return Colors;\n}(); // Inlined because closure compiler inlines\n\n\nfunction initializeColors() {\n  setManualColorizationPalette(0); // Do some automatic color palette swapping if we have a loaded ROM\n\n  var titleChecksum = 0x00;\n\n  for (var i = 0x0134; i <= 0x0143; i++) {\n    titleChecksum += eightBitLoadFromGBMemory(i);\n  } // Set the colorization for the game automatically if assigned\n  // https://tcrf.net/Notes:Game_Boy_Color_Bootstrap_ROM\n\n\n  var hash = titleChecksum & 0xff;\n  setHashColorizationPalette(hash);\n}\n\nfunction getRedFromHexColor(color) {\n  return (color & 0xff0000) >> 16;\n}\n\nfunction getGreenFromHexColor(color) {\n  return (color & 0x00ff00) >> 8;\n}\n\nfunction getBlueFromHexColor(color) {\n  return color & 0x0000ff;\n} // Function to set the colorization\n// By manually pressing buttons\n\n\nfunction setManualColorizationPalette(colorizationId) {\n  // Set the colorizationId clockwise according to:\n  // https://en.wikipedia.org/wiki/Game_Boy_Color\n  switch (colorizationId) {\n    case 0:\n      Colors.bgWhite = WasmBoyGBColors.bgWhite;\n      Colors.bgLightGrey = WasmBoyGBColors.bgLightGrey;\n      Colors.bgDarkGrey = WasmBoyGBColors.bgDarkGrey;\n      Colors.bgBlack = WasmBoyGBColors.bgBlack;\n      Colors.obj0White = WasmBoyGBColors.obj0White;\n      Colors.obj0LightGrey = WasmBoyGBColors.obj0LightGrey;\n      Colors.obj0DarkGrey = WasmBoyGBColors.obj0DarkGrey;\n      Colors.obj0Black = WasmBoyGBColors.obj0Black;\n      Colors.obj1White = WasmBoyGBColors.obj1White;\n      Colors.obj1LightGrey = WasmBoyGBColors.obj1LightGrey;\n      Colors.obj1DarkGrey = WasmBoyGBColors.obj1DarkGrey;\n      Colors.obj1Black = WasmBoyGBColors.obj1Black;\n      break;\n\n    case 1:\n      // Up, Brown\n      Colors.bgWhite = BrownColors.bgWhite;\n      Colors.bgLightGrey = BrownColors.bgLightGrey;\n      Colors.bgDarkGrey = BrownColors.bgDarkGrey;\n      Colors.bgBlack = BrownColors.bgBlack;\n      Colors.obj0White = BrownColors.obj0White;\n      Colors.obj0LightGrey = BrownColors.obj0LightGrey;\n      Colors.obj0DarkGrey = BrownColors.obj0DarkGrey;\n      Colors.obj0Black = BrownColors.obj0Black;\n      Colors.obj1White = BrownColors.obj1White;\n      Colors.obj1LightGrey = BrownColors.obj1LightGrey;\n      Colors.obj1DarkGrey = BrownColors.obj1DarkGrey;\n      Colors.obj1Black = BrownColors.obj1Black;\n      break;\n\n    case 2:\n      // Up + A, Red\n      Colors.bgWhite = RedColors.bgWhite;\n      Colors.bgLightGrey = RedColors.bgLightGrey;\n      Colors.bgDarkGrey = RedColors.bgDarkGrey;\n      Colors.bgBlack = RedColors.bgBlack;\n      Colors.obj0White = RedColors.obj0White;\n      Colors.obj0LightGrey = RedColors.obj0LightGrey;\n      Colors.obj0DarkGrey = RedColors.obj0DarkGrey;\n      Colors.obj0Black = RedColors.obj0Black;\n      Colors.obj1White = RedColors.obj1White;\n      Colors.obj1LightGrey = RedColors.obj1LightGrey;\n      Colors.obj1DarkGrey = RedColors.obj1DarkGrey;\n      Colors.obj1Black = RedColors.obj1Black;\n      break;\n\n    case 3:\n      // Up + B, DarkBrown\n      Colors.bgWhite = DarkBrownColors.bgWhite;\n      Colors.bgLightGrey = DarkBrownColors.bgLightGrey;\n      Colors.bgDarkGrey = DarkBrownColors.bgDarkGrey;\n      Colors.bgBlack = DarkBrownColors.bgBlack;\n      Colors.obj0White = DarkBrownColors.obj0White;\n      Colors.obj0LightGrey = DarkBrownColors.obj0LightGrey;\n      Colors.obj0DarkGrey = DarkBrownColors.obj0DarkGrey;\n      Colors.obj0Black = DarkBrownColors.obj0Black;\n      Colors.obj1White = DarkBrownColors.obj1White;\n      Colors.obj1LightGrey = DarkBrownColors.obj1LightGrey;\n      Colors.obj1DarkGrey = DarkBrownColors.obj1DarkGrey;\n      Colors.obj1Black = DarkBrownColors.obj1Black;\n      break;\n\n    case 4:\n      // Right, Green\n      Colors.bgWhite = GreenColors.bgWhite;\n      Colors.bgLightGrey = GreenColors.bgLightGrey;\n      Colors.bgDarkGrey = GreenColors.bgDarkGrey;\n      Colors.bgBlack = GreenColors.bgBlack;\n      Colors.obj0White = GreenColors.obj0White;\n      Colors.obj0LightGrey = GreenColors.obj0LightGrey;\n      Colors.obj0DarkGrey = GreenColors.obj0DarkGrey;\n      Colors.obj0Black = GreenColors.obj0Black;\n      Colors.obj1White = GreenColors.obj1White;\n      Colors.obj1LightGrey = GreenColors.obj1LightGrey;\n      Colors.obj1DarkGrey = GreenColors.obj1DarkGrey;\n      Colors.obj1Black = GreenColors.obj1Black;\n      break;\n\n    case 5:\n      // Right + A, DarkGreenColors\n      Colors.bgWhite = DarkGreenColors.bgWhite;\n      Colors.bgLightGrey = DarkGreenColors.bgLightGrey;\n      Colors.bgDarkGrey = DarkGreenColors.bgDarkGrey;\n      Colors.bgBlack = DarkGreenColors.bgBlack;\n      Colors.obj0White = DarkGreenColors.obj0White;\n      Colors.obj0LightGrey = DarkGreenColors.obj0LightGrey;\n      Colors.obj0DarkGrey = DarkGreenColors.obj0DarkGrey;\n      Colors.obj0Black = DarkGreenColors.obj0Black;\n      Colors.obj1White = DarkGreenColors.obj1White;\n      Colors.obj1LightGrey = DarkGreenColors.obj1LightGrey;\n      Colors.obj1DarkGrey = DarkGreenColors.obj1DarkGrey;\n      Colors.obj1Black = DarkGreenColors.obj1Black;\n      break;\n\n    case 6:\n      // Right + B, InvertedColors\n      Colors.bgWhite = InvertedColors.bgWhite;\n      Colors.bgLightGrey = InvertedColors.bgLightGrey;\n      Colors.bgDarkGrey = InvertedColors.bgDarkGrey;\n      Colors.bgBlack = InvertedColors.bgBlack;\n      Colors.obj0White = InvertedColors.obj0White;\n      Colors.obj0LightGrey = InvertedColors.obj0LightGrey;\n      Colors.obj0DarkGrey = InvertedColors.obj0DarkGrey;\n      Colors.obj0Black = InvertedColors.obj0Black;\n      Colors.obj1White = InvertedColors.obj1White;\n      Colors.obj1LightGrey = InvertedColors.obj1LightGrey;\n      Colors.obj1DarkGrey = InvertedColors.obj1DarkGrey;\n      Colors.obj1Black = InvertedColors.obj1Black;\n      break;\n\n    case 7:\n      // Down, PastelMixColors\n      Colors.bgWhite = PastelMixColors.bgWhite;\n      Colors.bgLightGrey = PastelMixColors.bgLightGrey;\n      Colors.bgDarkGrey = PastelMixColors.bgDarkGrey;\n      Colors.bgBlack = PastelMixColors.bgBlack;\n      Colors.obj0White = PastelMixColors.obj0White;\n      Colors.obj0LightGrey = PastelMixColors.obj0LightGrey;\n      Colors.obj0DarkGrey = PastelMixColors.obj0DarkGrey;\n      Colors.obj0Black = PastelMixColors.obj0Black;\n      Colors.obj1White = PastelMixColors.obj1White;\n      Colors.obj1LightGrey = PastelMixColors.obj1LightGrey;\n      Colors.obj1DarkGrey = PastelMixColors.obj1DarkGrey;\n      Colors.obj1Black = PastelMixColors.obj1Black;\n      break;\n\n    case 8:\n      // Down + A, Orange\n      Colors.bgWhite = OrangeColors.bgWhite;\n      Colors.bgLightGrey = OrangeColors.bgLightGrey;\n      Colors.bgDarkGrey = OrangeColors.bgDarkGrey;\n      Colors.bgBlack = OrangeColors.bgBlack;\n      Colors.obj0White = OrangeColors.obj0White;\n      Colors.obj0LightGrey = OrangeColors.obj0LightGrey;\n      Colors.obj0DarkGrey = OrangeColors.obj0DarkGrey;\n      Colors.obj0Black = OrangeColors.obj0Black;\n      Colors.obj1White = OrangeColors.obj1White;\n      Colors.obj1LightGrey = OrangeColors.obj1LightGrey;\n      Colors.obj1DarkGrey = OrangeColors.obj1DarkGrey;\n      Colors.obj1Black = OrangeColors.obj1Black;\n      break;\n\n    case 9:\n      // Down + B, Yellow\n      Colors.bgWhite = YellowColors.bgWhite;\n      Colors.bgLightGrey = YellowColors.bgLightGrey;\n      Colors.bgDarkGrey = YellowColors.bgDarkGrey;\n      Colors.bgBlack = YellowColors.bgBlack;\n      Colors.obj0White = YellowColors.obj0White;\n      Colors.obj0LightGrey = YellowColors.obj0LightGrey;\n      Colors.obj0DarkGrey = YellowColors.obj0DarkGrey;\n      Colors.obj0Black = YellowColors.obj0Black;\n      Colors.obj1White = YellowColors.obj1White;\n      Colors.obj1LightGrey = YellowColors.obj1LightGrey;\n      Colors.obj1DarkGrey = YellowColors.obj1DarkGrey;\n      Colors.obj1Black = YellowColors.obj1Black;\n      break;\n\n    case 10:\n      // Left, Blue\n      Colors.bgWhite = BlueColors.bgWhite;\n      Colors.bgLightGrey = BlueColors.bgLightGrey;\n      Colors.bgDarkGrey = BlueColors.bgDarkGrey;\n      Colors.bgBlack = BlueColors.bgBlack;\n      Colors.obj0White = BlueColors.obj0White;\n      Colors.obj0LightGrey = BlueColors.obj0LightGrey;\n      Colors.obj0DarkGrey = BlueColors.obj0DarkGrey;\n      Colors.obj0Black = BlueColors.obj0Black;\n      Colors.obj1White = BlueColors.obj1White;\n      Colors.obj1LightGrey = BlueColors.obj1LightGrey;\n      Colors.obj1DarkGrey = BlueColors.obj1DarkGrey;\n      Colors.obj1Black = BlueColors.obj1Black;\n      break;\n\n    case 11:\n      // Left + A, Dark Blue\n      Colors.bgWhite = DarkBlueColors.bgWhite;\n      Colors.bgLightGrey = DarkBlueColors.bgLightGrey;\n      Colors.bgDarkGrey = DarkBlueColors.bgDarkGrey;\n      Colors.bgBlack = DarkBlueColors.bgBlack;\n      Colors.obj0White = DarkBlueColors.obj0White;\n      Colors.obj0LightGrey = DarkBlueColors.obj0LightGrey;\n      Colors.obj0DarkGrey = DarkBlueColors.obj0DarkGrey;\n      Colors.obj0Black = DarkBlueColors.obj0Black;\n      Colors.obj1White = DarkBlueColors.obj1White;\n      Colors.obj1LightGrey = DarkBlueColors.obj1LightGrey;\n      Colors.obj1DarkGrey = DarkBlueColors.obj1DarkGrey;\n      Colors.obj1Black = DarkBlueColors.obj1Black;\n      break;\n\n    case 12:\n      // Left + B, GrayScale\n      Colors.bgWhite = GrayscaleColors.bgWhite;\n      Colors.bgLightGrey = GrayscaleColors.bgLightGrey;\n      Colors.bgDarkGrey = GrayscaleColors.bgDarkGrey;\n      Colors.bgBlack = GrayscaleColors.bgBlack;\n      Colors.obj0White = GrayscaleColors.obj0White;\n      Colors.obj0LightGrey = GrayscaleColors.obj0LightGrey;\n      Colors.obj0DarkGrey = GrayscaleColors.obj0DarkGrey;\n      Colors.obj0Black = GrayscaleColors.obj0Black;\n      Colors.obj1White = GrayscaleColors.obj1White;\n      Colors.obj1LightGrey = GrayscaleColors.obj1LightGrey;\n      Colors.obj1DarkGrey = GrayscaleColors.obj1DarkGrey;\n      Colors.obj1Black = GrayscaleColors.obj1Black;\n      break;\n  }\n} // Function to set the colorization\n// By checksum of the title\n// https://forums.nesdev.com/viewtopic.php?f=20&t=10226\n// TODO: torch2424 need to find how to get the \"disambiguation\"\n// Inlined because closure compiler inlines\n\n\nfunction setHashColorizationPalette(hash) {\n  switch (hash) {\n    case 0x88:\n      Colors.bgWhite = Table00Entry08Colors.bgWhite;\n      Colors.bgLightGrey = Table00Entry08Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table00Entry08Colors.bgDarkGrey;\n      Colors.bgBlack = Table00Entry08Colors.bgBlack;\n      Colors.obj0White = Table00Entry08Colors.obj0White;\n      Colors.obj0LightGrey = Table00Entry08Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table00Entry08Colors.obj0DarkGrey;\n      Colors.obj0Black = Table00Entry08Colors.obj0Black;\n      Colors.obj1White = Table00Entry08Colors.obj1White;\n      Colors.obj1LightGrey = Table00Entry08Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table00Entry08Colors.obj1DarkGrey;\n      Colors.obj1Black = Table00Entry08Colors.obj1Black;\n      break;\n\n    case 0x61:\n      Colors.bgWhite = Table01Entry0BColors.bgWhite;\n      Colors.bgLightGrey = Table01Entry0BColors.bgLightGrey;\n      Colors.bgDarkGrey = Table01Entry0BColors.bgDarkGrey;\n      Colors.bgBlack = Table01Entry0BColors.bgBlack;\n      Colors.obj0White = Table01Entry0BColors.obj0White;\n      Colors.obj0LightGrey = Table01Entry0BColors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table01Entry0BColors.obj0DarkGrey;\n      Colors.obj0Black = Table01Entry0BColors.obj0Black;\n      Colors.obj1White = Table01Entry0BColors.obj1White;\n      Colors.obj1LightGrey = Table01Entry0BColors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table01Entry0BColors.obj1DarkGrey;\n      Colors.obj1Black = Table01Entry0BColors.obj1Black;\n      break;\n\n    case 0x14:\n      Colors.bgWhite = Table01Entry10Colors.bgWhite;\n      Colors.bgLightGrey = Table01Entry10Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table01Entry10Colors.bgDarkGrey;\n      Colors.bgBlack = Table01Entry10Colors.bgBlack;\n      Colors.obj0White = Table01Entry10Colors.obj0White;\n      Colors.obj0LightGrey = Table01Entry10Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table01Entry10Colors.obj0DarkGrey;\n      Colors.obj0Black = Table01Entry10Colors.obj0Black;\n      Colors.obj1White = Table01Entry10Colors.obj1White;\n      Colors.obj1LightGrey = Table01Entry10Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table01Entry10Colors.obj1DarkGrey;\n      Colors.obj1Black = Table01Entry10Colors.obj1Black;\n      break;\n\n    case 0x46:\n      Colors.bgWhite = Table03Entry0AColors.bgWhite;\n      Colors.bgLightGrey = Table03Entry0AColors.bgLightGrey;\n      Colors.bgDarkGrey = Table03Entry0AColors.bgDarkGrey;\n      Colors.bgBlack = Table03Entry0AColors.bgBlack;\n      Colors.obj0White = Table03Entry0AColors.obj0White;\n      Colors.obj0LightGrey = Table03Entry0AColors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table03Entry0AColors.obj0DarkGrey;\n      Colors.obj0Black = Table03Entry0AColors.obj0Black;\n      Colors.obj1White = Table03Entry0AColors.obj1White;\n      Colors.obj1LightGrey = Table03Entry0AColors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table03Entry0AColors.obj1DarkGrey;\n      Colors.obj1Black = Table03Entry0AColors.obj1Black;\n      break;\n\n    case 0x59:\n    case 0xc6:\n      Colors.bgWhite = Table05Entry00Colors.bgWhite;\n      Colors.bgLightGrey = Table05Entry00Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table05Entry00Colors.bgDarkGrey;\n      Colors.bgBlack = Table05Entry00Colors.bgBlack;\n      Colors.obj0White = Table05Entry00Colors.obj0White;\n      Colors.obj0LightGrey = Table05Entry00Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table05Entry00Colors.obj0DarkGrey;\n      Colors.obj0Black = Table05Entry00Colors.obj0Black;\n      Colors.obj1White = Table05Entry00Colors.obj1White;\n      Colors.obj1LightGrey = Table05Entry00Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table05Entry00Colors.obj1DarkGrey;\n      Colors.obj1Black = Table05Entry00Colors.obj1Black;\n      break;\n\n    case 0x86:\n    case 0xa8:\n      Colors.bgWhite = Table05Entry01Colors.bgWhite;\n      Colors.bgLightGrey = Table05Entry01Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table05Entry01Colors.bgDarkGrey;\n      Colors.bgBlack = Table05Entry01Colors.bgBlack;\n      Colors.obj0White = Table05Entry01Colors.obj0White;\n      Colors.obj0LightGrey = Table05Entry01Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table05Entry01Colors.obj0DarkGrey;\n      Colors.obj0Black = Table05Entry01Colors.obj0Black;\n      Colors.obj1White = Table05Entry01Colors.obj1White;\n      Colors.obj1LightGrey = Table05Entry01Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table05Entry01Colors.obj1DarkGrey;\n      Colors.obj1Black = Table05Entry01Colors.obj1Black;\n      break;\n\n    case 0xbf:\n    case 0xce:\n    case 0xd1:\n    case 0xf0:\n      Colors.bgWhite = Table05Entry02Colors.bgWhite;\n      Colors.bgLightGrey = Table05Entry02Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table05Entry02Colors.bgDarkGrey;\n      Colors.bgBlack = Table05Entry02Colors.bgBlack;\n      Colors.obj0White = Table05Entry02Colors.obj0White;\n      Colors.obj0LightGrey = Table05Entry02Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table05Entry02Colors.obj0DarkGrey;\n      Colors.obj0Black = Table05Entry02Colors.obj0Black;\n      Colors.obj1White = Table05Entry02Colors.obj1White;\n      Colors.obj1LightGrey = Table05Entry02Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table05Entry02Colors.obj1DarkGrey;\n      Colors.obj1Black = Table05Entry02Colors.obj1Black;\n      break;\n\n    case 0x27:\n    case 0x49:\n    case 0x5c:\n    case 0xb3:\n      Colors.bgWhite = Table05Entry08Colors.bgWhite;\n      Colors.bgLightGrey = Table05Entry08Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table05Entry08Colors.bgDarkGrey;\n      Colors.bgBlack = Table05Entry08Colors.bgBlack;\n      Colors.obj0White = Table05Entry08Colors.obj0White;\n      Colors.obj0LightGrey = Table05Entry08Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table05Entry08Colors.obj0DarkGrey;\n      Colors.obj0Black = Table05Entry08Colors.obj0Black;\n      Colors.obj1White = Table05Entry08Colors.obj1White;\n      Colors.obj1LightGrey = Table05Entry08Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table05Entry08Colors.obj1DarkGrey;\n      Colors.obj1Black = Table05Entry08Colors.obj1Black;\n      break;\n\n    case 0xc9:\n      Colors.bgWhite = Table05Entry09Colors.bgWhite;\n      Colors.bgLightGrey = Table05Entry09Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table05Entry09Colors.bgDarkGrey;\n      Colors.bgBlack = Table05Entry09Colors.bgBlack;\n      Colors.obj0White = Table05Entry09Colors.obj0White;\n      Colors.obj0LightGrey = Table05Entry09Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table05Entry09Colors.obj0DarkGrey;\n      Colors.obj0Black = Table05Entry09Colors.obj0Black;\n      Colors.obj1White = Table05Entry09Colors.obj1White;\n      Colors.obj1LightGrey = Table05Entry09Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table05Entry09Colors.obj1DarkGrey;\n      Colors.obj1Black = Table05Entry09Colors.obj1Black;\n      break;\n\n    case 0x70:\n      Colors.bgWhite = Table05Entry11Colors.bgWhite;\n      Colors.bgLightGrey = Table05Entry11Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table05Entry11Colors.bgDarkGrey;\n      Colors.bgBlack = Table05Entry11Colors.bgBlack;\n      Colors.obj0White = Table05Entry11Colors.obj0White;\n      Colors.obj0LightGrey = Table05Entry11Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table05Entry11Colors.obj0DarkGrey;\n      Colors.obj0Black = Table05Entry11Colors.obj0Black;\n      Colors.obj1White = Table05Entry11Colors.obj1White;\n      Colors.obj1LightGrey = Table05Entry11Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table05Entry11Colors.obj1DarkGrey;\n      Colors.obj1Black = Table05Entry11Colors.obj1Black;\n      break;\n\n    case 0x46:\n      Colors.bgWhite = Table05Entry14Colors.bgWhite;\n      Colors.bgLightGrey = Table05Entry14Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table05Entry14Colors.bgDarkGrey;\n      Colors.bgBlack = Table05Entry14Colors.bgBlack;\n      Colors.obj0White = Table05Entry14Colors.obj0White;\n      Colors.obj0LightGrey = Table05Entry14Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table05Entry14Colors.obj0DarkGrey;\n      Colors.obj0Black = Table05Entry14Colors.obj0Black;\n      Colors.obj1White = Table05Entry14Colors.obj1White;\n      Colors.obj1LightGrey = Table05Entry14Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table05Entry14Colors.obj1DarkGrey;\n      Colors.obj1Black = Table05Entry14Colors.obj1Black;\n      break;\n\n    case 0xd3:\n      Colors.bgWhite = Table05Entry15Colors.bgWhite;\n      Colors.bgLightGrey = Table05Entry15Colors.bgLightGrey;\n      Colors.bgDarkGrey = Table05Entry15Colors.bgDarkGrey;\n      Colors.bgBlack = Table05Entry15Colors.bgBlack;\n      Colors.obj0White = Table05Entry15Colors.obj0White;\n      Colors.obj0LightGrey = Table05Entry15Colors.obj0LightGrey;\n      Colors.obj0DarkGrey = Table05Entry15Colors.obj0DarkGrey;\n      Colors.obj0Black = Table05Entry15Colors.obj0Black;\n      Colors.obj1White = Table05Entry15Colors.obj1White;\n      Colors.obj1LightGrey = Table05Entry15Colors.obj1LightGrey;\n      Colors.obj1DarkGrey = Table05Entry15Colors.obj1DarkGrey;\n      Colors.obj1Black = Table05Entry15Colors.obj1Black;\n      break;\n  }\n} // Grouped registers\n// possible overload these later to performace actions\n// AF, BC, DE, HL\n\n\nfunction concatenateBytes(highByte, lowByte) {\n  //https://stackoverflow.com/questions/38298412/convert-two-bytes-into-signed-16-bit-integer-in-javascript\n  return (highByte & 0xff) << 8 | lowByte & 0xff;\n}\n\nfunction splitHighByte(groupedByte) {\n  return (groupedByte & 0xff00) >> 8;\n}\n\nfunction splitLowByte(groupedByte) {\n  return groupedByte & 0x00ff;\n}\n\nfunction rotateByteLeft(value) {\n  // Rotate left\n  // https://stackoverflow.com/questions/19204750/how-do-i-perform-a-circular-rotation-of-a-byte\n  // 4-bit example:\n  // 1010 -> 0100 | 0001\n  return u8Portable(value << 1 | value >> 7);\n}\n\nfunction rotateByteLeftThroughCarry(value) {\n  // Example: https://github.com/nakardo/node-gameboy/blob/master/lib/cpu/opcodes.js\n  // Through carry meaning, instead of raotating the bit that gets dropped off, but the carry there instead\n  return u8Portable(value << 1 | getCarryFlag$$1());\n}\n\nfunction rotateByteRight(value) {\n  // Rotate right\n  // 4-bit example:\n  // 1010 -> 0101 | 0000\n  return u8Portable(value >> 1 | value << 7);\n}\n\nfunction rotateByteRightThroughCarry(value) {\n  // Example: https://github.com/nakardo/node-gameboy/blob/master/lib/cpu/opcodes.js\n  // Through carry meaning, instead of raotating the bit that gets dropped off, put the carry there instead\n  return u8Portable(value >> 1 | getCarryFlag$$1() << 7);\n}\n\nfunction setBitOnByte(bitPosition, byte) {\n  return byte | 0x01 << bitPosition;\n}\n\nfunction resetBitOnByte(bitPosition, byte) {\n  return byte & ~(0x01 << bitPosition);\n}\n\nfunction checkBitOnByte(bitPosition, byte) {\n  // Perforamnce improvements\n  // https://github.com/AssemblyScript/assemblyscript/issues/40\n  return (byte & 1 << bitPosition) != 0;\n} // Class for GBC Color palletes\n// http://gbdev.gg8.se/wiki/articles/Video_Display#FF68_-_BCPS.2FBGPI_-_CGB_Mode_Only_-_Background_Palette_Index\n\n\nvar Palette =\n/** @class */\nfunction () {\n  function Palette() {}\n\n  Palette.memoryLocationBackgroundPaletteIndex = 0xff68;\n  Palette.memoryLocationBackgroundPaletteData = 0xff69;\n  Palette.memoryLocationSpritePaletteIndex = 0xff6a;\n  Palette.memoryLocationSpritePaletteData = 0xff6b; // Palettes\n\n  Palette.memoryLocationBackgroundPalette = 0xff47;\n  Palette.memoryLocationSpritePaletteOne = 0xff48;\n  Palette.memoryLocationSpritePaletteTwo = 0xff49;\n  return Palette;\n}(); // Inlined because closure compiler inlines\n\n\nfunction initializePalette() {\n  if (Cpu.GBCEnabled) {\n    // GBC Palettes\n    eightBitStoreIntoGBMemory(0xff68, 0xc0);\n    eightBitStoreIntoGBMemory(0xff69, 0xff);\n    eightBitStoreIntoGBMemory(0xff6a, 0xc1);\n    eightBitStoreIntoGBMemory(0xff6b, 0x0d);\n  } else {\n    // GBC Palettes\n    eightBitStoreIntoGBMemory(0xff68, 0xff);\n    eightBitStoreIntoGBMemory(0xff69, 0xff);\n    eightBitStoreIntoGBMemory(0xff6a, 0xff);\n    eightBitStoreIntoGBMemory(0xff6b, 0xff);\n  }\n} // Simple get pallete color or monochrome GB\n// shouldRepresentColorByColorId is good for debugging tile data for GBC games that don't have\n// monochromePalettes\n// Inlined because closure compiler inlines\n\n\nfunction getMonochromeColorFromPalette(colorId, paletteMemoryLocation, shouldRepresentColorByColorId) {\n  if (shouldRepresentColorByColorId === void 0) {\n    shouldRepresentColorByColorId = false;\n  } // Shift our paletteByte, 2 times for each color ID\n  // And off any extra bytes\n  // Return our Color (00 - white, 01 - light grey, 10 Dark grey, or 11 - Black)\n\n\n  var color = colorId;\n\n  if (!shouldRepresentColorByColorId) {\n    color = eightBitLoadFromGBMemory(paletteMemoryLocation) >> (colorId << 1) & 0x03;\n  } // Since our max is 254, and max is 3.\n  // monochrome color palette is modified from bgb\n  // TODO: Make these colors into a constant\n\n\n  var rgbColor = 242;\n\n  switch (color) {\n    case 0:\n      break;\n\n    case 1:\n      rgbColor = 160;\n      break;\n\n    case 2:\n      rgbColor = 88;\n      break;\n\n    case 3:\n      rgbColor = 8;\n      break;\n  }\n\n  return rgbColor;\n} // Function to returns the Colorized color for a GB games\n\n\nfunction getColorizedGbHexColorFromPalette(colorId, paletteMemoryLocation) {\n  // Shift our paletteByte, 2 times for each color ID\n  // And off any extra bytes\n  // Return our Color (00 - white, 01 - light grey, 10 Dark grey, or 11 - Black)\n  var color = eightBitLoadFromGBMemory(paletteMemoryLocation) >> colorId * 2 & 0x03; // Check which palette we got, to apply the right color layer\n\n  var hexColor = 0;\n\n  if (paletteMemoryLocation === Palette.memoryLocationSpritePaletteOne) {\n    hexColor = Colors.obj0White;\n\n    switch (color) {\n      case 0:\n        break;\n\n      case 1:\n        hexColor = Colors.obj0LightGrey;\n        break;\n\n      case 2:\n        hexColor = Colors.obj0DarkGrey;\n        break;\n\n      case 3:\n        hexColor = Colors.obj0Black;\n        break;\n    }\n  } else if (paletteMemoryLocation === Palette.memoryLocationSpritePaletteTwo) {\n    hexColor = Colors.obj1White;\n\n    switch (color) {\n      case 0:\n        break;\n\n      case 1:\n        hexColor = Colors.obj1LightGrey;\n        break;\n\n      case 2:\n        hexColor = Colors.obj1DarkGrey;\n        break;\n\n      case 3:\n        hexColor = Colors.obj1Black;\n        break;\n    }\n  } else {\n    hexColor = Colors.bgWhite;\n\n    switch (color) {\n      case 0:\n        break;\n\n      case 1:\n        hexColor = Colors.bgLightGrey;\n        break;\n\n      case 2:\n        hexColor = Colors.bgDarkGrey;\n        break;\n\n      case 3:\n        hexColor = Colors.bgBlack;\n        break;\n    }\n  }\n\n  return hexColor;\n} // Inlined because closure compiler inlines\n\n\nfunction writeColorPaletteToMemory(offset, value) {\n  // FF68\n  //  Bit 0-5   Index (00-3F)\n  var memoryLocationSpritePaletteData = Palette.memoryLocationSpritePaletteData;\n\n  if (offset === Palette.memoryLocationBackgroundPaletteData || offset === memoryLocationSpritePaletteData) {\n    // Get the palette index\n    var paletteIndex = eightBitLoadFromGBMemory(offset - 1); // Clear the 6th bit, as it does nothing\n\n    paletteIndex = resetBitOnByte(6, paletteIndex); // Check if we are changing the sprite pallete data\n\n    var isSprite = offset === memoryLocationSpritePaletteData;\n    storePaletteByteInWasmMemory(paletteIndex, value, isSprite);\n    incrementPaletteIndexIfSet(paletteIndex, offset - 1);\n  }\n} // Functions to Handle Write to pallete data registers\n// http://gbdev.gg8.se/wiki/articles/Video_Display#FF68_-_BCPS.2FBGPI_-_CGB_Mode_Only_-_Background_Palette_Index\n// Function to handle incrementing the pallete index if required\n// Inlined because closure compiler inlines\n\n\nfunction incrementPaletteIndexIfSet(paletteIndex, offset) {\n  // Check ther auto increment box\n  if (checkBitOnByte(7, paletteIndex)) {\n    // Increment the index, and return the value before the increment\n    // Ensure we don't ouverflow our auto increment bit\n    paletteIndex += 1;\n    paletteIndex = setBitOnByte(7, paletteIndex);\n    eightBitStoreIntoGBMemory(offset, paletteIndex);\n  }\n} // FF68\n// Bit 0-5   Index (00-3F)\n// Bit 7     Auto Increment  (0=Disabled, 1=Increment after Writing)\n// Index is 00-0x3F because the means 0 - 63 (64),\n// and apparently there are 8 bytes per pallete to describe Color 0-3 (4 colors),\n// and 0-7 (8 palltetes). Therefore, 64!\n\n\nfunction getRgbColorFromPalette(paletteId, colorId, isSprite) {\n  // Each Pallete takes 8 bytes, so multiply by 8 to get the pallete\n  // And Each color takes 2 bytes, therefore, multiple by 2 for the correct color bytes in the palette\n  var paletteIndex = paletteId * 8 + colorId * 2; // Load the Color that is seperated into two bytes\n\n  var paletteHighByte = loadPaletteByteFromWasmMemory(paletteIndex + 1, isSprite);\n  var paletteLowByte = loadPaletteByteFromWasmMemory(paletteIndex, isSprite); // Return the concatenated color byte\n\n  return concatenateBytes(paletteHighByte, paletteLowByte);\n} // Function to return the color from a passed 16 bit color pallette\n\n\nfunction getColorComponentFromRgb(colorId, colorRgb) {\n  // Get our bitmask for the color ID\n  // bit mask tested good :)\n  colorId *= 5;\n  var bitMask = 0x1f << colorId;\n  var colorValue = (colorRgb & bitMask) >> colorId; // Goal is to reach 254 for each color, so 255 / 31 (0x1F) ~8 TODO: Make exact\n  // Want 5 bits for each\n\n  return colorValue * 8;\n} // Function to load a byte from our Gbc Palette memory\n\n\nfunction loadPaletteByteFromWasmMemory(paletteIndexByte, isSprite) {\n  // Clear the top two bits to just get the bottom palette Index\n  var paletteIndex = paletteIndexByte & 0x3f; // Move over the palette index to not overlap the background has 0x3F, so Zero for Sprites is 0x40)\n\n  if (isSprite) {\n    paletteIndex += 0x40;\n  }\n\n  return load(GBC_PALETTE_LOCATION + paletteIndex);\n} // Function to store a byte to our Gbc Palette memory\n// Inlined because closure compiler inlines\n\n\nfunction storePaletteByteInWasmMemory(paletteIndexByte, value, isSprite) {\n  // Clear the top two bits to just get the bottom palette Index\n  var paletteIndex = paletteIndexByte & 0x3f; // Move over the palette index to not overlap the background (has 0x3F, so Zero for Sprites is 0x40)\n\n  if (isSprite) {\n    paletteIndex += 0x40;\n  }\n\n  store(GBC_PALETTE_LOCATION + paletteIndex, value);\n} // https://github.com/torch2424/wasmBoy/issues/51\n\n\nfunction addPriorityforPixel(x, y, colorId, hasGbcBgPriority) {\n  if (colorId === void 0) {\n    colorId = 0;\n  }\n\n  if (hasGbcBgPriority === void 0) {\n    hasGbcBgPriority = false;\n  }\n\n  var bgPriorityByte = colorId & 0x03;\n\n  if (hasGbcBgPriority) {\n    bgPriorityByte = setBitOnByte(2, bgPriorityByte);\n  }\n\n  store(BG_PRIORITY_MAP_LOCATION + getPixelStart(x, y), bgPriorityByte);\n} // Inlined because closure compiler inlines\n\n\nfunction getPriorityforPixel(x, y) {\n  return load(BG_PRIORITY_MAP_LOCATION + getPixelStart(x, y));\n} // Inlined because closure compiler inlines\n\n\nfunction clearPriorityMap() {\n  for (var y = 0; y < 144; ++y) {\n    for (var x = 0; x < 160; ++x) {\n      store(BG_PRIORITY_MAP_LOCATION + getPixelStart(x, y), 0);\n    }\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction getPixelStart(x, y) {\n  // Get the pixel number\n  return y * 160 + x;\n} // Functions for performance hacks, and debugging tiles\n\n\nvar TileCache =\n/** @class */\nfunction () {\n  function TileCache() {}\n\n  TileCache.tileId = -1;\n  TileCache.horizontalFlip = false;\n  TileCache.nextXIndexToPerformCacheCheck = -1;\n  return TileCache;\n}(); // Inlined because closure compiler inlines\n\n\nfunction resetTileCache() {\n  TileCache.tileId = -1;\n  TileCache.nextXIndexToPerformCacheCheck = -1;\n}\n\nfunction drawPixelsFromLineOfTile(tileId, tileDataMemoryLocation, vramBankId, tileLineXStart, tileLineXEnd, tileLineY, outputLineX, outputLineY, outputWidth, wasmMemoryStart, shouldRepresentMonochromeColorByColorId, paletteLocation, bgMapAttributes, spriteAttributes) {\n  // Get our number of pixels drawn\n  var pixelsDrawn = 0; // Get our tile data address\n\n  var tileDataAddress = getTileDataAddress(tileDataMemoryLocation, tileId); // Get the bytes for our tile\n\n  var byteOneForLineOfTilePixels = loadFromVramBank(tileDataAddress + tileLineY * 2, vramBankId);\n  var byteTwoForLineOfTilePixels = loadFromVramBank(tileDataAddress + tileLineY * 2 + 1, vramBankId); // Loop through our X values to draw\n\n  for (var x = tileLineXStart; x <= tileLineXEnd; ++x) {\n    // First find where we are going to do our final output x\n    // And don't allow any width overflow\n    var iteratedOutputX = outputLineX + (x - tileLineXStart);\n\n    if (iteratedOutputX < outputWidth) {\n      // However, We need to reverse our byte (if not horizontally flipped),\n      // As pixel 0 is on byte 7, and pixel 1 is on byte 6, etc...\n      // Therefore, is pixelX was 2, then really is need to be 5\n      // So 2 - 7 = -5, * 1 = 5\n      // Or to simplify, 7 - 2 = 5 haha!\n      var pixelXInTile = x;\n\n      if (bgMapAttributes < 0 || !checkBitOnByte(5, bgMapAttributes)) {\n        pixelXInTile = 7 - pixelXInTile;\n      } // Get our pallete colors for the tile\n\n\n      var paletteColorId = 0;\n\n      if (checkBitOnByte(pixelXInTile, byteTwoForLineOfTilePixels)) {\n        // Byte one represents the second bit in our color id, so bit shift\n        paletteColorId += 1;\n        paletteColorId = paletteColorId << 1;\n      }\n\n      if (checkBitOnByte(pixelXInTile, byteOneForLineOfTilePixels)) {\n        paletteColorId += 1;\n      } // Get the pallete\n\n\n      var red = 0;\n      var green = 0;\n      var blue = 0; // Check if we should draw color or not\n\n      if (Cpu.GBCEnabled && (bgMapAttributes >= 0 || spriteAttributes >= 0)) {\n        // Draw C O L O R\n        var isSprite = spriteAttributes >= 0; // Call the helper function to grab the correct color from the palette\n        // Get the palette index byte\n\n        var bgPalette = bgMapAttributes & 0x07;\n\n        if (isSprite) {\n          bgPalette = spriteAttributes & 0x07;\n        }\n\n        var rgbColorPalette = getRgbColorFromPalette(bgPalette, paletteColorId, isSprite); // Split off into red green and blue\n\n        red = getColorComponentFromRgb(0, rgbColorPalette);\n        green = getColorComponentFromRgb(1, rgbColorPalette);\n        blue = getColorComponentFromRgb(2, rgbColorPalette);\n      } else {\n        // Draw Monochrome\n        // Get the default palette if none\n        if (paletteLocation <= 0) {\n          paletteLocation = Graphics.memoryLocationBackgroundPalette;\n        }\n\n        if (shouldRepresentMonochromeColorByColorId) {\n          var monochromeColor = getMonochromeColorFromPalette(paletteColorId, paletteLocation, shouldRepresentMonochromeColorByColorId);\n          red = monochromeColor;\n          green = monochromeColor;\n          blue = monochromeColor;\n        } else {\n          var hexColor = getColorizedGbHexColorFromPalette(paletteColorId, paletteLocation);\n          red = getRedFromHexColor(hexColor);\n          green = getGreenFromHexColor(hexColor);\n          blue = getBlueFromHexColor(hexColor);\n        }\n      } // Finally Lets place a pixel in memory\n      // Find where our tile line would start\n\n\n      var pixelStart = getTilePixelStart(iteratedOutputX, outputLineY, outputWidth);\n      wasmMemoryStart += pixelStart;\n      store(wasmMemoryStart + 0, red);\n      store(wasmMemoryStart + 1, green);\n      store(wasmMemoryStart + 2, blue);\n      var gbcBgPriority = false;\n\n      if (bgMapAttributes >= 0) {\n        gbcBgPriority = checkBitOnByte(7, bgMapAttributes);\n      } // Lastly, add the pixel to our background priority map\n      // https://github.com/torch2424/wasmBoy/issues/51\n      // Bits 0 & 1 will represent the color Id drawn by the BG/Window\n      // Bit 2 will represent if the Bg/Window has GBC priority.\n\n\n      addPriorityforPixel(iteratedOutputX, outputLineY, paletteColorId, gbcBgPriority);\n      pixelsDrawn++;\n    }\n  }\n\n  return pixelsDrawn;\n} // Inlined because closure compiler inlines\n\n\nfunction getTilePixelStart(outputLineX, outputLineY, outputWidth) {\n  // Finally Lets place a pixel in memory\n  var pixelStart = outputLineY * outputWidth + outputLineX; // Each pixel takes 3 slots, therefore, multiply by 3!\n\n  return pixelStart * 3;\n}\n\nfunction getTileDataAddress(tileDataMemoryLocation, tileIdFromTileMap) {\n  // Watch this part of The ultimate gameboy talk: https://youtu.be/HyzD8pNlpwI?t=30m50s\n  // A line of 8 pixels on a single tile, is represented by 2 bytes.\n  // since a single tile is 8x8 pixels, 8 * 2 = 16 bytes\n  // Get the tile ID's tile addess from tile data.\n  // For instance, let's say our first line of tile data represents tiles for letters:\n  // a b c d e f g\n  // And we have tileId 0x02. That means we want the tile for the 'c' character\n  // Since each tile is 16 bytes, it would be the starting tileDataAddress + (tileId * tileSize), to skip over tiles we dont want\n  // The whole signed thing is weird, and has something to do how the second set of tile data is stored :p\n  if (tileDataMemoryLocation === Graphics.memoryLocationTileDataSelectZeroStart) {\n    // Treat the tile Id as a signed int, subtract an offset of 128\n    // if the tileId was 0 then the tile would be in memory region 0x9000-0x900F\n    if (checkBitOnByte(7, tileIdFromTileMap)) {\n      tileIdFromTileMap -= 128;\n    } else {\n      tileIdFromTileMap += 128;\n    }\n  } // if the background layout gave us the tileId 0, then the tile data would be between 0x8000-0x800F.\n\n\n  return tileDataMemoryLocation + tileIdFromTileMap * 16;\n} // Functions to help with Handling Duty on Square Channels\n// Since there are no 2d arrays, we will use a byte to represent duty cycles (wave form from percentages)\n\n\nfunction isDutyCycleClockPositiveOrNegativeForWaveform(channelDuty, waveFormPositionOnDuty) {\n  // Get our Wave Form According to the Duty\n  // Default to a duty of 1\n  // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Square_Wave\n  switch (channelDuty) {\n    case 0x01:\n      // 1000 0001\n      return checkBitOnByte(waveFormPositionOnDuty, 0x81);\n\n    case 0x02:\n      // 1000 0111\n      return checkBitOnByte(waveFormPositionOnDuty, 0x87);\n\n    case 0x03:\n      // 0111 1110\n      return checkBitOnByte(waveFormPositionOnDuty, 0x7e);\n\n    default:\n      // 0000 0001\n      return checkBitOnByte(waveFormPositionOnDuty, 0x01);\n  }\n} // NOTE: Tons of Copy-pasta btween channels, because Classes cannot be instantiated yet in assemblyscript\n\n\nvar Channel1 =\n/** @class */\nfunction () {\n  function Channel1() {}\n\n  Channel1.updateNRx0 = function (value) {\n    Channel1.NRx0SweepPeriod = (value & 0x70) >> 4;\n    Channel1.NRx0Negate = checkBitOnByte(3, value);\n    Channel1.NRx0SweepShift = value & 0x07;\n  };\n\n  Channel1.updateNRx1 = function (value) {\n    Channel1.NRx1Duty = value >> 6 & 0x03;\n    Channel1.NRx1LengthLoad = value & 0x3f; // Also need to set our length counter. Taken from the old, setChannelLengthCounter\n    // Channel length is determined by 64 (or 256 if channel 3), - the length load\n    // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Registers\n    // Note, this will be different for channel 3\n\n    Channel1.lengthCounter = 64 - Channel1.NRx1LengthLoad;\n  };\n\n  Channel1.updateNRx2 = function (value) {\n    Channel1.NRx2StartingVolume = value >> 4 & 0x0f;\n    Channel1.NRx2EnvelopeAddMode = checkBitOnByte(3, value);\n    Channel1.NRx2EnvelopePeriod = value & 0x07; // Also, get our channel is dac enabled\n\n    Channel1.isDacEnabled = (value & 0xf8) > 0;\n  };\n\n  Channel1.updateNRx3 = function (value) {\n    Channel1.NRx3FrequencyLSB = value; // Update Channel Frequency\n\n    Channel1.frequency = Channel1.NRx4FrequencyMSB << 8 | value;\n  };\n\n  Channel1.updateNRx4 = function (value) {\n    Channel1.NRx4LengthEnabled = checkBitOnByte(6, value);\n    value &= 0x07;\n    Channel1.NRx4FrequencyMSB = value; // Update Channel Frequency\n\n    Channel1.frequency = value << 8 | Channel1.NRx3FrequencyLSB;\n  }; // Function to save the state of the class\n\n\n  Channel1.saveState = function () {\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x00, Channel1.saveStateSlot), Channel1.isEnabled);\n    store(getSaveStateMemoryOffset(0x01, Channel1.saveStateSlot), Channel1.frequencyTimer);\n    store(getSaveStateMemoryOffset(0x05, Channel1.saveStateSlot), Channel1.envelopeCounter);\n    store(getSaveStateMemoryOffset(0x09, Channel1.saveStateSlot), Channel1.lengthCounter);\n    store(getSaveStateMemoryOffset(0x0e, Channel1.saveStateSlot), Channel1.volume);\n    store(getSaveStateMemoryOffset(0x13, Channel1.saveStateSlot), Channel1.dutyCycle);\n    store(getSaveStateMemoryOffset(0x14, Channel1.saveStateSlot), Channel1.waveFormPositionOnDuty);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x19, Channel1.saveStateSlot), Channel1.isSweepEnabled);\n    store(getSaveStateMemoryOffset(0x1a, Channel1.saveStateSlot), Channel1.sweepCounter);\n    store(getSaveStateMemoryOffset(0x1f, Channel1.saveStateSlot), Channel1.sweepShadowFrequency);\n  }; // Function to load the save state from memory\n\n\n  Channel1.loadState = function () {\n    Channel1.isEnabled = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x00, Channel1.saveStateSlot));\n    Channel1.frequencyTimer = load(getSaveStateMemoryOffset(0x01, Channel1.saveStateSlot));\n    Channel1.envelopeCounter = load(getSaveStateMemoryOffset(0x05, Channel1.saveStateSlot));\n    Channel1.lengthCounter = load(getSaveStateMemoryOffset(0x09, Channel1.saveStateSlot));\n    Channel1.volume = load(getSaveStateMemoryOffset(0x0e, Channel1.saveStateSlot));\n    Channel1.dutyCycle = load(getSaveStateMemoryOffset(0x13, Channel1.saveStateSlot));\n    Channel1.waveFormPositionOnDuty = load(getSaveStateMemoryOffset(0x14, Channel1.saveStateSlot));\n    Channel1.isSweepEnabled = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x19, Channel1.saveStateSlot));\n    Channel1.sweepCounter = load(getSaveStateMemoryOffset(0x1a, Channel1.saveStateSlot));\n    Channel1.sweepShadowFrequency = load(getSaveStateMemoryOffset(0x1f, Channel1.saveStateSlot));\n  };\n\n  Channel1.initialize = function () {\n    eightBitStoreIntoGBMemory(Channel1.memoryLocationNRx0, 0x80);\n    eightBitStoreIntoGBMemory(Channel1.memoryLocationNRx1, 0xbf);\n    eightBitStoreIntoGBMemory(Channel1.memoryLocationNRx2, 0xf3);\n    eightBitStoreIntoGBMemory(Channel1.memoryLocationNRx3, 0xc1);\n    eightBitStoreIntoGBMemory(Channel1.memoryLocationNRx4, 0xbf);\n  }; // Function to get a sample using the cycle counter on the channel\n\n\n  Channel1.getSampleFromCycleCounter = function () {\n    var accumulatedCycles = Channel1.cycleCounter;\n    Channel1.cycleCounter = 0;\n    return Channel1.getSample(accumulatedCycles);\n  }; // Function to reset our timer, useful for GBC double speed mode\n\n\n  Channel1.resetTimer = function () {\n    var frequencyTimer = 2048 - Channel1.frequency << 2; // TODO: Ensure this is correct for GBC Double Speed Mode\n\n    if (Cpu.GBCDoubleSpeed) {\n      frequencyTimer = frequencyTimer << 2;\n    }\n\n    Channel1.frequencyTimer = frequencyTimer;\n  };\n\n  Channel1.getSample = function (numberOfCycles) {\n    // Decrement our channel timer\n    var frequencyTimer = Channel1.frequencyTimer - numberOfCycles;\n\n    if (frequencyTimer <= 0) {\n      // Get the amount that overflowed so we don't drop cycles\n      var overflowAmount = abs(frequencyTimer);\n      Channel1.frequencyTimer = frequencyTimer; // Reset our timer\n      // A square channel's frequency timer period is set to (2048-frequency)*4.\n      // Four duty cycles are available, each waveform taking 8 frequency timer clocks to cycle through:\n\n      Channel1.resetTimer();\n      Channel1.frequencyTimer -= overflowAmount; // Also increment our duty cycle\n      // What is duty? https://en.wikipedia.org/wiki/Duty_cycle\n      // Duty cycle for square wave: http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Square_Wave\n\n      Channel1.waveFormPositionOnDuty = Channel1.waveFormPositionOnDuty + 1 & 7;\n    } else {\n      Channel1.frequencyTimer = frequencyTimer;\n    } // Get our ourput volume\n\n\n    var outputVolume = 0; // Finally to set our output volume, the channel must be enabled,\n    // Our channel DAC must be enabled, and we must be in an active state\n    // Of our duty cycle\n\n    if (Channel1.isEnabled && Channel1.isDacEnabled) {\n      outputVolume = Channel1.volume;\n    } else {\n      // Return silence\n      // Since range from -15 - 15, or 0 to 30 for our unsigned\n      return 15;\n    } // Get the current sampleValue\n\n\n    var sample = 1;\n\n    if (!isDutyCycleClockPositiveOrNegativeForWaveform(Channel1.NRx1Duty, Channel1.waveFormPositionOnDuty)) {\n      sample = -sample;\n    }\n\n    sample *= outputVolume; // Square Waves Can range from -15 - 15. Therefore simply add 15\n\n    sample += 15;\n    return sample;\n  }; //http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Trigger_Event\n\n\n  Channel1.trigger = function () {\n    Channel1.isEnabled = true;\n\n    if (Channel1.lengthCounter === 0) {\n      Channel1.lengthCounter = 64;\n    } // Reset our timer\n    // A square channel's frequency timer period is set to (2048-frequency)*4.\n    // Four duty cycles are available, each waveform taking 8 frequency timer clocks to cycle through:\n\n\n    Channel1.resetTimer();\n    Channel1.envelopeCounter = Channel1.NRx2EnvelopePeriod;\n    Channel1.volume = Channel1.NRx2StartingVolume; // Handle Channel Sweep\n    // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware\n\n    Channel1.sweepShadowFrequency = Channel1.frequency; // Reset back to the sweep period\n\n    Channel1.sweepCounter = Channel1.NRx0SweepPeriod; // The internal enabled flag is set if either the sweep period or shift are non-zero, cleared otherwise.\n\n    Channel1.isSweepEnabled = Channel1.NRx0SweepPeriod > 0 && Channel1.NRx0SweepShift > 0; // If the sweep shift is non-zero, frequency calculation and the overflow check are performed immediately.\n\n    if (Channel1.NRx0SweepShift > 0) {\n      calculateSweepAndCheckOverflow();\n    } // Finally if DAC is off, channel is still disabled\n\n\n    if (!Channel1.isDacEnabled) {\n      Channel1.isEnabled = false;\n    }\n  }; // Function to determine if the current channel would update when getting the sample\n  // This is used to accumulate samples\n\n\n  Channel1.willChannelUpdate = function (numberOfCycles) {\n    //Increment our cycle counter\n    var cycleCounter = Channel1.cycleCounter + numberOfCycles;\n    Channel1.cycleCounter = cycleCounter; // Dac enabled status cached by accumulator\n\n    return !(Channel1.frequencyTimer - cycleCounter > 0);\n  };\n\n  Channel1.updateSweep = function () {\n    // Obscure behavior\n    // TODO: The volume envelope and sweep timers treat a period of 0 as 8.\n    // Decrement the sweep counter\n    var sweepCounter = Channel1.sweepCounter - 1;\n\n    if (sweepCounter <= 0) {\n      // Reset back to the sweep period\n      Channel1.sweepCounter = Channel1.NRx0SweepPeriod; // Calculate our sweep\n      // When it generates a clock and the sweep's internal enabled flag is set and the sweep period is not zero,\n      // a new frequency is calculated and the overflow check is performed.\n\n      if (Channel1.isSweepEnabled && Channel1.NRx0SweepPeriod > 0) {\n        calculateSweepAndCheckOverflow();\n      }\n    } else {\n      Channel1.sweepCounter = sweepCounter;\n    }\n  };\n\n  Channel1.updateLength = function () {\n    var lengthCounter = Channel1.lengthCounter;\n\n    if (lengthCounter > 0 && Channel1.NRx4LengthEnabled) {\n      lengthCounter -= 1;\n    }\n\n    if (lengthCounter === 0) {\n      Channel1.isEnabled = false;\n    }\n\n    Channel1.lengthCounter = lengthCounter;\n  };\n\n  Channel1.updateEnvelope = function () {\n    // Obscure behavior\n    // TODO: The volume envelope and sweep timers treat a period of 0 as 8.\n    var envelopeCounter = Channel1.envelopeCounter - 1;\n\n    if (envelopeCounter <= 0) {\n      Channel1.envelopeCounter = Channel1.NRx2EnvelopePeriod; // When the timer generates a clock and the envelope period is NOT zero, a new volume is calculated\n      // NOTE: There is some weiirrdd obscure behavior where zero can equal 8, so watch out for that\n      // If notes are sustained for too long, this is probably why\n\n      if (envelopeCounter !== 0) {\n        var volume = Channel1.volume;\n\n        if (Channel1.NRx2EnvelopeAddMode && volume < 15) {\n          volume += 1;\n        } else if (!Channel1.NRx2EnvelopeAddMode && volume > 0) {\n          volume -= 1;\n        }\n\n        Channel1.volume = volume;\n      }\n    } else {\n      Channel1.envelopeCounter = envelopeCounter;\n    }\n  };\n\n  Channel1.setFrequency = function (frequency) {\n    // Get the high and low bits\n    var passedFrequencyHighBits = frequency >> 8;\n    var passedFrequencyLowBits = frequency & 0xff; // Get the new register 4\n\n    var register4 = eightBitLoadFromGBMemory(Channel1.memoryLocationNRx4); // Knock off lower 3 bits, and Or on our high bits\n\n    var newRegister4 = register4 & 0xf8;\n    newRegister4 = newRegister4 | passedFrequencyHighBits; // Set the registers\n\n    eightBitStoreIntoGBMemory(Channel1.memoryLocationNRx3, passedFrequencyLowBits);\n    eightBitStoreIntoGBMemory(Channel1.memoryLocationNRx4, newRegister4); // Save the frequency for ourselves without triggering memory traps\n\n    Channel1.NRx3FrequencyLSB = passedFrequencyLowBits;\n    Channel1.NRx4FrequencyMSB = passedFrequencyHighBits;\n    Channel1.frequency = Channel1.NRx4FrequencyMSB << 8 | Channel1.NRx3FrequencyLSB;\n  }; // Cycle Counter for our sound accumulator\n\n\n  Channel1.cycleCounter = 0; // Squarewave channel with volume envelope and frequency sweep functions.\n  // NR10 -> Sweep Register R/W\n\n  Channel1.memoryLocationNRx0 = 0xff10; // -PPP NSSS Sweep period, negate, shift\n\n  Channel1.NRx0SweepPeriod = 0;\n  Channel1.NRx0Negate = false;\n  Channel1.NRx0SweepShift = 0; // NR11 -> Sound length/Wave pattern duty (R/W)\n\n  Channel1.memoryLocationNRx1 = 0xff11; // DDLL LLLL Duty, Length load (64-L)\n\n  Channel1.NRx1Duty = 0;\n  Channel1.NRx1LengthLoad = 0; // NR12 -> Volume Envelope (R/W)\n\n  Channel1.memoryLocationNRx2 = 0xff12; // VVVV APPP Starting volume, Envelope add mode, period\n\n  Channel1.NRx2StartingVolume = 0;\n  Channel1.NRx2EnvelopeAddMode = false;\n  Channel1.NRx2EnvelopePeriod = 0; // NR13 -> Frequency lo (W)\n\n  Channel1.memoryLocationNRx3 = 0xff13; // FFFF FFFF Frequency LSB\n\n  Channel1.NRx3FrequencyLSB = 0; // NR14 -> Frequency hi (R/W)\n\n  Channel1.memoryLocationNRx4 = 0xff14; // TL-- -FFF Trigger, Length enable, Frequency MSB\n\n  Channel1.NRx4LengthEnabled = false;\n  Channel1.NRx4FrequencyMSB = 0; // Channel Properties\n\n  Channel1.channelNumber = 1;\n  Channel1.isEnabled = false;\n  Channel1.isDacEnabled = false;\n  Channel1.frequency = 0;\n  Channel1.frequencyTimer = 0x00;\n  Channel1.envelopeCounter = 0x00;\n  Channel1.lengthCounter = 0x00;\n  Channel1.volume = 0x00; // Square Wave properties\n\n  Channel1.dutyCycle = 0x00;\n  Channel1.waveFormPositionOnDuty = 0x00; // Channel 1 Sweep\n\n  Channel1.isSweepEnabled = false;\n  Channel1.sweepCounter = 0x00;\n  Channel1.sweepShadowFrequency = 0x00; // Save States\n\n  Channel1.saveStateSlot = 7;\n  return Channel1;\n}(); // Sweep Specific functions\n\n\nfunction calculateSweepAndCheckOverflow() {\n  var newFrequency = getNewFrequencyFromSweep(); // 7FF is the highest value of the frequency: 111 1111 1111\n\n  if (newFrequency <= 0x7ff && Channel1.NRx0SweepShift > 0) {\n    // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware\n    // If the new frequency is 2047 or less and the sweep shift is not zero,\n    // this new frequency is written back to the shadow frequency and square 1's frequency in NR13 and NR14,\n    // then frequency calculation and overflow check are run AGAIN immediately using this new value,\n    // but this second new frequency is not written back.\n    Channel1.sweepShadowFrequency = newFrequency;\n    Channel1.setFrequency(newFrequency); // Re calculate the new frequency\n\n    newFrequency = getNewFrequencyFromSweep();\n  } // Next check if the new Frequency is above 0x7FF\n  // if So, disable our sweep\n\n\n  if (newFrequency > 0x7ff) {\n    Channel1.isEnabled = false;\n  }\n} // Function to determing a new sweep in the current context\n\n\nfunction getNewFrequencyFromSweep() {\n  // Start our new frequency, by making it equal to the \"shadow frequency\"\n  var oldFrequency = Channel1.sweepShadowFrequency;\n  var newFrequency = oldFrequency;\n  newFrequency = newFrequency >> Channel1.NRx0SweepShift; // Check for sweep negation\n\n  if (Channel1.NRx0Negate) {\n    newFrequency = oldFrequency - newFrequency;\n  } else {\n    newFrequency = oldFrequency + newFrequency;\n  }\n\n  return newFrequency;\n} // NOTE: Tons of Copy-pasta btween channels, because Classes cannot be instantiated yet in assemblyscript\n\n\nvar Channel2 =\n/** @class */\nfunction () {\n  function Channel2() {}\n\n  Channel2.updateNRx1 = function (value) {\n    Channel2.NRx1Duty = value >> 6 & 0x03;\n    Channel2.NRx1LengthLoad = value & 0x3f; // Also need to set our length counter. Taken from the old, setChannelLengthCounter\n    // Channel length is determined by 64 (or 256 if channel 3), - the length load\n    // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Registers\n    // Note, this will be different for channel 3\n\n    Channel2.lengthCounter = 64 - Channel2.NRx1LengthLoad;\n  };\n\n  Channel2.updateNRx2 = function (value) {\n    Channel2.NRx2StartingVolume = value >> 4 & 0x0f;\n    Channel2.NRx2EnvelopeAddMode = checkBitOnByte(3, value);\n    Channel2.NRx2EnvelopePeriod = value & 0x07; // Also, get our channel is dac enabled\n\n    Channel2.isDacEnabled = (value & 0xf8) > 0;\n  };\n\n  Channel2.updateNRx3 = function (value) {\n    Channel2.NRx3FrequencyLSB = value; // Update Channel Frequency\n\n    Channel2.frequency = Channel2.NRx4FrequencyMSB << 8 | value;\n  };\n\n  Channel2.updateNRx4 = function (value) {\n    Channel2.NRx4LengthEnabled = checkBitOnByte(6, value);\n    value &= 0x07;\n    Channel2.NRx4FrequencyMSB = value; // Update Channel Frequency\n\n    Channel2.frequency = value << 8 | Channel2.NRx3FrequencyLSB;\n  }; // Function to save the state of the class\n\n\n  Channel2.saveState = function () {\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x00, Channel2.saveStateSlot), Channel2.isEnabled);\n    store(getSaveStateMemoryOffset(0x01, Channel2.saveStateSlot), Channel2.frequencyTimer);\n    store(getSaveStateMemoryOffset(0x05, Channel2.saveStateSlot), Channel2.envelopeCounter);\n    store(getSaveStateMemoryOffset(0x09, Channel2.saveStateSlot), Channel2.lengthCounter);\n    store(getSaveStateMemoryOffset(0x0e, Channel2.saveStateSlot), Channel2.volume);\n    store(getSaveStateMemoryOffset(0x13, Channel2.saveStateSlot), Channel2.dutyCycle);\n    store(getSaveStateMemoryOffset(0x14, Channel2.saveStateSlot), Channel2.waveFormPositionOnDuty);\n  }; // Function to load the save state from memory\n\n\n  Channel2.loadState = function () {\n    Channel2.isEnabled = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x00, Channel2.saveStateSlot));\n    Channel2.frequencyTimer = load(getSaveStateMemoryOffset(0x01, Channel2.saveStateSlot));\n    Channel2.envelopeCounter = load(getSaveStateMemoryOffset(0x05, Channel2.saveStateSlot));\n    Channel2.lengthCounter = load(getSaveStateMemoryOffset(0x09, Channel2.saveStateSlot));\n    Channel2.volume = load(getSaveStateMemoryOffset(0x0e, Channel2.saveStateSlot));\n    Channel2.dutyCycle = load(getSaveStateMemoryOffset(0x13, Channel2.saveStateSlot));\n    Channel2.waveFormPositionOnDuty = load(getSaveStateMemoryOffset(0x14, Channel2.saveStateSlot));\n  };\n\n  Channel2.initialize = function () {\n    eightBitStoreIntoGBMemory(Channel2.memoryLocationNRx1 - 1, 0xff);\n    eightBitStoreIntoGBMemory(Channel2.memoryLocationNRx1, 0x3f);\n    eightBitStoreIntoGBMemory(Channel2.memoryLocationNRx2, 0x00);\n    eightBitStoreIntoGBMemory(Channel2.memoryLocationNRx3, 0x00);\n    eightBitStoreIntoGBMemory(Channel2.memoryLocationNRx4, 0xb8);\n  }; // Function to get a sample using the cycle counter on the channel\n\n\n  Channel2.getSampleFromCycleCounter = function () {\n    var accumulatedCycles = Channel2.cycleCounter;\n    Channel2.cycleCounter = 0;\n    return Channel2.getSample(accumulatedCycles);\n  }; // Function to reset our timer, useful for GBC double speed mode\n\n\n  Channel2.resetTimer = function () {\n    var frequencyTimer = 2048 - Channel2.frequency << 2; // TODO: Ensure this is correct for GBC Double Speed Mode\n\n    Channel2.frequencyTimer = frequencyTimer << Cpu.GBCDoubleSpeed;\n  };\n\n  Channel2.getSample = function (numberOfCycles) {\n    // Decrement our channel timer\n    var frequencyTimer = Channel2.frequencyTimer - numberOfCycles;\n    Channel2.frequencyTimer = frequencyTimer;\n\n    if (frequencyTimer <= 0) {\n      // Get the amount that overflowed so we don't drop cycles\n      var overflowAmount = abs(frequencyTimer); // Reset our timer\n      // A square channel's frequency timer period is set to (2048-frequency)*4.\n      // Four duty cycles are available, each waveform taking 8 frequency timer clocks to cycle through:\n\n      Channel2.resetTimer();\n      Channel2.frequencyTimer -= overflowAmount; // Also increment our duty cycle\n      // What is duty? https://en.wikipedia.org/wiki/Duty_cycle\n      // Duty cycle for square wave: http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Square_Wave\n\n      Channel2.waveFormPositionOnDuty = Channel2.waveFormPositionOnDuty + 1 & 7;\n    } // Get our ourput volume\n\n\n    var outputVolume = 0; // Finally to set our output volume, the channel must be enabled,\n    // Our channel DAC must be enabled, and we must be in an active state\n    // Of our duty cycle\n\n    if (Channel2.isEnabled && Channel2.isDacEnabled) {\n      outputVolume = Channel2.volume;\n    } else {\n      // Return silence\n      // Since range from -15 - 15, or 0 to 30 for our unsigned\n      return 15;\n    } // Get the current sampleValue\n\n\n    var sample = 1;\n\n    if (!isDutyCycleClockPositiveOrNegativeForWaveform(Channel2.NRx1Duty, Channel2.waveFormPositionOnDuty)) {\n      sample = -sample;\n    }\n\n    sample = sample * outputVolume; // Square Waves Can range from -15 - 15. Therefore simply add 15\n\n    sample += 15;\n    return sample;\n  }; //http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Trigger_Event\n\n\n  Channel2.trigger = function () {\n    Channel2.isEnabled = true;\n\n    if (Channel2.lengthCounter === 0) {\n      Channel2.lengthCounter = 64;\n    } // Reset our timer\n    // A square channel's frequency timer period is set to (2048-frequency)*4.\n    // Four duty cycles are available, each waveform taking 8 frequency timer clocks to cycle through:\n\n\n    Channel2.resetTimer();\n    Channel2.envelopeCounter = Channel2.NRx2EnvelopePeriod;\n    Channel2.volume = Channel2.NRx2StartingVolume; // Finally if DAC is off, channel is still disabled\n\n    if (!Channel2.isDacEnabled) {\n      Channel2.isEnabled = false;\n    }\n  }; // Function to determine if the current channel would update when getting the sample\n  // This is used to accumulate samples\n\n\n  Channel2.willChannelUpdate = function (numberOfCycles) {\n    //Increment our cycle counter\n    var cycleCounter = Channel2.cycleCounter + numberOfCycles;\n    Channel2.cycleCounter = cycleCounter; // Dac enabled status cached by accumulator\n\n    return !(Channel2.frequencyTimer - cycleCounter > 0);\n  };\n\n  Channel2.updateLength = function () {\n    var lengthCounter = Channel2.lengthCounter;\n\n    if (lengthCounter > 0 && Channel2.NRx4LengthEnabled) {\n      lengthCounter -= 1;\n    }\n\n    if (lengthCounter === 0) {\n      Channel2.isEnabled = false;\n    }\n\n    Channel2.lengthCounter = lengthCounter;\n  };\n\n  Channel2.updateEnvelope = function () {\n    // Obscure behavior\n    // TODO: The volume envelope and sweep timers treat a period of 0 as 8.\n    var envelopeCounter = Channel2.envelopeCounter - 1;\n\n    if (envelopeCounter <= 0) {\n      envelopeCounter = Channel2.NRx2EnvelopePeriod; // When the timer generates a clock and the envelope period is NOT zero, a new volume is calculated\n      // NOTE: There is some weiirrdd obscure behavior where zero can equal 8, so watch out for that\n\n      if (envelopeCounter !== 0) {\n        var volume = Channel2.volume;\n\n        if (Channel2.NRx2EnvelopeAddMode && volume < 15) {\n          volume += 1;\n        } else if (!Channel2.NRx2EnvelopeAddMode && volume > 0) {\n          volume -= 1;\n        }\n\n        Channel2.volume = volume;\n      }\n    }\n\n    Channel2.envelopeCounter = envelopeCounter;\n  };\n\n  Channel2.setFrequency = function (frequency) {\n    // Get the high and low bits\n    var passedFrequencyHighBits = frequency >> 8;\n    var passedFrequencyLowBits = frequency & 0xff; // Get the new register 4\n\n    var register4 = eightBitLoadFromGBMemory(Channel2.memoryLocationNRx4); // Knock off lower 3 bits, and Or on our high bits\n\n    var newRegister4 = register4 & 0xf8;\n    newRegister4 = newRegister4 | passedFrequencyHighBits; // Set the registers\n\n    eightBitStoreIntoGBMemory(Channel2.memoryLocationNRx3, passedFrequencyLowBits);\n    eightBitStoreIntoGBMemory(Channel2.memoryLocationNRx4, newRegister4); // Save the frequency for ourselves without triggering memory traps\n\n    Channel2.NRx3FrequencyLSB = passedFrequencyLowBits;\n    Channel2.NRx4FrequencyMSB = passedFrequencyHighBits;\n    Channel2.frequency = passedFrequencyHighBits << 8 | passedFrequencyLowBits;\n  }; // Cycle Counter for our sound accumulator\n\n\n  Channel2.cycleCounter = 0; // Squarewave channel with volume envelope functions only.\n  // NR21 -> Sound length/Wave pattern duty (R/W)\n\n  Channel2.memoryLocationNRx1 = 0xff16; // DDLL LLLL Duty, Length load (64-L)\n\n  Channel2.NRx1Duty = 0;\n  Channel2.NRx1LengthLoad = 0; // NR22 -> Volume Envelope (R/W)\n\n  Channel2.memoryLocationNRx2 = 0xff17; // VVVV APPP Starting volume, Envelope add mode, period\n\n  Channel2.NRx2StartingVolume = 0;\n  Channel2.NRx2EnvelopeAddMode = false;\n  Channel2.NRx2EnvelopePeriod = 0; // NR23 -> Frequency lo (W)\n\n  Channel2.memoryLocationNRx3 = 0xff18; // FFFF FFFF Frequency LSB\n\n  Channel2.NRx3FrequencyLSB = 0; // NR24 -> Frequency hi (R/W)\n\n  Channel2.memoryLocationNRx4 = 0xff19; // TL-- -FFF Trigger, Length enable, Frequency MSB\n\n  Channel2.NRx4LengthEnabled = false;\n  Channel2.NRx4FrequencyMSB = 0; // Channel Properties\n\n  Channel2.channelNumber = 2;\n  Channel2.isEnabled = false;\n  Channel2.isDacEnabled = false;\n  Channel2.frequency = 0;\n  Channel2.frequencyTimer = 0x00;\n  Channel2.envelopeCounter = 0x00;\n  Channel2.lengthCounter = 0x00;\n  Channel2.volume = 0x00; // Square Wave properties\n\n  Channel2.dutyCycle = 0x00;\n  Channel2.waveFormPositionOnDuty = 0x00; // Save States\n\n  Channel2.saveStateSlot = 8;\n  return Channel2;\n}(); // NOTE: Tons of Copy-pasta btween channels, because Classes cannot be instantiated yet in assemblyscript\n\n\nvar Channel3 =\n/** @class */\nfunction () {\n  function Channel3() {} // E--- ---- DAC power\n\n\n  Channel3.updateNRx0 = function (value) {\n    Channel3.isDacEnabled = checkBitOnByte(7, value);\n  };\n\n  Channel3.updateNRx1 = function (value) {\n    Channel3.NRx1LengthLoad = value; // Also need to set our length counter. Taken from the old, setChannelLengthCounter\n    // Channel length is determined by 64 (or 256 if channel 3), - the length load\n    // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Registers\n    // Note, this will be different for channel 3\n    // Supposed to be 256, so subtracting 255 and then adding 1 if that makes sense\n\n    Channel3.lengthCounter = 256 - Channel3.NRx1LengthLoad;\n  };\n\n  Channel3.updateNRx2 = function (value) {\n    Channel3.NRx2VolumeCode = value >> 5 & 0x0f;\n  };\n\n  Channel3.updateNRx3 = function (value) {\n    Channel3.NRx3FrequencyLSB = value; // Update Channel Frequency\n\n    Channel3.frequency = Channel3.NRx4FrequencyMSB << 8 | value;\n  };\n\n  Channel3.updateNRx4 = function (value) {\n    Channel3.NRx4LengthEnabled = checkBitOnByte(6, value);\n    value &= 0x07;\n    Channel3.NRx4FrequencyMSB = value; // Update Channel Frequency\n\n    Channel3.frequency = value << 8 | Channel3.NRx3FrequencyLSB;\n  }; // Function to save the state of the class\n\n\n  Channel3.saveState = function () {\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x00, Channel3.saveStateSlot), Channel3.isEnabled);\n    store(getSaveStateMemoryOffset(0x01, Channel3.saveStateSlot), Channel3.frequencyTimer);\n    store(getSaveStateMemoryOffset(0x05, Channel3.saveStateSlot), Channel3.lengthCounter);\n    store(getSaveStateMemoryOffset(0x09, Channel3.saveStateSlot), Channel3.waveTablePosition);\n  }; // Function to load the save state from memory\n\n\n  Channel3.loadState = function () {\n    Channel3.isEnabled = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x00, Channel3.saveStateSlot));\n    Channel3.frequencyTimer = load(getSaveStateMemoryOffset(0x01, Channel3.saveStateSlot));\n    Channel3.lengthCounter = load(getSaveStateMemoryOffset(0x05, Channel3.saveStateSlot));\n    Channel3.waveTablePosition = load(getSaveStateMemoryOffset(0x09, Channel3.saveStateSlot));\n  };\n\n  Channel3.initialize = function () {\n    eightBitStoreIntoGBMemory(Channel3.memoryLocationNRx0, 0x7f);\n    eightBitStoreIntoGBMemory(Channel3.memoryLocationNRx1, 0xff);\n    eightBitStoreIntoGBMemory(Channel3.memoryLocationNRx2, 0x9f);\n    eightBitStoreIntoGBMemory(Channel3.memoryLocationNRx3, 0x00);\n    eightBitStoreIntoGBMemory(Channel3.memoryLocationNRx4, 0xb8); // The volume code changed\n\n    Channel3.volumeCodeChanged = true;\n  }; // Function to get a sample using the cycle counter on the channel\n\n\n  Channel3.getSampleFromCycleCounter = function () {\n    var accumulatedCycles = Channel3.cycleCounter;\n    Channel3.cycleCounter = 0;\n    return Channel3.getSample(accumulatedCycles);\n  }; // Function to reset our timer, useful for GBC double speed mode\n\n\n  Channel3.resetTimer = function () {\n    var frequencyTimer = 2048 - Channel3.frequency << 1; // TODO: Ensure this is correct for GBC Double Speed Mode\n\n    Channel3.frequencyTimer = frequencyTimer << Cpu.GBCDoubleSpeed;\n  };\n\n  Channel3.getSample = function (numberOfCycles) {\n    // Decrement our channel timer\n    var frequencyTimer = Channel3.frequencyTimer;\n    frequencyTimer -= numberOfCycles;\n\n    if (frequencyTimer <= 0) {\n      // Get the amount that overflowed so we don't drop cycles\n      var overflowAmount = abs(frequencyTimer);\n      Channel3.frequencyTimer = frequencyTimer; // Reset our timer\n      // A wave channel's frequency timer period is set to (2048-frequency) * 2.\n      // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Wave_Channel\n\n      Channel3.resetTimer();\n      Channel3.frequencyTimer -= overflowAmount; // Advance the wave table position, and loop back if needed\n\n      Channel3.waveTablePosition = Channel3.waveTablePosition + 1 & 31;\n    } else {\n      Channel3.frequencyTimer = frequencyTimer;\n    } // Get our output volume\n\n\n    var volumeCode = Channel3.volumeCode; // Finally to set our output volume, the channel must be enabled,\n    // Our channel DAC must be enabled, and we must be in an active state\n    // Of our duty cycle\n\n    if (Channel3.isEnabled && Channel3.isDacEnabled) {\n      // Get our volume code\n      if (Channel3.volumeCodeChanged) {\n        volumeCode = eightBitLoadFromGBMemory(Channel3.memoryLocationNRx2);\n        volumeCode = volumeCode >> 5;\n        volumeCode = volumeCode & 0x0f;\n        Channel3.volumeCode = volumeCode;\n        Channel3.volumeCodeChanged = false;\n      }\n    } else {\n      // Return silence\n      // Since range from -15 - 15, or 0 to 30 for our unsigned\n      return 15;\n    } // Get the current sample\n\n\n    var sample = 0; // Will Find the position, and knock off any remainder\n\n    var waveTablePosition = Channel3.waveTablePosition;\n    var positionIndexToAdd = i32Portable(waveTablePosition >> 1);\n    var memoryLocationWaveSample = Channel3.memoryLocationWaveTable + positionIndexToAdd;\n    sample = eightBitLoadFromGBMemory(memoryLocationWaveSample); // Need to grab the top or lower half for the correct sample\n\n    sample >>= ((waveTablePosition & 1) === 0) << 2;\n    sample &= 0x0f; // Shift our sample and set our volume depending on the volume code\n    // Since we can't multiply by float, simply divide by 4, 2, 1\n    // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Wave_Channel\n\n    var outputVolume = 0;\n\n    switch (volumeCode) {\n      case 0:\n        sample >>= 4;\n        break;\n\n      case 1:\n        // Dont Shift sample\n        outputVolume = 1;\n        break;\n\n      case 2:\n        sample >>= 1;\n        outputVolume = 2;\n        break;\n\n      default:\n        sample >>= 2;\n        outputVolume = 4;\n        break;\n    } // Spply out output volume\n\n\n    sample = outputVolume > 0 ? sample / outputVolume : 0; // Square Waves Can range from -15 - 15. Therefore simply add 15\n\n    sample += 15;\n    return sample;\n  }; //http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Trigger_Event\n\n\n  Channel3.trigger = function () {\n    Channel3.isEnabled = true;\n\n    if (Channel3.lengthCounter === 0) {\n      Channel3.lengthCounter = 256;\n    } // Reset our timer\n    // A wave channel's frequency timer period is set to (2048-frequency)*2.\n\n\n    Channel3.resetTimer(); // Reset our wave table position\n\n    Channel3.waveTablePosition = 0; // Finally if DAC is off, channel is still disabled\n\n    if (!Channel3.isDacEnabled) {\n      Channel3.isEnabled = false;\n    }\n  }; // Function to determine if the current channel would update when getting the sample\n  // This is used to accumulate samples\n\n\n  Channel3.willChannelUpdate = function (numberOfCycles) {\n    //Increment our cycle counter\n    Channel3.cycleCounter += numberOfCycles; // Dac enabled status cached by accumulator\n\n    return !(!Channel3.volumeCodeChanged && Channel3.frequencyTimer - Channel3.cycleCounter > 0);\n  };\n\n  Channel3.updateLength = function () {\n    var lengthCounter = Channel3.lengthCounter;\n\n    if (lengthCounter > 0 && Channel3.NRx4LengthEnabled) {\n      lengthCounter -= 1;\n    }\n\n    if (lengthCounter === 0) {\n      Channel3.isEnabled = false;\n    }\n\n    Channel3.lengthCounter = lengthCounter;\n  }; // Cycle Counter for our sound accumulator\n\n\n  Channel3.cycleCounter = 0; // Voluntary Wave channel with 32 4-bit programmable samples, played in sequence.\n  // NR30 -> Sound on/off (R/W)\n\n  Channel3.memoryLocationNRx0 = 0xff1a; // NR31 -> Sound length (R/W)\n\n  Channel3.memoryLocationNRx1 = 0xff1b; // LLLL LLLL Length load (256-L)\n\n  Channel3.NRx1LengthLoad = 0; // NR32 -> Select ouput level (R/W)\n\n  Channel3.memoryLocationNRx2 = 0xff1c; // -VV- ---- Volume code (00=0%, 01=100%, 10=50%, 11=25%)\n\n  Channel3.NRx2VolumeCode = 0; // NR33 -> Frequency lower data (W)\n\n  Channel3.memoryLocationNRx3 = 0xff1d; // FFFF FFFF Frequency LSB\n\n  Channel3.NRx3FrequencyLSB = 0; // NR34 -> Frequency higher data (R/W)\n\n  Channel3.memoryLocationNRx4 = 0xff1e; // TL-- -FFF Trigger, Length enable, Frequency MSB\n\n  Channel3.NRx4LengthEnabled = false;\n  Channel3.NRx4FrequencyMSB = 0; // Our wave table location\n\n  Channel3.memoryLocationWaveTable = 0xff30; // Channel Properties\n\n  Channel3.channelNumber = 3;\n  Channel3.isEnabled = false;\n  Channel3.isDacEnabled = false;\n  Channel3.frequency = 0;\n  Channel3.frequencyTimer = 0x00;\n  Channel3.lengthCounter = 0x00;\n  Channel3.waveTablePosition = 0x00;\n  Channel3.volumeCode = 0x00;\n  Channel3.volumeCodeChanged = false; // Save States\n\n  Channel3.saveStateSlot = 9;\n  return Channel3;\n}(); // NOTE: Tons of Copy-pasta btween channels, because Classes cannot be instantiated yet in assemblyscript\n\n\nvar Channel4 =\n/** @class */\nfunction () {\n  function Channel4() {}\n\n  Channel4.updateNRx1 = function (value) {\n    Channel4.NRx1LengthLoad = value & 0x3f; // Also need to set our length counter. Taken from the old, setChannelLengthCounter\n    // Channel length is determined by 64 (or 256 if channel 3), - the length load\n    // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Registers\n    // Note, this will be different for channel 3\n\n    Channel4.lengthCounter = 64 - Channel4.NRx1LengthLoad;\n  };\n\n  Channel4.updateNRx2 = function (value) {\n    Channel4.NRx2StartingVolume = value >> 4 & 0x0f;\n    Channel4.NRx2EnvelopeAddMode = checkBitOnByte(3, value);\n    Channel4.NRx2EnvelopePeriod = value & 0x07; // Also, get our channel is dac enabled\n\n    Channel4.isDacEnabled = (value & 0xf8) > 0;\n  };\n\n  Channel4.updateNRx3 = function (value) {\n    var divisorCode = value & 0x07;\n    Channel4.NRx3ClockShift = value >> 4;\n    Channel4.NRx3WidthMode = checkBitOnByte(3, value);\n    Channel4.NRx3DivisorCode = divisorCode; // Also, get our divisor\n\n    divisorCode <<= 1;\n    if (divisorCode < 1) divisorCode = 1;\n    Channel4.divisor = divisorCode << 3;\n  };\n\n  Channel4.updateNRx4 = function (value) {\n    Channel4.NRx4LengthEnabled = checkBitOnByte(6, value);\n  }; // Function to save the state of the class\n\n\n  Channel4.saveState = function () {\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x00, Channel4.saveStateSlot), Channel4.isEnabled);\n    store(getSaveStateMemoryOffset(0x01, Channel4.saveStateSlot), Channel4.frequencyTimer);\n    store(getSaveStateMemoryOffset(0x05, Channel4.saveStateSlot), Channel4.envelopeCounter);\n    store(getSaveStateMemoryOffset(0x09, Channel4.saveStateSlot), Channel4.lengthCounter);\n    store(getSaveStateMemoryOffset(0x0e, Channel4.saveStateSlot), Channel4.volume);\n    store(getSaveStateMemoryOffset(0x13, Channel4.saveStateSlot), Channel4.linearFeedbackShiftRegister);\n  }; // Function to load the save state from memory\n\n\n  Channel4.loadState = function () {\n    Channel4.isEnabled = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x00, Channel4.saveStateSlot));\n    Channel4.frequencyTimer = load(getSaveStateMemoryOffset(0x01, Channel4.saveStateSlot));\n    Channel4.envelopeCounter = load(getSaveStateMemoryOffset(0x05, Channel4.saveStateSlot));\n    Channel4.lengthCounter = load(getSaveStateMemoryOffset(0x09, Channel4.saveStateSlot));\n    Channel4.volume = load(getSaveStateMemoryOffset(0x0e, Channel4.saveStateSlot));\n    Channel4.linearFeedbackShiftRegister = load(getSaveStateMemoryOffset(0x13, Channel4.saveStateSlot));\n  };\n\n  Channel4.initialize = function () {\n    eightBitStoreIntoGBMemory(Channel4.memoryLocationNRx1 - 1, 0xff);\n    eightBitStoreIntoGBMemory(Channel4.memoryLocationNRx1, 0xff);\n    eightBitStoreIntoGBMemory(Channel4.memoryLocationNRx2, 0x00);\n    eightBitStoreIntoGBMemory(Channel4.memoryLocationNRx3, 0x00);\n    eightBitStoreIntoGBMemory(Channel4.memoryLocationNRx4, 0xbf);\n  }; // Function to get a sample using the cycle counter on the channel\n\n\n  Channel4.getSampleFromCycleCounter = function () {\n    var accumulatedCycles = Channel4.cycleCounter;\n    Channel4.cycleCounter = 0;\n    return Channel4.getSample(accumulatedCycles);\n  };\n\n  Channel4.getSample = function (numberOfCycles) {\n    // Decrement our channel timer\n    var frequencyTimer = Channel4.frequencyTimer;\n    frequencyTimer -= numberOfCycles;\n\n    if (frequencyTimer <= 0) {\n      // Get the amount that overflowed so we don't drop cycles\n      var overflowAmount = abs(frequencyTimer); // Reset our timer\n\n      frequencyTimer = Channel4.getNoiseChannelFrequencyPeriod();\n      frequencyTimer -= overflowAmount; // Do some cool stuff with lfsr\n      // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Noise_Channel\n      // First XOR bit zero and one\n\n      var linearFeedbackShiftRegister = Channel4.linearFeedbackShiftRegister;\n      var lfsrBitZero = linearFeedbackShiftRegister & 0x01;\n      var lfsrBitOne = linearFeedbackShiftRegister >> 1;\n      lfsrBitOne = lfsrBitOne & 0x01;\n      var xorLfsrBitZeroOne = lfsrBitZero ^ lfsrBitOne; // Shift all lsfr bits by one\n\n      linearFeedbackShiftRegister = linearFeedbackShiftRegister >> 1; // Place the XOR result on bit 15\n\n      linearFeedbackShiftRegister = linearFeedbackShiftRegister | xorLfsrBitZeroOne << 14; // If the width mode is set, set xor on bit 6, and make lfsr 7 bit\n\n      if (Channel4.NRx3WidthMode) {\n        // Make 7 bit, by knocking off lower bits. Want to keeps bits 8 - 16, and then or on 7\n        linearFeedbackShiftRegister = linearFeedbackShiftRegister & ~0x40;\n        linearFeedbackShiftRegister = linearFeedbackShiftRegister | xorLfsrBitZeroOne << 6;\n      }\n\n      Channel4.linearFeedbackShiftRegister = linearFeedbackShiftRegister;\n    }\n\n    Channel4.frequencyTimer = frequencyTimer; // Get our ourput volume, set to zero for silence\n\n    var outputVolume = 0; // Finally to set our output volume, the channel must be enabled,\n    // Our channel DAC must be enabled, and we must be in an active state\n    // Of our duty cycle\n\n    if (Channel4.isEnabled && Channel4.isDacEnabled) {\n      outputVolume = Channel4.volume;\n    } else {\n      // Return silence\n      // Since range from -15 - 15, or 0 to 30 for our unsigned\n      return 15;\n    } // Declare our sample\n\n\n    var sample = 0; // Wave form output is bit zero of lfsr, INVERTED\n\n    sample = !checkBitOnByte(0, Channel4.linearFeedbackShiftRegister) ? 1 : -1;\n    sample = sample * outputVolume; // Noise Can range from -15 - 15. Therefore simply add 15\n\n    sample = sample + 15;\n    return sample;\n  }; //http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Trigger_Event\n\n\n  Channel4.trigger = function () {\n    Channel4.isEnabled = true;\n\n    if (Channel4.lengthCounter === 0) {\n      Channel4.lengthCounter = 64;\n    } // Reset our timers\n\n\n    Channel4.frequencyTimer = Channel4.getNoiseChannelFrequencyPeriod();\n    Channel4.envelopeCounter = Channel4.NRx2EnvelopePeriod;\n    Channel4.volume = Channel4.NRx2StartingVolume; // Noise channel's LFSR bits are all set to 1.\n\n    Channel4.linearFeedbackShiftRegister = 0x7fff; // Finally if DAC is off, channel is still disabled\n\n    if (!Channel4.isDacEnabled) {\n      Channel4.isEnabled = false;\n    }\n  }; // Function to determine if the current channel would update when getting the sample\n  // This is used to accumulate samples\n\n\n  Channel4.willChannelUpdate = function (numberOfCycles) {\n    //Increment our cycle counter\n    Channel4.cycleCounter += numberOfCycles; // Dac enabled status cached by accumulator\n\n    return !(Channel4.frequencyTimer - Channel4.cycleCounter > 0);\n  };\n\n  Channel4.getNoiseChannelFrequencyPeriod = function () {\n    // Get our divisor from the divisor code, and shift by the clock shift\n    var response = Channel4.divisor << Channel4.NRx3ClockShift;\n    return response << Cpu.GBCDoubleSpeed;\n  };\n\n  Channel4.updateLength = function () {\n    var lengthCounter = Channel4.lengthCounter;\n\n    if (lengthCounter > 0 && Channel4.NRx4LengthEnabled) {\n      lengthCounter -= 1;\n    }\n\n    if (lengthCounter === 0) {\n      Channel4.isEnabled = false;\n    }\n\n    Channel4.lengthCounter = lengthCounter;\n  };\n\n  Channel4.updateEnvelope = function () {\n    // Obscure behavior\n    // TODO: The volume envelope and sweep timers treat a period of 0 as 8.\n    var envelopeCounter = Channel4.envelopeCounter - 1;\n\n    if (envelopeCounter <= 0) {\n      envelopeCounter = Channel4.NRx2EnvelopePeriod; // When the timer generates a clock and the envelope period is NOT zero, a new volume is calculated\n      // NOTE: There is some weiirrdd obscure behavior where zero can equal 8, so watch out for that\n\n      if (envelopeCounter !== 0) {\n        var volume = Channel4.volume;\n\n        if (Channel4.NRx2EnvelopeAddMode && volume < 15) {\n          volume += 1;\n        } else if (!Channel4.NRx2EnvelopeAddMode && volume > 0) {\n          volume -= 1;\n        }\n\n        Channel4.volume = volume;\n      }\n    }\n\n    Channel4.envelopeCounter = envelopeCounter;\n  }; // Cycle Counter for our sound accumulator\n\n\n  Channel4.cycleCounter = 0; // Channel 4\n  // 'white noise' channel with volume envelope functions.\n  // NR41 -> Sound length (R/W)\n\n  Channel4.memoryLocationNRx1 = 0xff20; // --LL LLLL Length load (64-L)\n\n  Channel4.NRx1LengthLoad = 0; // NR42 -> Volume Envelope (R/W)\n\n  Channel4.memoryLocationNRx2 = 0xff21; // VVVV APPP Starting volume, Envelope add mode, period\n\n  Channel4.NRx2StartingVolume = 0;\n  Channel4.NRx2EnvelopeAddMode = false;\n  Channel4.NRx2EnvelopePeriod = 0; // NR43 -> Polynomial Counter (R/W)\n\n  Channel4.memoryLocationNRx3 = 0xff22; // SSSS WDDD Clock shift, Width mode of LFSR, Divisor code\n\n  Channel4.NRx3ClockShift = 0;\n  Channel4.NRx3WidthMode = false;\n  Channel4.NRx3DivisorCode = 0; // NR44 -> Trigger, Length Enable\n\n  Channel4.memoryLocationNRx4 = 0xff23; // TL-- ---- Trigger, Length enable\n\n  Channel4.NRx4LengthEnabled = false; // Channel Properties\n\n  Channel4.channelNumber = 4;\n  Channel4.isEnabled = false;\n  Channel4.isDacEnabled = false;\n  Channel4.frequencyTimer = 0x00;\n  Channel4.envelopeCounter = 0x00;\n  Channel4.lengthCounter = 0x00;\n  Channel4.volume = 0x00;\n  Channel4.divisor = 0; // Noise properties\n  // NOTE: Is only 15 bits\n\n  Channel4.linearFeedbackShiftRegister = 0x00; // Save States\n\n  Channel4.saveStateSlot = 10;\n  return Channel4;\n}(); // Another class simply for accumulating samples\n// Default everything to silence\n\n\nvar SoundAccumulator =\n/** @class */\nfunction () {\n  function SoundAccumulator() {}\n\n  SoundAccumulator.channel1Sample = 15;\n  SoundAccumulator.channel2Sample = 15;\n  SoundAccumulator.channel3Sample = 15;\n  SoundAccumulator.channel4Sample = 15;\n  SoundAccumulator.channel1DacEnabled = false;\n  SoundAccumulator.channel2DacEnabled = false;\n  SoundAccumulator.channel3DacEnabled = false;\n  SoundAccumulator.channel4DacEnabled = false;\n  SoundAccumulator.leftChannelSampleUnsignedByte = 127;\n  SoundAccumulator.rightChannelSampleUnsignedByte = 127;\n  SoundAccumulator.mixerVolumeChanged = false;\n  SoundAccumulator.mixerEnabledChanged = false; //If a channel was updated, need to also track if we need to need to mix them again\n\n  SoundAccumulator.needToRemixSamples = false;\n  return SoundAccumulator;\n}(); // Inlined because closure compiler inlines\n\n\nfunction initializeSoundAccumulator() {\n  SoundAccumulator.channel1Sample = 15;\n  SoundAccumulator.channel2Sample = 15;\n  SoundAccumulator.channel3Sample = 15;\n  SoundAccumulator.channel4Sample = 15;\n  SoundAccumulator.channel1DacEnabled = false;\n  SoundAccumulator.channel2DacEnabled = false;\n  SoundAccumulator.channel3DacEnabled = false;\n  SoundAccumulator.channel4DacEnabled = false;\n  SoundAccumulator.leftChannelSampleUnsignedByte = 127;\n  SoundAccumulator.rightChannelSampleUnsignedByte = 127;\n  SoundAccumulator.mixerVolumeChanged = true;\n  SoundAccumulator.mixerEnabledChanged = true;\n  SoundAccumulator.needToRemixSamples = false;\n} // Inlined because closure compiler inlines\n\n\nfunction accumulateSound(numberOfCycles) {\n  // Check if any of the individual channels will update\n  var channel1WillUpdate = Channel1.willChannelUpdate(numberOfCycles) || didChannelDacChange(Channel1.channelNumber);\n  var channel2WillUpdate = Channel2.willChannelUpdate(numberOfCycles) || didChannelDacChange(Channel2.channelNumber);\n  var channel3WillUpdate = Channel3.willChannelUpdate(numberOfCycles) || didChannelDacChange(Channel3.channelNumber);\n  var channel4WillUpdate = Channel4.willChannelUpdate(numberOfCycles) || didChannelDacChange(Channel4.channelNumber);\n\n  if (channel1WillUpdate) {\n    SoundAccumulator.channel1Sample = Channel1.getSampleFromCycleCounter();\n  }\n\n  if (channel2WillUpdate) {\n    SoundAccumulator.channel2Sample = Channel2.getSampleFromCycleCounter();\n  }\n\n  if (channel3WillUpdate) {\n    SoundAccumulator.channel3Sample = Channel3.getSampleFromCycleCounter();\n  }\n\n  if (channel4WillUpdate) {\n    SoundAccumulator.channel4Sample = Channel4.getSampleFromCycleCounter();\n  } // If any channel updated, we need to re-mix our samples\n\n\n  if (channel1WillUpdate || channel2WillUpdate || channel3WillUpdate || channel4WillUpdate) {\n    SoundAccumulator.needToRemixSamples = true;\n  } // Do Some downsampling magic\n\n\n  var downSampleCycleCounter = Sound.downSampleCycleCounter;\n  downSampleCycleCounter += numberOfCycles * Sound.downSampleCycleMultiplier;\n  var maxDownSampleCycles = Sound.maxDownSampleCycles();\n\n  if (downSampleCycleCounter >= maxDownSampleCycles) {\n    // Reset the downsample counter\n    // Don't set to zero to catch overflowed cycles\n    downSampleCycleCounter -= maxDownSampleCycles;\n    Sound.downSampleCycleCounter = downSampleCycleCounter;\n\n    if (SoundAccumulator.needToRemixSamples || SoundAccumulator.mixerVolumeChanged || SoundAccumulator.mixerEnabledChanged) {\n      mixChannelSamples(SoundAccumulator.channel1Sample, SoundAccumulator.channel2Sample, SoundAccumulator.channel3Sample, SoundAccumulator.channel4Sample);\n    } else {\n      Sound.downSampleCycleCounter = downSampleCycleCounter;\n    } // Finally Simply place the accumulated sample in memory\n    // Set our volumes in memory\n    // +1 so it can not be zero\n\n\n    setLeftAndRightOutputForAudioQueue(SoundAccumulator.leftChannelSampleUnsignedByte + 1, SoundAccumulator.rightChannelSampleUnsignedByte + 1, AUDIO_BUFFER_LOCATION);\n    var audioQueueIndex = Sound.audioQueueIndex + 1; // Don't allow our audioQueueIndex to overflow into other parts of the wasmBoy memory map\n    // https://docs.google.com/spreadsheets/d/17xrEzJk5-sCB9J2mMJcVnzhbE-XH_NvczVSQH9OHvRk/edit#gid=0\n    // Not 0xFFFF because we need half of 64kb since we store left and right channel\n\n    var maxIndex = i32Portable(Sound.wasmBoyMemoryMaxBufferSize >> 1) - 1;\n\n    if (audioQueueIndex >= maxIndex) {\n      audioQueueIndex -= 1;\n    }\n\n    Sound.audioQueueIndex = audioQueueIndex;\n  }\n} // Function used by SoundAccumulator to find out if a channel Dac Changed\n\n\nfunction didChannelDacChange(channelNumber) {\n  switch (channelNumber) {\n    case Channel1.channelNumber:\n      {\n        var isDacEnabled = Channel1.isDacEnabled;\n        var channel1Enabled = SoundAccumulator.channel1DacEnabled !== isDacEnabled;\n        SoundAccumulator.channel1DacEnabled = isDacEnabled;\n        return channel1Enabled;\n      }\n\n    case Channel2.channelNumber:\n      {\n        var isDacEnabled = Channel2.isDacEnabled;\n        var channel2Enabled = SoundAccumulator.channel2DacEnabled !== isDacEnabled;\n        SoundAccumulator.channel2DacEnabled = isDacEnabled;\n        return channel2Enabled;\n      }\n\n    case Channel3.channelNumber:\n      {\n        var isDacEnabled = Channel3.isDacEnabled;\n        var channel3Enabled = SoundAccumulator.channel3DacEnabled !== isDacEnabled;\n        SoundAccumulator.channel3DacEnabled = isDacEnabled;\n        return channel3Enabled;\n      }\n\n    case Channel4.channelNumber:\n      {\n        var isDacEnabled = Channel4.isDacEnabled;\n        var channel4Enabled = SoundAccumulator.channel4DacEnabled !== isDacEnabled;\n        SoundAccumulator.channel4DacEnabled = isDacEnabled;\n        return channel4Enabled;\n      }\n  }\n\n  return false;\n} // https://emu-docs.org/Game%20Boy/gb_sound.txt\n\n\nvar Sound =\n/** @class */\nfunction () {\n  function Sound() {} // Number of cycles to run in each batch process\n  // This number should be in sync so that sound doesn't run too many cyles at once\n  // and does not exceed the minimum number of cyles for either down sampling, or\n  // How often we change the frame, or a channel's update process\n\n\n  Sound.batchProcessCycles = function () {\n    // return Cpu.GBCDoubleSpeed ? 174 : 87;\n    return 87 << Cpu.GBCDoubleSpeed;\n  };\n\n  Sound.updateNR50 = function (value) {\n    Sound.NR50LeftMixerVolume = value >> 4 & 0x07;\n    Sound.NR50RightMixerVolume = value & 0x07;\n  };\n\n  Sound.updateNR51 = function (value) {\n    Sound.NR51IsChannel4EnabledOnLeftOutput = checkBitOnByte(7, value);\n    Sound.NR51IsChannel3EnabledOnLeftOutput = checkBitOnByte(6, value);\n    Sound.NR51IsChannel2EnabledOnLeftOutput = checkBitOnByte(5, value);\n    Sound.NR51IsChannel1EnabledOnLeftOutput = checkBitOnByte(4, value);\n    Sound.NR51IsChannel4EnabledOnRightOutput = checkBitOnByte(3, value);\n    Sound.NR51IsChannel3EnabledOnRightOutput = checkBitOnByte(2, value);\n    Sound.NR51IsChannel2EnabledOnRightOutput = checkBitOnByte(1, value);\n    Sound.NR51IsChannel1EnabledOnRightOutput = checkBitOnByte(0, value);\n  };\n\n  Sound.updateNR52 = function (value) {\n    Sound.NR52IsSoundEnabled = checkBitOnByte(7, value);\n  };\n\n  Sound.maxFrameSequenceCycles = function () {\n    // return Cpu.GBCDoubleSpeed ? 16384 : 8192;\n    return 8192 << Cpu.GBCDoubleSpeed;\n  };\n\n  Sound.maxDownSampleCycles = function () {\n    return Cpu.CLOCK_SPEED();\n  }; // Function to save the state of the class\n\n\n  Sound.saveState = function () {\n    store(getSaveStateMemoryOffset(0x00, Sound.saveStateSlot), Sound.frameSequenceCycleCounter);\n    store(getSaveStateMemoryOffset(0x04, Sound.saveStateSlot), Sound.downSampleCycleCounter);\n    store(getSaveStateMemoryOffset(0x05, Sound.saveStateSlot), Sound.frameSequencer);\n  }; // Function to load the save state from memory\n\n\n  Sound.loadState = function () {\n    Sound.frameSequenceCycleCounter = load(getSaveStateMemoryOffset(0x00, Sound.saveStateSlot));\n    Sound.downSampleCycleCounter = load(getSaveStateMemoryOffset(0x04, Sound.saveStateSlot));\n    Sound.frameSequencer = load(getSaveStateMemoryOffset(0x05, Sound.saveStateSlot));\n    clearAudioBuffer();\n  }; // Current cycles\n  // This will be used for batch processing\n  // https://github.com/binji/binjgb/commit/e028f45e805bc0b0aa4697224a209f9ae514c954\n  // TODO: May Also need to do this for Reads\n\n\n  Sound.currentCycles = 0; // Channel control / On-OFF / Volume (RW)\n\n  Sound.memoryLocationNR50 = 0xff24;\n  Sound.NR50LeftMixerVolume = 0;\n  Sound.NR50RightMixerVolume = 0; // 0xFF25 selects which output each channel goes to, Referred to as NR51\n\n  Sound.memoryLocationNR51 = 0xff25;\n  Sound.NR51IsChannel1EnabledOnLeftOutput = true;\n  Sound.NR51IsChannel2EnabledOnLeftOutput = true;\n  Sound.NR51IsChannel3EnabledOnLeftOutput = true;\n  Sound.NR51IsChannel4EnabledOnLeftOutput = true;\n  Sound.NR51IsChannel1EnabledOnRightOutput = true;\n  Sound.NR51IsChannel2EnabledOnRightOutput = true;\n  Sound.NR51IsChannel3EnabledOnRightOutput = true;\n  Sound.NR51IsChannel4EnabledOnRightOutput = true; // Sound on/off\n\n  Sound.memoryLocationNR52 = 0xff26;\n  Sound.NR52IsSoundEnabled = true; // $FF30 -- $FF3F is the load register space for the 4-bit samples for channel 3\n\n  Sound.memoryLocationChannel3LoadRegisterStart = 0xff30; // Need to count how often we need to increment our frame sequencer\n  // Which you can read about below\n\n  Sound.frameSequenceCycleCounter = 0x0000; // Also need to downsample our audio to average audio qualty\n  // https://www.reddit.com/r/EmuDev/comments/5gkwi5/gb_apu_sound_emulation/\n  // Want to do 48000hz, so CpuRate / Sound Rate, 4194304 / 48000 ~ 87 cycles\n\n  Sound.downSampleCycleCounter = 0x00;\n  Sound.downSampleCycleMultiplier = 48000; // Frame sequencer controls what should be updated and and ticked\n  // Every time the sound is updated :) It is updated everytime the\n  // Cycle counter reaches the max cycle\n\n  Sound.frameSequencer = 0x00; // Our current sample number we are passing back to the wasmboy memory map\n  // Found that a static number of samples doesn't work well on mobile\n  // Will just update the queue index, grab as much as we can whenever we need more audio, then reset\n  // NOTE: Giving a really large sample rate gives more latency, but less pops!\n  //static readonly MAX_NUMBER_OF_SAMPLES: i32 = 4096;\n\n  Sound.audioQueueIndex = 0x0000;\n  Sound.wasmBoyMemoryMaxBufferSize = 0x20000; // Save States\n\n  Sound.saveStateSlot = 6;\n  return Sound;\n}(); // Initialize sound registers\n// From: https://emu-docs.org/Game%20Boy/gb_sound.txt\n// Inlined because closure compiler inlines\n\n\nfunction initializeSound() {\n  // Reset Stateful variables\n  Sound.currentCycles = 0;\n  Sound.NR50LeftMixerVolume = 0;\n  Sound.NR50RightMixerVolume = 0;\n  Sound.NR51IsChannel1EnabledOnLeftOutput = true;\n  Sound.NR51IsChannel2EnabledOnLeftOutput = true;\n  Sound.NR51IsChannel3EnabledOnLeftOutput = true;\n  Sound.NR51IsChannel4EnabledOnLeftOutput = true;\n  Sound.NR51IsChannel1EnabledOnRightOutput = true;\n  Sound.NR51IsChannel2EnabledOnRightOutput = true;\n  Sound.NR51IsChannel3EnabledOnRightOutput = true;\n  Sound.NR51IsChannel4EnabledOnRightOutput = true;\n  Sound.NR52IsSoundEnabled = true;\n  Sound.frameSequenceCycleCounter = 0x0000;\n  Sound.downSampleCycleCounter = 0x00;\n  Sound.frameSequencer = 0x00;\n  Sound.audioQueueIndex = 0x0000; // intiialize our channels\n\n  Channel1.initialize();\n  Channel2.initialize();\n  Channel3.initialize();\n  Channel4.initialize(); // Other Sound Registers\n\n  eightBitStoreIntoGBMemory(Sound.memoryLocationNR50, 0x77);\n  eightBitStoreIntoGBMemory(Sound.memoryLocationNR51, 0xf3);\n  eightBitStoreIntoGBMemory(Sound.memoryLocationNR52, 0xf1);\n  initializeSoundAccumulator();\n} // Function to batch process our audio after we skipped so many cycles\n\n\nfunction batchProcessAudio() {\n  var batchProcessCycles = Sound.batchProcessCycles();\n\n  while (Sound.currentCycles >= batchProcessCycles) {\n    updateSound(batchProcessCycles);\n    Sound.currentCycles -= batchProcessCycles;\n  }\n} // Function for updating sound\n\n\nfunction updateSound(numberOfCycles) {\n  // Check if our frameSequencer updated\n  var frameSequencerUpdated = updateFrameSequencer(numberOfCycles);\n\n  if (Config.audioAccumulateSamples && !frameSequencerUpdated) {\n    accumulateSound(numberOfCycles);\n  } else {\n    calculateSound(numberOfCycles);\n  }\n} // Funciton to get the current Audio Queue index\n\n\nfunction getNumberOfSamplesInAudioBuffer() {\n  return Sound.audioQueueIndex;\n} // Function to reset the audio queue\n\n\nfunction clearAudioBuffer() {\n  Sound.audioQueueIndex = 0;\n} // Inlined because closure compiler inlines\n\n\nfunction calculateSound(numberOfCycles) {\n  // Update all of our channels\n  // All samples will be returned as 0 to 30\n  // 0 being -1.0, and 30 being 1.0\n  // (see blurb at top)\n  var channel1Sample = i32Portable(Channel1.getSample(numberOfCycles));\n  var channel2Sample = i32Portable(Channel2.getSample(numberOfCycles));\n  var channel3Sample = i32Portable(Channel3.getSample(numberOfCycles));\n  var channel4Sample = i32Portable(Channel4.getSample(numberOfCycles)); // TODO: Allow individual channels to be muted\n  // let channel1Sample: i32 = 15;\n  // let channel2Sample: i32 = 15;\n  // let channel3Sample: i32 = 15;\n  // let channel4Sample: i32 = 15;\n  // Save the samples in the accumulator\n\n  SoundAccumulator.channel1Sample = channel1Sample;\n  SoundAccumulator.channel2Sample = channel2Sample;\n  SoundAccumulator.channel3Sample = channel3Sample;\n  SoundAccumulator.channel4Sample = channel4Sample; // Do Some downsampling magic\n\n  var downSampleCycleCounter = Sound.downSampleCycleCounter + numberOfCycles * Sound.downSampleCycleMultiplier;\n\n  if (downSampleCycleCounter >= Sound.maxDownSampleCycles()) {\n    // Reset the downsample counter\n    // Don't set to zero to catch overflowed cycles\n    downSampleCycleCounter -= Sound.maxDownSampleCycles();\n    Sound.downSampleCycleCounter = downSampleCycleCounter; // Mix our samples\n\n    var mixedSample = mixChannelSamples(channel1Sample, channel2Sample, channel3Sample, channel4Sample);\n    var leftChannelSampleUnsignedByte = splitHighByte(mixedSample);\n    var rightChannelSampleUnsignedByte = splitLowByte(mixedSample); // Set our volumes in memory\n    // +1 so it can not be zero\n\n    setLeftAndRightOutputForAudioQueue(leftChannelSampleUnsignedByte + 1, rightChannelSampleUnsignedByte + 1, AUDIO_BUFFER_LOCATION);\n\n    if (Config.enableAudioDebugging) {\n      // Channel 1\n      mixedSample = mixChannelSamples(channel1Sample, 15, 15, 15);\n      leftChannelSampleUnsignedByte = splitHighByte(mixedSample);\n      rightChannelSampleUnsignedByte = splitLowByte(mixedSample);\n      setLeftAndRightOutputForAudioQueue(leftChannelSampleUnsignedByte + 1, rightChannelSampleUnsignedByte + 1, CHANNEL_1_BUFFER_LOCATION); // Channel 2\n\n      mixedSample = mixChannelSamples(15, channel2Sample, 15, 15);\n      leftChannelSampleUnsignedByte = splitHighByte(mixedSample);\n      rightChannelSampleUnsignedByte = splitLowByte(mixedSample);\n      setLeftAndRightOutputForAudioQueue(leftChannelSampleUnsignedByte + 1, rightChannelSampleUnsignedByte + 1, CHANNEL_2_BUFFER_LOCATION); // Channel 3\n\n      mixedSample = mixChannelSamples(15, 15, channel3Sample, 15);\n      leftChannelSampleUnsignedByte = splitHighByte(mixedSample);\n      rightChannelSampleUnsignedByte = splitLowByte(mixedSample);\n      setLeftAndRightOutputForAudioQueue(leftChannelSampleUnsignedByte + 1, rightChannelSampleUnsignedByte + 1, CHANNEL_3_BUFFER_LOCATION); // Channel 4\n\n      mixedSample = mixChannelSamples(15, 15, 15, channel4Sample);\n      leftChannelSampleUnsignedByte = splitHighByte(mixedSample);\n      rightChannelSampleUnsignedByte = splitLowByte(mixedSample);\n      setLeftAndRightOutputForAudioQueue(leftChannelSampleUnsignedByte + 1, rightChannelSampleUnsignedByte + 1, CHANNEL_4_BUFFER_LOCATION);\n    }\n\n    var audioQueueIndex = Sound.audioQueueIndex + 1; // Don't allow our audioQueueIndex to overflow into other parts of the wasmBoy memory map\n    // https://docs.google.com/spreadsheets/d/17xrEzJk5-sCB9J2mMJcVnzhbE-XH_NvczVSQH9OHvRk/edit#gid=0\n    // Not 0xFFFF because we need half of 64kb since we store left and right channel\n\n    var maxIndex = i32Portable(Sound.wasmBoyMemoryMaxBufferSize >> 1) - 1;\n\n    if (audioQueueIndex >= maxIndex) {\n      audioQueueIndex -= 1;\n    }\n\n    Sound.audioQueueIndex = audioQueueIndex;\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction updateFrameSequencer(numberOfCycles) {\n  // APU runs at 4194304 / 512\n  // Or Cpu.clockSpeed / 512\n  // Which means, we need to update once every 8192 cycles :)\n  var maxFrameSequenceCycles = Sound.maxFrameSequenceCycles();\n  var frameSequenceCycleCounter = Sound.frameSequenceCycleCounter + numberOfCycles;\n\n  if (frameSequenceCycleCounter >= maxFrameSequenceCycles) {\n    // Reset the frameSequenceCycleCounter\n    // Not setting to zero as we do not want to drop cycles\n    frameSequenceCycleCounter -= maxFrameSequenceCycles;\n    Sound.frameSequenceCycleCounter = frameSequenceCycleCounter; // Check our frame sequencer\n    // https://gist.github.com/drhelius/3652407\n\n    var frameSequencer = Sound.frameSequencer;\n\n    switch (frameSequencer) {\n      case 0:\n        // Update Length on Channels\n        Channel1.updateLength();\n        Channel2.updateLength();\n        Channel3.updateLength();\n        Channel4.updateLength();\n        break;\n\n      /* Do Nothing on one */\n\n      case 2:\n        // Update Sweep and Length on Channels\n        Channel1.updateLength();\n        Channel2.updateLength();\n        Channel3.updateLength();\n        Channel4.updateLength();\n        Channel1.updateSweep();\n        break;\n\n      /* Do Nothing on three */\n\n      case 4:\n        // Update Length on Channels\n        Channel1.updateLength();\n        Channel2.updateLength();\n        Channel3.updateLength();\n        Channel4.updateLength();\n        break;\n\n      /* Do Nothing on five */\n\n      case 6:\n        // Update Sweep and Length on Channels\n        Channel1.updateLength();\n        Channel2.updateLength();\n        Channel3.updateLength();\n        Channel4.updateLength();\n        Channel1.updateSweep();\n        break;\n\n      case 7:\n        // Update Envelope on channels\n        Channel1.updateEnvelope();\n        Channel2.updateEnvelope();\n        Channel4.updateEnvelope();\n        break;\n    } // Update our frame sequencer\n\n\n    Sound.frameSequencer = frameSequencer + 1 & 7;\n    return true;\n  } else {\n    Sound.frameSequenceCycleCounter = frameSequenceCycleCounter;\n  }\n\n  return false;\n}\n\nfunction mixChannelSamples(channel1Sample, channel2Sample, channel3Sample, channel4Sample) {\n  // Do Some Cool mixing\n  // NR50 FF24 ALLL BRRR Vin L enable, Left vol, Vin R enable, Right vol\n  // NR51 FF25 NW21 NW21 Left enables, Right enables\n  // NR52 FF26 P--- NW21 Power control/status, Channel length statuses\n  // NW21 = 4 bits on byte\n  // 3 -> Channel 4, 2 -> Channel 3, 1 -> Channel 2, 0 -> Channel 1\n  if (channel1Sample === void 0) {\n    channel1Sample = 15;\n  }\n\n  if (channel2Sample === void 0) {\n    channel2Sample = 15;\n  }\n\n  if (channel3Sample === void 0) {\n    channel3Sample = 15;\n  }\n\n  if (channel4Sample === void 0) {\n    channel4Sample = 15;\n  } // Matt's Proccess\n  // I push out 1024 samples at a time and use 96000 hz sampling rate, so I guess i'm a bit less than one frame,\n  // but I let the queue fill up with 4 x 1024 samples before I start waiting for the audio\n  // TODO: Vin Mixing\n\n\n  SoundAccumulator.mixerVolumeChanged = false; // Get our channel volume for left/right\n\n  var leftChannelSample = 0;\n  var rightChannelSample = 0; // Find the sample for the left if enabled\n  // other wise add silence (15) for the channel\n\n  leftChannelSample += Sound.NR51IsChannel1EnabledOnLeftOutput ? channel1Sample : 15;\n  leftChannelSample += Sound.NR51IsChannel2EnabledOnLeftOutput ? channel2Sample : 15;\n  leftChannelSample += Sound.NR51IsChannel3EnabledOnLeftOutput ? channel3Sample : 15;\n  leftChannelSample += Sound.NR51IsChannel4EnabledOnLeftOutput ? channel4Sample : 15; // Find the sample for the right if enabled\n  // other wise add silence (15) for the channel\n\n  rightChannelSample += Sound.NR51IsChannel1EnabledOnRightOutput ? channel1Sample : 15;\n  rightChannelSample += Sound.NR51IsChannel2EnabledOnRightOutput ? channel2Sample : 15;\n  rightChannelSample += Sound.NR51IsChannel3EnabledOnRightOutput ? channel3Sample : 15;\n  rightChannelSample += Sound.NR51IsChannel4EnabledOnRightOutput ? channel4Sample : 15; // Update our accumulator\n\n  SoundAccumulator.mixerEnabledChanged = false;\n  SoundAccumulator.needToRemixSamples = false; // Finally multiply our volumes by the mixer volume\n  // Mixer volume can be at most 7 + 1\n  // Can be at most 7, because we only have 3 bits, 111 = 7\n  // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Mixer\n  // Done in the getSampleAsUnsignedByte(), since we are doing some weirdness there :)\n  // Convert our samples from unsigned 32 to unsigned byte\n  // Reason being, We want to be able to pass in wasm memory as usigned byte. Javascript will handle the conversion back\n\n  var leftChannelSampleUnsignedByte = getSampleAsUnsignedByte(leftChannelSample, Sound.NR50LeftMixerVolume + 1);\n  var rightChannelSampleUnsignedByte = getSampleAsUnsignedByte(rightChannelSample, Sound.NR50RightMixerVolume + 1); // Save these samples in the accumulator\n\n  SoundAccumulator.leftChannelSampleUnsignedByte = leftChannelSampleUnsignedByte;\n  SoundAccumulator.rightChannelSampleUnsignedByte = rightChannelSampleUnsignedByte;\n  return concatenateBytes(leftChannelSampleUnsignedByte, rightChannelSampleUnsignedByte);\n}\n\nfunction getSampleAsUnsignedByte(sample, mixerVolume) {\n  // If the sample is silence, return silence as unsigned byte\n  // Silence is common, and should be checked for performance\n  if (sample === 60) {\n    return 127;\n  } // convert to a signed, precise scale of -6000 to 6000 (cheap way of -1.0 to 1.0)\n  // Multiply by the mixer volume fraction (to find the actual volume)\n\n\n  var precision = 100000;\n  var convertedSample = sample - 60;\n  convertedSample = convertedSample * precision; // Multiply by the mixer volume fraction (to find the actual volume)\n\n  convertedSample = convertedSample * mixerVolume >> 3; // Convert back to scale of 0 to 120\n\n  convertedSample = i32Portable(convertedSample / precision) + 60; // Finally, convert to an unsigned byte scale\n  // With Four Channels (0 to 30) and no global volume. Max is 120\n  // max unsigned byte goal is 254 (see blurb at top).\n  // 120 / 254 should give the correct conversion\n  // For example, 120 / 254 = 0.47244094488188976\n  // Multiply by 1000 to increase the float into an int\n  // so, 120 * 1000 / (0.47244094488188976 * 1000) should give approximate answer for max mixer volume\n\n  var maxDivider = i32Portable(120 * precision / 254);\n  convertedSample = i32Portable(convertedSample * precision / maxDivider); // Ensure we have an i32 and not a float for JS builds\n\n  convertedSample = i32Portable(convertedSample);\n  return convertedSample;\n} // Function to set our left and right channels at the correct queue index\n\n\nfunction setLeftAndRightOutputForAudioQueue(leftVolume, rightVolume, bufferLocation) {\n  // Get our stereo index\n  var audioQueueOffset = bufferLocation + (Sound.audioQueueIndex << 1); // Store our volumes\n  // +1 that way we don't have empty data to ensure that the value is set\n\n  store(audioQueueOffset + 0, leftVolume + 1);\n  store(audioQueueOffset + 1, rightVolume + 1);\n} // Functions involved in R/W of sound registers\n// Function to check and handle writes to sound registers\n// Inlined because closure compiler inlines\n\n\nfunction SoundRegisterWriteTraps(offset, value) {\n  if (offset !== Sound.memoryLocationNR52 && !Sound.NR52IsSoundEnabled) {\n    // Block all writes to any sound register EXCEPT NR52!\n    // This is under the assumption that the check for\n    // offset >= 0xFF10 && offset <= 0xFF26\n    // is done in writeTraps.ts (which it is)\n    // NOTE: Except on DMG, length can still be written (whatever that means)\n    return false;\n  }\n\n  switch (offset) {\n    // Handle NRx0 on Channels\n    case Channel1.memoryLocationNRx0:\n      Channel1.updateNRx0(value);\n      return true;\n\n    case Channel3.memoryLocationNRx0:\n      Channel3.updateNRx0(value);\n      return true;\n    // Handle NRx1 (Length Counter) on Channels\n\n    case Channel1.memoryLocationNRx1:\n      Channel1.updateNRx1(value);\n      return true;\n\n    case Channel2.memoryLocationNRx1:\n      Channel2.updateNRx1(value);\n      return true;\n\n    case Channel3.memoryLocationNRx1:\n      Channel3.updateNRx1(value);\n      return true;\n\n    case Channel4.memoryLocationNRx1:\n      Channel4.updateNRx1(value);\n      return true;\n    // Handle NRx2 (Envelope / Volume) on Channels\n\n    case Channel1.memoryLocationNRx2:\n      Channel1.updateNRx2(value);\n      return true;\n\n    case Channel2.memoryLocationNRx2:\n      Channel2.updateNRx2(value);\n      return true;\n\n    case Channel3.memoryLocationNRx2:\n      // Check if channel 3's volume code was written too\n      // This is handcy to know for accumulation of samples\n      Channel3.volumeCodeChanged = true;\n      Channel3.updateNRx2(value);\n      return true;\n\n    case Channel4.memoryLocationNRx2:\n      Channel4.updateNRx2(value);\n      return true;\n    // Handle NRx3 (Frequency / Noise Properties) on Channels\n\n    case Channel1.memoryLocationNRx3:\n      Channel1.updateNRx3(value);\n      return true;\n\n    case Channel2.memoryLocationNRx3:\n      Channel2.updateNRx3(value);\n      return true;\n\n    case Channel3.memoryLocationNRx3:\n      Channel3.updateNRx3(value);\n      return true;\n\n    case Channel4.memoryLocationNRx3:\n      Channel4.updateNRx3(value);\n      return true;\n    // Check our NRx4 registers to trap our trigger bits\n\n    case Channel1.memoryLocationNRx4:\n      if (checkBitOnByte(7, value)) {\n        Channel1.updateNRx4(value);\n        Channel1.trigger();\n      }\n\n      return true;\n\n    case Channel2.memoryLocationNRx4:\n      if (checkBitOnByte(7, value)) {\n        Channel2.updateNRx4(value);\n        Channel2.trigger();\n      }\n\n      return true;\n\n    case Channel3.memoryLocationNRx4:\n      if (checkBitOnByte(7, value)) {\n        Channel3.updateNRx4(value);\n        Channel3.trigger();\n      }\n\n      return true;\n\n    case Channel4.memoryLocationNRx4:\n      if (checkBitOnByte(7, value)) {\n        Channel4.updateNRx4(value);\n        Channel4.trigger();\n      }\n\n      return true;\n    // Tell the sound accumulator if volumes changes\n\n    case Sound.memoryLocationNR50:\n      Sound.updateNR50(value);\n      SoundAccumulator.mixerVolumeChanged = true;\n      return true;\n    // Tell the sound accumulator if volumes changes\n\n    case Sound.memoryLocationNR51:\n      Sound.updateNR51(value);\n      SoundAccumulator.mixerEnabledChanged = true;\n      return true;\n\n    case Sound.memoryLocationNR52:\n      // Reset all registers except NR52\n      Sound.updateNR52(value);\n\n      if (!checkBitOnByte(7, value)) {\n        for (var i = 0xff10; i < 0xff26; ++i) {\n          eightBitStoreIntoGBMemory(i, 0x00);\n        }\n      }\n\n      return true;\n  } // We did not handle the write, Allow the write\n\n\n  return true;\n} // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Registers\n// Inlined because closure compiler inlines\n\n\nfunction SoundRegisterReadTraps(offset) {\n  // TODO: OR All Registers\n  // This will fix bugs in orcale of ages :)\n  if (offset === Sound.memoryLocationNR52) {\n    // Get our registerNR52\n    var registerNR52 = eightBitLoadFromGBMemory(Sound.memoryLocationNR52); // Knock off lower 7 bits\n\n    registerNR52 &= 0x80; // Or from the table\n\n    registerNR52 |= 0x70;\n    return registerNR52;\n  }\n\n  return -1;\n}\n\nvar Interrupts =\n/** @class */\nfunction () {\n  function Interrupts() {}\n\n  Interrupts.updateInterruptEnabled = function (value) {\n    Interrupts.isVBlankInterruptEnabled = checkBitOnByte(Interrupts.bitPositionVBlankInterrupt, value);\n    Interrupts.isLcdInterruptEnabled = checkBitOnByte(Interrupts.bitPositionLcdInterrupt, value);\n    Interrupts.isTimerInterruptEnabled = checkBitOnByte(Interrupts.bitPositionTimerInterrupt, value);\n    Interrupts.isSerialInterruptEnabled = checkBitOnByte(Interrupts.bitPositionSerialInterrupt, value);\n    Interrupts.isJoypadInterruptEnabled = checkBitOnByte(Interrupts.bitPositionJoypadInterrupt, value);\n    Interrupts.interruptsEnabledValue = value;\n  };\n\n  Interrupts.updateInterruptRequested = function (value) {\n    Interrupts.isVBlankInterruptRequested = checkBitOnByte(Interrupts.bitPositionVBlankInterrupt, value);\n    Interrupts.isLcdInterruptRequested = checkBitOnByte(Interrupts.bitPositionLcdInterrupt, value);\n    Interrupts.isTimerInterruptRequested = checkBitOnByte(Interrupts.bitPositionTimerInterrupt, value);\n    Interrupts.isSerialInterruptRequested = checkBitOnByte(Interrupts.bitPositionSerialInterrupt, value);\n    Interrupts.isJoypadInterruptRequested = checkBitOnByte(Interrupts.bitPositionJoypadInterrupt, value);\n    Interrupts.interruptsRequestedValue = value;\n  }; // Function to return if we have any pending interrupts\n\n\n  Interrupts.areInterruptsPending = function () {\n    return (Interrupts.interruptsRequestedValue & Interrupts.interruptsEnabledValue & 0x1f) > 0;\n  }; // Function to save the state of the class\n\n\n  Interrupts.saveState = function () {\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x00, Interrupts.saveStateSlot), Interrupts.masterInterruptSwitch);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x01, Interrupts.saveStateSlot), Interrupts.masterInterruptSwitchDelay); // Interrupts enabled and requested are stored in actual GB memory, thus, don't need to be saved\n  }; // Function to load the save state from memory\n\n\n  Interrupts.loadState = function () {\n    Interrupts.masterInterruptSwitch = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x00, Interrupts.saveStateSlot));\n    Interrupts.masterInterruptSwitchDelay = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x01, Interrupts.saveStateSlot));\n    Interrupts.updateInterruptEnabled(eightBitLoadFromGBMemory(Interrupts.memoryLocationInterruptEnabled));\n    Interrupts.updateInterruptRequested(eightBitLoadFromGBMemory(Interrupts.memoryLocationInterruptRequest));\n  };\n\n  Interrupts.masterInterruptSwitch = false; // According to mooneye, interrupts are not handled until AFTER\n  // Next instruction\n  // https://github.com/Gekkio/mooneye-gb/blob/master/docs/accuracy.markdown\n\n  Interrupts.masterInterruptSwitchDelay = false; // Biut position for each part of the interrupts HW registers\n\n  Interrupts.bitPositionVBlankInterrupt = 0;\n  Interrupts.bitPositionLcdInterrupt = 1;\n  Interrupts.bitPositionTimerInterrupt = 2;\n  Interrupts.bitPositionSerialInterrupt = 3;\n  Interrupts.bitPositionJoypadInterrupt = 4;\n  Interrupts.memoryLocationInterruptEnabled = 0xffff; // A.K.A interrupt Flag (IE)\n  // Cache which Interrupts are enabled\n\n  Interrupts.interruptsEnabledValue = 0;\n  Interrupts.isVBlankInterruptEnabled = false;\n  Interrupts.isLcdInterruptEnabled = false;\n  Interrupts.isTimerInterruptEnabled = false;\n  Interrupts.isSerialInterruptEnabled = false;\n  Interrupts.isJoypadInterruptEnabled = false;\n  Interrupts.memoryLocationInterruptRequest = 0xff0f; // A.K.A interrupt Flag (IF)\n  // Cache which Interrupts are requested\n\n  Interrupts.interruptsRequestedValue = 0;\n  Interrupts.isVBlankInterruptRequested = false;\n  Interrupts.isLcdInterruptRequested = false;\n  Interrupts.isTimerInterruptRequested = false;\n  Interrupts.isSerialInterruptRequested = false;\n  Interrupts.isJoypadInterruptRequested = false; // Save States\n\n  Interrupts.saveStateSlot = 2;\n  return Interrupts;\n}(); // Inlined because closure compiler inlines\n\n\nfunction initializeInterrupts() {\n  // Values from BGB\n  // IE\n  Interrupts.updateInterruptEnabled(0x00);\n  eightBitStoreIntoGBMemory(Interrupts.memoryLocationInterruptEnabled, Interrupts.interruptsEnabledValue); // IF\n\n  Interrupts.updateInterruptRequested(0xe1);\n  eightBitStoreIntoGBMemory(Interrupts.memoryLocationInterruptRequest, Interrupts.interruptsRequestedValue);\n} // NOTE: Interrupts should be handled before reading an opcode\n// Inlined because closure compiler inlines\n\n\nfunction checkInterrupts() {\n  // First check for our delay was enabled\n  if (Interrupts.masterInterruptSwitchDelay) {\n    Interrupts.masterInterruptSwitch = true;\n    Interrupts.masterInterruptSwitchDelay = false;\n  } // Check if we have an enabled and requested interrupt\n\n\n  var isAnInterruptRequestedAndEnabledValue = Interrupts.interruptsEnabledValue & Interrupts.interruptsRequestedValue & 0x1f;\n\n  if (isAnInterruptRequestedAndEnabledValue > 0) {\n    // Boolean to track if interrupts were handled\n    // Interrupt handling requires 20 cycles\n    // https://github.com/Gekkio/mooneye-gb/blob/master/docs/accuracy.markdown#what-is-the-exact-timing-of-cpu-servicing-an-interrupt\n    var wasInterruptHandled = false; // Service our interrupts, if we have the master switch enabled\n    // https://www.reddit.com/r/EmuDev/comments/5ie3k7/infinite_loop_trying_to_pass_blarggs_interrupt/\n\n    if (Interrupts.masterInterruptSwitch && !Cpu.isHaltNoJump) {\n      if (Interrupts.isVBlankInterruptEnabled && Interrupts.isVBlankInterruptRequested) {\n        _handleInterrupt(Interrupts.bitPositionVBlankInterrupt);\n\n        wasInterruptHandled = true;\n      } else if (Interrupts.isLcdInterruptEnabled && Interrupts.isLcdInterruptRequested) {\n        _handleInterrupt(Interrupts.bitPositionLcdInterrupt);\n\n        wasInterruptHandled = true;\n      } else if (Interrupts.isTimerInterruptEnabled && Interrupts.isTimerInterruptRequested) {\n        _handleInterrupt(Interrupts.bitPositionTimerInterrupt);\n\n        wasInterruptHandled = true;\n      } else if (Interrupts.isSerialInterruptEnabled && Interrupts.isSerialInterruptRequested) {\n        _handleInterrupt(Interrupts.bitPositionSerialInterrupt);\n\n        wasInterruptHandled = true;\n      } else if (Interrupts.isJoypadInterruptEnabled && Interrupts.isJoypadInterruptRequested) {\n        _handleInterrupt(Interrupts.bitPositionJoypadInterrupt);\n\n        wasInterruptHandled = true;\n      }\n    }\n\n    var interuptHandlerCycles = 0;\n\n    if (wasInterruptHandled) {\n      // Interrupt handling requires 20 cycles, TCAGBD\n      interuptHandlerCycles = 20;\n\n      if (Cpu.isHalted()) {\n        // If the CPU was halted, now is the time to un-halt\n        // Should be done here when the jump occurs according to:\n        // https://www.reddit.com/r/EmuDev/comments/6fmjch/gb_glitches_in_links_awakening_and_pok%C3%A9mon_gold/\n        Cpu.exitHaltAndStop();\n        interuptHandlerCycles += 4;\n      }\n    }\n\n    if (Cpu.isHalted()) {\n      Cpu.exitHaltAndStop();\n    }\n\n    return interuptHandlerCycles;\n  }\n\n  return 0;\n}\n\nfunction _handleInterrupt(bitPosition) {\n  // Disable the master switch\n  setInterrupts(false); // Disable the bit on the interruptRequest\n\n  var interruptRequest = eightBitLoadFromGBMemory(Interrupts.memoryLocationInterruptRequest);\n  interruptRequest = resetBitOnByte(bitPosition, interruptRequest);\n  Interrupts.interruptsRequestedValue = interruptRequest;\n  eightBitStoreIntoGBMemory(Interrupts.memoryLocationInterruptRequest, interruptRequest); // Push the programCounter onto the stacks\n  // Push the next instruction, not the halt itself (TCAGBD).\n\n  Cpu.stackPointer = Cpu.stackPointer - 2;\n\n  if (Cpu.isHalted()) {\n    // TODO: This breaks Pokemon Yellow, And OG Link's awakening. Find out why...\n    // sixteenBitStoreIntoGBMemory(Cpu.stackPointer, Cpu.programCounter + 1);\n    sixteenBitStoreIntoGBMemory(Cpu.stackPointer, Cpu.programCounter);\n  } else {\n    sixteenBitStoreIntoGBMemory(Cpu.stackPointer, Cpu.programCounter);\n  } // Jump to the correct interrupt location\n  // Also piggyback off of the switch to reset our HW Register caching\n  // http://www.codeslinger.co.uk/pages/projects/gameboy/interupts.html\n\n\n  switch (bitPosition) {\n    case Interrupts.bitPositionVBlankInterrupt:\n      Interrupts.isVBlankInterruptRequested = false;\n      Cpu.programCounter = 0x40;\n      break;\n\n    case Interrupts.bitPositionLcdInterrupt:\n      Interrupts.isLcdInterruptRequested = false;\n      Cpu.programCounter = 0x48;\n      break;\n\n    case Interrupts.bitPositionTimerInterrupt:\n      Interrupts.isTimerInterruptRequested = false;\n      Cpu.programCounter = 0x50;\n      break;\n\n    case Interrupts.bitPositionSerialInterrupt:\n      Interrupts.isSerialInterruptRequested = false;\n      Cpu.programCounter = 0x58;\n      break;\n\n    case Interrupts.bitPositionJoypadInterrupt:\n      Interrupts.isJoypadInterruptRequested = false;\n      Cpu.programCounter = 0x60;\n      break;\n  }\n}\n\nfunction _requestInterrupt(bitPosition) {\n  var interruptRequest = eightBitLoadFromGBMemory(Interrupts.memoryLocationInterruptRequest); // Pass to set the correct interrupt bit on interruptRequest\n\n  interruptRequest = setBitOnByte(bitPosition, interruptRequest);\n  Interrupts.interruptsRequestedValue = interruptRequest;\n  eightBitStoreIntoGBMemory(Interrupts.memoryLocationInterruptRequest, interruptRequest);\n}\n\nfunction setInterrupts(value) {\n  // If we are enabling interrupts,\n  // we want to wait 4 cycles before enabling\n  if (value) {\n    Interrupts.masterInterruptSwitchDelay = true;\n  } else {\n    Interrupts.masterInterruptSwitch = false;\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction requestVBlankInterrupt() {\n  Interrupts.isVBlankInterruptRequested = true;\n\n  _requestInterrupt(Interrupts.bitPositionVBlankInterrupt);\n} // Inlined because closure compiler inlines\n\n\nfunction requestLcdInterrupt() {\n  Interrupts.isLcdInterruptRequested = true;\n\n  _requestInterrupt(Interrupts.bitPositionLcdInterrupt);\n} // Inlined because closure compiler inlines\n\n\nfunction requestTimerInterrupt() {\n  Interrupts.isTimerInterruptRequested = true;\n\n  _requestInterrupt(Interrupts.bitPositionTimerInterrupt);\n} // Inlined because closure compiler inlines\n\n\nfunction requestJoypadInterrupt() {\n  Interrupts.isJoypadInterruptRequested = true;\n\n  _requestInterrupt(Interrupts.bitPositionJoypadInterrupt);\n} // Inlined because closure compiler inlines\n\n\nfunction requestSerialInterrupt() {\n  Interrupts.isSerialInterruptRequested = true;\n\n  _requestInterrupt(Interrupts.bitPositionSerialInterrupt);\n}\n\nvar Timers =\n/** @class */\nfunction () {\n  function Timers() {} // Number of cycles to run in each batch process\n\n\n  Timers.batchProcessCycles = function () {\n    return 256;\n  };\n\n  Timers.updateDividerRegister = function () {\n    var oldDividerRegister = Timers.dividerRegister;\n    Timers.dividerRegister = 0;\n    eightBitStoreIntoGBMemory(Timers.memoryLocationDividerRegister, 0);\n\n    if (Timers.timerEnabled && _checkDividerRegisterFallingEdgeDetector(oldDividerRegister, 0)) {\n      _incrementTimerCounter();\n    }\n  };\n\n  Timers.updateTimerCounter = function (value) {\n    if (Timers.timerEnabled) {\n      // From binjgb, dont write TIMA if we were just reset\n      if (Timers.timerCounterWasReset) {\n        return;\n      } // Mooneye Test, tima_write_reloading\n      // Writing in this strange delay cycle, will cancel\n      // Both the interrupt and the TMA reload\n\n\n      if (Timers.timerCounterOverflowDelay) {\n        Timers.timerCounterOverflowDelay = false;\n      }\n    }\n\n    Timers.timerCounter = value;\n  };\n\n  Timers.updateTimerModulo = function (value) {\n    Timers.timerModulo = value; // Mooneye Test, tma_write_reloading\n    // Don't update if we were reloading\n\n    if (Timers.timerEnabled && Timers.timerCounterWasReset) {\n      Timers.timerCounter = value;\n      Timers.timerCounterWasReset = false;\n    }\n  };\n\n  Timers.updateTimerControl = function (value) {\n    // Get some initial values\n    var oldTimerEnabled = Timers.timerEnabled;\n    Timers.timerEnabled = checkBitOnByte(2, value);\n    var newTimerInputClock = value & 0x03; // Do some obscure behavior for if we should increment TIMA\n    // This does the timer increments from rapid_toggle mooneye tests\n\n    if (!oldTimerEnabled) {\n      var oldTimerCounterMaskBit = _getTimerCounterMaskBit(Timers.timerInputClock);\n\n      var newTimerCounterMaskBit = _getTimerCounterMaskBit(newTimerInputClock);\n\n      var shouldIncrementTimerCounter = false;\n      var dividerRegister = Timers.dividerRegister;\n\n      if (Timers.timerEnabled) {\n        shouldIncrementTimerCounter = checkBitOnByte(oldTimerCounterMaskBit, dividerRegister);\n      } else {\n        shouldIncrementTimerCounter = checkBitOnByte(oldTimerCounterMaskBit, dividerRegister) && checkBitOnByte(newTimerCounterMaskBit, dividerRegister);\n      }\n\n      if (shouldIncrementTimerCounter) {\n        _incrementTimerCounter();\n      }\n    }\n\n    Timers.timerInputClock = newTimerInputClock;\n  }; // Function to save the state of the class\n  // TODO: Save state for new properties on Timers\n\n\n  Timers.saveState = function () {\n    store(getSaveStateMemoryOffset(0x00, Timers.saveStateSlot), Timers.currentCycles);\n    store(getSaveStateMemoryOffset(0x04, Timers.saveStateSlot), Timers.dividerRegister);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x08, Timers.saveStateSlot), Timers.timerCounterOverflowDelay);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x0b, Timers.saveStateSlot), Timers.timerCounterWasReset);\n    eightBitStoreIntoGBMemory(Timers.memoryLocationTimerCounter, Timers.timerCounter);\n  }; // Function to load the save state from memory\n\n\n  Timers.loadState = function () {\n    Timers.currentCycles = load(getSaveStateMemoryOffset(0x00, Timers.saveStateSlot));\n    Timers.dividerRegister = load(getSaveStateMemoryOffset(0x04, Timers.saveStateSlot));\n    Timers.timerCounterOverflowDelay = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x08, Timers.saveStateSlot));\n    Timers.timerCounterWasReset = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x0b, Timers.saveStateSlot));\n    Timers.timerCounter = eightBitLoadFromGBMemory(Timers.memoryLocationTimerCounter);\n    Timers.timerModulo = eightBitLoadFromGBMemory(Timers.memoryLocationTimerModulo);\n    Timers.timerInputClock = eightBitLoadFromGBMemory(Timers.memoryLocationTimerControl);\n  }; // Current cycles\n  // This will be used for batch processing\n\n\n  Timers.currentCycles = 0; // Divider Register = DIV\n  // Divider Register is 16 bits.\n  // Divider Register when read is just the upper 8 bits\n  // But internally is used as the full 16\n  // Essentially dividerRegister is an always counting clock\n  // DIV Drives everything, it is the heart of the timer.\n  // All other timing registers base them selves relative to the DIV register\n  // Think of the div register as like a cycle counter :)\n  // DIV will increment TIMA, whenever there is a falling edge, see below for that.\n\n  Timers.memoryLocationDividerRegister = 0xff04; // DIV\n\n  Timers.dividerRegister = 0; // timerCounter = TIMA\n  // TIMA is the actual counter.\n  // Whenever the DIV gets the falling edge, and other obscure cases,\n  // This is incremented. When this overflows, we need to fire an interrupt.\n\n  Timers.memoryLocationTimerCounter = 0xff05;\n  Timers.timerCounter = 0;\n  Timers.timerCounterOverflowDelay = false;\n  Timers.timerCounterWasReset = false;\n  Timers.timerCounterMask = 0; // Timer Modulo = TMA\n  // TMA is what TIMA (Notice the I :p) is counting from, and TIMA will load\n  // Whenever TIMA overflow.\n  // For instance, we count like 1,2,3,4,5,6,7,8,9, and then overflow to 10.\n  // TMA would be like \"Hey, start counting from 5 whenever we reset\"\n  // Then we would be like 5,6,7,8,9...5,6,7,8,9...etc...\n\n  Timers.memoryLocationTimerModulo = 0xff06;\n  Timers.timerModulo = 0; // Timer Control = TAC\n  // TAC Says how fast we are counting.\n  // TAC controls which bit we are watching for the falling edge on the DIV register\n  // And whenever the bit has the falling edge, we increment TIMA (The thing counting).\n  // Therefore, depending on the value, we will either count faster or slower.\n\n  Timers.memoryLocationTimerControl = 0xff07; // Bit 2    - Timer Stop  (0=Stop, 1=Start)\n  // Bits 1-0 - Input Clock Select\n  //            00:   4096 Hz    (~4194 Hz SGB) (1024 cycles)\n  //            01: 262144 Hz  (~268400 Hz SGB) (16 cycles)\n  //            10:  65536 Hz   (~67110 Hz SGB) (64 cycles)\n  //            11:  16384 Hz   (~16780 Hz SGB) (256 cycles)\n\n  Timers.timerEnabled = false;\n  Timers.timerInputClock = 0; // Save States\n\n  Timers.saveStateSlot = 5;\n  return Timers;\n}(); // Inlined because closure compiler inlines\n\n\nfunction initializeTimers() {\n  // Reset stateful Variables\n  Timers.currentCycles = 0;\n  Timers.dividerRegister = 0;\n  Timers.timerCounter = 0;\n  Timers.timerModulo = 0;\n  Timers.timerEnabled = false;\n  Timers.timerInputClock = 0;\n  Timers.timerCounterOverflowDelay = false;\n  Timers.timerCounterWasReset = false;\n\n  if (Cpu.GBCEnabled) {\n    // DIV\n    eightBitStoreIntoGBMemory(0xff04, 0x1e);\n    Timers.dividerRegister = 0x1ea0; // 0xFF05 -> 0xFF06 = 0x00\n    // TAC\n\n    eightBitStoreIntoGBMemory(0xff07, 0xf8);\n    Timers.timerInputClock = 0xf8;\n  } else {\n    // DIV\n    eightBitStoreIntoGBMemory(0xff04, 0xab);\n    Timers.dividerRegister = 0xabcc; // 0xFF05 -> 0xFF06 = 0x00\n    // TAC\n\n    eightBitStoreIntoGBMemory(0xff07, 0xf8);\n    Timers.timerInputClock = 0xf8;\n  }\n} // Batch Process Timers\n// Only checked on writes\n// Function to batch process our Timers after we skipped so many cycles\n\n\nfunction batchProcessTimers() {\n  // TODO: Did a timer rewrite, make a proper batch processing\n  // For timers\n  updateTimers(Timers.currentCycles);\n  Timers.currentCycles = 0;\n}\n\nfunction updateTimers(numberOfCycles) {\n  // Want to increment 4 cycles at a time like an actual GB would\n  var cyclesIncreased = 0;\n\n  while (cyclesIncreased < numberOfCycles) {\n    var oldDividerRegister = Timers.dividerRegister;\n    var curDividerRegister = oldDividerRegister;\n    cyclesIncreased += 4;\n    curDividerRegister += 4;\n    curDividerRegister &= 0xffff;\n    Timers.dividerRegister = curDividerRegister;\n\n    if (Timers.timerEnabled) {\n      var timerCounterWasReset = Timers.timerCounterWasReset;\n\n      if (Timers.timerCounterOverflowDelay) {\n        Timers.timerCounter = Timers.timerModulo; // Fire off timer interrupt\n\n        requestTimerInterrupt();\n        Timers.timerCounterOverflowDelay = false;\n        Timers.timerCounterWasReset = true;\n      } else if (timerCounterWasReset) {\n        Timers.timerCounterWasReset = false;\n      }\n\n      if (_checkDividerRegisterFallingEdgeDetector(oldDividerRegister, curDividerRegister)) {\n        _incrementTimerCounter();\n      }\n    }\n  }\n} // Function to increment our Timer Counter\n// This fires off interrupts once we overflow\n\n\nfunction _incrementTimerCounter() {\n  var counter = Timers.timerCounter;\n\n  if (++counter > 255) {\n    // Whenever the timer overflows, there is a slight delay (4 cycles)\n    // Of when TIMA gets TMA's value, and the interrupt is fired.\n    // Thus we will set the delay, which can be handled in the update timer or write trap\n    Timers.timerCounterOverflowDelay = true;\n    counter = 0;\n  }\n\n  Timers.timerCounter = counter;\n} // Function to act as our falling edge detector\n// Whenever we have a falling edge, we need to increment TIMA\n// http://gbdev.gg8.se/wiki/articles/Timer_Obscure_Behaviour\n// https://github.com/binji/binjgb/blob/master/src/emulator.c#L1944\n\n\nfunction _checkDividerRegisterFallingEdgeDetector(oldDividerRegister, newDividerRegister) {\n  // Get our mask\n  var timerCounterMaskBit = _getTimerCounterMaskBit(Timers.timerInputClock); // If the old register's watched bit was zero,\n  // but after adding the new registers wastch bit is now 1\n\n\n  return checkBitOnByte(timerCounterMaskBit, oldDividerRegister) && !checkBitOnByte(timerCounterMaskBit, newDividerRegister);\n} // Function to get our current tima mask bit\n// used for our falling edge detector\n// See The docs linked above, or TCAGB for this bit mapping\n\n\nfunction _getTimerCounterMaskBit(timerInputClock) {\n  switch (timerInputClock) {\n    case 0x00:\n      return 9;\n\n    case 0x01:\n      return 3;\n\n    case 0x02:\n      return 5;\n\n    case 0x03:\n      return 7;\n  }\n\n  return 0;\n} // Link cable / serial implementation\n\n\nvar Serial =\n/** @class */\nfunction () {\n  function Serial() {}\n\n  Serial.updateTransferControl = function (value) {\n    Serial.isShiftClockInternal = checkBitOnByte(0, value);\n    Serial.isClockSpeedFast = checkBitOnByte(1, value);\n    Serial.transferStartFlag = checkBitOnByte(7, value); // Allow the original write, and return since we dont need to look anymore\n\n    return true;\n  }; // Cycle counter\n\n\n  Serial.currentCycles = 0x00; // Register locations\n\n  Serial.memoryLocationSerialTransferData = 0xff01; // SB\n\n  Serial.memoryLocationSerialTransferControl = 0xff02; // SC\n  // Number of bits transferred\n\n  Serial.numberOfBitsTransferred = 0; // Transfer control variables\n\n  Serial.isShiftClockInternal = false;\n  Serial.isClockSpeedFast = false;\n  Serial.transferStartFlag = false;\n  return Serial;\n}(); // Function to initialize our serial values\n// Inlined because closure compiler inlines\n\n\nfunction initializeSerial() {\n  Serial.currentCycles = 0x00;\n  Serial.numberOfBitsTransferred = 0;\n\n  if (Cpu.GBCEnabled) {\n    // FF01 = 0x00\n    eightBitStoreIntoGBMemory(0xff02, 0x7c);\n    Serial.updateTransferControl(0x7c);\n  } else {\n    // FF01 = 0x00\n    eightBitStoreIntoGBMemory(0xff02, 0x7e);\n    Serial.updateTransferControl(0x7e);\n  }\n} // TODO: Finish serial\n// See minimal serial: https://github.com/binji/binjgb/commit/64dece05c4ef5a052c4b9b75eb3ddbbfc6677cbe\n// Inlined because closure compiler inlines\n\n\nfunction updateSerial(numberOfCycles) {\n  // If we aren't starting our transfer, or transferring,\n  // return\n  if (!Serial.transferStartFlag) {\n    return;\n  } // Want to increment 4 cycles at a time like an actual GB would\n\n\n  var cyclesIncreased = 0;\n\n  while (cyclesIncreased < numberOfCycles) {\n    var oldCycles = Serial.currentCycles;\n    var curCycles = oldCycles;\n    cyclesIncreased += 4;\n    curCycles += 4;\n\n    if (curCycles > 0xffff) {\n      curCycles -= 0x10000;\n    }\n\n    Serial.currentCycles = curCycles;\n\n    if (_checkFallingEdgeDetector(oldCycles, curCycles)) {\n      // TODO: Since no actual connection, always transfer 1\n      // Need to fix this\n      var memoryLocationSerialTransferData = Serial.memoryLocationSerialTransferData;\n      var transferData = eightBitLoadFromGBMemory(memoryLocationSerialTransferData);\n      transferData = (transferData << 1) + 1;\n      transferData = transferData & 0xff;\n      eightBitStoreIntoGBMemory(memoryLocationSerialTransferData, transferData);\n      var numberOfBitsTransferred = Serial.numberOfBitsTransferred;\n\n      if (++numberOfBitsTransferred === 8) {\n        Serial.numberOfBitsTransferred = 0;\n        requestSerialInterrupt(); // Disable transfer start\n\n        var memoryLocationSerialTransferControl = Serial.memoryLocationSerialTransferControl;\n        var transferControl = eightBitLoadFromGBMemory(memoryLocationSerialTransferControl);\n        eightBitStoreIntoGBMemory(memoryLocationSerialTransferControl, resetBitOnByte(7, transferControl));\n        Serial.transferStartFlag = false;\n      } else {\n        Serial.numberOfBitsTransferred = numberOfBitsTransferred;\n      }\n    }\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction _checkFallingEdgeDetector(oldCycles, newCycles) {\n  // Get our mask\n  var maskBit = _getFallingEdgeMaskBit(); // If the old register's watched bit was zero,\n  // but after adding the new registers wastch bit is now 1\n\n\n  return checkBitOnByte(maskBit, oldCycles) && !checkBitOnByte(maskBit, newCycles);\n} // Function to get our current tima mask bit\n// used for our falling edge detector\n// See The docs linked above, or TCAGB for this bit mapping\n// Inlined because closure compiler inlines\n\n\nfunction _getFallingEdgeMaskBit() {\n  return Serial.isClockSpeedFast ? 2 : 7;\n} // http://www.codeslinger.co.uk/pages/projects/gameboy/joypad.html\n// Joypad Register\n// Taken from pandocs\n// Bit 7 - Not used\n// Bit 6 - Not used\n// Bit 5 - P15 Select Button Keys (0=Select)\n// Bit 4 - P14 Select Direction Keys (0=Select)\n// Bit 3 - P13 Input Down or Start (0=Pressed) (Read Only)\n// Bit 2 - P12 Input Up or Select (0=Pressed) (Read Only)\n// Bit 1 - P11 Input Left or Button B (0=Pressed) (Read Only)\n// Bit 0 - P10 Input Right or Button A (0=Pressed) (Read Only)\n// Button Ids will be the following:\n// UP - 0\n// RIGHT - 1\n// DOWN - 2\n// LEFT - 3\n// A - 4\n// B - 5\n// SELECT - 6\n// START - 7\n\n\nvar Joypad =\n/** @class */\nfunction () {\n  function Joypad() {}\n\n  Joypad.updateJoypad = function (value) {\n    Joypad.joypadRegisterFlipped = value ^ 0xff;\n    Joypad.isDpadType = checkBitOnByte(4, Joypad.joypadRegisterFlipped);\n    Joypad.isButtonType = checkBitOnByte(5, Joypad.joypadRegisterFlipped);\n  }; // Function to save the state of the class\n\n\n  Joypad.saveState = function () {}; // Function to load the save state from memory\n\n\n  Joypad.loadState = function () {\n    Joypad.updateJoypad(eightBitLoadFromGBMemory(Joypad.memoryLocationJoypadRegister));\n  };\n\n  Joypad.up = false;\n  Joypad.down = false;\n  Joypad.left = false;\n  Joypad.right = false;\n  Joypad.a = false;\n  Joypad.b = false;\n  Joypad.select = false;\n  Joypad.start = false;\n  Joypad.memoryLocationJoypadRegister = 0xff00; // Cache some values on the Joypad register\n\n  Joypad.joypadRegisterFlipped = 0;\n  Joypad.isDpadType = false;\n  Joypad.isButtonType = false; // Save States\n  // Not doing anything for Joypad for now\n\n  Joypad.saveStateSlot = 3;\n  return Joypad;\n}(); // Inlined because closure compiler inlines\n\n\nfunction getJoypadState() {\n  // Get the joypad register\n  var joypadRegister = Joypad.joypadRegisterFlipped;\n\n  if (Joypad.isDpadType) {\n    // D-pad buttons\n    // Up\n    if (Joypad.up) {\n      joypadRegister = resetBitOnByte(2, joypadRegister);\n    } else {\n      joypadRegister = setBitOnByte(2, joypadRegister);\n    } // Right\n\n\n    if (Joypad.right) {\n      joypadRegister = resetBitOnByte(0, joypadRegister);\n    } else {\n      joypadRegister = setBitOnByte(0, joypadRegister);\n    } // Down\n\n\n    if (Joypad.down) {\n      joypadRegister = resetBitOnByte(3, joypadRegister);\n    } else {\n      joypadRegister = setBitOnByte(3, joypadRegister);\n    } // Left\n\n\n    if (Joypad.left) {\n      joypadRegister = resetBitOnByte(1, joypadRegister);\n    } else {\n      joypadRegister = setBitOnByte(1, joypadRegister);\n    }\n  } else if (Joypad.isButtonType) {\n    // A\n    if (Joypad.a) {\n      joypadRegister = resetBitOnByte(0, joypadRegister);\n    } else {\n      joypadRegister = setBitOnByte(0, joypadRegister);\n    } // B\n\n\n    if (Joypad.b) {\n      joypadRegister = resetBitOnByte(1, joypadRegister);\n    } else {\n      joypadRegister = setBitOnByte(1, joypadRegister);\n    } // Select\n\n\n    if (Joypad.select) {\n      joypadRegister = resetBitOnByte(2, joypadRegister);\n    } else {\n      joypadRegister = setBitOnByte(2, joypadRegister);\n    } // Start\n\n\n    if (Joypad.start) {\n      joypadRegister = resetBitOnByte(3, joypadRegister);\n    } else {\n      joypadRegister = setBitOnByte(3, joypadRegister);\n    }\n  } // Set the top 4 bits to on\n\n\n  joypadRegister = joypadRegister | 0xf0;\n  return joypadRegister;\n}\n\nfunction setJoypadState(up, right, down, left, a, b, select, start) {\n  if (up > 0) {\n    _pressJoypadButton(0);\n  } else {\n    _releaseJoypadButton(0);\n  }\n\n  if (right > 0) {\n    _pressJoypadButton(1);\n  } else {\n    _releaseJoypadButton(1);\n  }\n\n  if (down > 0) {\n    _pressJoypadButton(2);\n  } else {\n    _releaseJoypadButton(2);\n  }\n\n  if (left > 0) {\n    _pressJoypadButton(3);\n  } else {\n    _releaseJoypadButton(3);\n  }\n\n  if (a > 0) {\n    _pressJoypadButton(4);\n  } else {\n    _releaseJoypadButton(4);\n  }\n\n  if (b > 0) {\n    _pressJoypadButton(5);\n  } else {\n    _releaseJoypadButton(5);\n  }\n\n  if (select > 0) {\n    _pressJoypadButton(6);\n  } else {\n    _releaseJoypadButton(6);\n  }\n\n  if (start > 0) {\n    _pressJoypadButton(7);\n  } else {\n    _releaseJoypadButton(7);\n  }\n}\n\nfunction _pressJoypadButton(buttonId) {\n  // Un stop the CPU\n  Cpu.isStopped = false; // Check if the button state changed from not pressed\n\n  var isButtonStateChanging = false;\n\n  if (!_getJoypadButtonStateFromButtonId(buttonId)) {\n    isButtonStateChanging = true;\n  } // Set our joypad state\n\n\n  _setJoypadButtonStateFromButtonId(buttonId, true); // If the button state is changing, check for an interrupt\n\n\n  if (isButtonStateChanging) {\n    // Determine if it is a button or a dpad button\n    var isDpadTypeButton = false;\n\n    if (buttonId <= 3) {\n      isDpadTypeButton = true;\n    } // Determine if we should request an interrupt\n\n\n    var shouldRequestInterrupt = false; // Check if the game is looking for a dpad type button press\n\n    if (Joypad.isDpadType && isDpadTypeButton) {\n      shouldRequestInterrupt = true;\n    } // Check if the game is looking for a button type button press\n\n\n    if (Joypad.isButtonType && !isDpadTypeButton) {\n      shouldRequestInterrupt = true;\n    } // Finally, request the interrupt, if the button state actually changed\n\n\n    if (shouldRequestInterrupt) {\n      requestJoypadInterrupt();\n    }\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction _releaseJoypadButton(buttonId) {\n  // Set our joypad state\n  _setJoypadButtonStateFromButtonId(buttonId, false);\n}\n\nfunction _getJoypadButtonStateFromButtonId(buttonId) {\n  switch (buttonId) {\n    case 0:\n      return Joypad.up;\n\n    case 1:\n      return Joypad.right;\n\n    case 2:\n      return Joypad.down;\n\n    case 3:\n      return Joypad.left;\n\n    case 4:\n      return Joypad.a;\n\n    case 5:\n      return Joypad.b;\n\n    case 6:\n      return Joypad.select;\n\n    case 7:\n      return Joypad.start;\n\n    default:\n      return false;\n  }\n}\n\nfunction _setJoypadButtonStateFromButtonId(buttonId, isPressed) {\n  switch (buttonId) {\n    case 0:\n      Joypad.up = isPressed;\n      break;\n\n    case 1:\n      Joypad.right = isPressed;\n      break;\n\n    case 2:\n      Joypad.down = isPressed;\n      break;\n\n    case 3:\n      Joypad.left = isPressed;\n      break;\n\n    case 4:\n      Joypad.a = isPressed;\n      break;\n\n    case 5:\n      Joypad.b = isPressed;\n      break;\n\n    case 6:\n      Joypad.select = isPressed;\n      break;\n\n    case 7:\n      Joypad.start = isPressed;\n      break;\n  }\n} // Function to handle rom/rambanking\n// Inlined because closure compiler inlines\n\n\nfunction handleBanking(offset, value) {\n  // Is rom Only does not bank\n  if (Memory.isRomOnly) {\n    return;\n  }\n\n  var isMBC1 = Memory.isMBC1;\n  var isMBC2 = Memory.isMBC2; // Enable Ram Banking\n\n  if (offset <= 0x1fff) {\n    if (isMBC2 && !checkBitOnByte(4, value)) {\n      // Do Nothing\n      return;\n    } else {\n      var romEnableByte = value & 0x0f;\n\n      if (romEnableByte === 0x00) {\n        Memory.isRamBankingEnabled = false;\n      } else if (romEnableByte === 0x0a) {\n        Memory.isRamBankingEnabled = true;\n      }\n    }\n  } else if (offset <= 0x3fff) {\n    var isMBC5 = Memory.isMBC5;\n\n    if (!isMBC5 || offset <= 0x2fff) {\n      // Change Low Bits on the Current Rom Bank\n      var currentRomBank = Memory.currentRomBank;\n\n      if (isMBC2) {\n        currentRomBank = value & 0x0f;\n      } // Set the number of bottom bytes from the MBC type\n\n\n      var romBankLowerBits = value;\n\n      if (isMBC1) {\n        // Only want the bottom 5\n        romBankLowerBits = romBankLowerBits & 0x1f;\n        currentRomBank &= 0xe0;\n      } else if (Memory.isMBC3) {\n        // Only Want the bottom 7\n        romBankLowerBits = romBankLowerBits & 0x7f;\n        currentRomBank &= 0x80;\n      } else if (isMBC5) {\n        // Going to switch the whole thing\n        currentRomBank &= 0x00;\n      } // Set the lower bytes\n\n\n      currentRomBank |= romBankLowerBits;\n      Memory.currentRomBank = currentRomBank;\n      return;\n    } else {\n      // TODO: MBC5 High bits Rom bank, check if this works, not sure about the value\n      var lowByte = splitLowByte(Memory.currentRomBank);\n      var highByte = value > 0;\n      Memory.currentRomBank = concatenateBytes(highByte, lowByte);\n    }\n  } else if (!isMBC2 && offset <= 0x5fff) {\n    // ROM / RAM Banking, MBC2 doesn't do this\n    if (isMBC1 && Memory.isMBC1RomModeEnabled) {\n      // Do an upper bit rom bank for MBC 1\n      // Remove upper bits of currentRomBank\n      var currentRomBank = Memory.currentRomBank & 0x1f;\n      var romBankHigherBits = value & 0xe0;\n      currentRomBank |= romBankHigherBits;\n      Memory.currentRomBank = currentRomBank;\n      return;\n    }\n\n    var ramBankBits = value;\n\n    if (!Memory.isMBC5) {\n      // Get the bottom 2 bits\n      ramBankBits &= 0x03;\n    } else {\n      // Get the bottom nibble\n      ramBankBits &= 0x0f;\n    } // Set our ram bank\n\n\n    Memory.currentRamBank = ramBankBits;\n    return;\n  } else if (!isMBC2 && offset <= 0x7fff) {\n    if (isMBC1) {\n      Memory.isMBC1RomModeEnabled = checkBitOnByte(0, value);\n    } // TODO: MBC3 Latch Clock Data\n\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction getRomBankAddress(gameboyOffset) {\n  var currentRomBank = Memory.currentRomBank;\n\n  if (!Memory.isMBC5 && currentRomBank === 0) {\n    currentRomBank = 1;\n  } // Adjust our gameboy offset relative to zero for the gameboy memory map\n\n\n  return 0x4000 * currentRomBank + (gameboyOffset - Memory.switchableCartridgeRomLocation);\n} // Inlined because closure compiler inlines\n\n\nfunction getRamBankAddress(gameboyOffset) {\n  // Adjust our gameboy offset relative to zero for the gameboy memory map\n  return 0x2000 * Memory.currentRamBank + (gameboyOffset - Memory.cartridgeRamLocation);\n} // Inlined because closure compiler inlines\n\n\nfunction initializeDma() {\n  if (Cpu.GBCEnabled) {\n    // GBC DMA\n    eightBitStoreIntoGBMemory(0xff51, 0xff);\n    eightBitStoreIntoGBMemory(0xff52, 0xff);\n    eightBitStoreIntoGBMemory(0xff53, 0xff);\n    eightBitStoreIntoGBMemory(0xff54, 0xff);\n    eightBitStoreIntoGBMemory(0xff55, 0xff);\n  } else {\n    // GBC DMA\n    eightBitStoreIntoGBMemory(0xff51, 0xff);\n    eightBitStoreIntoGBMemory(0xff52, 0xff);\n    eightBitStoreIntoGBMemory(0xff53, 0xff);\n    eightBitStoreIntoGBMemory(0xff54, 0xff);\n    eightBitStoreIntoGBMemory(0xff55, 0xff);\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction startDmaTransfer(sourceAddressOffset) {\n  var sourceAddress = sourceAddressOffset << 8;\n\n  for (var i = 0; i <= 0x9f; ++i) {\n    var spriteInformationByte = eightBitLoadFromGBMemory(sourceAddress + i);\n    var spriteInformationAddress = Memory.spriteInformationTableLocation + i;\n    eightBitStoreIntoGBMemory(spriteInformationAddress, spriteInformationByte);\n  } // TCAGBD:  This copy (DMA) needs 160 × 4 + 4 clocks to complete in both double speed and single speeds modes\n  // Increment all of our Cycle coiunters in ../cpu/opcodes\n\n\n  Memory.DMACycles = 644;\n} // https://gist.github.com/drhelius/3394856\n// http://bgb.bircd.org/pandocs.htm\n// Inlined because closure compiler inlines\n\n\nfunction startHdmaTransfer(hdmaTriggerByteToBeWritten) {\n  // Check if we are Gbc\n  if (!Cpu.GBCEnabled) {\n    return;\n  } // Check if we are trying to terminate an already active HBLANK HDMA\n\n\n  if (Memory.isHblankHdmaActive && !checkBitOnByte(7, hdmaTriggerByteToBeWritten)) {\n    // Don't reset anything, just set bit 7 to 1 on the trigger byte\n    Memory.isHblankHdmaActive = false;\n    var hdmaTriggerByte = eightBitLoadFromGBMemory(Memory.memoryLocationHdmaTrigger);\n    eightBitStoreIntoGBMemory(Memory.memoryLocationHdmaTrigger, setBitOnByte(7, hdmaTriggerByte));\n    return;\n  } // Get our source and destination for the HDMA\n\n\n  var hdmaSource = getHdmaSourceFromMemory();\n  var hdmaDestination = getHdmaDestinationFromMemory(); // Get the length from the trigger\n  // Lower 7 bits, Add 1, times 16\n  // https://gist.github.com/drhelius/3394856\n\n  var transferLength = resetBitOnByte(7, hdmaTriggerByteToBeWritten);\n  transferLength = transferLength + 1 << 4; // Get bit 7 of the trigger for the HDMA type\n\n  if (checkBitOnByte(7, hdmaTriggerByteToBeWritten)) {\n    // H-Blank DMA\n    Memory.isHblankHdmaActive = true;\n    Memory.hblankHdmaTransferLengthRemaining = transferLength;\n    Memory.hblankHdmaSource = hdmaSource;\n    Memory.hblankHdmaDestination = hdmaDestination; // This will be handled in updateHblankHdma()\n    // Since we return false in write traps, we need to now write the byte\n    // Be sure to reset bit 7, to show that the hdma is active\n\n    eightBitStoreIntoGBMemory(Memory.memoryLocationHdmaTrigger, resetBitOnByte(7, hdmaTriggerByteToBeWritten));\n  } else {\n    // General DMA\n    hdmaTransfer(hdmaSource, hdmaDestination, transferLength); // Stop the DMA\n\n    eightBitStoreIntoGBMemory(Memory.memoryLocationHdmaTrigger, 0xff);\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction updateHblankHdma() {\n  if (!Memory.isHblankHdmaActive) {\n    return;\n  } // Get our amount of bytes to transfer (Only 0x10 bytes at a time)\n\n\n  var bytesToTransfer = 0x10;\n  var hblankHdmaTransferLengthRemaining = Memory.hblankHdmaTransferLengthRemaining;\n\n  if (hblankHdmaTransferLengthRemaining < bytesToTransfer) {\n    // Set to the difference\n    bytesToTransfer = hblankHdmaTransferLengthRemaining;\n  } // Do the transfer (Only 0x10 bytes at a time)\n\n\n  hdmaTransfer(Memory.hblankHdmaSource, Memory.hblankHdmaDestination, bytesToTransfer); // Update our source and destination\n\n  Memory.hblankHdmaSource += bytesToTransfer;\n  Memory.hblankHdmaDestination += bytesToTransfer;\n  hblankHdmaTransferLengthRemaining -= bytesToTransfer;\n  Memory.hblankHdmaTransferLengthRemaining = hblankHdmaTransferLengthRemaining;\n  var memoryLocationHdmaTrigger = Memory.memoryLocationHdmaTrigger;\n\n  if (hblankHdmaTransferLengthRemaining <= 0) {\n    // End the transfer\n    Memory.isHblankHdmaActive = false; // Need to clear the HDMA with 0xFF, which sets bit 7 to 1 to show the HDMA has ended\n\n    eightBitStoreIntoGBMemory(memoryLocationHdmaTrigger, 0xff);\n  } else {\n    // Set our new transfer length, make sure it is in the weird format,\n    // and make sure bit 7 is 0, to show that the HDMA is Active\n    var remainingTransferLength = hblankHdmaTransferLengthRemaining;\n    var transferLengthAsByte = (remainingTransferLength >> 4) - 1;\n    eightBitStoreIntoGBMemory(memoryLocationHdmaTrigger, resetBitOnByte(7, transferLengthAsByte));\n  }\n} // Simple Function to transfer the bytes from a destination to a source for a general pourpose or Hblank HDMA\n\n\nfunction hdmaTransfer(hdmaSource, hdmaDestination, transferLength) {\n  for (var i = 0; i < transferLength; ++i) {\n    var sourceByte = eightBitLoadFromGBMemoryWithTraps(hdmaSource + i); // get the hdmaDestination with wrapping\n    // See issue #61: https://github.com/torch2424/wasmBoy/issues/61\n\n    var hdmaDestinationWithWrapping = hdmaDestination + i;\n\n    while (hdmaDestinationWithWrapping > 0x9fff) {\n      // Simply clear the top 3 bits\n      hdmaDestinationWithWrapping -= 0x2000;\n    }\n\n    eightBitStoreIntoGBMemoryWithTraps(hdmaDestinationWithWrapping, sourceByte);\n  } // Set our Cycles used for the HDMA\n  // Since DMA in GBC Double Speed Mode takes 80 micro seconds,\n  // And HDMA takes 8 micro seconds per 0x10 bytes in GBC Double Speed mode (and GBC Normal Mode)\n  // Will assume (644 / 10) cycles for GBC Double Speed Mode,\n  // and (644 / 10 / 2) for GBC Normal Mode\n\n\n  var hdmaCycles = 32 << Cpu.GBCDoubleSpeed;\n  hdmaCycles = hdmaCycles * (transferLength >> 4);\n  Memory.DMACycles += hdmaCycles;\n} // Function to get our HDMA Source\n// Follows the poan docs\n// Inlined because closure compiler inlines\n\n\nfunction getHdmaSourceFromMemory() {\n  // Get our source for the HDMA\n  var hdmaSourceHigh = eightBitLoadFromGBMemory(Memory.memoryLocationHdmaSourceHigh);\n  var hdmaSourceLow = eightBitLoadFromGBMemory(Memory.memoryLocationHdmaSourceLow);\n  var hdmaSource = concatenateBytes(hdmaSourceHigh, hdmaSourceLow); // And off the appopriate bits for the source and destination\n  // And off the bottom 4 bits\n\n  hdmaSource = hdmaSource & 0xfff0;\n  return hdmaSource;\n} // Function to get our HDMA Destination\n// Follows the poan docs\n// Inlined because closure compiler inlines\n\n\nfunction getHdmaDestinationFromMemory() {\n  var hdmaDestinationHigh = eightBitLoadFromGBMemory(Memory.memoryLocationHdmaDestinationHigh);\n  var hdmaDestinationLow = eightBitLoadFromGBMemory(Memory.memoryLocationHdmaDestinationLow);\n  var hdmaDestination = concatenateBytes(hdmaDestinationHigh, hdmaDestinationLow); // Can only be in VRAM, 0x8000 -> 0x9FF0\n  // Pan docs says to knock off upper 3 bits, and lower 4 bits\n  // Which gives us: 0001111111110000 or 0x1FF0\n  // Meaning we must add 0x8000\n\n  hdmaDestination = hdmaDestination & 0x1ff0;\n  hdmaDestination += Memory.videoRamLocation;\n  return hdmaDestination;\n} // Internal function to trap any modify data trying to be written to Gameboy memory\n// Follows the Gameboy memory map\n// Return true if you want to continue the write, return false to end it here\n\n\nfunction checkWriteTraps(offset, value) {\n  // Cpu\n  if (offset === Cpu.memoryLocationSpeedSwitch) {\n    // TCAGBD, only Bit 0 is writable\n    eightBitStoreIntoGBMemory(Cpu.memoryLocationSpeedSwitch, value & 0x01); // We did the write, dont need to\n\n    return false;\n  } // Graphics\n  // Cache globals used multiple times for performance\n\n\n  var videoRamLocation = Memory.videoRamLocation;\n  var spriteInformationTableLocation = Memory.spriteInformationTableLocation; // Handle banking\n\n  if (offset < videoRamLocation) {\n    handleBanking(offset, value);\n    return false;\n  } // Check the graphics mode to see if we can write to VRAM\n  // http://gbdev.gg8.se/wiki/articles/Video_Display#Accessing_VRAM_and_OAM\n\n\n  if (offset >= videoRamLocation && offset < Memory.cartridgeRamLocation) {\n    // Can only read/write from VRAM During Modes 0 - 2\n    // See graphics/lcd.ts\n    // TODO: This can do more harm than good in a beta emulator,\n    // requires precise timing disabling for now\n    // if (Graphics.currentLcdMode > 2) {\n    //   return false;\n    // }\n    // Not batch processing here for performance\n    // batchProcessGraphics();\n    // Allow the original write, and return since we dont need to look anymore\n    return true;\n  } // Be sure to copy everything in EchoRam to Work Ram\n  // Codeslinger: The ECHO memory region (0xE000-0xFDFF) is quite different because any data written here is also written in the equivelent ram memory region 0xC000-0xDDFF.\n  // Hence why it is called echo\n\n\n  if (offset >= Memory.echoRamLocation && offset < spriteInformationTableLocation) {\n    var wramOffset = offset - 0x2000;\n    eightBitStoreIntoGBMemory(wramOffset, value); // Allow the original write, and return since we dont need to look anymore\n\n    return true;\n  } // Also check for individal writes\n  // Can only read/write from OAM During Modes 0 - 1\n  // See graphics/lcd.ts\n\n\n  if (offset >= spriteInformationTableLocation && offset <= Memory.spriteInformationTableLocationEnd) {\n    // Can only read/write from OAM During Mode 2\n    // See graphics/lcd.ts\n    // if (Lcd.currentLcdMode < 2) {\n    // return false;\n    // }\n    // Not batch processing here for performance\n    // batchProcessGraphics();\n    // Allow the original write, and return since we dont need to look anymore\n    // return true;\n    return Lcd.currentLcdMode >= 2;\n  }\n\n  if (offset >= Memory.unusableMemoryLocation && offset <= Memory.unusableMemoryEndLocation) {\n    return false;\n  } // Serial\n\n\n  if (offset === Serial.memoryLocationSerialTransferControl) {\n    // SC\n    return Serial.updateTransferControl(value);\n  } // Sound\n  // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Registers\n\n\n  if (offset >= 0xff10 && offset <= 0xff26) {\n    batchProcessAudio();\n    return SoundRegisterWriteTraps(offset, value);\n  } // FF27 - FF2F not used\n  // Final Wave Table for Channel 3\n\n\n  if (offset >= 0xff30 && offset <= 0xff3f) {\n    batchProcessAudio();\n  } // Other Memory effects fomr read/write to Lcd/Graphics\n\n\n  if (offset >= Lcd.memoryLocationLcdControl && offset <= Graphics.memoryLocationWindowX) {\n    // Not batch processing here for performance\n    // batchProcessGraphics();\n    if (offset === Lcd.memoryLocationLcdControl) {\n      // Shorcut for isLCD Enabled since it gets \"hot\"\n      Lcd.updateLcdControl(value);\n      return true;\n    }\n\n    if (offset === Lcd.memoryLocationLcdStatus) {\n      // We are handling the write here\n      Lcd.updateLcdStatus(value);\n      return false;\n    } // reset the current scanline if the game tries to write to it\n\n\n    if (offset === Graphics.memoryLocationScanlineRegister) {\n      Graphics.scanlineRegister = 0;\n      eightBitStoreIntoGBMemory(offset, 0);\n      return false;\n    } // Cache our coincidence compare\n\n\n    if (offset === Lcd.memoryLocationCoincidenceCompare) {\n      Lcd.coincidenceCompare = value;\n      return true;\n    } // Do the direct memory access transfer for spriteInformationTable\n    // Check the graphics mode to see if we can write to VRAM\n    // http://gbdev.gg8.se/wiki/articles/Video_Display#Accessing_VRAM_and_OAM\n\n\n    if (offset === Graphics.memoryLocationDmaTransfer) {\n      // otherwise, perform a DMA transfer\n      // And allow the original write\n      startDmaTransfer(value);\n      return true;\n    } // Scroll and Window XY\n\n\n    switch (offset) {\n      case Graphics.memoryLocationScrollX:\n        Graphics.scrollX = value;\n        return true;\n\n      case Graphics.memoryLocationScrollY:\n        Graphics.scrollY = value;\n        return true;\n\n      case Graphics.memoryLocationWindowX:\n        Graphics.windowX = value;\n        return true;\n\n      case Graphics.memoryLocationWindowY:\n        Graphics.windowY = value;\n        return true;\n    } // Allow the original write, and return since we dont need to look anymore\n\n\n    return true;\n  } // Do an HDMA\n\n\n  if (offset === Memory.memoryLocationHdmaTrigger) {\n    startHdmaTransfer(value);\n    return false;\n  } // Don't allow banking if we are doing an Hblank HDM transfer\n  // https://gist.github.com/drhelius/3394856\n\n\n  if (offset === Memory.memoryLocationGBCWRAMBank || offset === Memory.memoryLocationGBCVRAMBank) {\n    if (Memory.isHblankHdmaActive) {\n      var hblankHdmaSource = Memory.hblankHdmaSource;\n\n      if (hblankHdmaSource >= 0x4000 && hblankHdmaSource <= 0x7fff || hblankHdmaSource >= 0xd000 && hblankHdmaSource <= 0xdfff) {\n        return false;\n      }\n    }\n  } // Handle GBC Pallete Write\n\n\n  if (offset >= Palette.memoryLocationBackgroundPaletteIndex && offset <= Palette.memoryLocationSpritePaletteData) {\n    // Incremeenting the palette handled by the write\n    writeColorPaletteToMemory(offset, value);\n    return true;\n  } // Handle timer writes\n\n\n  if (offset >= Timers.memoryLocationDividerRegister && offset <= Timers.memoryLocationTimerControl) {\n    // Batch Process\n    batchProcessTimers();\n\n    switch (offset) {\n      case Timers.memoryLocationDividerRegister:\n        Timers.updateDividerRegister();\n        return false;\n\n      case Timers.memoryLocationTimerCounter:\n        Timers.updateTimerCounter(value);\n        return true;\n\n      case Timers.memoryLocationTimerModulo:\n        Timers.updateTimerModulo(value);\n        return true;\n\n      case Timers.memoryLocationTimerControl:\n        Timers.updateTimerControl(value);\n        return true;\n    }\n\n    return true;\n  } // Handle Joypad writes for HW reg caching\n\n\n  if (offset === Joypad.memoryLocationJoypadRegister) {\n    Joypad.updateJoypad(value);\n  } // Handle Interrupt writes\n\n\n  if (offset === Interrupts.memoryLocationInterruptRequest) {\n    Interrupts.updateInterruptRequested(value);\n    return true;\n  }\n\n  if (offset === Interrupts.memoryLocationInterruptEnabled) {\n    Interrupts.updateInterruptEnabled(value);\n    return true;\n  } // Allow the original write\n\n\n  return true;\n} // WasmBoy memory map:\n// Private function to translate a offset meant for the gameboy memory map\n// To the wasmboy memory map\n// Following: http://gameboy.mongenel.com/dmg/asmmemmap.html\n// And https://github.com/Dooskington/GameLad/wiki/Part-11---Memory-Bank-Controllers\n// Performance help from @dcodeIO, and awesome-gbdev\n\n\nfunction getWasmBoyOffsetFromGameBoyOffset(gameboyOffset) {\n  // Get the top byte and switch\n  var gameboyOffsetHighByte = gameboyOffset >> 12;\n\n  switch (gameboyOffsetHighByte) {\n    case 0x00:\n    case 0x01:\n    case 0x02:\n    case 0x03:\n      // Cartridge ROM - Bank 0 (fixed)\n      // 0x0000 -> 0x0D2400\n      return gameboyOffset + CARTRIDGE_ROM_LOCATION;\n\n    case 0x04:\n    case 0x05:\n    case 0x06:\n    case 0x07:\n      // Cartridge ROM - Switchable Banks 1-xx\n      // 0x4000 -> (0x0D2400 + 0x4000)\n      return getRomBankAddress(gameboyOffset) + CARTRIDGE_ROM_LOCATION;\n\n    case 0x08:\n    case 0x09:\n      // Video RAM\n      // 0x8000 -> 0x000400\n      var vramBankId = 0;\n\n      if (Cpu.GBCEnabled) {\n        // Find our current VRAM Bank\n        vramBankId = eightBitLoadFromGBMemory(Memory.memoryLocationGBCVRAMBank) & 0x01; // Even though We added another 0x2000, the Cartridge ram is pulled out of our Internal Memory Space\n        // Therefore, we do not need to adjust for this extra 0x2000\n      }\n\n      return gameboyOffset - Memory.videoRamLocation + VIDEO_RAM_LOCATION + 0x2000 * vramBankId;\n\n    case 0x0a:\n    case 0x0b:\n      // Cartridge RAM - A.K.A External RAM\n      // 0xA000 -> 0x008400\n      return getRamBankAddress(gameboyOffset) + CARTRIDGE_RAM_LOCATION;\n\n    case 0x0c:\n      // Gameboy Ram Bank 0\n      // 0xC000 -> 0x000400\n      // Don't need to add head, since we move out 0x200 from the cartridge ram\n      return gameboyOffset - Memory.internalRamBankZeroLocation + WORK_RAM_LOCATION;\n\n    case 0x0d:\n      // Gameboy Ram Banks, Switchable in GBC Mode\n      // 0xD000 -> 0x000400\n      // In CGB Mode 32 KBytes internal RAM are available.\n      // This memory is divided into 8 banks of 4 KBytes each.\n      // Bank 0 is always available in memory at C000-CFFF,\n      // Bank 1-7 can be selected into the address space at D000-DFFF.\n      // http://gbdev.gg8.se/wiki/articles/CGB_Registers#FF70_-_SVBK_-_CGB_Mode_Only_-_WRAM_Bank\n      // Get the last 3 bits to find our wram ID\n      var wramBankId = 0;\n\n      if (Cpu.GBCEnabled) {\n        wramBankId = eightBitLoadFromGBMemory(Memory.memoryLocationGBCWRAMBank) & 0x07;\n      }\n\n      wramBankId = wramBankId < 1 ? 1 : wramBankId; // (0x1000 * (wramBankId - 1)) -> To find the correct wram bank.\n      // wramBankId - 1, because we alreayd have the space for wramBank 1, and are currently in it\n      // So need to address space for 6 OTHER banks\n\n      return gameboyOffset - Memory.internalRamBankZeroLocation + WORK_RAM_LOCATION + 0x1000 * (wramBankId - 1);\n\n    default:\n      // Everything Else after Gameboy Ram Banks\n      // 0xE000 -> 0x000400\n      // 0x6000 For the Extra WRAM Banks\n      return gameboyOffset - Memory.echoRamLocation + OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION;\n  }\n} // Breakpoints for memory / cpu\n\n\nvar Breakpoints =\n/** @class */\nfunction () {\n  function Breakpoints() {}\n\n  Breakpoints.programCounter = -1;\n  Breakpoints.readGbMemory = -1;\n  Breakpoints.writeGbMemory = -1;\n  Breakpoints.reachedBreakpoint = false;\n  return Breakpoints;\n}();\n\nfunction setProgramCounterBreakpoint(breakpoint) {\n  Breakpoints.programCounter = breakpoint;\n}\n\nfunction resetProgramCounterBreakpoint() {\n  Breakpoints.programCounter = -1;\n}\n\nfunction setReadGbMemoryBreakpoint(breakpoint) {\n  Breakpoints.readGbMemory = breakpoint;\n}\n\nfunction resetReadGbMemoryBreakpoint() {\n  Breakpoints.readGbMemory = -1;\n}\n\nfunction setWriteGbMemoryBreakpoint(breakpoint) {\n  Breakpoints.writeGbMemory = breakpoint;\n}\n\nfunction resetWriteGbMemoryBreakpoint() {\n  Breakpoints.writeGbMemory = -1;\n} // Store / Write memory access\n\n\nfunction eightBitStoreIntoGBMemory(gameboyOffset, value) {\n  store(getWasmBoyOffsetFromGameBoyOffset(gameboyOffset), value);\n}\n\nfunction eightBitStoreIntoGBMemoryWithTraps(offset, value) {\n  if (offset === Breakpoints.writeGbMemory) {\n    Breakpoints.reachedBreakpoint = true;\n  }\n\n  if (checkWriteTraps(offset, value)) {\n    eightBitStoreIntoGBMemory(offset, value);\n  }\n}\n\nfunction sixteenBitStoreIntoGBMemoryWithTraps(offset, value) {\n  // Dividing into two seperate eight bit calls to help with debugging tilemap overwrites\n  // Split the value into two seperate bytes\n  var highByte = splitHighByte(value);\n  var lowByte = splitLowByte(value);\n\n  if (checkWriteTraps(offset, lowByte)) {\n    eightBitStoreIntoGBMemory(offset, lowByte);\n  }\n\n  var nextOffset = offset + 1;\n\n  if (checkWriteTraps(nextOffset, highByte)) {\n    eightBitStoreIntoGBMemory(nextOffset, highByte);\n  }\n}\n\nfunction sixteenBitStoreIntoGBMemory(offset, value) {\n  // Dividing into two seperate eight bit calls to help with debugging tilemap overwrites\n  // Split the value into two seperate bytes\n  var highByte = splitHighByte(value);\n  var lowByte = splitLowByte(value);\n  eightBitStoreIntoGBMemory(offset + 0, lowByte);\n  eightBitStoreIntoGBMemory(offset + 1, highByte);\n}\n\nfunction storeBooleanDirectlyToWasmMemory(offset, value) {\n  store(offset, value);\n} // Funcitons for setting and checking the LCD\n\n\nvar Lcd =\n/** @class */\nfunction () {\n  function Lcd() {} // Function called in write traps to update our hardware registers\n\n\n  Lcd.updateLcdStatus = function (value) {\n    // Bottom three bits are read only\n    var currentLcdStatus = eightBitLoadFromGBMemory(Lcd.memoryLocationLcdStatus);\n    var valueNoBottomBits = value & 0xf8;\n    var lcdStatusOnlyBottomBits = currentLcdStatus & 0x07;\n    value = valueNoBottomBits | lcdStatusOnlyBottomBits; // Top bit is always 1\n\n    value = setBitOnByte(7, value);\n    eightBitStoreIntoGBMemory(Lcd.memoryLocationLcdStatus, value);\n  }; // Function called in write traps to update our hardware registers\n\n\n  Lcd.updateLcdControl = function (value) {\n    var wasLcdEnabled = Lcd.enabled;\n    Lcd.enabled = checkBitOnByte(7, value);\n    Lcd.windowTileMapDisplaySelect = checkBitOnByte(6, value);\n    Lcd.windowDisplayEnabled = checkBitOnByte(5, value);\n    Lcd.bgWindowTileDataSelect = checkBitOnByte(4, value);\n    Lcd.bgTileMapDisplaySelect = checkBitOnByte(3, value);\n    Lcd.tallSpriteSize = checkBitOnByte(2, value);\n    Lcd.spriteDisplayEnable = checkBitOnByte(1, value);\n    Lcd.bgDisplayEnabled = checkBitOnByte(0, value);\n\n    if (wasLcdEnabled && !Lcd.enabled) {\n      // Disable the LCD\n      resetLcd(true);\n    }\n\n    if (!wasLcdEnabled && Lcd.enabled) {\n      // Re-enable the LCD\n      resetLcd(false);\n    }\n  }; // Memory Locations\n  // Also known at STAT\n  // LCD Status (0xFF41) bits Explanation\n  // 0                0                    000                    0             00\n  //       |Coicedence Interrupt|     |Mode Interrupts|  |coincidence flag|  | Mode |\n  // Modes:\n  // 0 or 00: H-Blank\n  // 1 or 01: V-Blank\n  // 2 or 10: Searching Sprites Atts\n  // 3 or 11: Transfering Data to LCD Driver\n\n\n  Lcd.memoryLocationLcdStatus = 0xff41;\n  Lcd.currentLcdMode = 0;\n  Lcd.memoryLocationCoincidenceCompare = 0xff45;\n  Lcd.coincidenceCompare = 0; // Also known as LCDC\n  // http://www.codeslinger.co.uk/pages/projects/gameboy/graphics.html\n  // Bit 7 - LCD Display Enable (0=Off, 1=On)\n  // Bit 6 - Window Tile Map Display Select (0=9800-9BFF, 1=9C00-9FFF)\n  // Bit 5 - Window Display Enable (0=Off, 1=On)\n  // Bit 4 - BG & Window Tile Data Select (0=8800-97FF, 1=8000-8FFF)\n  // Bit 3 - BG Tile Map Display Select (0=9800-9BFF, 1=9C00-9FFF)\n  // Bit 2 - OBJ (Sprite) Size (0=8x8, 1=8x16)\n  // Bit 1 - OBJ (Sprite) Display Enable (0=Off, 1=On)\n  // Bit 0 - BG Display (for CGB see below) (0=Off, 1=On\n\n  Lcd.memoryLocationLcdControl = 0xff40; // Decoupled LCDC for caching\n\n  Lcd.enabled = true;\n  Lcd.windowTileMapDisplaySelect = false;\n  Lcd.windowDisplayEnabled = false;\n  Lcd.bgWindowTileDataSelect = false;\n  Lcd.bgTileMapDisplaySelect = false;\n  Lcd.tallSpriteSize = false;\n  Lcd.spriteDisplayEnable = false;\n  Lcd.bgDisplayEnabled = false;\n  return Lcd;\n}();\n\nfunction resetLcd(shouldBlankScreen) {\n  // Reset scanline cycle counter\n  Graphics.scanlineCycleCounter = 0;\n  Graphics.scanlineRegister = 0;\n  eightBitStoreIntoGBMemory(Graphics.memoryLocationScanlineRegister, 0); // Set to mode 0\n  // https://www.reddit.com/r/EmuDev/comments/4w6479/gb_dr_mario_level_generation_issues/\n\n  var lcdStatus = eightBitLoadFromGBMemory(Lcd.memoryLocationLcdStatus);\n  lcdStatus = resetBitOnByte(1, lcdStatus);\n  lcdStatus = resetBitOnByte(0, lcdStatus);\n  Lcd.currentLcdMode = 0; // Store the status in memory\n\n  eightBitStoreIntoGBMemory(Lcd.memoryLocationLcdStatus, lcdStatus); // Blank the screen\n\n  if (shouldBlankScreen) {\n    for (var i = 0; i < FRAME_SIZE; ++i) {\n      store(FRAME_LOCATION + i, 255);\n    }\n  }\n} // Pass in the lcd status for performance\n// Inlined because closure compiler inlines\n\n\nfunction setLcdStatus() {\n  // Check if the Lcd was disabled\n  if (!Lcd.enabled) {\n    return;\n  } // Get our current scanline, and lcd mode\n\n\n  var scanlineRegister = Graphics.scanlineRegister;\n  var lcdMode = Lcd.currentLcdMode; // Default to  H-Blank\n\n  var newLcdMode = 0; // Find our newLcd mode\n\n  if (scanlineRegister >= 144) {\n    // VBlank mode\n    newLcdMode = 1;\n  } else {\n    var scanlineCycleCounter = Graphics.scanlineCycleCounter;\n    var MIN_CYCLES_SPRITES_LCD_MODE = Graphics.MIN_CYCLES_SPRITES_LCD_MODE();\n\n    if (scanlineCycleCounter >= MIN_CYCLES_SPRITES_LCD_MODE) {\n      // Searching Sprites Atts\n      newLcdMode = 2;\n    } else if (scanlineCycleCounter >= MIN_CYCLES_SPRITES_LCD_MODE) {\n      // Transferring data to lcd\n      newLcdMode = 3;\n    }\n  }\n\n  if (lcdMode !== newLcdMode) {\n    // Get our lcd status\n    var lcdStatus = eightBitLoadFromGBMemory(Lcd.memoryLocationLcdStatus); // Save our lcd mode\n\n    Lcd.currentLcdMode = newLcdMode;\n    var shouldRequestInterrupt = false; // Set our LCD Status accordingly\n\n    switch (newLcdMode) {\n      case 0x00:\n        lcdStatus = resetBitOnByte(0, lcdStatus);\n        lcdStatus = resetBitOnByte(1, lcdStatus);\n        shouldRequestInterrupt = checkBitOnByte(3, lcdStatus);\n        break;\n\n      case 0x01:\n        lcdStatus = resetBitOnByte(1, lcdStatus);\n        lcdStatus = setBitOnByte(0, lcdStatus);\n        shouldRequestInterrupt = checkBitOnByte(4, lcdStatus);\n        break;\n\n      case 0x02:\n        lcdStatus = resetBitOnByte(0, lcdStatus);\n        lcdStatus = setBitOnByte(1, lcdStatus);\n        shouldRequestInterrupt = checkBitOnByte(5, lcdStatus);\n        break;\n\n      case 0x03:\n        lcdStatus = setBitOnByte(0, lcdStatus);\n        lcdStatus = setBitOnByte(1, lcdStatus);\n        break;\n    } // Check if we want to request an interrupt, and we JUST changed modes\n\n\n    if (shouldRequestInterrupt) {\n      requestLcdInterrupt();\n    } // Check for updating the Hblank HDMA\n\n\n    if (newLcdMode === 0) {\n      // Update the Hblank DMA, will simply return if not active\n      updateHblankHdma();\n    } // Check for requesting a VBLANK interrupt\n\n\n    if (newLcdMode === 1) {\n      requestVBlankInterrupt();\n    } // Check for the coincidence\n\n\n    lcdStatus = checkCoincidence(newLcdMode, lcdStatus); // Finally, save our status\n\n    eightBitStoreIntoGBMemory(Lcd.memoryLocationLcdStatus, lcdStatus);\n  } else if (scanlineRegister === 153) {\n    // Special Case, need to check LYC\n    // Fix prehistorik man freeze\n    var lcdStatus = eightBitLoadFromGBMemory(Lcd.memoryLocationLcdStatus);\n    lcdStatus = checkCoincidence(newLcdMode, lcdStatus);\n    eightBitStoreIntoGBMemory(Lcd.memoryLocationLcdStatus, lcdStatus);\n  }\n}\n\nfunction checkCoincidence(lcdMode, lcdStatus) {\n  // Check for the coincidence flag\n  // Need to check on every mode, and not just HBLANK, as checking on hblank breaks shantae, which checks on vblank\n  if ((lcdMode === 0 || lcdMode === 1) && Graphics.scanlineRegister === Lcd.coincidenceCompare) {\n    lcdStatus = setBitOnByte(2, lcdStatus);\n\n    if (checkBitOnByte(6, lcdStatus)) {\n      requestLcdInterrupt();\n    }\n  } else {\n    lcdStatus = resetBitOnByte(2, lcdStatus);\n  }\n\n  return lcdStatus;\n} // Functions for rendering the background\n// NOTE: i32Portable wraps modulo here as somehow it gets converted to a double:\n// https://github.com/torch2424/wasmboy/issues/216\n// Inlined because closure compiler inlines\n\n\nfunction renderBackground(scanlineRegister, tileDataMemoryLocation, tileMapMemoryLocation) {\n  // NOTE: Camera is reffering to what you can see inside the 160x144 viewport of the entire rendered 256x256 map.\n  // Get our scrollX and scrollY (u16 to play nice with assemblyscript)\n  // let scrollX: i32 = eightBitLoadFromGBMemory(Graphics.memoryLocationScrollX);\n  // let scrollY: i32 = eightBitLoadFromGBMemory(Graphics.memoryLocationScrollY);\n  var scrollX = Graphics.scrollX;\n  var scrollY = Graphics.scrollY; // Get our current pixel y positon on the 160x144 camera (Row that the scanline draws across)\n  // this is done by getting the current scroll Y position,\n  // and adding it do what Y Value the scanline is drawing on the camera.\n\n  var pixelYPositionInMap = scanlineRegister + scrollY; // Gameboy camera will \"wrap\" around the background map,\n  // meaning that if the pixelValue is 350, then we need to subtract 256 (decimal) to get it's actual value\n  // pixel values (scrollX and scrollY) range from 0x00 - 0xFF\n\n  pixelYPositionInMap &= 0x100 - 1; // Draw the Background scanline\n\n  drawBackgroundWindowScanline(scanlineRegister, tileDataMemoryLocation, tileMapMemoryLocation, pixelYPositionInMap, 0, scrollX);\n} // Inlined because closure compiler inlines\n\n\nfunction renderWindow(scanlineRegister, tileDataMemoryLocation, tileMapMemoryLocation) {\n  // Get our windowX and windowY\n  // let windowX: i32 = eightBitLoadFromGBMemory(Graphics.memoryLocationWindowX);\n  // let windowY: i32 = eightBitLoadFromGBMemory(Graphics.memoryLocationWindowY);\n  var windowX = Graphics.windowX;\n  var windowY = Graphics.windowY; // NOTE: Camera is reffering to what you can see inside the 160x144 viewport of the entire rendered 256x256 map.\n  // First ensure that the scanline is greater than our window\n\n  if (scanlineRegister < windowY) {\n    // Window is not within the current camera view\n    return;\n  } // WindowX is offset by 7\n\n\n  windowX -= 7; // Get our current pixel y positon on the 160x144 camera (Row that the scanline draws across)\n\n  var pixelYPositionInMap = scanlineRegister - windowY; // xOffset is simply a neagative window x\n  // NOTE: This can become negative zero?\n  // https://github.com/torch2424/wasmboy/issues/216\n\n  var xOffset = i32Portable(-windowX); // Draw the Background scanline\n\n  drawBackgroundWindowScanline(scanlineRegister, tileDataMemoryLocation, tileMapMemoryLocation, pixelYPositionInMap, windowX, xOffset);\n} // Function frankenstein'd together to allow background and window to share the same draw scanline function\n\n\nfunction drawBackgroundWindowScanline(scanlineRegister, tileDataMemoryLocation, tileMapMemoryLocation, pixelYPositionInMap, iStart, xOffset) {\n  // Get our tile Y position in the map\n  var tileYPositionInMap = pixelYPositionInMap >> 3; // Loop through x to draw the line like a CRT\n\n  for (var i = iStart; i < 160; ++i) {\n    // Get our Current X position of our pixel on the on the 160x144 camera\n    // this is done by getting the current scroll X position,\n    // and adding it do what X Value the scanline is drawing on the camera.\n    var pixelXPositionInMap = i + xOffset; // This is to compensate wrapping, same as pixelY\n\n    if (pixelXPositionInMap >= 0x100) {\n      pixelXPositionInMap -= 0x100;\n    } // Divide our pixel position by 8 to get our tile.\n    // Since, there are 256x256 pixels, and 32x32 tiles.\n    // 256 / 8 = 32.\n    // Also, bitshifting by 3, do do a division by 8\n    // Need to use u16s, as they will be used to compute an address, which will cause weird errors and overflows\n\n\n    var tileXPositionInMap = pixelXPositionInMap >> 3; // Get our tile address on the tileMap\n    // NOTE: (tileMap represents where each tile is displayed on the screen)\n    // NOTE: (tile map represents the entire map, now just what is within the \"camera\")\n    // For instance, if we have y pixel 144. 144 / 8 = 18. 18 * 32 = line address in map memory.\n    // And we have x pixel 160. 160 / 8 = 20.\n    // * 32, because remember, this is NOT only for the camera, the actual map is 32x32. Therefore, the next tile line of the map, is 32 byte offset.\n    // Think like indexing a 2d array, as a 1d array and it make sense :)\n\n    var tileMapAddress = tileMapMemoryLocation + (tileYPositionInMap << 5) + tileXPositionInMap; // Get the tile Id on the Tile Map\n\n    var tileIdFromTileMap = loadFromVramBank(tileMapAddress, 0); // Now that we have our Tile Id, let's check our Tile Cache\n\n    var usedTileCache = false;\n\n    if (Config.tileCaching) {\n      var pixelsDrawn = drawLineOfTileFromTileCache(i, scanlineRegister, pixelXPositionInMap, pixelYPositionInMap, tileMapAddress, tileDataMemoryLocation, tileIdFromTileMap); // Increment i by 7, not 8 because i will be incremented at end of for loop\n\n      if (pixelsDrawn > 0) {\n        i += pixelsDrawn - 1;\n        usedTileCache = true;\n      }\n    }\n\n    if (Config.tileRendering && !usedTileCache) {\n      var pixelsDrawn = drawLineOfTileFromTileId(i, scanlineRegister, pixelXPositionInMap, pixelYPositionInMap, tileMapAddress, tileDataMemoryLocation, tileIdFromTileMap); // A line of a tile is 8 pixels wide, therefore increase i by (pixelsDrawn - 1), and then the for loop will increment by 1\n      // For a net increment for 8\n\n      if (pixelsDrawn > 0) {\n        i += pixelsDrawn - 1;\n      }\n    } else if (!usedTileCache) {\n      if (Cpu.GBCEnabled) {\n        // Draw the individual pixel\n        drawColorPixelFromTileId(i, scanlineRegister, pixelXPositionInMap, pixelYPositionInMap, tileMapAddress, tileDataMemoryLocation, tileIdFromTileMap);\n      } else {\n        // Draw the individual pixel\n        drawMonochromePixelFromTileId(i, scanlineRegister, pixelXPositionInMap, pixelYPositionInMap, tileDataMemoryLocation, tileIdFromTileMap);\n      }\n    }\n  }\n} // Function to draw a pixel for the standard GB\n// Inlined because closure compiler inlines\n\n\nfunction drawMonochromePixelFromTileId(xPixel, yPixel, pixelXPositionInMap, pixelYPositionInMap, tileDataMemoryLocation, tileIdFromTileMap) {\n  // Now we can process the the individual bytes that represent the pixel on a tile\n  // Now get our tileDataAddress for the corresponding tileID we found in the map\n  // Read the comments in _getTileDataAddress() to see what's going on.\n  // tl;dr if we had the tile map of \"a b c d\", and wanted tileId 2.\n  // This funcitons returns the start of memory locaiton for the tile 'c'.\n  var tileDataAddress = getTileDataAddress(tileDataMemoryLocation, tileIdFromTileMap); // Get the y pixel of the 8 by 8 tile.\n  // Simply modulo the scanline.\n  // For instance, let's say we are printing the first line of pixels on our camera,\n  // And the first line of pixels on our tile.\n  // yPixel = 1. 1 % 8 = 1.\n  // And for the last line\n  // yPixel = 144. 144 % 8 = 0.\n  // 0 Represents last line of pixels in a tile, 1 represents first. 1 2 3 4 5 6 7 0.\n  // Because remember, we are counting lines on the display NOT including zero\n\n  var pixelYInTile = i32Portable(pixelYPositionInMap & 7); // Remember to represent a single line of 8 pixels on a tile, we need two bytes.\n  // Therefore, we need to times our modulo by 2, to get the correct line of pixels on the tile.\n  // Again, think like you had to map a 2d array as a 1d.\n\n  var byteOneForLineOfTilePixels = loadFromVramBank(tileDataAddress + pixelYInTile * 2, 0);\n  var byteTwoForLineOfTilePixels = loadFromVramBank(tileDataAddress + pixelYInTile * 2 + 1, 0); // Same logic as pixelYInTile.\n  // However, We need to reverse our byte,\n  // As pixel 0 is on byte 7, and pixel 1 is on byte 6, etc...\n  // Therefore, is pixelX was 2, then really is need to be 5\n  // So 2 - 7 = -5, * 1 = 5\n  // Or to simplify, 7 - 2 = 5 haha!\n\n  var pixelXInTile = i32Portable(pixelXPositionInMap & 7);\n  pixelXInTile = 7 - pixelXInTile; // Now we can get the color for that pixel\n  // Colors are represented by getting X position of ByteTwo, and X positon of Byte One\n  // To Get the color Id.\n  // For example, the result of the color id is 0000 00[xPixelByteTwo][xPixelByteOne]\n  // See: How to draw a tile/sprite from memory: http://www.codeslinger.co.uk/pages/projects/gameboy/graphics.html\n\n  var paletteColorId = 0;\n\n  if (checkBitOnByte(pixelXInTile, byteTwoForLineOfTilePixels)) {\n    // Byte one represents the second bit in our color id, so bit shift\n    paletteColorId += 1;\n    paletteColorId = paletteColorId << 1;\n  }\n\n  if (checkBitOnByte(pixelXInTile, byteOneForLineOfTilePixels)) {\n    paletteColorId += 1;\n  } // Not checking u8 Portability overflow here, since it can't be greater than i32 over :p\n  // Now get the colorId from the pallete, to get our final color\n  // Developers could change colorIds to represents different colors\n  // in their palette, thus we need to grab the color from there\n  //let pixelColorInTileFromPalette: u8 = getColorFromPalette(paletteColorId, Graphics.memoryLocationBackgroundPalette);\n  // Moved below for perofrmance\n  // FINALLY, RENDER THAT PIXEL!\n  // Only rendering camera for now, so coordinates are for the camera.\n  // Get the rgb value for the color Id, will be repeated into R, G, B. if not colorized\n\n\n  var hexColor = getColorizedGbHexColorFromPalette(paletteColorId, Graphics.memoryLocationBackgroundPalette);\n  setPixelOnFrame(xPixel, yPixel, 0, getRedFromHexColor(hexColor));\n  setPixelOnFrame(xPixel, yPixel, 1, getGreenFromHexColor(hexColor));\n  setPixelOnFrame(xPixel, yPixel, 2, getBlueFromHexColor(hexColor)); // Lastly, add the pixel to our background priority map\n  // https://github.com/torch2424/wasmBoy/issues/51\n  // Bits 0 & 1 will represent the color Id drawn by the BG/Window\n  // Bit 2 will represent if the Bg/Window has GBC priority.\n\n  addPriorityforPixel(xPixel, yPixel, paletteColorId);\n} // Function to draw a pixel from a tile in C O L O R\n// See above for more context on some variables\n// Inlined because closure compiler inlines\n\n\nfunction drawColorPixelFromTileId(xPixel, yPixel, pixelXPositionInMap, pixelYPositionInMap, tileMapAddress, tileDataMemoryLocation, tileIdFromTileMap) {\n  // Now get our tileDataAddress for the corresponding tileID we found in the map\n  // Read the comments in _getTileDataAddress() to see what's going on.\n  // tl;dr if we had the tile map of \"a b c d\", and wanted tileId 2.\n  // This funcitons returns the start of memory locaiton for the tile 'c'.\n  var tileDataAddress = getTileDataAddress(tileDataMemoryLocation, tileIdFromTileMap); // Get the GB Map Attributes\n  // Bit 0-2  Background Palette number  (BGP0-7)\n  // Bit 3    Tile VRAM Bank number      (0=Bank 0, 1=Bank 1)\n  // Bit 4    Not used\n  // Bit 5    Horizontal Flip            (0=Normal, 1=Mirror horizontally)\n  // Bit 6    Vertical Flip              (0=Normal, 1=Mirror vertically)\n  // Bit 7    BG-to-OAM Priority         (0=Use OAM priority bit, 1=BG Priority)\n\n  var bgMapAttributes = loadFromVramBank(tileMapAddress, 1); // See above for explanation\n\n  var pixelYInTile = i32Portable(pixelYPositionInMap & 7);\n\n  if (checkBitOnByte(6, bgMapAttributes)) {\n    // We are mirroring the tile, therefore, we need to opposite byte\n    // So if our pixel was 0 our of 8, it wild become 7 :)\n    pixelYInTile = 7 - pixelYInTile;\n  } // Remember to represent a single line of 8 pixels on a tile, we need two bytes.\n  // Therefore, we need to times our modulo by 2, to get the correct line of pixels on the tile.\n  // But we need to load the time from a specific Vram bank\n\n\n  var vramBankId = i32Portable(checkBitOnByte(3, bgMapAttributes));\n  var byteOneForLineOfTilePixels = loadFromVramBank(tileDataAddress + pixelYInTile * 2, vramBankId);\n  var byteTwoForLineOfTilePixels = loadFromVramBank(tileDataAddress + pixelYInTile * 2 + 1, vramBankId); // Get our X pixel. Need to NOT reverse it if it was flipped.\n  // See above, you have to reverse this normally\n\n  var pixelXInTile = i32Portable(pixelXPositionInMap & 7);\n\n  if (!checkBitOnByte(5, bgMapAttributes)) {\n    pixelXInTile = 7 - pixelXInTile;\n  } // Now we can get the color for that pixel\n  // Colors are represented by getting X position of ByteTwo, and X positon of Byte One\n  // To Get the color Id.\n  // For example, the result of the color id is 0000 00[xPixelByteTwo][xPixelByteOne]\n  // See: How to draw a tile/sprite from memory: http://www.codeslinger.co.uk/pages/projects/gameboy/graphics.html\n\n\n  var paletteColorId = 0;\n\n  if (checkBitOnByte(pixelXInTile, byteTwoForLineOfTilePixels)) {\n    // Byte one represents the second bit in our color id, so bit shift\n    paletteColorId += 1;\n    paletteColorId = paletteColorId << 1;\n  }\n\n  if (checkBitOnByte(pixelXInTile, byteOneForLineOfTilePixels)) {\n    paletteColorId += 1;\n  } // Finally lets add some, C O L O R\n  // Want the botom 3 bits\n\n\n  var bgPalette = bgMapAttributes & 0x07; // Call the helper function to grab the correct color from the palette\n\n  var rgbColorPalette = getRgbColorFromPalette(bgPalette, paletteColorId, false); // Split off into red green and blue\n\n  var red = getColorComponentFromRgb(0, rgbColorPalette);\n  var green = getColorComponentFromRgb(1, rgbColorPalette);\n  var blue = getColorComponentFromRgb(2, rgbColorPalette); // Finally Place our colors on the things\n\n  setPixelOnFrame(xPixel, yPixel, 0, red);\n  setPixelOnFrame(xPixel, yPixel, 1, green);\n  setPixelOnFrame(xPixel, yPixel, 2, blue); // Lastly, add the pixel to our background priority map\n  // https://github.com/torch2424/wasmBoy/issues/51\n  // Bits 0 & 1 will represent the color Id drawn by the BG/Window\n  // Bit 2 will represent if the Bg/Window has GBC priority.\n\n  addPriorityforPixel(xPixel, yPixel, paletteColorId, checkBitOnByte(7, bgMapAttributes));\n} // Function to attempt to draw the tile from the tile cache\n// Inlined because closure compiler inlines\n\n\nfunction drawLineOfTileFromTileCache(xPixel, yPixel, pixelXPositionInMap, pixelYPositionInMap, tileMapAddress, tileDataMemoryLocation, tileIdFromTileMap) {\n  // First, initialize how many pixels we have drawn\n  var pixelsDrawn = 0; // Check if the current tile matches our tileId\n  // TODO: Allow the first line to use the tile cache, for some odd reason it doesn't work when scanline is 0\n\n  var nextXIndexToPerformCacheCheck = TileCache.nextXIndexToPerformCacheCheck;\n\n  if (yPixel > 0 && xPixel > 8 && tileIdFromTileMap === TileCache.tileId && xPixel === nextXIndexToPerformCacheCheck) {\n    // Was last tile flipped\n    var wasLastTileHorizontallyFlipped = checkBitOnByte(5, eightBitLoadFromGBMemory(tileMapAddress - 1));\n    var isCurrentTileHorizontallyFlipped = checkBitOnByte(5, eightBitLoadFromGBMemory(tileMapAddress)); // Simply copy the last 8 pixels from memory to copy the line from the tile\n\n    for (var tileCacheIndex = 0; tileCacheIndex < 8; ++tileCacheIndex) {\n      // Check if we need to render backwards for flipping\n      if (wasLastTileHorizontallyFlipped !== isCurrentTileHorizontallyFlipped) {\n        tileCacheIndex = 7 - tileCacheIndex;\n      }\n\n      var xPos = xPixel + tileCacheIndex; // First check for overflow\n\n      if (xPos <= 160) {\n        // Get the pixel location in memory of the tile\n        var previousXPixel = xPixel - (8 - tileCacheIndex);\n        var previousTilePixelLocation = FRAME_LOCATION + getRgbPixelStart(xPos, yPixel); // Cycle through the RGB\n        // for (let tileCacheRgb = 0; tileCacheRgb < 3; ++tileCacheRgb) {\n        //  setPixelOnFrame(xPixel + tileCacheIndex, yPixel, tileCacheRgb, load<u8>(previousTilePixelLocation + tileCacheRgb));\n        // }\n        // unroll\n\n        setPixelOnFrame(xPos, yPixel, 0, load(previousTilePixelLocation, 0));\n        setPixelOnFrame(xPos, yPixel, 1, load(previousTilePixelLocation, 1));\n        setPixelOnFrame(xPos, yPixel, 2, load(previousTilePixelLocation, 2)); // Copy the priority for the pixel\n\n        var pixelPriority = getPriorityforPixel(previousXPixel, yPixel);\n        addPriorityforPixel(xPos, yPixel, resetBitOnByte(2, pixelPriority), checkBitOnByte(2, pixelPriority));\n        pixelsDrawn++;\n      }\n    }\n  } else {\n    // Save our current tile Id, and the next x value we should check the x index\n    TileCache.tileId = tileIdFromTileMap;\n  } // Calculate when we should do the tileCache calculation again\n\n\n  if (xPixel >= nextXIndexToPerformCacheCheck) {\n    nextXIndexToPerformCacheCheck = xPixel + 8;\n    var xOffsetTileWidthRemainder = i32Portable(pixelXPositionInMap & 7);\n\n    if (xPixel < xOffsetTileWidthRemainder) {\n      nextXIndexToPerformCacheCheck += xOffsetTileWidthRemainder;\n    }\n  }\n\n  TileCache.nextXIndexToPerformCacheCheck = nextXIndexToPerformCacheCheck;\n  return pixelsDrawn;\n} // Function to draw a line of a tile in Color\n// This is for tile rendering shortcuts\n// Inlined because closure compiler inlines\n\n\nfunction drawLineOfTileFromTileId(xPixel, yPixel, pixelXPositionInMap, pixelYPositionInMap, tileMapAddress, tileDataMemoryLocation, tileIdFromTileMap) {\n  // Get the which line of the tile we are rendering\n  var tileLineY = i32Portable(pixelYPositionInMap & 7); // Now lets find our tileX start and end\n  // This is for the case where i = 0, but scroll X was 3.\n  // Or i is 157, and our camera is only 160 pixels wide\n\n  var tileXStart = 0;\n\n  if (xPixel == 0) {\n    tileXStart = pixelXPositionInMap - (pixelXPositionInMap >> 3 << 3);\n  }\n\n  var tileXEnd = 7;\n\n  if (xPixel + 8 > 160) {\n    tileXEnd = 160 - xPixel;\n  } // initialize some variables for GBC\n\n\n  var bgMapAttributes = -1;\n  var vramBankId = 0;\n\n  if (Cpu.GBCEnabled) {\n    // Get Our GBC properties\n    bgMapAttributes = loadFromVramBank(tileMapAddress, 1);\n    vramBankId = i32Portable(checkBitOnByte(3, bgMapAttributes));\n\n    if (checkBitOnByte(6, bgMapAttributes)) {\n      // We are mirroring the tile, therefore, we need to opposite byte\n      // So if our pixel was 0 our of 8, it wild become 7 :)\n      tileLineY = 7 - tileLineY;\n    }\n  } // Return the number of pixels drawn\n\n\n  return drawPixelsFromLineOfTile(tileIdFromTileMap, tileDataMemoryLocation, vramBankId, tileXStart, tileXEnd, tileLineY, xPixel, yPixel, 160, FRAME_LOCATION, false, 0, bgMapAttributes, -1);\n} // Functions for rendering the sprites\n// Inlined because closure compiler inlines\n\n\nfunction renderSprites(scanlineRegister, useLargerSprites) {\n  // Need to loop through all 40 sprites to check their status\n  // Going backwards since lower sprites draw over higher ones\n  // Will fix dragon warrior 3 intro\n  for (var i = 39; i >= 0; --i) {\n    // Sprites occupy 4 bytes in the sprite attribute table\n    var spriteTableIndex = i * 4; // Y positon is offset by 16, X position is offset by 8\n\n    var index = Graphics.memoryLocationSpriteAttributesTable + spriteTableIndex;\n    var spriteYPosition = eightBitLoadFromGBMemory(index + 0);\n    var spriteXPosition = eightBitLoadFromGBMemory(index + 1);\n    var spriteTileId = eightBitLoadFromGBMemory(index + 2); // Pan docs of sprite attirbute table\n    // Bit7   OBJ-to-BG Priority (0=OBJ Above BG, 1=OBJ Behind BG color 1-3)\n    //      (Used for both BG and Window. BG color 0 is always behind OBJ)\n    // Bit6   Y flip          (0=Normal, 1=Vertically mirrored)\n    // Bit5   X flip          (0=Normal, 1=Horizontally mirrored)\n    // Bit4   Palette number  **Non CGB Mode Only** (0=OBP0, 1=OBP1)\n    // Bit3   Tile VRAM-Bank  **CGB Mode Only**     (0=Bank 0, 1=Bank 1)\n    // Bit2-0 Palette number  **CGB Mode Only**     (OBP0-7)\n    // Apply sprite X and Y offset\n    // TODO: Sprites are overflowing on x if less than 8\n\n    spriteYPosition -= 16;\n    spriteXPosition -= 8; // Find our sprite height\n\n    var spriteHeight = 8;\n\n    if (useLargerSprites) {\n      spriteHeight = 16; // @binji says in 8x16 mode, even tileId always drawn first\n      // This will fix shantae sprites which always uses odd numbered indexes\n      // TODO: Do the actual Pandocs thing:\n      // \"In 8x16 mode, the lower bit of the tile number is ignored. Ie. the upper 8x8 tile is \"NN AND FEh\", and the lower 8x8 tile is \"NN OR 01h\".\"\n      // So just knock off the last bit? :)\n\n      spriteTileId -= spriteTileId & 1;\n    } // Find if our sprite is on the current scanline\n\n\n    if (scanlineRegister >= spriteYPosition && scanlineRegister < spriteYPosition + spriteHeight) {\n      // Then we need to draw the current sprite\n      // Get our sprite attributes since we know we shall be drawing the tile\n      var spriteAttributes = eightBitLoadFromGBMemory(Graphics.memoryLocationSpriteAttributesTable + spriteTableIndex + 3); // Check sprite Priority\n\n      var isSpritePriorityBehindWindowAndBackground = checkBitOnByte(7, spriteAttributes); // Check if we should flip the sprite on the x or y axis\n\n      var flipSpriteY = checkBitOnByte(6, spriteAttributes);\n      var flipSpriteX = checkBitOnByte(5, spriteAttributes); // TODO: Torch2424 continue here.\n      // Find which line on the sprite we are on\n\n      var currentSpriteLine = scanlineRegister - spriteYPosition; // If we fliiped the Y axis on our sprite, need to read from memory backwards to acheive the same effect\n\n      if (flipSpriteY) {\n        currentSpriteLine = spriteHeight - currentSpriteLine; // Bug fix for the flipped flies in link's awakening\n\n        currentSpriteLine -= 1;\n      } // Each line of a tile takes two bytes of memory\n\n\n      currentSpriteLine <<= 1; // Get our sprite tile address, need to also add the current sprite line to get the correct bytes\n\n      var spriteTileAddressStart = getTileDataAddress(Graphics.memoryLocationTileDataSelectOneStart, spriteTileId);\n      spriteTileAddressStart += currentSpriteLine;\n      var spriteTileAddress = spriteTileAddressStart; // Find which VRAM Bank to load from\n\n      var vramBankId = Cpu.GBCEnabled && checkBitOnByte(3, spriteAttributes);\n      var spriteDataByteOneForLineOfTilePixels = loadFromVramBank(spriteTileAddress + 0, vramBankId);\n      var spriteDataByteTwoForLineOfTilePixels = loadFromVramBank(spriteTileAddress + 1, vramBankId); // Iterate over the width of our sprite to find our individual pixels\n\n      for (var tilePixel = 7; tilePixel >= 0; --tilePixel) {\n        // Get our spritePixel, and check for flipping\n        var spritePixelXInTile = tilePixel;\n\n        if (flipSpriteX) {\n          spritePixelXInTile -= 7;\n          spritePixelXInTile = -spritePixelXInTile;\n        } // Get the color Id of our sprite, similar to renderBackground()\n        // With the first byte, and second byte lined up method thing\n        // Yes, the second byte comes before the first, see ./background.ts\n\n\n        var spriteColorId = 0;\n\n        if (checkBitOnByte(spritePixelXInTile, spriteDataByteTwoForLineOfTilePixels)) {\n          // Byte one represents the second bit in our color id, so bit shift\n          spriteColorId = spriteColorId + 1 << 1;\n        }\n\n        if (checkBitOnByte(spritePixelXInTile, spriteDataByteOneForLineOfTilePixels)) {\n          spriteColorId += 1;\n        } // ColorId zero (last two bits of pallette) are transparent\n        // http://gbdev.gg8.se/wiki/articles/Video_Display\n\n\n        if (spriteColorId !== 0) {\n          // Find our actual X pixel location on the gameboy \"camera\" view\n          // This cannot be less than zero, i32 will overflow\n          var spriteXPixelLocationInCameraView = spriteXPosition + (7 - tilePixel);\n\n          if (spriteXPixelLocationInCameraView >= 0 && spriteXPixelLocationInCameraView <= 160) {\n            // There are two cases where wouldnt draw the pixel on top of the Bg/window\n            // 1. if isSpritePriorityBehindWindowAndBackground, sprite can only draw over color 0\n            // 2. if bit 2 of our priority is set, then BG-to-OAM Priority from pandoc\n            //  is active, meaning BG tile will have priority above all OBJs\n            //  (regardless of the priority bits in OAM memory)\n            // But if GBC and Bit 0 of LCDC is set, we always draw the object\n            var shouldShowFromLcdcPriority = Cpu.GBCEnabled && !Lcd.bgDisplayEnabled; // LCDC Priority\n\n            var shouldHideFromOamPriority = false;\n            var shouldHideFromBgPriority = false;\n\n            if (!shouldShowFromLcdcPriority) {\n              // Now that we have our coordinates, check for sprite priority\n              // Lets get the priority byte we put in memory\n              var bgPriorityByte = getPriorityforPixel(spriteXPixelLocationInCameraView, scanlineRegister);\n              var bgColorFromPriorityByte = bgPriorityByte & 0x03; // Doing an else if, since either will automatically stop drawing the pixel\n\n              if (isSpritePriorityBehindWindowAndBackground && bgColorFromPriorityByte > 0) {\n                // OAM Priority\n                shouldHideFromOamPriority = true;\n              } else if (Cpu.GBCEnabled && checkBitOnByte(2, bgPriorityByte) && bgColorFromPriorityByte > 0) {\n                // Bg priority\n                shouldHideFromBgPriority = true;\n              }\n            }\n\n            if (shouldShowFromLcdcPriority || !shouldHideFromOamPriority && !shouldHideFromBgPriority) {\n              if (!Cpu.GBCEnabled) {\n                // Get our monochrome color RGB from the current sprite pallete\n                // Get our sprite pallete\n                var spritePaletteLocation = Graphics.memoryLocationSpritePaletteOne;\n\n                if (checkBitOnByte(4, spriteAttributes)) {\n                  spritePaletteLocation = Graphics.memoryLocationSpritePaletteTwo;\n                }\n\n                var hexColor = getColorizedGbHexColorFromPalette(spriteColorId, spritePaletteLocation); // Finally set the pixel!\n\n                setPixelOnFrame(spriteXPixelLocationInCameraView, scanlineRegister, 0, getRedFromHexColor(hexColor));\n                setPixelOnFrame(spriteXPixelLocationInCameraView, scanlineRegister, 1, getGreenFromHexColor(hexColor));\n                setPixelOnFrame(spriteXPixelLocationInCameraView, scanlineRegister, 2, getBlueFromHexColor(hexColor));\n              } else {\n                // Get our RGB Color\n                // Finally lets add some, C O L O R\n                // Want the botom 3 bits\n                var bgPalette = spriteAttributes & 0x07; // Call the helper function to grab the correct color from the palette\n\n                var rgbColorPalette = getRgbColorFromPalette(bgPalette, spriteColorId, true); // Split off into red green and blue\n\n                var red = getColorComponentFromRgb(0, rgbColorPalette);\n                var green = getColorComponentFromRgb(1, rgbColorPalette);\n                var blue = getColorComponentFromRgb(2, rgbColorPalette); // Finally Place our colors on the things\n\n                setPixelOnFrame(spriteXPixelLocationInCameraView, scanlineRegister, 0, red);\n                setPixelOnFrame(spriteXPixelLocationInCameraView, scanlineRegister, 1, green);\n                setPixelOnFrame(spriteXPixelLocationInCameraView, scanlineRegister, 2, blue);\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n} // Main Class and funcitons for rendering the gameboy display\n\n\nvar Graphics =\n/** @class */\nfunction () {\n  function Graphics() {} // Number of cycles to run in each batch process\n  // This number should be in sync so that graphics doesn't run too many cyles at once\n  // and does not exceed the minimum number of cyles for either scanlines, or\n  // How often we change the frame, or a channel's update process\n\n\n  Graphics.batchProcessCycles = function () {\n    return Graphics.MAX_CYCLES_PER_SCANLINE();\n  }; // TCAGBD says 456 per scanline, but 153 only a handful\n\n\n  Graphics.MAX_CYCLES_PER_SCANLINE = function () {\n    if (Graphics.scanlineRegister === 153) {\n      return 4 << Cpu.GBCDoubleSpeed;\n    } else {\n      return 456 << Cpu.GBCDoubleSpeed;\n    }\n  };\n\n  Graphics.MIN_CYCLES_SPRITES_LCD_MODE = function () {\n    // TODO: Confirm these clock cyles, double similar to scanline, which TCAGBD did\n    return 376 << Cpu.GBCDoubleSpeed;\n  };\n\n  Graphics.MIN_CYCLES_TRANSFER_DATA_LCD_MODE = function () {\n    // TODO: Confirm these clock cyles, double similar to scanline, which TCAGBD did\n    return 249 << Cpu.GBCDoubleSpeed;\n  }; // Function to save the state of the class\n\n\n  Graphics.saveState = function () {\n    store(getSaveStateMemoryOffset(0x00, Graphics.saveStateSlot), Graphics.scanlineCycleCounter);\n    store(getSaveStateMemoryOffset(0x04, Graphics.saveStateSlot), Lcd.currentLcdMode);\n    eightBitStoreIntoGBMemory(Graphics.memoryLocationScanlineRegister, Graphics.scanlineRegister);\n  }; // Function to load the save state from memory\n\n\n  Graphics.loadState = function () {\n    Graphics.scanlineCycleCounter = load(getSaveStateMemoryOffset(0x00, Graphics.saveStateSlot));\n    Lcd.currentLcdMode = load(getSaveStateMemoryOffset(0x04, Graphics.saveStateSlot));\n    Graphics.scanlineRegister = eightBitLoadFromGBMemory(Graphics.memoryLocationScanlineRegister);\n    Lcd.updateLcdControl(eightBitLoadFromGBMemory(Lcd.memoryLocationLcdControl));\n  }; // Current cycles\n  // This will be used for batch processing\n\n\n  Graphics.currentCycles = 0; // Count the number of cycles to keep synced with cpu cycles\n  // Found GBC cycles by finding clock speed from Gb Cycles\n  // See TCAGBD For cycles\n\n  Graphics.scanlineCycleCounter = 0x00; // LCD\n  // scanlineRegister also known as LY\n  // See: http://bgb.bircd.org/pandocs.txt , and search \" LY \"\n\n  Graphics.memoryLocationScanlineRegister = 0xff44;\n  Graphics.scanlineRegister = 0;\n  Graphics.memoryLocationDmaTransfer = 0xff46; // Scroll and Window\n\n  Graphics.memoryLocationScrollX = 0xff43;\n  Graphics.scrollX = 0;\n  Graphics.memoryLocationScrollY = 0xff42;\n  Graphics.scrollY = 0;\n  Graphics.memoryLocationWindowX = 0xff4b;\n  Graphics.windowX = 0;\n  Graphics.memoryLocationWindowY = 0xff4a;\n  Graphics.windowY = 0; // Tile Maps And Data\n\n  Graphics.memoryLocationTileMapSelectZeroStart = 0x9800;\n  Graphics.memoryLocationTileMapSelectOneStart = 0x9c00;\n  Graphics.memoryLocationTileDataSelectZeroStart = 0x8800;\n  Graphics.memoryLocationTileDataSelectOneStart = 0x8000; // Sprites\n\n  Graphics.memoryLocationSpriteAttributesTable = 0xfe00; // Palettes\n\n  Graphics.memoryLocationBackgroundPalette = 0xff47;\n  Graphics.memoryLocationSpritePaletteOne = 0xff48;\n  Graphics.memoryLocationSpritePaletteTwo = 0xff49; // Screen data needs to be stored in wasm memory\n  // Save States\n\n  Graphics.saveStateSlot = 1;\n  return Graphics;\n}(); // Batch Process Graphics\n// http://gameboy.mongenel.com/dmg/asmmemmap.html and http://gbdev.gg8.se/wiki/articles/Video_Display\n// Function to batch process our graphics after we skipped so many cycles\n// This is not currently checked in memory read/write\n\n\nfunction batchProcessGraphics() {\n  var batchProcessCycles = Graphics.batchProcessCycles();\n\n  while (Graphics.currentCycles >= batchProcessCycles) {\n    updateGraphics(batchProcessCycles);\n    Graphics.currentCycles -= batchProcessCycles;\n  }\n} // Inlined because closure compiler inlines\n\n\nfunction initializeGraphics() {\n  // Reset Stateful Variables\n  Graphics.currentCycles = 0;\n  Graphics.scanlineCycleCounter = 0x00;\n  Graphics.scanlineRegister = 0;\n  Graphics.scrollX = 0;\n  Graphics.scrollY = 0;\n  Graphics.windowX = 0;\n  Graphics.windowY = 0;\n  Graphics.scanlineRegister = 0x90;\n\n  if (Cpu.GBCEnabled) {\n    // Bgb says LY is 90 on boot\n    eightBitStoreIntoGBMemory(0xff40, 0x91);\n    eightBitStoreIntoGBMemory(0xff41, 0x81); // 0xFF42 -> 0xFF43 = 0x00\n\n    eightBitStoreIntoGBMemory(0xff44, 0x90); // 0xFF45 -> 0xFF46 = 0x00\n\n    eightBitStoreIntoGBMemory(0xff47, 0xfc); // 0xFF48 -> 0xFF4B = 0x00\n  } else {\n    eightBitStoreIntoGBMemory(0xff40, 0x91);\n    eightBitStoreIntoGBMemory(0xff41, 0x85); // 0xFF42 -> 0xFF45 = 0x00\n\n    eightBitStoreIntoGBMemory(0xff46, 0xff);\n    eightBitStoreIntoGBMemory(0xff47, 0xfc);\n    eightBitStoreIntoGBMemory(0xff48, 0xff);\n    eightBitStoreIntoGBMemory(0xff49, 0xff); // 0xFF4A -> 0xFF4B = 0x00\n  } // GBC VRAM Banks\n\n\n  eightBitStoreIntoGBMemory(0xff4f, 0x00);\n  eightBitStoreIntoGBMemory(0xff70, 0x01);\n  initializeColors();\n}\n\nfunction updateGraphics(numberOfCycles) {\n  if (Lcd.enabled) {\n    Graphics.scanlineCycleCounter += numberOfCycles;\n    var graphicsDisableScanlineRendering = Config.graphicsDisableScanlineRendering;\n\n    while (Graphics.scanlineCycleCounter >= Graphics.MAX_CYCLES_PER_SCANLINE()) {\n      // Reset the scanlineCycleCounter\n      // Don't set to zero to catch extra cycles\n      Graphics.scanlineCycleCounter -= Graphics.MAX_CYCLES_PER_SCANLINE(); // Move to next scanline\n      // let scanlineRegister: i32 = eightBitLoadFromGBMemory(Graphics.memoryLocationScanlineRegister);\n\n      var scanlineRegister = Graphics.scanlineRegister; // Check if we've reached the last scanline\n\n      if (scanlineRegister === 144) {\n        // Draw the scanline\n        if (!graphicsDisableScanlineRendering) {\n          _drawScanline(scanlineRegister);\n        } else {\n          _renderEntireFrame();\n        } // Clear the priority map\n\n\n        clearPriorityMap(); // Reset the tile cache\n\n        resetTileCache();\n      } else if (scanlineRegister < 144) {\n        // Draw the scanline\n        if (!graphicsDisableScanlineRendering) {\n          _drawScanline(scanlineRegister);\n        }\n      } // Post increment the scanline register after drawing\n      // TODO: Need to fix graphics timing\n\n\n      if (scanlineRegister > 153) {\n        // Check if we overflowed scanlines\n        // if so, reset our scanline number\n        scanlineRegister = 0;\n      } else {\n        scanlineRegister += 1;\n      } // Store our new scanline value\n\n\n      Graphics.scanlineRegister = scanlineRegister; // eightBitStoreIntoGBMemory(Graphics.memoryLocationScanlineRegister, scanlineRegister);\n    }\n  } // Games like Pokemon crystal want the vblank right as it turns to the value, and not have it increment after\n  // It will break and lead to an infinite loop in crystal\n  // Therefore, we want to be checking/Setting our LCD status after the scanline updates\n\n\n  setLcdStatus();\n} // TODO: Make this a _drawPixelOnScanline, as values can be updated while drawing a scanline\n\n\nfunction _drawScanline(scanlineRegister) {\n  // Get our seleted tile data memory location\n  var tileDataMemoryLocation = Graphics.memoryLocationTileDataSelectZeroStart;\n\n  if (Lcd.bgWindowTileDataSelect) {\n    tileDataMemoryLocation = Graphics.memoryLocationTileDataSelectOneStart;\n  } // Check if the background is enabled\n  // NOTE: On Gameboy color, Pandocs says this does something completely different\n  // LCDC.0 - 2) CGB in CGB Mode: BG and Window Master Priority\n  // When Bit 0 is cleared, the background and window lose their priority -\n  // the sprites will be always displayed on top of background and window,\n  // independently of the priority flags in OAM and BG Map attributes.\n  // TODO: Enable this different feature for GBC\n\n\n  if (Cpu.GBCEnabled || Lcd.bgDisplayEnabled) {\n    // Get our map memory location\n    var tileMapMemoryLocation = Graphics.memoryLocationTileMapSelectZeroStart;\n\n    if (Lcd.bgTileMapDisplaySelect) {\n      tileMapMemoryLocation = Graphics.memoryLocationTileMapSelectOneStart;\n    } // Finally, pass everything to draw the background\n\n\n    renderBackground(scanlineRegister, tileDataMemoryLocation, tileMapMemoryLocation);\n  } // Check if the window is enabled, and we are currently\n  // Drawing lines on the window\n\n\n  if (Lcd.windowDisplayEnabled) {\n    // Get our map memory location\n    var tileMapMemoryLocation = Graphics.memoryLocationTileMapSelectZeroStart;\n\n    if (Lcd.windowTileMapDisplaySelect) {\n      tileMapMemoryLocation = Graphics.memoryLocationTileMapSelectOneStart;\n    } // Finally, pass everything to draw the background\n\n\n    renderWindow(scanlineRegister, tileDataMemoryLocation, tileMapMemoryLocation);\n  }\n\n  if (Lcd.spriteDisplayEnable) {\n    // Sprites are enabled, render them!\n    renderSprites(scanlineRegister, Lcd.tallSpriteSize);\n  }\n} // Function to render everything for a frame at once\n// This is to improve performance\n// See above for comments on how things are donw\n\n\nfunction _renderEntireFrame() {\n  // Scanline needs to be in sync while we draw, thus, we can't shortcut anymore than here\n  for (var i = 0; i <= 144; ++i) {\n    _drawScanline(i);\n  }\n} // Function to get the start of a RGB pixel (R, G, B)\n// Inlined because closure compiler inlines\n\n\nfunction getRgbPixelStart(x, y) {\n  // Get the pixel number\n  // let pixelNumber: i32 = (y * 160) + x;\n  // Each pixel takes 3 slots, therefore, multiply by 3!\n  return (y * 160 + x) * 3;\n} // Also need to store current frame in memory to be read by JS\n\n\nfunction setPixelOnFrame(x, y, colorId, color) {\n  // Currently only supports 160x144\n  // Storing in X, then y\n  // So need an offset\n  store(FRAME_LOCATION + getRgbPixelStart(x, y) + colorId, color);\n} // Function to shortcut the memory map, and load directly from the VRAM Bank\n\n\nfunction loadFromVramBank(gameboyOffset, vramBankId) {\n  var wasmBoyAddress = gameboyOffset - Memory.videoRamLocation + GAMEBOY_INTERNAL_MEMORY_LOCATION + 0x2000 * (vramBankId & 0x01);\n  return load(wasmBoyAddress);\n} // Returns -1 if no trap found, otherwise returns a value that should be fed for the address\n\n\nfunction checkReadTraps(offset) {\n  // Cache globals used multiple times for performance\n  var videoRamLocation = Memory.videoRamLocation; // Try to break early for most common scenario\n\n  if (offset < videoRamLocation) {\n    return -1;\n  } // Check the graphics mode to see if we can read VRAM\n  // http://gbdev.gg8.se/wiki/articles/Video_Display#Accessing_VRAM_and_OAM\n\n\n  if (offset >= videoRamLocation && offset < Memory.cartridgeRamLocation) {\n    // Can only read/write from VRAM During Modes 0 - 2\n    // See graphics/lcd.ts\n    // TODO: This can do more harm than good in a beta emulator,\n    // requres precise timing, disabling for now\n    // if (Graphics.currentLcdMode > 2) {\n    //   return 0xFF;\n    // }\n    return -1;\n  } // ECHO Ram, E000\tFDFF\tMirror of C000~DDFF (ECHO RAM)\n  // http://gbdev.gg8.se/wiki/articles/Memory_Map\n\n\n  if (offset >= Memory.echoRamLocation && offset < Memory.spriteInformationTableLocation) {\n    // Simply return the mirror'd value\n    return eightBitLoadFromGBMemory(offset - 0x2000);\n  } // Check for individal writes\n  // Can only read/write from OAM During Modes 0 - 1\n  // See graphics/lcd.ts\n\n\n  if (offset >= Memory.spriteInformationTableLocation && offset <= Memory.spriteInformationTableLocationEnd) {\n    // Can only read/write from OAM During Mode 2\n    // See graphics/lcd.ts\n    // if (Lcd.currentLcdMode < 2) {\n    // return 0xff;\n    // }\n    // Not batch processing here for performance\n    // batchProcessGraphics();\n    // return -1;\n    return Lcd.currentLcdMode < 2 ? 0xff : -1;\n  } // CPU\n\n\n  if (offset === Cpu.memoryLocationSpeedSwitch) {\n    // TCAGBD, only Bit 7 and 0 are readable, all others are 1\n    var response = 0xff;\n    var currentSpeedSwitchRegister = eightBitLoadFromGBMemory(Cpu.memoryLocationSpeedSwitch);\n\n    if (!checkBitOnByte(0, currentSpeedSwitchRegister)) {\n      response = resetBitOnByte(0, response);\n    }\n\n    if (!Cpu.GBCDoubleSpeed) {\n      response = resetBitOnByte(7, response);\n    }\n\n    return response;\n  } // Graphics\n  // Not batch processing here for performance\n  // batchProcessGraphics();\n\n\n  if (offset === Graphics.memoryLocationScanlineRegister) {\n    eightBitStoreIntoGBMemory(offset, Graphics.scanlineRegister);\n    return Graphics.scanlineRegister;\n  } // Sound\n  // http://gbdev.gg8.se/wiki/articles/Gameboy_sound_hardware#Registers\n  // TODO: Put these bounds on the Sound Class\n\n\n  if (offset >= 0xff10 && offset <= 0xff26) {\n    batchProcessAudio();\n    return SoundRegisterReadTraps(offset);\n  } // FF27 - FF2F not used\n  // Final Wave Table for Channel 3\n\n\n  if (offset >= 0xff30 && offset <= 0xff3f) {\n    batchProcessAudio();\n    return -1;\n  } // Timers\n\n\n  if (offset === Timers.memoryLocationDividerRegister) {\n    // Divider register in memory is just the upper 8 bits\n    // http://gbdev.gg8.se/wiki/articles/Timer_Obscure_Behaviour\n    var upperDividerRegisterBits = splitHighByte(Timers.dividerRegister);\n    eightBitStoreIntoGBMemory(offset, upperDividerRegisterBits);\n    return upperDividerRegisterBits;\n  }\n\n  if (offset === Timers.memoryLocationTimerCounter) {\n    eightBitStoreIntoGBMemory(offset, Timers.timerCounter);\n    return Timers.timerCounter;\n  } // Interrupts\n\n\n  if (offset === Interrupts.memoryLocationInterruptRequest) {\n    // TCAGB and BGB say the top 5 bits are always 1.\n    return 0xe0 | Interrupts.interruptsRequestedValue;\n  } // Joypad\n\n\n  if (offset === Joypad.memoryLocationJoypadRegister) {\n    return getJoypadState();\n  }\n\n  return -1;\n} // Load/Read functionality for memory\n\n\nfunction eightBitLoadFromGBMemory(gameboyOffset) {\n  return load(getWasmBoyOffsetFromGameBoyOffset(gameboyOffset));\n}\n\nfunction eightBitLoadFromGBMemoryWithTraps(offset) {\n  if (offset === Breakpoints.readGbMemory) {\n    Breakpoints.reachedBreakpoint = true;\n  }\n\n  var readTrapResult = checkReadTraps(offset);\n  return readTrapResult === -1 ? eightBitLoadFromGBMemory(offset) : readTrapResult;\n} // TODO: Rename this to sixteenBitLoadFromGBMemoryWithTraps\n// Inlined because closure compiler inlines\n\n\nfunction sixteenBitLoadFromGBMemory(offset) {\n  // Get our low byte\n  var lowByteReadTrapResult = checkReadTraps(offset);\n  var lowByte = lowByteReadTrapResult === -1 ? eightBitLoadFromGBMemory(offset) : lowByteReadTrapResult; // Get the next offset for the second byte\n\n  var nextOffset = offset + 1; // Get our high byte\n\n  var highByteReadTrapResult = checkReadTraps(nextOffset);\n  var highByte = highByteReadTrapResult === -1 ? eightBitLoadFromGBMemory(nextOffset) : highByteReadTrapResult; // Concatenate the bytes and return\n\n  return concatenateBytes(highByte, lowByte);\n}\n\nfunction loadBooleanDirectlyFromWasmMemory(offset) {\n  return load(offset) > 0;\n} // WasmBoy memory map:\n\n\nvar Memory =\n/** @class */\nfunction () {\n  function Memory() {} // Function to save the state of the class\n\n\n  Memory.saveState = function () {\n    store(getSaveStateMemoryOffset(0x00, Memory.saveStateSlot), Memory.currentRomBank);\n    store(getSaveStateMemoryOffset(0x02, Memory.saveStateSlot), Memory.currentRamBank);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x04, Memory.saveStateSlot), Memory.isRamBankingEnabled);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x05, Memory.saveStateSlot), Memory.isMBC1RomModeEnabled);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x06, Memory.saveStateSlot), Memory.isRomOnly);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x07, Memory.saveStateSlot), Memory.isMBC1);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x08, Memory.saveStateSlot), Memory.isMBC2);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x09, Memory.saveStateSlot), Memory.isMBC3);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x0a, Memory.saveStateSlot), Memory.isMBC5);\n  }; // Function to load the save state from memory\n\n\n  Memory.loadState = function () {\n    Memory.currentRomBank = load(getSaveStateMemoryOffset(0x00, Memory.saveStateSlot));\n    Memory.currentRamBank = load(getSaveStateMemoryOffset(0x02, Memory.saveStateSlot));\n    Memory.isRamBankingEnabled = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x04, Memory.saveStateSlot));\n    Memory.isMBC1RomModeEnabled = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x05, Memory.saveStateSlot));\n    Memory.isRomOnly = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x06, Memory.saveStateSlot));\n    Memory.isMBC1 = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x07, Memory.saveStateSlot));\n    Memory.isMBC2 = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x08, Memory.saveStateSlot));\n    Memory.isMBC3 = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x09, Memory.saveStateSlot));\n    Memory.isMBC5 = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x0a, Memory.saveStateSlot));\n  }; // ----------------------------------\n  // Gameboy Memory Map\n  // ----------------------------------\n  // https://github.com/AntonioND/giibiiadvance/blob/master/docs/TCAGBD.pdf\n  // http://gameboy.mongenel.com/dmg/asmmemmap.html\n  // using Arrays, first index is start, second is end\n\n\n  Memory.cartridgeRomLocation = 0x0000;\n  Memory.switchableCartridgeRomLocation = 0x4000;\n  Memory.videoRamLocation = 0x8000;\n  Memory.cartridgeRamLocation = 0xa000;\n  Memory.internalRamBankZeroLocation = 0xc000; // This ram bank is switchable\n\n  Memory.internalRamBankOneLocation = 0xd000;\n  Memory.echoRamLocation = 0xe000;\n  Memory.spriteInformationTableLocation = 0xfe00;\n  Memory.spriteInformationTableLocationEnd = 0xfe9f;\n  Memory.unusableMemoryLocation = 0xfea0;\n  Memory.unusableMemoryEndLocation = 0xfeff; // Hardware I/O, 0xFF00 -> 0xFF7F\n  // Zero Page, 0xFF80 -> 0xFFFE\n  // Intterupt Enable Flag, 0xFFFF\n  // ----------------------------------\n  // Rom/Ram Banking\n  // ----------------------------------\n  // http://gbdev.gg8.se/wiki/articles/Memory_Bank_Controllers#MBC3_.28max_2MByte_ROM_and.2For_32KByte_RAM_and_Timer.29\n  // http://www.codeslinger.co.uk/pages/projects/gameboy/banking.html\n\n  Memory.currentRomBank = 0x00;\n  Memory.currentRamBank = 0x00;\n  Memory.isRamBankingEnabled = false;\n  Memory.isMBC1RomModeEnabled = true; // Cartridge Types\n  // http://gbdev.gg8.se/wiki/articles/The_Cartridge_Header\n\n  Memory.isRomOnly = true;\n  Memory.isMBC1 = false;\n  Memory.isMBC2 = false;\n  Memory.isMBC3 = false;\n  Memory.isMBC5 = false; // DMA\n\n  Memory.memoryLocationHdmaSourceHigh = 0xff51;\n  Memory.memoryLocationHdmaSourceLow = 0xff52;\n  Memory.memoryLocationHdmaDestinationHigh = 0xff53;\n  Memory.memoryLocationHdmaDestinationLow = 0xff54;\n  Memory.memoryLocationHdmaTrigger = 0xff55; // Cycles accumulated for DMA\n\n  Memory.DMACycles = 0; // Boolean we will mirror to indicate if Hdma is active\n\n  Memory.isHblankHdmaActive = false;\n  Memory.hblankHdmaTransferLengthRemaining = 0x00; // Store the source and destination for performance, and update as needed\n\n  Memory.hblankHdmaSource = 0x00;\n  Memory.hblankHdmaDestination = 0x00; // GBC Registers\n\n  Memory.memoryLocationGBCVRAMBank = 0xff4f;\n  Memory.memoryLocationGBCWRAMBank = 0xff70; // Save States\n\n  Memory.saveStateSlot = 4;\n  return Memory;\n}(); // Inlined because closure compiler inlines\n\n\nfunction initializeCartridge() {\n  // Reset stateful variables\n  Memory.isRamBankingEnabled = false;\n  Memory.isMBC1RomModeEnabled = true; // Get our game MBC type from the cartridge header\n  // http://gbdev.gg8.se/wiki/articles/The_Cartridge_Header\n\n  var cartridgeType = eightBitLoadFromGBMemory(0x0147); // Reset our Cartridge types\n\n  Memory.isRomOnly = cartridgeType === 0x00;\n  Memory.isMBC1 = cartridgeType >= 0x01 && cartridgeType <= 0x03;\n  Memory.isMBC2 = cartridgeType >= 0x05 && cartridgeType <= 0x06;\n  Memory.isMBC3 = cartridgeType >= 0x0f && cartridgeType <= 0x13;\n  Memory.isMBC5 = cartridgeType >= 0x19 && cartridgeType <= 0x1e;\n  Memory.currentRomBank = 0x01;\n  Memory.currentRamBank = 0x00;\n} // WasmBoy memory map:\n// Everything Static as class instances just aren't quite there yet\n// https://github.com/AssemblyScript/assemblyscript/blob/master/tests/compiler/showcase.ts\n\n\nvar Cpu =\n/** @class */\nfunction () {\n  function Cpu() {}\n\n  Cpu.CLOCK_SPEED = function () {\n    // 2^23, thanks binji!\n    // return Cpu.GBCDoubleSpeed ? 8388608 : 4194304;\n    return 4194304 << Cpu.GBCDoubleSpeed;\n  }; // Cycles Per Frame = Clock Speed / fps\n  // So: 4194304 / 59.73\n\n\n  Cpu.MAX_CYCLES_PER_FRAME = function () {\n    // return Cpu.GBCDoubleSpeed ? 140448 : 70224;\n    return 70224 << Cpu.GBCDoubleSpeed;\n  }; // See section 4.10 of TCAGBD\n  // Cpu Halting explained: https://www.reddit.com/r/EmuDev/comments/5ie3k7/infinite_loop_trying_to_pass_blarggs_interrupt/db7xnbe/\n\n\n  Cpu.enableHalt = function () {\n    if (Interrupts.masterInterruptSwitch) {\n      Cpu.isHaltNormal = true;\n      return;\n    }\n\n    var haltTypeValue = Interrupts.interruptsEnabledValue & Interrupts.interruptsRequestedValue & 0x1f;\n\n    if (haltTypeValue === 0) {\n      Cpu.isHaltNoJump = true;\n      return;\n    }\n\n    Cpu.isHaltBug = true;\n  };\n\n  Cpu.exitHaltAndStop = function () {\n    Cpu.isHaltNoJump = false;\n    Cpu.isHaltNormal = false;\n    Cpu.isHaltBug = false;\n    Cpu.isStopped = false;\n  };\n\n  Cpu.isHalted = function () {\n    return Cpu.isHaltNormal || Cpu.isHaltNoJump;\n  }; // Function to save the state of the class\n\n\n  Cpu.saveState = function () {\n    // Registers\n    store(getSaveStateMemoryOffset(0x00, Cpu.saveStateSlot), Cpu.registerA);\n    store(getSaveStateMemoryOffset(0x01, Cpu.saveStateSlot), Cpu.registerB);\n    store(getSaveStateMemoryOffset(0x02, Cpu.saveStateSlot), Cpu.registerC);\n    store(getSaveStateMemoryOffset(0x03, Cpu.saveStateSlot), Cpu.registerD);\n    store(getSaveStateMemoryOffset(0x04, Cpu.saveStateSlot), Cpu.registerE);\n    store(getSaveStateMemoryOffset(0x05, Cpu.saveStateSlot), Cpu.registerH);\n    store(getSaveStateMemoryOffset(0x06, Cpu.saveStateSlot), Cpu.registerL);\n    store(getSaveStateMemoryOffset(0x07, Cpu.saveStateSlot), Cpu.registerF);\n    store(getSaveStateMemoryOffset(0x08, Cpu.saveStateSlot), Cpu.stackPointer);\n    store(getSaveStateMemoryOffset(0x0a, Cpu.saveStateSlot), Cpu.programCounter);\n    store(getSaveStateMemoryOffset(0x0c, Cpu.saveStateSlot), Cpu.currentCycles);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x11, Cpu.saveStateSlot), Cpu.isHaltNormal);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x12, Cpu.saveStateSlot), Cpu.isHaltNoJump);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x13, Cpu.saveStateSlot), Cpu.isHaltBug);\n    storeBooleanDirectlyToWasmMemory(getSaveStateMemoryOffset(0x14, Cpu.saveStateSlot), Cpu.isStopped);\n  }; // Function to load the save state from memory\n\n\n  Cpu.loadState = function () {\n    // Registers\n    Cpu.registerA = load(getSaveStateMemoryOffset(0x00, Cpu.saveStateSlot));\n    Cpu.registerB = load(getSaveStateMemoryOffset(0x01, Cpu.saveStateSlot));\n    Cpu.registerC = load(getSaveStateMemoryOffset(0x02, Cpu.saveStateSlot));\n    Cpu.registerD = load(getSaveStateMemoryOffset(0x03, Cpu.saveStateSlot));\n    Cpu.registerE = load(getSaveStateMemoryOffset(0x04, Cpu.saveStateSlot));\n    Cpu.registerH = load(getSaveStateMemoryOffset(0x05, Cpu.saveStateSlot));\n    Cpu.registerL = load(getSaveStateMemoryOffset(0x06, Cpu.saveStateSlot));\n    Cpu.registerF = load(getSaveStateMemoryOffset(0x07, Cpu.saveStateSlot));\n    Cpu.stackPointer = load(getSaveStateMemoryOffset(0x08, Cpu.saveStateSlot));\n    Cpu.programCounter = load(getSaveStateMemoryOffset(0x0a, Cpu.saveStateSlot));\n    Cpu.currentCycles = load(getSaveStateMemoryOffset(0x0c, Cpu.saveStateSlot));\n    Cpu.isHaltNormal = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x11, Cpu.saveStateSlot));\n    Cpu.isHaltNoJump = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x12, Cpu.saveStateSlot));\n    Cpu.isHaltBug = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x13, Cpu.saveStateSlot));\n    Cpu.isStopped = loadBooleanDirectlyFromWasmMemory(getSaveStateMemoryOffset(0x14, Cpu.saveStateSlot));\n  }; // Status to track if we are in Gameboy Color Mode, and GBC State\n\n\n  Cpu.GBCEnabled = false; // Memory Location for the GBC Speed switch\n  // And the current status\n\n  Cpu.memoryLocationSpeedSwitch = 0xff4d;\n  Cpu.GBCDoubleSpeed = false; // 8-bit Cpu.registers\n\n  Cpu.registerA = 0;\n  Cpu.registerB = 0;\n  Cpu.registerC = 0;\n  Cpu.registerD = 0;\n  Cpu.registerE = 0;\n  Cpu.registerH = 0;\n  Cpu.registerL = 0;\n  Cpu.registerF = 0; // 16-bit Cpu.registers\n\n  Cpu.stackPointer = 0; // Boot rom from 0x00 to 0x99, all games start at 0x100\n\n  Cpu.programCounter = 0x00; // Current number of cycles, shouldn't execeed max number of cycles\n\n  Cpu.currentCycles = 0; // HALT and STOP instructions need to stop running opcodes, but simply check timers\n  // https://github.com/nakardo/node-gameboy/blob/master/lib/cpu/opcodes.js\n  // Matt said is should work to, so it must work!\n  // TCAGBD shows three different HALT states. Therefore, we need to handle each\n\n  Cpu.isHaltNormal = false;\n  Cpu.isHaltNoJump = false;\n  Cpu.isHaltBug = false;\n  Cpu.isStopped = false; // Save States\n\n  Cpu.saveStateSlot = 0;\n  return Cpu;\n}(); // Inlined because closure compiler does so\n\n\nfunction initializeCpu() {\n  // Reset all stateful Cpu variables\n  // Cpu.GBCEnabled is done by core/initialize\n  Cpu.GBCDoubleSpeed = false;\n  Cpu.registerA = 0;\n  Cpu.registerB = 0;\n  Cpu.registerC = 0;\n  Cpu.registerD = 0;\n  Cpu.registerE = 0;\n  Cpu.registerH = 0;\n  Cpu.registerL = 0;\n  Cpu.registerF = 0;\n  Cpu.stackPointer = 0;\n  Cpu.programCounter = 0x00;\n  Cpu.currentCycles = 0;\n  Cpu.isHaltNormal = false;\n  Cpu.isHaltNoJump = false;\n  Cpu.isHaltBug = false;\n  Cpu.isStopped = false;\n\n  if (Cpu.GBCEnabled) {\n    // CPU Registers\n    Cpu.registerA = 0x11;\n    Cpu.registerF = 0x80;\n    Cpu.registerB = 0x00;\n    Cpu.registerC = 0x00;\n    Cpu.registerD = 0xff;\n    Cpu.registerE = 0x56;\n    Cpu.registerH = 0x00;\n    Cpu.registerL = 0x0d;\n  } else {\n    // Cpu Registers\n    Cpu.registerA = 0x01;\n    Cpu.registerF = 0xb0;\n    Cpu.registerB = 0x00;\n    Cpu.registerC = 0x13;\n    Cpu.registerD = 0x00;\n    Cpu.registerE = 0xd8;\n    Cpu.registerH = 0x01;\n    Cpu.registerL = 0x4d;\n  } // Cpu Control Flow\n\n\n  Cpu.programCounter = 0x100;\n  Cpu.stackPointer = 0xfffe;\n} // Imports\n// General Logic Instructions\n// Such as the ones found on the CB table and 0x40 - 0xBF\n// NOTE: Only CB table uses these for now, was mostly me realizing that I messed up, trying to be all cute and verbose :p\n// NOTE: TODO: Refactor honestly shouldn't take that long, and may happen once assembly script is improved\n\n\nfunction addARegister(register) {\n  var registerA = Cpu.registerA;\n  checkAndSetEightBitHalfCarryFlag(registerA, register);\n  checkAndSetEightBitCarryFlag(registerA, register);\n  registerA = u8Portable(registerA + register);\n  Cpu.registerA = registerA;\n  setZeroFlag$$1(registerA === 0);\n  setSubtractFlag(0);\n}\n\nfunction addAThroughCarryRegister(register) {\n  // Handling flags manually as they require some special overflow\n  // From: https://github.com/nakardo/node-gameboy/blob/master/lib/cpu/opcodes.js\n  // CTRL+F adc\n  var registerA = Cpu.registerA;\n  var result = u8Portable(registerA + register + getCarryFlag$$1());\n  setHalfCarryFlag((u8Portable(registerA ^ register ^ result) & 0x10) != 0);\n  var overflowedResult = u16Portable(registerA + register + getCarryFlag$$1());\n  setCarryFlag((overflowedResult & 0x100) > 0);\n  Cpu.registerA = result;\n  setZeroFlag$$1(result === 0);\n  setSubtractFlag(0);\n}\n\nfunction subARegister(register) {\n  // Need to convert the register on one line, and flip the sign on another\n  var negativeRegister = register;\n  negativeRegister = negativeRegister * -1;\n  var registerA = Cpu.registerA;\n  checkAndSetEightBitHalfCarryFlag(registerA, negativeRegister);\n  checkAndSetEightBitCarryFlag(registerA, negativeRegister);\n  registerA = u8Portable(registerA - register);\n  Cpu.registerA = registerA;\n  setZeroFlag$$1(registerA === 0);\n  setSubtractFlag(1);\n}\n\nfunction subAThroughCarryRegister(register) {\n  // Handling flags manually as they require some special overflow\n  // From: https://github.com/nakardo/node-gameboy/blob/master/lib/cpu/opcodes.js\n  // CTRL+F adc\n  var registerA = Cpu.registerA;\n  var result = u8Portable(registerA - register - getCarryFlag$$1());\n  var carryRegisterCheck = u8Portable((registerA ^ register ^ result) & 0x10);\n  setHalfCarryFlag(carryRegisterCheck != 0);\n  var overflowedResult = u16Portable(registerA - register - getCarryFlag$$1());\n  setCarryFlag((overflowedResult & 0x100) > 0);\n  Cpu.registerA = result;\n  setZeroFlag$$1(result === 0);\n  setSubtractFlag(1);\n}\n\nfunction andARegister(register) {\n  var registerA = Cpu.registerA & register;\n  Cpu.registerA = registerA;\n  setZeroFlag$$1(registerA === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(1);\n  setCarryFlag(0);\n}\n\nfunction xorARegister(register) {\n  var registerA = u8Portable(Cpu.registerA ^ register);\n  Cpu.registerA = registerA;\n  setZeroFlag$$1(registerA === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0);\n  setCarryFlag(0);\n}\n\nfunction orARegister(register) {\n  var registerA = Cpu.registerA | register;\n  Cpu.registerA = registerA;\n  setZeroFlag$$1(registerA === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0);\n  setCarryFlag(0);\n}\n\nfunction cpARegister(register) {\n  // 0xB8 - 0xBF\n  // CP B\n  // 1  4\n  // Z 1 H C\n  var registerA = Cpu.registerA;\n  var negativeRegister = register;\n  negativeRegister = negativeRegister * -1;\n  checkAndSetEightBitHalfCarryFlag(registerA, negativeRegister);\n  checkAndSetEightBitCarryFlag(registerA, negativeRegister);\n  var tempResult = registerA + negativeRegister;\n  setZeroFlag$$1(tempResult === 0);\n  setSubtractFlag(1);\n} // Inlined because closure compiler inlines\n\n\nfunction rotateRegisterLeft(register) {\n  // RLC register 8-bit\n  // Z 0 0 C\n  setCarryFlag((register & 0x80) === 0x80);\n  register = rotateByteLeft(register);\n  setZeroFlag$$1(register === 0); // Set all other flags to zero\n\n  setSubtractFlag(0);\n  setHalfCarryFlag(0); // Return the register\n\n  return register;\n} // Inlined because closure compiler inlines\n\n\nfunction rotateRegisterRight(register) {\n  // RLC register 8-bit\n  // Z 0 0 C\n  // Check for the last bit, to see if it will be carried\n  setCarryFlag((register & 0x01) > 0);\n  register = rotateByteRight(register);\n  setZeroFlag$$1(register === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0); // Return the register\n\n  return register;\n} // Inlined because closure compiler inlines\n\n\nfunction rotateRegisterLeftThroughCarry(register) {\n  // RL register 8-bit\n  // Z 0 0 C\n  // setting has first bit since we need to use carry\n  var hasHighbit = (register & 0x80) === 0x80;\n  register = rotateByteLeftThroughCarry(register);\n  setCarryFlag(hasHighbit);\n  setZeroFlag$$1(register === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0);\n  return register;\n} // Inlined because closure compiler inlines\n\n\nfunction rotateRegisterRightThroughCarry(register) {\n  // RR register 8-bit\n  // Z 0 0 C\n  var hasLowBit = (register & 0x01) === 0x01;\n  register = rotateByteRightThroughCarry(register);\n  setCarryFlag(hasLowBit);\n  setZeroFlag$$1(register === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0);\n  return register;\n} // Inlined because closure compiler inlines\n\n\nfunction shiftLeftRegister(register) {\n  // SLA register 8-bit\n  // Z 0 0 C\n  var hasHighbit = (register & 0x80) === 0x80;\n  register = u8Portable(register << 1);\n  setCarryFlag(hasHighbit);\n  setZeroFlag$$1(register === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0);\n  return register;\n} // Inlined because closure compiler inlines\n\n\nfunction shiftRightArithmeticRegister(register) {\n  // SRA register 8-bit\n  // Z 0 0 C\n  // NOTE: This C flag may need to be set to 0;\n  // This preserves the MSB (Most significant bit)\n  var hasHighbit = (register & 0x80) === 0x80;\n  var hasLowbit = (register & 0x01) === 0x01;\n  register = u8Portable(register >> 1);\n\n  if (hasHighbit) {\n    register = register | 0x80;\n  }\n\n  setZeroFlag$$1(register === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0);\n  setCarryFlag(hasLowbit);\n  return register;\n} // Inlined because closure compiler inlines\n\n\nfunction swapNibblesOnRegister(register) {\n  // SWAP register 8-bit\n  // Z 0 0 0\n  var highNibble = register & 0xf0;\n  var lowNibble = register & 0x0f;\n  register = u8Portable(lowNibble << 4 | highNibble >> 4);\n  setZeroFlag$$1(register === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0);\n  setCarryFlag(0);\n  return register;\n} // Inlined because closure compiler inlines\n\n\nfunction shiftRightLogicalRegister(register) {\n  // SRA register 8-bit\n  // Z 0 0 C\n  // NOTE: This C flag may need to be set to 0;\n  // This does NOT preserve MSB (most significant bit)\n  var hasLowbit = (register & 0x01) === 0x01;\n  register = u8Portable(register >> 1);\n  setZeroFlag$$1(register === 0);\n  setSubtractFlag(0);\n  setHalfCarryFlag(0);\n  setCarryFlag(hasLowbit);\n  return register;\n}\n\nfunction testBitOnRegister(bitPosition, register) {\n  // BIT bitPosition ,register 8-bit\n  // Z 0 1 -\n  var testByte = 0x01 << bitPosition;\n  var result = register & testByte;\n  setZeroFlag$$1(result === 0x00);\n  setSubtractFlag(0);\n  setHalfCarryFlag(1);\n  return register;\n}\n\nfunction setBitOnRegister(bitPosition, bitValue, register) {\n  // RES 0,B or SET 0,B depending on bit value\n  if (bitValue > 0) {\n    var setByte = 0x01 << bitPosition;\n    register = register | setByte;\n  } else {\n    // NOT (byte we want)\n    // 0000 0100 becomes 1111 1011\n    var setByte = ~(0x01 << bitPosition);\n    register = register & setByte;\n  }\n\n  return register;\n} // Private function for our relative jumps\n\n\nfunction relativeJump(value) {\n  // Need to convert the value to i8, since in this case, u8 can be negative\n  var relativeJumpOffset = i8Portable(value);\n  var programCounter = Cpu.programCounter;\n  programCounter = u16Portable(programCounter + relativeJumpOffset); // Realtive jump, using bgb debugger\n  // and my debugger shows,\n  // on JR you need to jump to the relative jump offset,\n  // However, if the jump fails (such as conditional), only jump +2 in total\n\n  programCounter = u16Portable(programCounter + 1);\n  Cpu.programCounter = programCounter;\n} // Imports\n// Handle CB Opcodes\n// NOTE: Program stpes and cycles are standardized depending on the register type\n// NOTE: Doing some funny stuff to get around not having arrays or objects\n// Inlined because closure compiler inlines.\n\n\nfunction handleCbOpcode(cbOpcode) {\n  var numberOfCycles = -1;\n  var handledOpcode = false; // The result of our cb logic instruction\n\n  var instructionRegisterValue = 0;\n  var instructionRegisterResult = 0; // Get our register number by modulo 0x08 (number of registers)\n  // cbOpcode % 0x08\n\n  var registerNumber = cbOpcode & 0x07; // NOTE: registerNumber = register on CB table. Cpu.registerB = 0, Cpu.registerC = 1....Cpu.registerA = 7\n\n  switch (registerNumber) {\n    case 0:\n      instructionRegisterValue = Cpu.registerB;\n      break;\n\n    case 1:\n      instructionRegisterValue = Cpu.registerC;\n      break;\n\n    case 2:\n      instructionRegisterValue = Cpu.registerD;\n      break;\n\n    case 3:\n      instructionRegisterValue = Cpu.registerE;\n      break;\n\n    case 4:\n      instructionRegisterValue = Cpu.registerH;\n      break;\n\n    case 5:\n      instructionRegisterValue = Cpu.registerL;\n      break;\n\n    case 6:\n      // Value at register HL\n      // 4 cycles\n      instructionRegisterValue = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      break;\n\n    case 7:\n      instructionRegisterValue = Cpu.registerA;\n      break;\n  } // Grab the high nibble to perform skips to speed up performance\n\n\n  var opcodeHighNibble = cbOpcode & 0xf0;\n  opcodeHighNibble = opcodeHighNibble >> 4; // Send to the correct function\n\n  switch (opcodeHighNibble) {\n    case 0x00:\n      if (cbOpcode <= 0x07) {\n        // RLC register 8-bit\n        // Z 0 0 C\n        instructionRegisterResult = rotateRegisterLeft(instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x0f) {\n        // RRC register 8-bit\n        // Z 0 0 C\n        instructionRegisterResult = rotateRegisterRight(instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x01:\n      if (cbOpcode <= 0x17) {\n        // RL register 8-bit\n        // Z 0 0 C\n        instructionRegisterResult = rotateRegisterLeftThroughCarry(instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x1f) {\n        // RR register 8-bit\n        // Z 0 0 C\n        instructionRegisterResult = rotateRegisterRightThroughCarry(instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x02:\n      if (cbOpcode <= 0x27) {\n        // SLA register 8-bit\n        // Z 0 0 C\n        instructionRegisterResult = shiftLeftRegister(instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x2f) {\n        // SRA register 8-bit\n        // Z 0 0 0\n        instructionRegisterResult = shiftRightArithmeticRegister(instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x03:\n      if (cbOpcode <= 0x37) {\n        // SWAP register 8-bit\n        // Z 0 0 0\n        instructionRegisterResult = swapNibblesOnRegister(instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x3f) {\n        // SRL B\n        // Z 0 0 C\n        instructionRegisterResult = shiftRightLogicalRegister(instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x04:\n      if (cbOpcode <= 0x47) {\n        // BIT 0,register 8-bit\n        // Z 0 1 -\n        //TODO: Optimize this not to do logic of setting register back\n        instructionRegisterResult = testBitOnRegister(0, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x4f) {\n        // BIT 1,register 8-bit\n        // Z 0 1 -\n        instructionRegisterResult = testBitOnRegister(1, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x05:\n      if (cbOpcode <= 0x57) {\n        // BIT 2,register 8-bit\n        // Z 0 1 -\n        instructionRegisterResult = testBitOnRegister(2, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x5f) {\n        // BIT 3,register 8-bit\n        // Z 0 1 -\n        instructionRegisterResult = testBitOnRegister(3, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x06:\n      if (cbOpcode <= 0x67) {\n        // BIT 4,register 8-bit\n        // Z 0 1 -\n        instructionRegisterResult = testBitOnRegister(4, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x6f) {\n        // BIT 5,register 8-bit\n        // Z 0 1 -\n        instructionRegisterResult = testBitOnRegister(5, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x07:\n      if (cbOpcode <= 0x77) {\n        // BIT 6,register 8-bit\n        // Z 0 1 -\n        instructionRegisterResult = testBitOnRegister(6, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x7f) {\n        // BIT 7,register 8-bit\n        // Z 0 1 -\n        instructionRegisterResult = testBitOnRegister(7, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x08:\n      if (cbOpcode <= 0x87) {\n        // Res 0,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(0, 0, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x8f) {\n        // Res 1,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(1, 0, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x09:\n      if (cbOpcode <= 0x97) {\n        // Res 2,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(2, 0, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0x9f) {\n        // Res 3,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(3, 0, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x0a:\n      if (cbOpcode <= 0xa7) {\n        // Res 4,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(4, 0, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0xaf) {\n        // Res 5,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(5, 0, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x0b:\n      if (cbOpcode <= 0xb7) {\n        // Res 6,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(6, 0, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0xbf) {\n        // Res 7,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(7, 0, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x0c:\n      if (cbOpcode <= 0xc7) {\n        // SET 0,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(0, 1, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0xcf) {\n        // SET 1,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(1, 1, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x0d:\n      if (cbOpcode <= 0xd7) {\n        // SET 2,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(2, 1, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0xdf) {\n        // SET 3,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(3, 1, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x0e:\n      if (cbOpcode <= 0xe7) {\n        // SET 4,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(4, 1, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0xef) {\n        // SET 5,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(5, 1, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n\n    case 0x0f:\n      if (cbOpcode <= 0xf7) {\n        // SET 6,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(6, 1, instructionRegisterValue);\n        handledOpcode = true;\n      } else if (cbOpcode <= 0xff) {\n        // SET 7,register 8-bit\n        // - - - -\n        instructionRegisterResult = setBitOnRegister(7, 1, instructionRegisterValue);\n        handledOpcode = true;\n      }\n\n      break;\n  } // Finally Pass back into the correct register\n\n\n  switch (registerNumber) {\n    case 0:\n      Cpu.registerB = instructionRegisterResult;\n      break;\n\n    case 1:\n      Cpu.registerC = instructionRegisterResult;\n      break;\n\n    case 2:\n      Cpu.registerD = instructionRegisterResult;\n      break;\n\n    case 3:\n      Cpu.registerE = instructionRegisterResult;\n      break;\n\n    case 4:\n      Cpu.registerH = instructionRegisterResult;\n      break;\n\n    case 5:\n      Cpu.registerL = instructionRegisterResult;\n      break;\n\n    case 6:\n      // Value at register HL\n      // Opcodes 0x40 -> 0x7F only do simple\n      // Bit test, and don't need to be stored back in memory\n      // Thus they take 4 less cycles to run\n      if (opcodeHighNibble < 0x04 || opcodeHighNibble > 0x07) {\n        // Store the result back\n        // 4 cycles\n        eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), instructionRegisterResult);\n      }\n\n      break;\n\n    case 7:\n      Cpu.registerA = instructionRegisterResult;\n      break;\n  } // Finally our number of cycles\n  // Set if we handled the opcode\n\n\n  if (handledOpcode) {\n    numberOfCycles = 4;\n  } // Return our number of cycles\n\n\n  return numberOfCycles;\n} // Imports\n// Take in any opcode, and decode it, and return the number of cycles\n// Program counter can be gotten from getProgramCounter();\n// Setting return value to i32 instead of u16, as we want to return a negative number on error\n// https://rednex.github.io/rgbds/gbz80.7.html\n// http://pastraiser.com/cpu/gameboy/gameboyopcodes.html\n\n\nfunction executeOpcode$$1(opcode) {\n  // Always implement the program counter by one\n  // Any other value can just subtract or add however much offset before reaching this line\n  var programCounter = Cpu.programCounter;\n  programCounter = u16Portable(programCounter + 1); // Check if we are in the halt bug\n\n  if (Cpu.isHaltBug) {\n    // Need to not increment program counter,\n    // thus, running the next opcode twice\n    // E.g\n    // 0x76 - halt\n    // FA 34 12 - ld a,(1234)\n    // Becomes\n    // FA FA 34 ld a,(34FA)\n    // 12 ld (de),a\n    programCounter = u16Portable(programCounter - 1);\n  }\n\n  Cpu.programCounter = programCounter; // Split our opcode into a high nibble to speed up performance\n  // Running 255 if statements is slow, even in wasm haha!\n\n  var opcodeHighNibble = opcode & 0xf0;\n  opcodeHighNibble = opcodeHighNibble >> 4; // NOTE: @binji rule of thumb: it takes 4 cpu cycles to read one byte\n  // Therefore isntructions that use more than just the opcode (databyte one and two) will take at least\n  // 8 cyckles to use getDataByteOne(), and two cycles to use the concatented\n  // Not using a switch statement to avoid cannot redeclare this variable errors\n  // And it would be a ton of work :p\n\n  switch (opcodeHighNibble) {\n    case 0x00:\n      return handleOpcode0x(opcode);\n\n    case 0x01:\n      return handleOpcode1x(opcode);\n\n    case 0x02:\n      return handleOpcode2x(opcode);\n\n    case 0x03:\n      return handleOpcode3x(opcode);\n\n    case 0x04:\n      return handleOpcode4x(opcode);\n\n    case 0x05:\n      return handleOpcode5x(opcode);\n\n    case 0x06:\n      return handleOpcode6x(opcode);\n\n    case 0x07:\n      return handleOpcode7x(opcode);\n\n    case 0x08:\n      return handleOpcode8x(opcode);\n\n    case 0x09:\n      return handleOpcode9x(opcode);\n\n    case 0x0a:\n      return handleOpcodeAx(opcode);\n\n    case 0x0b:\n      return handleOpcodeBx(opcode);\n\n    case 0x0c:\n      return handleOpcodeCx(opcode);\n\n    case 0x0d:\n      return handleOpcodeDx(opcode);\n\n    case 0x0e:\n      return handleOpcodeEx(opcode);\n\n    default:\n      return handleOpcodeFx(opcode);\n  }\n} // Wrapper functions around loading and storing memory, and syncing those cycles\n\n\nfunction eightBitLoadSyncCycles(gameboyOffset) {\n  syncCycles(4);\n  return eightBitLoadFromGBMemoryWithTraps(gameboyOffset);\n}\n\nfunction eightBitStoreSyncCycles(gameboyOffset, value) {\n  syncCycles(4);\n  eightBitStoreIntoGBMemoryWithTraps(gameboyOffset, value);\n}\n\nfunction sixteenBitLoadSyncCycles(gameboyOffset) {\n  syncCycles(8); // sixteen bit load has traps even though it has no label\n\n  return sixteenBitLoadFromGBMemory(gameboyOffset);\n}\n\nfunction sixteenBitStoreSyncCycles(gameboyOffset, value) {\n  syncCycles(8);\n  sixteenBitStoreIntoGBMemoryWithTraps(gameboyOffset, value);\n} // Functions to access the next operands of a opcode, reffering to them as \"dataBytes\"\n\n\nfunction getDataByteOne() {\n  syncCycles(4);\n  return eightBitLoadFromGBMemory(Cpu.programCounter);\n}\n\nfunction getDataByteTwo() {\n  syncCycles(4);\n  return eightBitLoadFromGBMemory(u16Portable(Cpu.programCounter + 1));\n} // Get our concatenated databyte one and getDataByteTwo()\n// Find and replace with : getConcatenatedDataByte()\n\n\nfunction getConcatenatedDataByte() {\n  return concatenateBytes(getDataByteTwo(), getDataByteOne());\n}\n\nfunction handleOpcode0x(opcode) {\n  switch (opcode) {\n    case 0x00:\n      // NOP\n      // 1  4\n      // No Operation\n      return 4;\n\n    case 0x01:\n      {\n        // LD BC,d16\n        // 3  12\n        // 8 cycles\n        var concatenatedDataByte = getConcatenatedDataByte();\n        Cpu.registerB = splitHighByte(concatenatedDataByte);\n        Cpu.registerC = splitLowByte(concatenatedDataByte);\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n        return 4;\n      }\n\n    case 0x02:\n      {\n        // LD (BC),A\n        // 1  8\n        // () means load into address pointed by BC\n        // 4 cycles\n        eightBitStoreSyncCycles(concatenateBytes(Cpu.registerB, Cpu.registerC), Cpu.registerA);\n        return 4;\n      }\n\n    case 0x03:\n      {\n        // INC BC\n        // 1  8\n        var registerBC3 = concatenateBytes(Cpu.registerB, Cpu.registerC);\n        registerBC3++;\n        Cpu.registerB = splitHighByte(registerBC3);\n        Cpu.registerC = splitLowByte(registerBC3);\n        return 8;\n      }\n\n    case 0x04:\n      {\n        // INC B\n        // 1  4\n        // Z 0 H -\n        var registerB = Cpu.registerB;\n        checkAndSetEightBitHalfCarryFlag(registerB, 1);\n        registerB = u8Portable(registerB + 1);\n        Cpu.registerB = registerB;\n        setZeroFlag$$1(registerB === 0);\n        setSubtractFlag(0);\n        return 4;\n      }\n\n    case 0x05:\n      {\n        // DEC B\n        // 1  4\n        // Z 1 H -\n        var registerB = Cpu.registerB;\n        checkAndSetEightBitHalfCarryFlag(registerB, -1);\n        registerB = u8Portable(registerB - 1);\n        Cpu.registerB = registerB;\n        setZeroFlag$$1(registerB === 0);\n        setSubtractFlag(1);\n        return 4;\n      }\n\n    case 0x06:\n      {\n        // LD B,d8\n        // 2  8\n        // 4 cycles\n        Cpu.registerB = getDataByteOne();\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x07:\n      {\n        // RLCA\n        // 1  4\n        // 0 0 0 C\n        // Check for the carry\n        var registerA = Cpu.registerA;\n        setCarryFlag((registerA & 0x80) === 0x80);\n        Cpu.registerA = rotateByteLeft(registerA); // Set all other flags to zero\n\n        setZeroFlag$$1(0);\n        setSubtractFlag(0);\n        setHalfCarryFlag(0);\n        return 4;\n      }\n\n    case 0x08:\n      {\n        // LD (a16),SP\n        // 3  20\n        // Load the stack pointer into the 16 bit address represented by the two data bytes\n        // 16 cycles, 8 from data byte, 8 from sixteenbit store\n        sixteenBitStoreSyncCycles(getConcatenatedDataByte(), Cpu.stackPointer);\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n        return 4;\n      }\n\n    case 0x09:\n      {\n        // ADD HL,BC\n        // 1 8\n        // - 0 H C\n        var registerHL = concatenateBytes(Cpu.registerH, Cpu.registerL);\n        var registerBC9 = concatenateBytes(Cpu.registerB, Cpu.registerC);\n        checkAndSetSixteenBitFlagsAddOverflow(registerHL, registerBC9, false);\n        var result = u16Portable(registerHL + registerBC9);\n        Cpu.registerH = splitHighByte(result);\n        Cpu.registerL = splitLowByte(result);\n        setSubtractFlag(0);\n        return 8;\n      }\n\n    case 0x0a:\n      {\n        // LD A,(BC)\n        // 1 8\n        // 4 cycles from load\n        Cpu.registerA = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerB, Cpu.registerC));\n        return 4;\n      }\n\n    case 0x0b:\n      {\n        // DEC BC\n        // 1  8\n        var registerBCB = concatenateBytes(Cpu.registerB, Cpu.registerC);\n        registerBCB = u16Portable(registerBCB - 1);\n        Cpu.registerB = splitHighByte(registerBCB);\n        Cpu.registerC = splitLowByte(registerBCB);\n        return 8;\n      }\n\n    case 0x0c:\n      {\n        // INC C\n        // 1  4\n        // Z 0 H -\n        var registerC = Cpu.registerC;\n        checkAndSetEightBitHalfCarryFlag(registerC, 1);\n        registerC = u8Portable(registerC + 1);\n        Cpu.registerC = registerC;\n        setZeroFlag$$1(registerC === 0);\n        setSubtractFlag(0);\n        return 4;\n      }\n\n    case 0x0d:\n      {\n        // DEC C\n        // 1  4\n        // Z 1 H -\n        var registerC = Cpu.registerC;\n        checkAndSetEightBitHalfCarryFlag(registerC, -1);\n        registerC = u8Portable(registerC - 1);\n        Cpu.registerC = registerC;\n        setZeroFlag$$1(registerC === 0);\n        setSubtractFlag(1);\n        return 4;\n      }\n\n    case 0x0e:\n      {\n        // LD C,d8\n        // 2 8\n        // 4 cycles\n        Cpu.registerC = getDataByteOne();\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x0f:\n      {\n        // RRCA\n        // 1 4\n        // 0 0 0 C\n        // Check for the last bit, to see if it will be carried\n        var registerA = Cpu.registerA;\n        setCarryFlag((registerA & 0x01) > 0);\n        Cpu.registerA = rotateByteRight(registerA); // Set all other flags to zero\n\n        setZeroFlag$$1(0);\n        setSubtractFlag(0);\n        setHalfCarryFlag(0);\n        return 4;\n      }\n  }\n\n  return -1;\n}\n\nfunction handleOpcode1x(opcode) {\n  switch (opcode) {\n    case 0x10:\n      {\n        // STOP 0\n        // 2 4\n        // Enter CPU very low power mode. Also used to switch between double and normal speed CPU modes in GBC.\n        // Meaning Don't Decode anymore opcodes , or updated the LCD until joypad interrupt (or when button is pressed if I am wrong)\n        // See HALT\n        // If we are in gameboy color mode, set the new speed\n        if (Cpu.GBCEnabled) {\n          // 4 cycles\n          var speedSwitch = eightBitLoadSyncCycles(Cpu.memoryLocationSpeedSwitch);\n\n          if (checkBitOnByte(0, speedSwitch)) {\n            // Reset the prepare bit\n            speedSwitch = resetBitOnByte(0, speedSwitch); // Switch to the new mode, and set the speed switch to the OTHER speed, to represent our new speed\n\n            if (!checkBitOnByte(7, speedSwitch)) {\n              Cpu.GBCDoubleSpeed = true;\n              speedSwitch = setBitOnByte(7, speedSwitch);\n            } else {\n              Cpu.GBCDoubleSpeed = false;\n              speedSwitch = resetBitOnByte(7, speedSwitch);\n            } // Store the final speed switch\n            // 4 cycles\n\n\n            eightBitStoreSyncCycles(Cpu.memoryLocationSpeedSwitch, speedSwitch); // Cycle accurate gameboy docs says this takes 76 clocks\n            // 76 - 8 cycles (from load/store) = 68\n\n            return 68;\n          }\n        } // NOTE: This breaks Blarggs CPU tests if CGB Stop is not implemented\n\n\n        Cpu.isStopped = true;\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x11:\n      {\n        // LD DE,d16\n        // 3  12\n        // 8 cycles\n        var concatenatedDataByte = getConcatenatedDataByte();\n        Cpu.registerD = splitHighByte(concatenatedDataByte);\n        Cpu.registerE = splitLowByte(concatenatedDataByte);\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n        return 4;\n      }\n\n    case 0x12:\n      {\n        // LD (DE),A\n        // 1 8\n        // 4 cycles\n        eightBitStoreSyncCycles(concatenateBytes(Cpu.registerD, Cpu.registerE), Cpu.registerA);\n        return 4;\n      }\n\n    case 0x13:\n      {\n        // INC DE\n        // 1 8\n        var registerDE3 = concatenateBytes(Cpu.registerD, Cpu.registerE);\n        registerDE3 = u16Portable(registerDE3 + 1);\n        Cpu.registerD = splitHighByte(registerDE3);\n        Cpu.registerE = splitLowByte(registerDE3);\n        return 8;\n      }\n\n    case 0x14:\n      {\n        // INC D\n        // 1  4\n        // Z 0 H -\n        var registerD = Cpu.registerD;\n        checkAndSetEightBitHalfCarryFlag(registerD, 1);\n        registerD = u8Portable(registerD + 1);\n        Cpu.registerD = registerD;\n        setZeroFlag$$1(Cpu.registerD === 0);\n        setSubtractFlag(0);\n        return 4;\n      }\n\n    case 0x15:\n      {\n        // DEC D\n        // 1  4\n        // Z 1 H -\n        var registerD = Cpu.registerD;\n        checkAndSetEightBitHalfCarryFlag(registerD, -1);\n        registerD = u8Portable(registerD - 1);\n        Cpu.registerD = registerD;\n        setZeroFlag$$1(Cpu.registerD === 0);\n        setSubtractFlag(1);\n        return 4;\n      }\n\n    case 0x16:\n      {\n        // LD D,d8\n        // 2 8\n        // 4 cycles\n        Cpu.registerD = getDataByteOne();\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x17:\n      {\n        // RLA\n        // 1 4\n        // 0 0 0 C\n        // Check for the carry\n        // setting has first bit since we need to use carry\n        var hasHighbit = (Cpu.registerA & 0x80) === 0x80;\n        Cpu.registerA = rotateByteLeftThroughCarry(Cpu.registerA); // OR the carry flag to the end\n\n        setCarryFlag(hasHighbit); // Set all other flags to zero\n\n        setZeroFlag$$1(0);\n        setSubtractFlag(0);\n        setHalfCarryFlag(0);\n        return 4;\n      }\n\n    case 0x18:\n      {\n        // JR r8\n        // 2  12\n        // NOTE: Discoved dataByte is signed\n        // However the relative Jump Function handles this\n        // 4 cycles\n        relativeJump(getDataByteOne());\n        return 8;\n      }\n    // Relative Jump Function Handles program counter\n\n    case 0x19:\n      {\n        // ADD HL,DE\n        // 1  8\n        // - 0 H C\n        var registerHL = concatenateBytes(Cpu.registerH, Cpu.registerL);\n        var registerDE9 = concatenateBytes(Cpu.registerD, Cpu.registerE);\n        checkAndSetSixteenBitFlagsAddOverflow(registerHL, registerDE9, false);\n        var result = u16Portable(registerHL + registerDE9);\n        Cpu.registerH = splitHighByte(result);\n        Cpu.registerL = splitLowByte(result);\n        setSubtractFlag(0);\n        return 8;\n      }\n\n    case 0x1a:\n      {\n        // LD A,(DE)\n        // 1 8\n        var registerDEA = concatenateBytes(Cpu.registerD, Cpu.registerE); // 4 cycles\n\n        Cpu.registerA = eightBitLoadSyncCycles(registerDEA);\n        return 4;\n      }\n\n    case 0x1b:\n      {\n        // DEC DE\n        // 1 8\n        var registerDEB = concatenateBytes(Cpu.registerD, Cpu.registerE);\n        registerDEB = u16Portable(registerDEB - 1);\n        Cpu.registerD = splitHighByte(registerDEB);\n        Cpu.registerE = splitLowByte(registerDEB);\n        return 8;\n      }\n\n    case 0x1c:\n      {\n        // INC E\n        // 1  4\n        // Z 0 H -\n        var registerE = Cpu.registerE;\n        checkAndSetEightBitHalfCarryFlag(registerE, 1);\n        registerE = u8Portable(registerE + 1);\n        Cpu.registerE = registerE;\n        setZeroFlag$$1(registerE === 0);\n        setSubtractFlag(0);\n        return 4;\n      }\n\n    case 0x1d:\n      {\n        // DEC E\n        // 1  4\n        // Z 1 H -\n        var registerE = Cpu.registerE;\n        checkAndSetEightBitHalfCarryFlag(registerE, -1);\n        registerE = u8Portable(registerE - 1);\n        Cpu.registerE = registerE;\n        setZeroFlag$$1(registerE === 0);\n        setSubtractFlag(1);\n        return 4;\n      }\n\n    case 0x1e:\n      {\n        // LD E,d8\n        // 2 8\n        // 4 cycles\n        Cpu.registerE = getDataByteOne();\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x1f:\n      {\n        // RRA\n        // 1 4\n        // 0 0 0 C\n        // Check for the carry\n        // setting has low bit since we need to use carry\n        var hasLowBit = (Cpu.registerA & 0x01) === 0x01;\n        Cpu.registerA = rotateByteRightThroughCarry(Cpu.registerA);\n        setCarryFlag(hasLowBit); // Set all other flags to zero\n\n        setZeroFlag$$1(0);\n        setSubtractFlag(0);\n        setHalfCarryFlag(0);\n        return 4;\n      }\n  }\n\n  return -1;\n}\n\nfunction handleOpcode2x(opcode) {\n  switch (opcode) {\n    case 0x20:\n      {\n        // JR NZ,r8\n        // 2  12/8\n        // NOTE: NZ stands for not [flag], so in this case, not zero flag\n        // Also, / means, if condition. so if met, 12 cycles, otherwise 8 cycles\n        if (getZeroFlag$$1() === 0) {\n          // 4 cycles\n          relativeJump(getDataByteOne()); // Relative Jump Funciton handles program counter\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        }\n\n        return 8;\n      }\n\n    case 0x21:\n      {\n        // LD HL,d16\n        // 3  12\n        // 8 cycles\n        var sixteenBitDataByte = getConcatenatedDataByte();\n        Cpu.registerH = splitHighByte(sixteenBitDataByte);\n        Cpu.registerL = splitLowByte(sixteenBitDataByte);\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n        return 4;\n      }\n\n    case 0x22:\n      {\n        // LD (HL+),A\n        // 1 8\n        var registerHL2 = concatenateBytes(Cpu.registerH, Cpu.registerL); // 4 cycles\n\n        eightBitStoreSyncCycles(registerHL2, Cpu.registerA);\n        registerHL2 = u16Portable(registerHL2 + 1);\n        Cpu.registerH = splitHighByte(registerHL2);\n        Cpu.registerL = splitLowByte(registerHL2);\n        return 4;\n      }\n\n    case 0x23:\n      {\n        // INC HL\n        // 1  8\n        var registerHL3 = concatenateBytes(Cpu.registerH, Cpu.registerL);\n        registerHL3 = u16Portable(registerHL3 + 1);\n        Cpu.registerH = splitHighByte(registerHL3);\n        Cpu.registerL = splitLowByte(registerHL3);\n        return 8;\n      }\n\n    case 0x24:\n      {\n        // INC H\n        // 1  4\n        // Z 0 H -\n        var registerH = Cpu.registerH;\n        checkAndSetEightBitHalfCarryFlag(registerH, 1);\n        registerH = u8Portable(registerH + 1);\n        Cpu.registerH = registerH;\n        setZeroFlag$$1(registerH === 0);\n        setSubtractFlag(0);\n        return 4;\n      }\n\n    case 0x25:\n      {\n        // DEC H\n        // 1  4\n        // Z 1 H -\n        var registerH = Cpu.registerH;\n        checkAndSetEightBitHalfCarryFlag(registerH, -1);\n        registerH = u8Portable(registerH - 1);\n        Cpu.registerH = registerH;\n        setZeroFlag$$1(registerH === 0);\n        setSubtractFlag(1);\n        return 4;\n      }\n\n    case 0x26:\n      {\n        // LD H,d8\n        // 2 8\n        // 4 cycles\n        Cpu.registerH = getDataByteOne();\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x27:\n      {\n        // DAA\n        // 1 4\n        // Z - 0 C\n        var adjustedRegister = 0;\n        var adjustment = 0;\n\n        if (getHalfCarryFlag() > 0) {\n          adjustment = adjustment | 0x06;\n        }\n\n        if (getCarryFlag$$1() > 0) {\n          adjustment = adjustment | 0x60;\n        }\n\n        var registerA = Cpu.registerA;\n\n        if (getSubtractFlag() > 0) {\n          adjustedRegister = u8Portable(registerA - adjustment);\n        } else {\n          if ((registerA & 0x0f) > 0x09) {\n            adjustment = adjustment | 0x06;\n          }\n\n          if (registerA > 0x99) {\n            adjustment = adjustment | 0x60;\n          }\n\n          adjustedRegister = u8Portable(registerA + adjustment);\n        } // Now set our flags to the correct values\n\n\n        setZeroFlag$$1(adjustedRegister === 0);\n        setCarryFlag((adjustment & 0x60) !== 0);\n        setHalfCarryFlag(0);\n        Cpu.registerA = adjustedRegister;\n        return 4;\n      }\n\n    case 0x28:\n      {\n        // JR Z,r8\n        // 2  12/8\n        if (getZeroFlag$$1() > 0) {\n          // 4 cycles\n          relativeJump(getDataByteOne()); // Relative Jump funciton handles pogram counter\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        }\n\n        return 8;\n      }\n\n    case 0x29:\n      {\n        // ADD HL,HL\n        // 1  8\n        // - 0 H C\n        var registerHL9 = concatenateBytes(Cpu.registerH, Cpu.registerL);\n        checkAndSetSixteenBitFlagsAddOverflow(registerHL9, registerHL9, false);\n        registerHL9 = u16Portable(registerHL9 * 2);\n        Cpu.registerH = splitHighByte(registerHL9);\n        Cpu.registerL = splitLowByte(registerHL9);\n        setSubtractFlag(0);\n        return 8;\n      }\n\n    case 0x2a:\n      {\n        // LD A,(HL+)\n        // 1  8\n        var registerHLA = concatenateBytes(Cpu.registerH, Cpu.registerL); // 4 cycles\n\n        Cpu.registerA = eightBitLoadSyncCycles(registerHLA);\n        registerHLA = u16Portable(registerHLA + 1);\n        Cpu.registerH = splitHighByte(registerHLA);\n        Cpu.registerL = splitLowByte(registerHLA);\n        return 4;\n      }\n\n    case 0x2b:\n      {\n        // DEC HL\n        // 1 8\n        var registerHLB = concatenateBytes(Cpu.registerH, Cpu.registerL);\n        registerHLB = u16Portable(registerHLB - 1);\n        Cpu.registerH = splitHighByte(registerHLB);\n        Cpu.registerL = splitLowByte(registerHLB);\n        return 8;\n      }\n\n    case 0x2c:\n      {\n        // INC L\n        // 1  4\n        // Z 0 H -\n        var registerL = Cpu.registerL;\n        checkAndSetEightBitHalfCarryFlag(registerL, 1);\n        registerL = u8Portable(registerL + 1);\n        Cpu.registerL = registerL;\n        setZeroFlag$$1(registerL === 0);\n        setSubtractFlag(0);\n        return 4;\n      }\n\n    case 0x2d:\n      {\n        // DEC L\n        // 1  4\n        // Z 1 H -\n        var registerL = Cpu.registerL;\n        checkAndSetEightBitHalfCarryFlag(registerL, -1);\n        registerL = u8Portable(registerL - 1);\n        Cpu.registerL = registerL;\n        setZeroFlag$$1(registerL === 0);\n        setSubtractFlag(1);\n        return 4;\n      }\n\n    case 0x2e:\n      {\n        // LD L,d8\n        // 2  8\n        // 4 cycles\n        Cpu.registerL = getDataByteOne();\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x2f:\n      {\n        // CPL\n        // 1 4\n        // - 1 1 -\n        Cpu.registerA = ~Cpu.registerA;\n        setSubtractFlag(1);\n        setHalfCarryFlag(1);\n        return 4;\n      }\n  }\n\n  return -1;\n}\n\nfunction handleOpcode3x(opcode) {\n  switch (opcode) {\n    case 0x30:\n      {\n        // JR NC,r8\n        // 2 12 / 8\n        if (getCarryFlag$$1() === 0) {\n          // 4 cycles\n          relativeJump(getDataByteOne()); // Relative Jump function handles program counter\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        }\n\n        return 8;\n      }\n\n    case 0x31:\n      {\n        // LD SP,d16\n        // 3 12\n        // 8 cycles\n        Cpu.stackPointer = getConcatenatedDataByte();\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n        return 4;\n      }\n\n    case 0x32:\n      {\n        // LD (HL-),A\n        // 1 8\n        var registerHL2 = concatenateBytes(Cpu.registerH, Cpu.registerL); // 4 cycles\n\n        eightBitStoreSyncCycles(registerHL2, Cpu.registerA);\n        registerHL2 = u16Portable(registerHL2 - 1);\n        Cpu.registerH = splitHighByte(registerHL2);\n        Cpu.registerL = splitLowByte(registerHL2);\n        return 4;\n      }\n\n    case 0x33:\n      {\n        // INC SP\n        // 1 8\n        Cpu.stackPointer = u16Portable(Cpu.stackPointer + 1);\n        return 8;\n      }\n\n    case 0x34:\n      {\n        // INC (HL)\n        // 1  12\n        // Z 0 H -\n        var registerHL4 = concatenateBytes(Cpu.registerH, Cpu.registerL); // 4 cycles\n\n        var valueAtHL4 = eightBitLoadSyncCycles(registerHL4); // Creating a varible for this to fix assemblyscript overflow bug\n        // Requires explicit casting\n        // https://github.com/AssemblyScript/assemblyscript/issues/26\n\n        var incrementer = 1;\n        checkAndSetEightBitHalfCarryFlag(valueAtHL4, incrementer);\n        valueAtHL4 = u8Portable(valueAtHL4 + incrementer);\n        setZeroFlag$$1(valueAtHL4 === 0);\n        setSubtractFlag(0); // 4 cycles\n\n        eightBitStoreSyncCycles(registerHL4, valueAtHL4);\n        return 4;\n      }\n\n    case 0x35:\n      {\n        // DEC (HL)\n        // 1  12\n        // Z 1 H -\n        var registerHL5 = concatenateBytes(Cpu.registerH, Cpu.registerL); // 4 cycles\n\n        var valueAtHL5 = eightBitLoadSyncCycles(registerHL5); // NOTE: This opcode may not overflow correctly,\n        // Please see previous opcode\n\n        checkAndSetEightBitHalfCarryFlag(valueAtHL5, -1);\n        valueAtHL5 = u8Portable(valueAtHL5 - 1);\n        setZeroFlag$$1(valueAtHL5 === 0);\n        setSubtractFlag(1); // 4 cycles\n\n        eightBitStoreSyncCycles(registerHL5, valueAtHL5);\n        return 4;\n      }\n\n    case 0x36:\n      {\n        // LD (HL),d8\n        // 2  12\n        // 8 cycles, 4 from store, 4 from data byte\n        eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x37:\n      {\n        // SCF\n        // 1  4\n        // - 0 0 1\n        // Simply set the carry flag\n        setSubtractFlag(0);\n        setHalfCarryFlag(0);\n        setCarryFlag(1);\n        return 4;\n      }\n\n    case 0x38:\n      {\n        // JR C,r8\n        // 2 12/8\n        if (getCarryFlag$$1() === 1) {\n          // 4 cycles\n          relativeJump(getDataByteOne()); // Relative Jump Funciton handles program counter\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        }\n\n        return 8;\n      }\n\n    case 0x39:\n      {\n        // ADD HL,SP\n        // 1 8\n        // - 0 H C\n        var registerHL9 = concatenateBytes(Cpu.registerH, Cpu.registerL);\n        checkAndSetSixteenBitFlagsAddOverflow(registerHL9, Cpu.stackPointer, false);\n        var result = u16Portable(registerHL9 + Cpu.stackPointer);\n        Cpu.registerH = splitHighByte(result);\n        Cpu.registerL = splitLowByte(result);\n        setSubtractFlag(0);\n        return 8;\n      }\n\n    case 0x3a:\n      {\n        // LD A,(HL-)\n        // 1 8\n        var registerHLA = concatenateBytes(Cpu.registerH, Cpu.registerL); // 4 cycles\n\n        Cpu.registerA = eightBitLoadSyncCycles(registerHLA);\n        registerHLA = u16Portable(registerHLA - 1);\n        Cpu.registerH = splitHighByte(registerHLA);\n        Cpu.registerL = splitLowByte(registerHLA);\n        return 4;\n      }\n\n    case 0x3b:\n      {\n        // DEC SP\n        // 1 8\n        Cpu.stackPointer = u16Portable(Cpu.stackPointer - 1);\n        return 8;\n      }\n\n    case 0x3c:\n      {\n        // INC A\n        // 1  4\n        // Z 0 H -\n        var registerA = Cpu.registerA;\n        checkAndSetEightBitHalfCarryFlag(registerA, 1);\n        registerA = u8Portable(registerA + 1);\n        Cpu.registerA = registerA;\n        setZeroFlag$$1(registerA === 0);\n        setSubtractFlag(0);\n        return 4;\n      }\n\n    case 0x3d:\n      {\n        // DEC A\n        // 1  4\n        // Z 1 H -\n        var registerA = Cpu.registerA;\n        checkAndSetEightBitHalfCarryFlag(registerA, -1);\n        registerA = u8Portable(registerA - 1);\n        Cpu.registerA = registerA;\n        setZeroFlag$$1(registerA === 0);\n        setSubtractFlag(1);\n        return 4;\n      }\n\n    case 0x3e:\n      {\n        // LD A,d8\n        // 2 8\n        // 4 cycles\n        Cpu.registerA = getDataByteOne();\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0x3f:\n      {\n        // CCF\n        // 1 4\n        // - 0 0 C\n        setSubtractFlag(0);\n        setHalfCarryFlag(0);\n        setCarryFlag(getCarryFlag$$1() <= 0);\n        return 4;\n      }\n  }\n\n  return -1;\n}\n\nfunction handleOpcode4x(opcode) {\n  switch (opcode) {\n    case 0x40:\n      // LD B,B\n      // 1 4\n      // Load B into B, Do nothing\n      return 4;\n\n    case 0x41:\n      // LD B,C\n      // 1 4\n      Cpu.registerB = Cpu.registerC;\n      return 4;\n\n    case 0x42:\n      // LD B,D\n      // 1 4\n      Cpu.registerB = Cpu.registerD;\n      return 4;\n\n    case 0x43:\n      // LD B,E\n      // 1 4\n      Cpu.registerB = Cpu.registerE;\n      return 4;\n\n    case 0x44:\n      // LD B,H\n      // 1 4\n      Cpu.registerB = Cpu.registerH;\n      return 4;\n\n    case 0x45:\n      // LD B,L\n      // 1 4\n      Cpu.registerB = Cpu.registerL;\n      return 4;\n\n    case 0x46:\n      // LD B,(HL)\n      // 1 8\n      // 4 cycles\n      Cpu.registerB = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      return 4;\n\n    case 0x47:\n      // LD B,A\n      // 1 4\n      Cpu.registerB = Cpu.registerA;\n      return 4;\n\n    case 0x48:\n      // LD C,B\n      // 1 4\n      Cpu.registerC = Cpu.registerB;\n      return 4;\n\n    case 0x49:\n      // LD C,C\n      // 1 4\n      // Do nothing\n      return 4;\n\n    case 0x4a:\n      // LD C,D\n      // 1 4\n      Cpu.registerC = Cpu.registerD;\n      return 4;\n\n    case 0x4b:\n      // LD C,E\n      // 1 4\n      Cpu.registerC = Cpu.registerE;\n      return 4;\n\n    case 0x4c:\n      // LD C,H\n      // 1 4\n      Cpu.registerC = Cpu.registerH;\n      return 4;\n\n    case 0x4d:\n      // LD C,L\n      // 1 4\n      Cpu.registerC = Cpu.registerL;\n      return 4;\n\n    case 0x4e:\n      // LD C,(HL)\n      // 1 8\n      // 4 cycles\n      Cpu.registerC = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      return 4;\n\n    case 0x4f:\n      // LD C,A\n      // 1 4\n      Cpu.registerC = Cpu.registerA;\n      return 4;\n  }\n\n  return -1;\n}\n\nfunction handleOpcode5x(opcode) {\n  switch (opcode) {\n    case 0x50:\n      // LD D,B\n      // 1 4\n      Cpu.registerD = Cpu.registerB;\n      return 4;\n\n    case 0x51:\n      // LD D,C\n      // 1 4\n      Cpu.registerD = Cpu.registerC;\n      return 4;\n\n    case 0x52:\n      // LD D,D\n      // 1 4\n      // Do Nothing\n      return 4;\n\n    case 0x53:\n      // LD D,E\n      // 1 4\n      Cpu.registerD = Cpu.registerE;\n      return 4;\n\n    case 0x54:\n      // LD D,H\n      // 1 4\n      Cpu.registerD = Cpu.registerH;\n      return 4;\n\n    case 0x55:\n      // LD D,L\n      // 1 4\n      Cpu.registerD = Cpu.registerL;\n      return 4;\n\n    case 0x56:\n      // LD D,(HL)\n      // 1 8\n      // 4 cycles\n      Cpu.registerD = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      return 4;\n\n    case 0x57:\n      // LD D,A\n      // 1 4\n      Cpu.registerD = Cpu.registerA;\n      return 4;\n\n    case 0x58:\n      // LD E,B\n      // 1 4\n      Cpu.registerE = Cpu.registerB;\n      return 4;\n\n    case 0x59:\n      // LD E,C\n      // 1 4\n      Cpu.registerE = Cpu.registerC;\n      return 4;\n\n    case 0x5a:\n      // LD E,D\n      // 1 4\n      Cpu.registerE = Cpu.registerD;\n      return 4;\n\n    case 0x5b:\n      // LD E,E\n      // 1 4\n      // Do Nothing\n      return 4;\n\n    case 0x5c:\n      // LD E,H\n      // 1 4\n      Cpu.registerE = Cpu.registerH;\n      return 4;\n\n    case 0x5d:\n      // LD E,L\n      // 1 4\n      Cpu.registerE = Cpu.registerL;\n      return 4;\n\n    case 0x5e:\n      // LD E,(HL)\n      // 1 8\n      // 4 cycles\n      Cpu.registerE = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      return 4;\n\n    case 0x5f:\n      // LD E,A\n      // 1 4\n      Cpu.registerE = Cpu.registerA;\n      return 4;\n  }\n\n  return -1;\n}\n\nfunction handleOpcode6x(opcode) {\n  switch (opcode) {\n    case 0x60:\n      // LD H,B\n      // 1 4\n      Cpu.registerH = Cpu.registerB;\n      return 4;\n\n    case 0x61:\n      // LD H,C\n      // 1 4\n      Cpu.registerH = Cpu.registerC;\n      return 4;\n\n    case 0x62:\n      // LD H,D\n      // 1 4\n      Cpu.registerH = Cpu.registerD;\n      return 4;\n\n    case 0x63:\n      // LD H,E\n      // 1 4\n      Cpu.registerH = Cpu.registerE;\n      return 4;\n\n    case 0x64:\n      // LD H,H\n      // 1 4\n      Cpu.registerH = Cpu.registerH;\n      return 4;\n\n    case 0x65:\n      // LD H,L\n      // 1 4\n      Cpu.registerH = Cpu.registerL;\n      return 4;\n\n    case 0x66:\n      // LD H,(HL)\n      // 1 8\n      // 4 cycles\n      Cpu.registerH = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      return 4;\n\n    case 0x67:\n      // LD H,A\n      // 1 4\n      Cpu.registerH = Cpu.registerA;\n      return 4;\n\n    case 0x68:\n      // LD L,B\n      // 1 4\n      Cpu.registerL = Cpu.registerB;\n      return 4;\n\n    case 0x69:\n      // LD L,C\n      // 1 4\n      Cpu.registerL = Cpu.registerC;\n      return 4;\n\n    case 0x6a:\n      // LD L,D\n      // 1 4\n      Cpu.registerL = Cpu.registerD;\n      return 4;\n\n    case 0x6b:\n      // LD L,E\n      // 1 4\n      Cpu.registerL = Cpu.registerE;\n      return 4;\n\n    case 0x6c:\n      // LD L,H\n      // 1 4\n      Cpu.registerL = Cpu.registerH;\n      return 4;\n\n    case 0x6d:\n      // LD L,L\n      // 1 4\n      Cpu.registerL = Cpu.registerL;\n      return 4;\n\n    case 0x6e:\n      // LD L,(HL)\n      // 1 8\n      // 4 cycles\n      Cpu.registerL = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      return 4;\n\n    case 0x6f:\n      // LD L,A\n      // 1 4\n      Cpu.registerL = Cpu.registerA;\n      return 4;\n  }\n\n  return -1;\n}\n\nfunction handleOpcode7x(opcode) {\n  switch (opcode) {\n    case 0x70:\n      // LD (HL),B\n      // 1 8\n      // 4 cycles\n      eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), Cpu.registerB);\n      return 4;\n\n    case 0x71:\n      // LD (HL),C\n      // 1 8\n      // 4 cycles\n      eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), Cpu.registerC);\n      return 4;\n\n    case 0x72:\n      // LD (HL),D\n      // 1 8\n      // 4 cycles\n      eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), Cpu.registerD);\n      return 4;\n\n    case 0x73:\n      // LD (HL),E\n      // 1 8\n      // 4 cycles\n      eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), Cpu.registerE);\n      return 4;\n\n    case 0x74:\n      // LD (HL),H\n      // 1 8\n      // 4 cycles\n      eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), Cpu.registerH);\n      return 4;\n\n    case 0x75:\n      // LD (HL),L\n      // 1 8\n      // 4 cycles\n      eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), Cpu.registerL);\n      return 4;\n\n    case 0x76:\n      // HALT\n      // 1 4\n      // Enter CPU very low power mode\n      // Meaning Don't Decode anymore opcodes until an interrupt occurs\n      // Still need to do timers and things\n      // Can't Halt during an HDMA\n      // https://gist.github.com/drhelius/3394856\n      if (!Memory.isHblankHdmaActive) {\n        Cpu.enableHalt();\n      }\n\n      return 4;\n\n    case 0x77:\n      // LD (HL),A\n      // 1 8\n      // 4 cycles\n      eightBitStoreSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL), Cpu.registerA);\n      return 4;\n\n    case 0x78:\n      // LD A,B\n      // 1 4\n      Cpu.registerA = Cpu.registerB;\n      return 4;\n\n    case 0x79:\n      // LD A,C\n      // 1 4\n      Cpu.registerA = Cpu.registerC;\n      return 4;\n\n    case 0x7a:\n      // LD A,D\n      // 1 4\n      Cpu.registerA = Cpu.registerD;\n      return 4;\n\n    case 0x7b:\n      // LD A,E\n      // 1 4\n      Cpu.registerA = Cpu.registerE;\n      return 4;\n\n    case 0x7c:\n      // LD A,H\n      // 1 4\n      Cpu.registerA = Cpu.registerH;\n      return 4;\n\n    case 0x7d:\n      // LD A,L\n      // 1 4\n      Cpu.registerA = Cpu.registerL;\n      return 4;\n\n    case 0x7e:\n      // LD A,(HL)\n      // 1 8\n      // NOTE: Thanks to @binji for catching that this should be 8 cycles, not 4\n      // 4 cycles\n      Cpu.registerA = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      return 4;\n\n    case 0x7f:\n      // LD A,A\n      // 1 4\n      // Do Nothing\n      return 4;\n  }\n\n  return -1;\n}\n\nfunction handleOpcode8x(opcode) {\n  switch (opcode) {\n    case 0x80:\n      // ADD A,B\n      // 1 4\n      // Z 0 H C\n      addARegister(Cpu.registerB);\n      return 4;\n\n    case 0x81:\n      // ADD A,C\n      // 1 4\n      // Z 0 H C\n      addARegister(Cpu.registerC);\n      return 4;\n\n    case 0x82:\n      // ADD A,D\n      // 1 4\n      // Z 0 H C\n      addARegister(Cpu.registerD);\n      return 4;\n\n    case 0x83:\n      // ADD A,E\n      // 1 4\n      // Z 0 H C\n      addARegister(Cpu.registerE);\n      return 4;\n\n    case 0x84:\n      // ADD A,H\n      // 1 4\n      // Z 0 H C\n      addARegister(Cpu.registerH);\n      return 4;\n\n    case 0x85:\n      // ADD A,L\n      // 1 4\n      // Z 0 H C\n      addARegister(Cpu.registerL);\n      return 4;\n\n    case 0x86:\n      // ADD A,(HL)\n      // 1 8\n      // Z 0 H C\n      // 4 cycles\n      var valueAtHL6 = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      addARegister(valueAtHL6);\n      return 4;\n\n    case 0x87:\n      // ADD A,A\n      // 1 4\n      // Z 0 H C\n      addARegister(Cpu.registerA);\n      return 4;\n\n    case 0x88:\n      // ADC A,B\n      // 1 4\n      // Z 0 H C\n      addAThroughCarryRegister(Cpu.registerB);\n      return 4;\n\n    case 0x89:\n      // ADC A,C\n      // 1 4\n      // Z 0 H C\n      addAThroughCarryRegister(Cpu.registerC);\n      return 4;\n\n    case 0x8a:\n      // ADC A,D\n      // 1 4\n      // Z 0 H C\n      addAThroughCarryRegister(Cpu.registerD);\n      return 4;\n\n    case 0x8b:\n      // ADC A,E\n      // 1 4\n      // Z 0 H C\n      addAThroughCarryRegister(Cpu.registerE);\n      return 4;\n\n    case 0x8c:\n      // ADC A,H\n      // 1 4\n      // Z 0 H C\n      addAThroughCarryRegister(Cpu.registerH);\n      return 4;\n\n    case 0x8d:\n      // ADC A,L\n      // 1 4\n      // Z 0 H C\n      addAThroughCarryRegister(Cpu.registerL);\n      return 4;\n\n    case 0x8e:\n      // ADC A,(HL)\n      // 1 8\n      // Z 0 H C\n      // 4 cycles\n      var valueAtHLE = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      addAThroughCarryRegister(valueAtHLE);\n      return 4;\n\n    case 0x8f:\n      // ADC A,A\n      // 1 4\n      // Z 0 H C\n      addAThroughCarryRegister(Cpu.registerA);\n      return 4;\n  }\n\n  return -1;\n}\n\nfunction handleOpcode9x(opcode) {\n  switch (opcode) {\n    case 0x90:\n      // SUB B\n      // 1  4\n      // Z 1 H C\n      subARegister(Cpu.registerB);\n      return 4;\n\n    case 0x91:\n      // SUB C\n      // 1  4\n      // Z 1 H C\n      subARegister(Cpu.registerC);\n      return 4;\n\n    case 0x92:\n      // SUB D\n      // 1  4\n      // Z 1 H C\n      subARegister(Cpu.registerD);\n      return 4;\n\n    case 0x93:\n      // SUB E\n      // 1  4\n      // Z 1 H C\n      subARegister(Cpu.registerE);\n      return 4;\n\n    case 0x94:\n      // SUB H\n      // 1  4\n      // Z 1 H C\n      subARegister(Cpu.registerH);\n      return 4;\n\n    case 0x95:\n      // SUB L\n      // 1  4\n      // Z 1 H C\n      subARegister(Cpu.registerL);\n      return 4;\n\n    case 0x96:\n      // SUB (HL)\n      // 1  8\n      // Z 1 H C\n      // 4 cycles\n      var valueAtHL6 = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      subARegister(valueAtHL6);\n      return 4;\n\n    case 0x97:\n      // SUB A\n      // 1  4\n      // Z 1 H C\n      subARegister(Cpu.registerA);\n      return 4;\n\n    case 0x98:\n      // SBC A,B\n      // 1  4\n      // Z 1 H C\n      subAThroughCarryRegister(Cpu.registerB);\n      return 4;\n\n    case 0x99:\n      // SBC A,C\n      // 1  4\n      // Z 1 H C\n      subAThroughCarryRegister(Cpu.registerC);\n      return 4;\n\n    case 0x9a:\n      // SBC A,D\n      // 1  4\n      // Z 1 H C\n      subAThroughCarryRegister(Cpu.registerD);\n      return 4;\n\n    case 0x9b:\n      // SBC A,E\n      // 1  4\n      // Z 1 H C\n      subAThroughCarryRegister(Cpu.registerE);\n      return 4;\n\n    case 0x9c:\n      // SBC A,H\n      // 1  4\n      // Z 1 H C\n      subAThroughCarryRegister(Cpu.registerH);\n      return 4;\n\n    case 0x9d:\n      // SBC A,L\n      // 1  4\n      // Z 1 H C\n      subAThroughCarryRegister(Cpu.registerL);\n      return 4;\n\n    case 0x9e:\n      // SBC A,(HL)\n      // 1  8\n      // Z 1 H C\n      // 4 cycles\n      var valueAtHLE = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      subAThroughCarryRegister(valueAtHLE);\n      return 4;\n\n    case 0x9f:\n      // SBC A,A\n      // 1  4\n      // Z 1 H C\n      subAThroughCarryRegister(Cpu.registerA);\n      return 4;\n  }\n\n  return -1;\n}\n\nfunction handleOpcodeAx(opcode) {\n  switch (opcode) {\n    case 0xa0:\n      // AND B\n      // 1  4\n      // Z 0 1 0\n      andARegister(Cpu.registerB);\n      return 4;\n\n    case 0xa1:\n      // AND C\n      // 1  4\n      // Z 0 1 0\n      andARegister(Cpu.registerC);\n      return 4;\n\n    case 0xa2:\n      // AND D\n      // 1  4\n      // Z 0 1 0\n      andARegister(Cpu.registerD);\n      return 4;\n\n    case 0xa3:\n      // AND E\n      // 1  4\n      // Z 0 1 0\n      andARegister(Cpu.registerE);\n      return 4;\n\n    case 0xa4:\n      // AND H\n      // 1  4\n      // Z 0 1 0\n      andARegister(Cpu.registerH);\n      return 4;\n\n    case 0xa5:\n      // AND L\n      // 1  4\n      // Z 0 1 0\n      andARegister(Cpu.registerL);\n      return 4;\n\n    case 0xa6:\n      // AND (HL)\n      // 1  8\n      // Z 0 1 0\n      // 4 cycles\n      var valueAtHL6 = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      andARegister(valueAtHL6);\n      return 4;\n\n    case 0xa7:\n      // AND A\n      // 1  4\n      // Z 0 1 0\n      // NOTE: & Yourself, does nothing\n      andARegister(Cpu.registerA);\n      return 4;\n\n    case 0xa8:\n      // XOR B\n      // 1  4\n      // Z 0 0 0\n      xorARegister(Cpu.registerB);\n      return 4;\n\n    case 0xa9:\n      // XOR C\n      // 1  4\n      // Z 0 0 0\n      xorARegister(Cpu.registerC);\n      return 4;\n\n    case 0xaa:\n      // XOR D\n      // 1  4\n      // Z 0 0 0\n      xorARegister(Cpu.registerD);\n      return 4;\n\n    case 0xab:\n      // XOR E\n      // 1  4\n      // Z 0 0 0\n      xorARegister(Cpu.registerE);\n      return 4;\n\n    case 0xac:\n      // XOR H\n      // 1  4\n      // Z 0 0 0\n      xorARegister(Cpu.registerH);\n      return 4;\n\n    case 0xad:\n      // XOR L\n      // 1  4\n      // Z 0 0 0\n      xorARegister(Cpu.registerL);\n      return 4;\n\n    case 0xae:\n      // XOR (HL)\n      // 1  8\n      // Z 0 0 0\n      // 4 cycles\n      var valueAtHLE = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      xorARegister(valueAtHLE);\n      return 4;\n\n    case 0xaf:\n      // XOR A\n      // 1  4\n      // Z 0 0 0\n      xorARegister(Cpu.registerA);\n      return 4;\n  }\n\n  return -1;\n}\n\nfunction handleOpcodeBx(opcode) {\n  switch (opcode) {\n    case 0xb0:\n      // OR B\n      // 1  4\n      // Z 0 0 0\n      orARegister(Cpu.registerB);\n      return 4;\n\n    case 0xb1:\n      // OR C\n      // 1  4\n      // Z 0 0 0\n      orARegister(Cpu.registerC);\n      return 4;\n\n    case 0xb2:\n      // OR D\n      // 1  4\n      // Z 0 0 0\n      orARegister(Cpu.registerD);\n      return 4;\n\n    case 0xb3:\n      // OR E\n      // 1  4\n      // Z 0 0 0\n      orARegister(Cpu.registerE);\n      return 4;\n\n    case 0xb4:\n      // OR H\n      // 1  4\n      // Z 0 0 0\n      orARegister(Cpu.registerH);\n      return 4;\n\n    case 0xb5:\n      // OR L\n      // 1  4\n      // Z 0 0 0\n      orARegister(Cpu.registerL);\n      return 4;\n\n    case 0xb6:\n      // OR (HL)\n      // 1  8\n      // Z 0 0 0\n      // 4 cycles\n      var valueAtHL6 = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      orARegister(valueAtHL6);\n      return 4;\n\n    case 0xb7:\n      // OR A\n      // 1  4\n      // Z 0 0 0\n      orARegister(Cpu.registerA);\n      return 4;\n\n    case 0xb8:\n      // CP B\n      // 1  4\n      // Z 1 H C\n      cpARegister(Cpu.registerB);\n      return 4;\n\n    case 0xb9:\n      // CP C\n      // 1  4\n      // Z 1 H C\n      cpARegister(Cpu.registerC);\n      return 4;\n\n    case 0xba:\n      // CP D\n      // 1  4\n      // Z 1 H C\n      cpARegister(Cpu.registerD);\n      return 4;\n\n    case 0xbb:\n      // CP E\n      // 1  4\n      // Z 1 H C\n      cpARegister(Cpu.registerE);\n      return 4;\n\n    case 0xbc:\n      // CP H\n      // 1  4\n      // Z 1 H C\n      cpARegister(Cpu.registerH);\n      return 4;\n\n    case 0xbd:\n      // CP L\n      // 1  4\n      // Z 1 H C\n      cpARegister(Cpu.registerL);\n      return 4;\n\n    case 0xbe:\n      // CP (HL)\n      // 1  8\n      // Z 1 H C\n      // 4 cycles\n      var valueAtHLE = eightBitLoadSyncCycles(concatenateBytes(Cpu.registerH, Cpu.registerL));\n      cpARegister(valueAtHLE);\n      return 4;\n\n    case 0xbf:\n      // CP A\n      // 1  4\n      // Z 1 H C\n      cpARegister(Cpu.registerA);\n      return 4;\n  }\n\n  return -1;\n}\n\nfunction handleOpcodeCx(opcode) {\n  switch (opcode) {\n    case 0xc0:\n      {\n        // RET NZ\n        // 1  20/8\n        if (getZeroFlag$$1() === 0) {\n          // 8 cycles\n          var stackPointer = Cpu.stackPointer;\n          Cpu.programCounter = sixteenBitLoadSyncCycles(stackPointer);\n          Cpu.stackPointer = u16Portable(stackPointer + 2);\n          return 12;\n        } else {\n          return 8;\n        }\n      }\n\n    case 0xc1:\n      {\n        // POP BC\n        // 1  12\n        // 8 cycles\n        var registerBC1 = sixteenBitLoadSyncCycles(Cpu.stackPointer);\n        Cpu.stackPointer = u16Portable(Cpu.stackPointer + 2);\n        Cpu.registerB = splitHighByte(registerBC1);\n        Cpu.registerC = splitLowByte(registerBC1);\n        return 4;\n      }\n\n    case 0xc2:\n      {\n        // JP NZ,a16\n        // 3  16/12\n        if (getZeroFlag$$1() === 0) {\n          // 8 cycles\n          Cpu.programCounter = getConcatenatedDataByte();\n          return 8;\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n          return 12;\n        }\n      }\n\n    case 0xc3:\n      {\n        // JP a16\n        // 3  16\n        // 8 cycles\n        Cpu.programCounter = getConcatenatedDataByte();\n        return 8;\n      }\n\n    case 0xc4:\n      {\n        // CALL NZ,a16\n        // 3  24/12\n        if (getZeroFlag$$1() === 0) {\n          var stackPointer = u16Portable(Cpu.stackPointer - 2);\n          Cpu.stackPointer = stackPointer; // 8 cycles\n\n          sixteenBitStoreSyncCycles(stackPointer, u16Portable(Cpu.programCounter + 2)); // 8 cycles\n\n          Cpu.programCounter = getConcatenatedDataByte();\n          return 8;\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n          return 12;\n        }\n      }\n\n    case 0xc5:\n      {\n        // PUSH BC\n        // 1  16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, concatenateBytes(Cpu.registerB, Cpu.registerC));\n        return 8;\n      }\n\n    case 0xc6:\n      {\n        // ADD A,d8\n        // 2 8\n        // Z 0 H C\n        // 4 cycles\n        addARegister(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xc7:\n      {\n        // RST 00H\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter);\n        Cpu.programCounter = 0x00;\n        return 8;\n      }\n\n    case 0xc8:\n      {\n        // RET Z\n        // 1  20/8\n        if (getZeroFlag$$1() === 1) {\n          // 8 cycles\n          var stackPointer = Cpu.stackPointer;\n          Cpu.programCounter = sixteenBitLoadSyncCycles(stackPointer);\n          Cpu.stackPointer = u16Portable(stackPointer + 2);\n          return 12;\n        } else {\n          return 8;\n        }\n      }\n\n    case 0xc9:\n      {\n        // RET\n        // 1 16\n        // 8 cycles\n        var stackPointer = Cpu.stackPointer;\n        Cpu.programCounter = sixteenBitLoadSyncCycles(stackPointer);\n        Cpu.stackPointer = u16Portable(stackPointer + 2);\n        return 8;\n      }\n\n    case 0xca:\n      {\n        // JP Z,a16\n        // 3 16/12\n        if (getZeroFlag$$1() === 1) {\n          // 8 cycles\n          Cpu.programCounter = getConcatenatedDataByte();\n          return 8;\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n          return 12;\n        }\n      }\n\n    case 0xcb:\n      {\n        // PREFIX CB\n        // 1  4\n        // 4 cycles\n        var cbCycles = handleCbOpcode(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return cbCycles;\n      }\n\n    case 0xcc:\n      {\n        // CALL Z,a16\n        // 3  24/12\n        if (getZeroFlag$$1() === 1) {\n          var stackPointer = u16Portable(Cpu.stackPointer - 2);\n          Cpu.stackPointer = stackPointer; // 8 cycles\n\n          sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter + 2); // 8 cycles\n\n          Cpu.programCounter = getConcatenatedDataByte();\n          return 8;\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n          return 12;\n        }\n      }\n\n    case 0xcd:\n      {\n        // CALL a16\n        // 3  24\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, u16Portable(Cpu.programCounter + 2)); // 8 cycles\n\n        Cpu.programCounter = getConcatenatedDataByte();\n        return 8;\n      }\n\n    case 0xce:\n      {\n        // ADC A,d8\n        // 2  8\n        // Z 0 H C\n        // 4 cycles\n        addAThroughCarryRegister(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xcf:\n      {\n        // RST 08H\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter);\n        Cpu.programCounter = 0x08;\n        return 8;\n      }\n  }\n\n  return -1;\n}\n\nfunction handleOpcodeDx(opcode) {\n  switch (opcode) {\n    case 0xd0:\n      {\n        // RET NC\n        // 1  20/8\n        if (getCarryFlag$$1() === 0) {\n          // 8 cycles\n          var stackPointer = Cpu.stackPointer;\n          Cpu.programCounter = sixteenBitLoadSyncCycles(stackPointer);\n          Cpu.stackPointer = u16Portable(stackPointer + 2);\n          return 12;\n        } else {\n          return 8;\n        }\n      }\n\n    case 0xd1:\n      {\n        // POP DE\n        // 1  12\n        // 8 cycles\n        var stackPointer = Cpu.stackPointer;\n        var registerDE1 = sixteenBitLoadSyncCycles(stackPointer);\n        Cpu.stackPointer = u16Portable(stackPointer + 2);\n        Cpu.registerD = splitHighByte(registerDE1);\n        Cpu.registerE = splitLowByte(registerDE1);\n        return 4;\n      }\n\n    case 0xd2:\n      {\n        // JP NC,a16\n        // 3  16/12\n        if (getCarryFlag$$1() === 0) {\n          // 8 cycles\n          Cpu.programCounter = getConcatenatedDataByte();\n          return 8;\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n          return 12;\n        }\n      }\n\n    /* No Opcode for: 0xD3 */\n\n    case 0xd4:\n      {\n        // CALL NC,a16\n        // 3  24/12\n        if (getCarryFlag$$1() === 0) {\n          var stackPointer = u16Portable(Cpu.stackPointer - 2);\n          Cpu.stackPointer = stackPointer; // 8 cycles\n\n          sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter + 2); // 8 cycles\n\n          Cpu.programCounter = getConcatenatedDataByte();\n          return 8;\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n          return 12;\n        }\n      }\n\n    case 0xd5:\n      {\n        // PUSH DE\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, concatenateBytes(Cpu.registerD, Cpu.registerE));\n        return 8;\n      }\n\n    case 0xd6:\n      {\n        // SUB d8\n        // 2  8\n        // Z 1 H C\n        // 4 cycles\n        subARegister(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xd7:\n      {\n        // RST 10H\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter);\n        Cpu.programCounter = 0x10;\n        return 8;\n      }\n\n    case 0xd8:\n      {\n        // RET C\n        // 1  20/8\n        if (getCarryFlag$$1() === 1) {\n          var stackPointer = Cpu.stackPointer; // 8 cycles\n\n          Cpu.programCounter = sixteenBitLoadSyncCycles(stackPointer);\n          Cpu.stackPointer = u16Portable(stackPointer + 2);\n          return 12;\n        } else {\n          return 8;\n        }\n      }\n\n    case 0xd9:\n      {\n        // RETI\n        // 1  16\n        var stackPointer = Cpu.stackPointer; // 8 cycles\n\n        Cpu.programCounter = sixteenBitLoadSyncCycles(stackPointer); // Enable interrupts\n\n        setInterrupts(true);\n        Cpu.stackPointer = u16Portable(stackPointer + 2);\n        return 8;\n      }\n\n    case 0xda:\n      {\n        // JP C,a16\n        // 3 16/12\n        if (getCarryFlag$$1() === 1) {\n          // 8 cycles\n          Cpu.programCounter = getConcatenatedDataByte();\n          return 8;\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n          return 12;\n        }\n      }\n\n    /* No Opcode for: 0xDB */\n\n    case 0xdc:\n      {\n        // CALL C,a16\n        // 3  24/12\n        if (getCarryFlag$$1() === 1) {\n          var stackPointer = u16Portable(Cpu.stackPointer - 2);\n          Cpu.stackPointer = stackPointer; // 8 cycles\n\n          sixteenBitStoreSyncCycles(stackPointer, u16Portable(Cpu.programCounter + 2)); // 8 cycles\n\n          Cpu.programCounter = getConcatenatedDataByte();\n          return 8;\n        } else {\n          Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n          return 12;\n        }\n      }\n\n    /* No Opcode for: 0xDD */\n\n    case 0xde:\n      {\n        // SBC A,d8\n        // 2 8\n        // Z 1 H C\n        // 4 cycles\n        subAThroughCarryRegister(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xdf:\n      {\n        // RST 18H\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter);\n        Cpu.programCounter = 0x18;\n        return 8;\n      }\n  }\n\n  return -1;\n}\n\nfunction handleOpcodeEx(opcode) {\n  switch (opcode) {\n    case 0xe0:\n      {\n        // LDH (a8),A\n        // 2  12\n        // Store value in high RAM ($FF00 + a8)\n        // 4 cycles\n        var largeDataByteOne = getDataByteOne(); // 4 cycles\n\n        eightBitStoreSyncCycles(0xff00 + largeDataByteOne, Cpu.registerA);\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xe1:\n      {\n        // POP HL\n        // 1  12\n        // 8 cycles\n        var stackPointer = Cpu.stackPointer;\n        var registerHL1 = sixteenBitLoadSyncCycles(stackPointer);\n        Cpu.stackPointer = u16Portable(stackPointer + 2);\n        Cpu.registerH = splitHighByte(registerHL1);\n        Cpu.registerL = splitLowByte(registerHL1);\n        return 4;\n      }\n\n    case 0xe2:\n      {\n        // LD (C),A\n        // 1  8\n        // NOTE: Table says 2 Program counter,\n        // But stepping through the boot rom, should be one\n        // Also should change 0xF2\n        // Store value in high RAM ($FF00 + register c)\n        // 4 cycles\n        eightBitStoreSyncCycles(0xff00 + Cpu.registerC, Cpu.registerA);\n        return 4;\n      }\n\n    /* No Opcode for: 0xE3, 0xE4 */\n\n    case 0xe5:\n      {\n        // PUSH HL\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, concatenateBytes(Cpu.registerH, Cpu.registerL));\n        return 8;\n      }\n\n    case 0xe6:\n      {\n        // AND d8\n        // 2  8\n        // Z 0 1 0\n        // 4 cycles\n        andARegister(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xe7:\n      {\n        // RST 20H\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter);\n        Cpu.programCounter = 0x20;\n        return 8;\n      }\n\n    case 0xe8:\n      {\n        // ADD SP, r8\n        // 2 16\n        // 0 0 H C\n        // NOTE: Discoved dataByte is signed\n        // 4 cycles\n        var signedDataByteOne = i8Portable(getDataByteOne());\n        checkAndSetSixteenBitFlagsAddOverflow(Cpu.stackPointer, signedDataByteOne, true);\n        Cpu.stackPointer = u16Portable(Cpu.stackPointer + signedDataByteOne);\n        setZeroFlag$$1(0);\n        setSubtractFlag(0);\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 12;\n      }\n\n    case 0xe9:\n      {\n        // JP HL\n        // 1 4\n        Cpu.programCounter = concatenateBytes(Cpu.registerH, Cpu.registerL);\n        return 4;\n      }\n\n    case 0xea:\n      {\n        // LD (a16),A\n        // 3 16\n        // 12 cycles, 4 from store, 8 from concatenated data byte\n        eightBitStoreSyncCycles(getConcatenatedDataByte(), Cpu.registerA);\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n        return 4;\n      }\n\n    /* No Opcode for: 0xEB, 0xEC, 0xED */\n\n    case 0xee:\n      {\n        // XOR d8\n        // 2 8\n        // Z 0 0 0\n        // 4 cycles\n        xorARegister(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xef:\n      {\n        // RST 28H\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter);\n        Cpu.programCounter = 0x28;\n        return 8;\n      }\n  }\n\n  return -1;\n}\n\nfunction handleOpcodeFx(opcode) {\n  switch (opcode) {\n    case 0xf0:\n      {\n        // LDH A,(a8)\n        // 2 12\n        // 4 cycles\n        var largeDataByteOne = getDataByteOne(); // 4 cycles\n\n        Cpu.registerA = u8Portable(eightBitLoadSyncCycles(0xff00 + largeDataByteOne));\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xf1:\n      {\n        // POP AF\n        // 1 12\n        // Z N H C (But No work require, flags are already set)\n        // 8 cycles\n        var stackPointer = Cpu.stackPointer;\n        var registerAF1 = sixteenBitLoadSyncCycles(stackPointer);\n        Cpu.stackPointer = u16Portable(stackPointer + 2);\n        Cpu.registerA = splitHighByte(registerAF1);\n        Cpu.registerF = splitLowByte(registerAF1);\n        return 4;\n      }\n\n    case 0xf2:\n      {\n        // LD A,(C)\n        // 1 8\n        // 4 cycles\n        Cpu.registerA = u8Portable(eightBitLoadSyncCycles(0xff00 + Cpu.registerC));\n        return 4;\n      }\n\n    case 0xf3:\n      {\n        // DI\n        // 1 4\n        setInterrupts(false);\n        return 4;\n      }\n\n    /* No Opcode for: 0xF4 */\n\n    case 0xf5:\n      {\n        // PUSH AF\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, concatenateBytes(Cpu.registerA, Cpu.registerF));\n        return 8;\n      }\n\n    case 0xf6:\n      {\n        // OR d8\n        // 2 8\n        // Z 0 0 0\n        // 4 cycles\n        orARegister(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xf7:\n      {\n        // RST 30H\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter);\n        Cpu.programCounter = 0x30;\n        return 8;\n      }\n\n    case 0xf8:\n      {\n        // LD HL,SP+r8\n        // 2 12\n        // 0 0 H C\n        // NOTE: Discoved dataByte is signed\n        // 4 cycles\n        var signedDataByteOne = i8Portable(getDataByteOne());\n        var stackPointer = Cpu.stackPointer; // First, let's handle flags\n\n        setZeroFlag$$1(0);\n        setSubtractFlag(0);\n        checkAndSetSixteenBitFlagsAddOverflow(stackPointer, signedDataByteOne, true);\n        var registerHL = u16Portable(stackPointer + signedDataByteOne);\n        Cpu.registerH = splitHighByte(registerHL);\n        Cpu.registerL = splitLowByte(registerHL);\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 8;\n      }\n\n    case 0xf9:\n      {\n        // LD SP,HL\n        // 1 8\n        Cpu.stackPointer = concatenateBytes(Cpu.registerH, Cpu.registerL);\n        return 8;\n      }\n\n    case 0xfa:\n      {\n        // LD A,(a16)\n        // 3 16\n        // 12 cycles, 4 from load, 8 from concatenated data byte\n        Cpu.registerA = eightBitLoadSyncCycles(getConcatenatedDataByte());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 2);\n        return 4;\n      }\n\n    case 0xfb:\n      {\n        // EI\n        // 1 4\n        setInterrupts(true);\n        return 4;\n      }\n\n    /* No Opcode for: 0xFC, 0xFD */\n\n    case 0xfe:\n      {\n        // CP d8\n        // 2 8\n        // Z 1 H C\n        // 4 cycles\n        cpARegister(getDataByteOne());\n        Cpu.programCounter = u16Portable(Cpu.programCounter + 1);\n        return 4;\n      }\n\n    case 0xff:\n      {\n        // RST 38H\n        // 1 16\n        var stackPointer = u16Portable(Cpu.stackPointer - 2);\n        Cpu.stackPointer = stackPointer; // 8 cycles\n\n        sixteenBitStoreSyncCycles(stackPointer, Cpu.programCounter);\n        Cpu.programCounter = 0x38;\n        return 8;\n      }\n  }\n\n  return -1;\n} // NOTE: Code is very verbose, and will have some copy pasta'd lines.\n// Syncing and Tracking executed cycles\n\n\nvar Cycles =\n/** @class */\nfunction () {\n  function Cycles() {} // An even number below the max 32 bit integer\n\n\n  Cycles.cyclesPerCycleSet = 2000000000;\n  Cycles.cycleSets = 0;\n  Cycles.cycles = 0;\n  return Cycles;\n}();\n\nfunction getCyclesPerCycleSet() {\n  return Cycles.cyclesPerCycleSet;\n}\n\nfunction getCycleSets() {\n  return Cycles.cycleSets;\n}\n\nfunction getCycles() {\n  return Cycles.cycles;\n} // Inlined because closure compiler inlines\n\n\nfunction trackCyclesRan(numberOfCycles) {\n  var cycles = Cycles.cycles;\n  cycles += numberOfCycles;\n\n  if (cycles >= Cycles.cyclesPerCycleSet) {\n    Cycles.cycleSets += 1;\n    cycles -= Cycles.cyclesPerCycleSet;\n  }\n\n  Cycles.cycles = cycles;\n} // Inlined because closure compiler inlines\n\n\nfunction resetCycles() {\n  Cycles.cyclesPerCycleSet = 2000000000;\n  Cycles.cycleSets = 0;\n  Cycles.cycles = 0;\n} // Sync other GB Components with the number of cycles\n\n\nfunction syncCycles(numberOfCycles) {\n  // Check if we did a DMA TRansfer, if we did add the cycles\n  if (Memory.DMACycles > 0) {\n    numberOfCycles += Memory.DMACycles;\n    Memory.DMACycles = 0;\n  } // Finally, Add our number of cycles to the CPU Cycles\n\n\n  Cpu.currentCycles += numberOfCycles; // Check other Gameboy components\n\n  if (!Cpu.isStopped) {\n    if (Config.graphicsBatchProcessing) {\n      // Need to do this, since a lot of things depend on the scanline\n      // Batch processing will simply return if the number of cycles is too low\n      Graphics.currentCycles += numberOfCycles;\n      batchProcessGraphics();\n    } else {\n      updateGraphics(numberOfCycles);\n    }\n\n    if (Config.audioBatchProcessing) {\n      Sound.currentCycles += numberOfCycles;\n    } else {\n      updateSound(numberOfCycles);\n    }\n\n    updateSerial(numberOfCycles);\n  }\n\n  if (Config.timersBatchProcessing) {\n    // Batch processing will simply return if the number of cycles is too low\n    Timers.currentCycles += numberOfCycles;\n    batchProcessTimers();\n  } else {\n    updateTimers(numberOfCycles);\n  }\n\n  trackCyclesRan(numberOfCycles);\n} // Functions involving executing/running the emulator after initializtion\n\n\nvar Execute =\n/** @class */\nfunction () {\n  function Execute() {} // An even number bewlow the max 32 bit integer\n\n\n  Execute.stepsPerStepSet = 2000000000;\n  Execute.stepSets = 0;\n  Execute.steps = 0; // Response Codes from Execute Conditions\n\n  Execute.RESPONSE_CONDITION_ERROR = -1;\n  Execute.RESPONSE_CONDITION_FRAME = 0;\n  Execute.RESPONSE_CONDITION_AUDIO = 1;\n  Execute.RESPONSE_CONDITION_BREAKPOINT = 2;\n  return Execute;\n}();\n\nfunction getStepsPerStepSet() {\n  return Execute.stepsPerStepSet;\n}\n\nfunction getStepSets() {\n  return Execute.stepSets;\n}\n\nfunction getSteps() {\n  return Execute.steps;\n} // Inlined because closure compiler inlines\n\n\nfunction trackStepsRan(steps) {\n  var esteps = Execute.steps;\n  esteps += steps;\n\n  if (esteps >= Execute.stepsPerStepSet) {\n    Execute.stepSets += 1;\n    esteps -= Execute.stepsPerStepSet;\n  }\n\n  Execute.steps = esteps;\n} // Inlined because closure compiler inlines\n\n\nfunction resetSteps() {\n  Execute.stepsPerStepSet = 2000000000;\n  Execute.stepSets = 0;\n  Execute.steps = 0;\n} // // Public funciton to run frames until,\n// the specified number of frames have run or error.\n// Return values:\n// -1 = error\n// 0 = render a frame\n\n\nfunction executeMultipleFrames(numberOfFrames) {\n  var frameResponse = 0;\n  var framesRun = 0;\n\n  while (framesRun < numberOfFrames && frameResponse >= 0) {\n    frameResponse = executeFrame();\n    framesRun += 1;\n  }\n\n  if (frameResponse < 0) {\n    return frameResponse;\n  }\n\n  return 0;\n} // Public funciton to run opcodes until,\n// a frame is ready, or error.\n// Return values:\n// -1 = error\n// 0 = render a frame\n\n\nfunction executeFrame() {\n  return executeUntilCondition(true, -1);\n} // Public Function to run opcodes until,\n// a frame is ready, audio bufer is filled, or error\n\n\nfunction executeFrameAndCheckAudio(maxAudioBuffer) {\n  if (maxAudioBuffer === void 0) {\n    maxAudioBuffer = 0;\n  }\n\n  return executeUntilCondition(true, maxAudioBuffer);\n} // Base function that executes steps, and checks conditions\n// Return values:\n\n\nfunction executeUntilCondition(checkMaxCyclesPerFrame, maxAudioBuffer) {\n  if (checkMaxCyclesPerFrame === void 0) {\n    checkMaxCyclesPerFrame = true;\n  }\n\n  if (maxAudioBuffer === void 0) {\n    maxAudioBuffer = -1;\n  } // Common tracking variables\n\n\n  var numberOfCycles = -1;\n  var audioBufferSize = 1024;\n\n  if (maxAudioBuffer > 0) {\n    audioBufferSize = maxAudioBuffer;\n  } else if (maxAudioBuffer < 0) {\n    audioBufferSize = -1;\n  }\n\n  var errorCondition = false;\n  var frameCondition = false;\n  var audioBufferCondition = false;\n\n  while (!errorCondition && !frameCondition && !audioBufferCondition && !Breakpoints.reachedBreakpoint) {\n    numberOfCycles = executeStep(); // Error Condition\n\n    if (numberOfCycles < 0) {\n      errorCondition = true;\n    } else if (Cpu.currentCycles >= Cpu.MAX_CYCLES_PER_FRAME()) {\n      frameCondition = true;\n    } else if (audioBufferSize > -1 && getNumberOfSamplesInAudioBuffer() >= audioBufferSize) {\n      audioBufferCondition = true;\n    }\n  } // Find our exit reason\n\n\n  if (frameCondition) {\n    // Render a frame\n    // Reset our currentCycles\n    Cpu.currentCycles -= Cpu.MAX_CYCLES_PER_FRAME();\n    return Execute.RESPONSE_CONDITION_FRAME;\n  }\n\n  if (audioBufferCondition) {\n    return Execute.RESPONSE_CONDITION_AUDIO;\n  }\n\n  if (Breakpoints.reachedBreakpoint) {\n    Breakpoints.reachedBreakpoint = false;\n    return Execute.RESPONSE_CONDITION_BREAKPOINT;\n  } // TODO: Boot ROM handling\n  // There was an error, return -1, and push the program counter back to grab the error opcode\n\n\n  Cpu.programCounter = u16Portable(Cpu.programCounter - 1);\n  return -1;\n} // Function to execute an opcode, and update other gameboy hardware.\n// http://www.codeslinger.co.uk/pages/projects/gameboy/beginning.html\n\n\nfunction executeStep() {\n  // Set has started to 1 since we ran a emulation step\n  setHasCoreStarted(true); // Check if we are in the halt bug\n\n  if (Cpu.isHaltBug) {\n    // Need to not increment program counter,\n    // thus, running the next opcode twice\n    // E.g\n    // 0x76 - halt\n    // FA 34 12 - ld a,(1234)\n    // Becomes\n    // FA FA 34 ld a,(34FA)\n    // 12 ld (de),a\n    var haltBugOpcode = eightBitLoadFromGBMemory(Cpu.programCounter); // Execute opcode will handle the actual PC behavior\n\n    var haltBugCycles = executeOpcode$$1(haltBugOpcode);\n    syncCycles(haltBugCycles);\n    Cpu.exitHaltAndStop();\n  } // Interrupts should be handled before reading an opcode\n  // https://github.com/Gekkio/mooneye-gb/blob/master/docs/accuracy.markdown#what-is-the-exact-timing-of-cpu-servicing-an-interrupt\n\n\n  var interruptCycles = checkInterrupts();\n\n  if (interruptCycles > 0) {\n    syncCycles(interruptCycles);\n  } // Get the opcode, and additional bytes to be handled\n  // Number of cycles defaults to 4, because while we're halted, we run 4 cycles (according to matt :))\n\n\n  var numberOfCycles = 4;\n  var opcode = 0; // If we are not halted or stopped, run instructions\n  // If we are halted, this will be skipped and just sync the 4 cycles\n\n  if (!Cpu.isHalted() && !Cpu.isStopped) {\n    opcode = eightBitLoadFromGBMemory(Cpu.programCounter);\n    numberOfCycles = executeOpcode$$1(opcode);\n  } // blarggFixes, don't allow register F to have the bottom nibble\n\n\n  Cpu.registerF = Cpu.registerF & 0xf0; // Check if there was an error decoding the opcode\n\n  if (numberOfCycles <= 0) {\n    return numberOfCycles;\n  } // Sync other GB Components with the number of cycles\n\n\n  syncCycles(numberOfCycles); // Update our steps\n\n  trackStepsRan(1); // Check if we reached the CPU breakpoint\n\n  if (Cpu.programCounter === Breakpoints.programCounter) {\n    Breakpoints.reachedBreakpoint = true;\n  }\n\n  return numberOfCycles;\n} // Imports\n// Grow our memory to the specified size\n\n\nif (memory.size() < WASMBOY_WASM_PAGES) {\n  memory.grow(WASMBOY_WASM_PAGES - memory.size());\n} // Function to track if the core has started\n\n\nvar hasStarted = false;\n\nfunction setHasCoreStarted(value) {\n  hasStarted = value;\n}\n\nfunction hasCoreStarted() {\n  return hasStarted;\n} // Function to configure & initialize wasmboy\n\n\nfunction config(enableBootRom, useGbcWhenAvailable, audioBatchProcessing, graphicsBatchProcessing, timersBatchProcessing, graphicsDisableScanlineRendering, audioAccumulateSamples, tileRendering, tileCaching, enableAudioDebugging) {\n  // TODO: depending on the boot rom, initialization may be different\n  // From: http://www.codeslinger.co.uk/pages/projects/gameboy/hardware.html\n  // All values default to zero in memory, so not setting them yet\n  // log('initializing (includeBootRom=$0)', 1, enableBootRom);\n  Config.enableBootRom = enableBootRom > 0;\n  Config.useGbcWhenAvailable = useGbcWhenAvailable > 0;\n  Config.audioBatchProcessing = audioBatchProcessing > 0;\n  Config.graphicsBatchProcessing = graphicsBatchProcessing > 0;\n  Config.timersBatchProcessing = timersBatchProcessing > 0;\n  Config.graphicsDisableScanlineRendering = graphicsDisableScanlineRendering > 0;\n  Config.audioAccumulateSamples = audioAccumulateSamples > 0;\n  Config.tileRendering = tileRendering > 0;\n  Config.tileCaching = tileCaching > 0;\n  Config.enableAudioDebugging = enableAudioDebugging > 0;\n  initialize();\n} // Function to initiialize the core\n\n\nfunction initialize() {\n  // Initialization variables from BGB\n  // First, try to switch to Gameboy Color Mode\n  // Get our GBC support from the cartridge header\n  // http://gbdev.gg8.se/wiki/articles/The_Cartridge_Header\n  var gbcType = eightBitLoadFromGBMemory(0x0143); // Detecting GBC http://bgb.bircd.org/pandocs.htm#cgbregisters\n\n  if (gbcType === 0xc0 || Config.useGbcWhenAvailable && gbcType === 0x80) {\n    Cpu.GBCEnabled = true;\n  } else {\n    Cpu.GBCEnabled = false;\n  } // Call our respective classes intialization\n\n\n  initializeCpu();\n  initializeCartridge();\n  initializeDma();\n  initializeGraphics();\n  initializePalette();\n  initializeSound();\n  initializeInterrupts();\n  initializeTimers();\n  initializeSerial(); // Various Other Registers\n\n  if (Cpu.GBCEnabled) {\n    // Various other registers\n    eightBitStoreIntoGBMemory(0xff70, 0xf8);\n    eightBitStoreIntoGBMemory(0xff4f, 0xfe);\n    eightBitStoreIntoGBMemory(0xff4d, 0x7e);\n    eightBitStoreIntoGBMemory(0xff00, 0xcf);\n    eightBitStoreIntoGBMemory(0xff0f, 0xe1); // 0xFFFF = 0x00\n    // Undocumented from Pandocs\n\n    eightBitStoreIntoGBMemory(0xff6c, 0xfe);\n    eightBitStoreIntoGBMemory(0xff75, 0x8f);\n  } else {\n    eightBitStoreIntoGBMemory(0xff70, 0xff);\n    eightBitStoreIntoGBMemory(0xff4f, 0xff);\n    eightBitStoreIntoGBMemory(0xff4d, 0xff);\n    eightBitStoreIntoGBMemory(0xff00, 0xcf);\n    eightBitStoreIntoGBMemory(0xff0f, 0xe1); // 0xFFFF = 0x00\n  } // Reset hasStarted, since we are now reset\n\n\n  setHasCoreStarted(false); // Reset our cycles ran\n\n  resetCycles();\n  resetSteps();\n} // Function to return if we are currently playing a GBC ROM\n\n\nfunction isGBC() {\n  return Cpu.GBCEnabled;\n} // Function to return an address to store into save state memory\n// this is to regulate our 20 slots\n// https://docs.google.com/spreadsheets/d/17xrEzJk5-sCB9J2mMJcVnzhbE-XH_NvczVSQH9OHvRk/edit?usp=sharing\n// Inlined because closure compiler inlines\n\n\nfunction getSaveStateMemoryOffset(offset, saveStateSlot) {\n  // 50 bytes per save state memory partiton sli32\n  return WASMBOY_STATE_LOCATION + offset + 50 * saveStateSlot;\n} // Function to save state to memory for all of our classes\n\n\nfunction saveState() {\n  Cpu.saveState();\n  Graphics.saveState();\n  Interrupts.saveState();\n  Joypad.saveState();\n  Memory.saveState();\n  Timers.saveState();\n  Sound.saveState();\n  Channel1.saveState();\n  Channel2.saveState();\n  Channel3.saveState();\n  Channel4.saveState(); // Reset hasStarted, since we are now reset\n\n  setHasCoreStarted(false); // Don't want to reset cycles here, as this does not reset the emulator\n} // Function to load state from memory for all of our classes\n\n\nfunction loadState() {\n  Cpu.loadState();\n  Graphics.loadState();\n  Interrupts.loadState();\n  Joypad.loadState();\n  Memory.loadState();\n  Timers.loadState();\n  Sound.loadState();\n  Channel1.loadState();\n  Channel2.loadState();\n  Channel3.loadState();\n  Channel4.loadState(); // Reset hasStarted, since we are now reset\n\n  setHasCoreStarted(false); // Reset our cycles ran\n\n  resetCycles();\n  resetSteps();\n} // Functions to get information about the emulator for debugging purposes\n\n\nfunction getRegisterA() {\n  return Cpu.registerA;\n}\n\nfunction getRegisterB() {\n  return Cpu.registerB;\n}\n\nfunction getRegisterC() {\n  return Cpu.registerC;\n}\n\nfunction getRegisterD() {\n  return Cpu.registerD;\n}\n\nfunction getRegisterE() {\n  return Cpu.registerE;\n}\n\nfunction getRegisterH() {\n  return Cpu.registerH;\n}\n\nfunction getRegisterL() {\n  return Cpu.registerL;\n}\n\nfunction getRegisterF() {\n  return Cpu.registerF;\n}\n\nfunction getProgramCounter() {\n  return Cpu.programCounter;\n}\n\nfunction getStackPointer() {\n  return Cpu.stackPointer;\n}\n\nfunction getOpcodeAtProgramCounter() {\n  return eightBitLoadFromGBMemory(Cpu.programCounter);\n} // Functions to debug graphical output\n// Some Simple internal getters\n\n\nfunction getLY() {\n  return Graphics.scanlineRegister;\n} // TODO: Render by tile, rather than by pixel\n\n\nfunction drawBackgroundMapToWasmMemory(showColor) {\n  // http://www.codeslinger.co.uk/pages/projects/gameboy/graphics.html\n  // Bit 7 - LCD Display Enable (0=Off, 1=On)\n  // Bit 6 - Window Tile Map Display Select (0=9800-9BFF, 1=9C00-9FFF)\n  // Bit 5 - Window Display Enable (0=Off, 1=On)\n  // Bit 4 - BG & Window Tile Data Select (0=8800-97FF, 1=8000-8FFF)\n  // Bit 3 - BG Tile Map Display Select (0=9800-9BFF, 1=9C00-9FFF)\n  // Bit 2 - OBJ (Sprite) Size (0=8x8, 1=8x16)\n  // Bit 1 - OBJ (Sprite) Display Enable (0=Off, 1=On)\n  // Bit 0 - BG Display (for CGB see below) (0=Off, 1=On)\n  // Get our seleted tile data memory location\n  var tileDataMemoryLocation = Graphics.memoryLocationTileDataSelectZeroStart;\n\n  if (Lcd.bgWindowTileDataSelect) {\n    tileDataMemoryLocation = Graphics.memoryLocationTileDataSelectOneStart;\n  }\n\n  var tileMapMemoryLocation = Graphics.memoryLocationTileMapSelectZeroStart;\n\n  if (Lcd.bgTileMapDisplaySelect) {\n    tileMapMemoryLocation = Graphics.memoryLocationTileMapSelectOneStart;\n  }\n\n  for (var y = 0; y < 256; y++) {\n    for (var x = 0; x < 256; x++) {\n      // Get our current Y\n      var pixelYPositionInMap = y; // Get our Current X position of our pixel on the on the 160x144 camera\n      // this is done by getting the current scroll X position,\n      // and adding it do what X Value the scanline is drawing on the camera.\n\n      var pixelXPositionInMap = x; // Divide our pixel position by 8 to get our tile.\n      // Since, there are 256x256 pixels, and 32x32 tiles.\n      // 256 / 8 = 32.\n      // Also, bitshifting by 3, do do a division by 8\n      // Need to use u16s, as they will be used to compute an address, which will cause weird errors and overflows\n\n      var tileXPositionInMap = pixelXPositionInMap >> 3;\n      var tileYPositionInMap = pixelYPositionInMap >> 3; // Get our tile address on the tileMap\n      // NOTE: (tileMap represents where each tile is displayed on the screen)\n      // NOTE: (tile map represents the entire map, now just what is within the \"camera\")\n      // For instance, if we have y pixel 144. 144 / 8 = 18. 18 * 32 = line address in map memory.\n      // And we have x pixel 160. 160 / 8 = 20.\n      // * 32, because remember, this is NOT only for the camera, the actual map is 32x32. Therefore, the next tile line of the map, is 32 byte offset.\n      // Think like indexing a 2d array, as a 1d array and it make sense :)\n\n      var tileMapAddress = tileMapMemoryLocation + tileYPositionInMap * 32 + tileXPositionInMap; // Get the tile Id on the Tile Map\n\n      var tileIdFromTileMap = loadFromVramBank(tileMapAddress, 0); // Now get our tileDataAddress for the corresponding tileID we found in the map\n      // Read the comments in _getTileDataAddress() to see what's going on.\n      // tl;dr if we had the tile map of \"a b c d\", and wanted tileId 2.\n      // This funcitons returns the start of memory locaiton for the tile 'c'.\n\n      var tileDataAddress = getTileDataAddress(tileDataMemoryLocation, tileIdFromTileMap); // Now we can process the the individual bytes that represent the pixel on a tile\n      // Get the y pixel of the 8 by 8 tile.\n      // Simply modulo the scanline.\n      // For instance, let's say we are printing the first line of pixels on our camera,\n      // And the first line of pixels on our tile.\n      // yPixel = 1. 1 % 8 = 1.\n      // And for the last line\n      // yPixel = 144. 144 % 8 = 0.\n      // 0 Represents last line of pixels in a tile, 1 represents first. 1 2 3 4 5 6 7 0.\n      // Because remember, we are counting lines on the display NOT including zero\n\n      var pixelYInTile = pixelYPositionInMap % 8; // Same logic as pixelYInTile.\n      // However, We need to reverse our byte,\n      // As pixel 0 is on byte 7, and pixel 1 is on byte 6, etc...\n      // Therefore, is pixelX was 2, then really is need to be 5\n      // So 2 - 7 = -5, * 1 = 5\n      // Or to simplify, 7 - 2 = 5 haha!\n\n      var pixelXInTile = pixelXPositionInMap % 8;\n      pixelXInTile = 7 - pixelXInTile; // Get the GB Map Attributes\n      // Bit 0-2  Background Palette number  (BGP0-7)\n      // Bit 3    Tile VRAM Bank number      (0=Bank 0, 1=Bank 1)\n      // Bit 4    Not used\n      // Bit 5    Horizontal Flip            (0=Normal, 1=Mirror horizontally)\n      // Bit 6    Vertical Flip              (0=Normal, 1=Mirror vertically)\n      // Bit 7    BG-to-OAM Priority         (0=Use OAM priority bit, 1=BG Priority)\n\n      var bgMapAttributes = 0;\n\n      if (Cpu.GBCEnabled && showColor > 0) {\n        bgMapAttributes = loadFromVramBank(tileMapAddress, 1);\n      }\n\n      if (checkBitOnByte(6, bgMapAttributes)) {\n        // We are mirroring the tile, therefore, we need to opposite byte\n        // So if our pizel was 0 our of 8, it wild become 7 :)\n        // TODO: This may be wrong :p\n        pixelYInTile = 7 - pixelYInTile;\n      } // Remember to represent a single line of 8 pixels on a tile, we need two bytes.\n      // Therefore, we need to times our modulo by 2, to get the correct line of pixels on the tile.\n      // But we need to load the time from a specific Vram bank\n\n\n      var vramBankId = 0;\n\n      if (checkBitOnByte(3, bgMapAttributes)) {\n        vramBankId = 1;\n      } // Remember to represent a single line of 8 pixels on a tile, we need two bytes.\n      // Therefore, we need to times our modulo by 2, to get the correct line of pixels on the tile.\n      // Again, think like you had to map a 2d array as a 1d.\n\n\n      var byteOneForLineOfTilePixels = loadFromVramBank(tileDataAddress + pixelYInTile * 2, vramBankId);\n      var byteTwoForLineOfTilePixels = loadFromVramBank(tileDataAddress + pixelYInTile * 2 + 1, vramBankId); // Now we can get the color for that pixel\n      // Colors are represented by getting X position of ByteTwo, and X positon of Byte One\n      // To Get the color Id.\n      // For example, the result of the color id is 0000 00[xPixelByteTwo][xPixelByteOne]\n      // See: How to draw a tile/sprite from memory: http://www.codeslinger.co.uk/pages/projects/gameboy/graphics.html\n\n      var paletteColorId = 0;\n\n      if (checkBitOnByte(pixelXInTile, byteTwoForLineOfTilePixels)) {\n        // Byte one represents the second bit in our color id, so bit shift\n        paletteColorId += 1;\n        paletteColorId = paletteColorId << 1;\n      }\n\n      if (checkBitOnByte(pixelXInTile, byteOneForLineOfTilePixels)) {\n        paletteColorId += 1;\n      } // FINALLY, RENDER THAT PIXEL!\n\n\n      var pixelStart = (y * 256 + x) * 3;\n\n      if (Cpu.GBCEnabled && showColor > 0) {\n        // Finally lets add some, C O L O R\n        // Want the botom 3 bits\n        var bgPalette = bgMapAttributes & 0x07; // Call the helper function to grab the correct color from the palette\n\n        var rgbColorPalette = getRgbColorFromPalette(bgPalette, paletteColorId, false); // Split off into red green and blue\n\n        var red = getColorComponentFromRgb(0, rgbColorPalette);\n        var green = getColorComponentFromRgb(1, rgbColorPalette);\n        var blue = getColorComponentFromRgb(2, rgbColorPalette);\n        var offset = BACKGROUND_MAP_LOCATION + pixelStart;\n        store(offset, red);\n        store(offset + 1, green);\n        store(offset + 2, blue);\n      } else {\n        // Only rendering camera for now, so coordinates are for the camera.\n        // Get the rgb value for the color Id, will be repeated into R, G, B (if not colorized)\n        var hexColor = getColorizedGbHexColorFromPalette(paletteColorId, Graphics.memoryLocationBackgroundPalette);\n        var offset = BACKGROUND_MAP_LOCATION + pixelStart; // Red\n\n        store(offset + 0, getRedFromHexColor(hexColor)); // Green\n\n        store(offset + 1, getGreenFromHexColor(hexColor)); // Blue\n\n        store(offset + 2, getBlueFromHexColor(hexColor));\n      }\n    }\n  }\n}\n\nfunction drawTileDataToWasmMemory() {\n  for (var tileDataMapGridY = 0; tileDataMapGridY < 0x17; tileDataMapGridY++) {\n    for (var tileDataMapGridX = 0; tileDataMapGridX < 0x1f; tileDataMapGridX++) {\n      // Get Our VramBankID\n      var vramBankId = 0;\n\n      if (tileDataMapGridX > 0x0f) {\n        vramBankId = 1;\n      } // Get our tile ID\n\n\n      var tileId = tileDataMapGridY;\n\n      if (tileDataMapGridY > 0x0f) {\n        tileId -= 0x0f;\n      }\n\n      tileId = tileId << 4;\n\n      if (tileDataMapGridX > 0x0f) {\n        tileId = tileId + (tileDataMapGridX - 0x0f);\n      } else {\n        tileId = tileId + tileDataMapGridX;\n      } // Finally get our tile Data location\n\n\n      var tileDataMemoryLocation = Graphics.memoryLocationTileDataSelectOneStart;\n\n      if (tileDataMapGridY > 0x0f) {\n        tileDataMemoryLocation = Graphics.memoryLocationTileDataSelectZeroStart;\n      } // Let's see if we have C O L O R\n      // Set the map and sprite attributes to -1\n      // Meaning, we will draw monochrome\n\n\n      var paletteLocation = Graphics.memoryLocationBackgroundPalette;\n      var bgMapAttributes = -1;\n      var spriteAttributes = -1; // Let's see if the tile is being used by a sprite\n\n      for (var spriteRow = 0; spriteRow < 8; spriteRow++) {\n        for (var spriteColumn = 0; spriteColumn < 5; spriteColumn++) {\n          var spriteIndex = spriteColumn * 8 + spriteRow; // Sprites occupy 4 bytes in the sprite attribute table\n\n          var spriteTableIndex = spriteIndex * 4;\n          var spriteTileId = eightBitLoadFromGBMemory(Graphics.memoryLocationSpriteAttributesTable + spriteTableIndex + 2);\n\n          if (tileId === spriteTileId) {\n            var currentSpriteAttributes = eightBitLoadFromGBMemory(Graphics.memoryLocationSpriteAttributesTable + spriteTableIndex + 3);\n            var spriteVramBankId = 0;\n\n            if (Cpu.GBCEnabled && checkBitOnByte(3, currentSpriteAttributes)) {\n              spriteVramBankId = 1;\n            }\n\n            if (spriteVramBankId === vramBankId) {\n              spriteAttributes = currentSpriteAttributes;\n              spriteRow = 8;\n              spriteColumn = 5; // Set our paletteLocation\n\n              paletteLocation = Graphics.memoryLocationSpritePaletteOne;\n\n              if (checkBitOnByte(4, spriteAttributes)) {\n                paletteLocation = Graphics.memoryLocationSpritePaletteTwo;\n              }\n            }\n          }\n        }\n      } // If we didn't find a sprite,\n      // Let's see if the tile is on the bg tile map\n      // If so, use that bg map for attributes\n\n\n      if (Cpu.GBCEnabled && spriteAttributes < 0) {\n        var tileMapMemoryLocation = Graphics.memoryLocationTileMapSelectZeroStart;\n\n        if (Lcd.bgTileMapDisplaySelect) {\n          tileMapMemoryLocation = Graphics.memoryLocationTileMapSelectOneStart;\n        } // Loop through the tileMap, and find if we have our current ID\n\n\n        var foundTileMapAddress = -1;\n\n        for (var x = 0; x < 32; x++) {\n          for (var y = 0; y < 32; y++) {\n            var tileMapAddress = tileMapMemoryLocation + y * 32 + x;\n            var tileIdFromTileMap = loadFromVramBank(tileMapAddress, 0); // Check if we found our tileId\n\n            if (tileId === tileIdFromTileMap) {\n              foundTileMapAddress = tileMapAddress;\n              x = 32;\n              y = 32;\n            }\n          }\n        }\n\n        if (foundTileMapAddress >= 0) {\n          bgMapAttributes = loadFromVramBank(foundTileMapAddress, 1);\n        }\n      } // Draw each Y line of the tile\n\n\n      for (var tileLineY = 0; tileLineY < 8; tileLineY++) {\n        drawPixelsFromLineOfTile(tileId, // tileId\n        tileDataMemoryLocation, // Graphics.memoryLocationTileDataSelect\n        vramBankId, // Vram Bank\n        0, // Tile Line X Start\n        7, // Tile Line X End\n        tileLineY, // Tile Line Y\n        tileDataMapGridX * 8, // Output line X\n        tileDataMapGridY * 8 + tileLineY, // Output line Y\n        0x1f * 8, // Output Width\n        TILE_DATA_LOCATION, // Wasm Memory Start\n        false, // shouldRepresentMonochromeColorByColorId\n        paletteLocation, // paletteLocation\n        bgMapAttributes, // bgMapAttributes\n        spriteAttributes // spriteAttributes\n        );\n      }\n    }\n  }\n}\n\nfunction drawOamToWasmMemory() {\n  // Draw all 40 sprites\n  // Going to be like BGB and do 8 x 5 sprites\n  for (var spriteRow = 0; spriteRow < 8; spriteRow++) {\n    for (var spriteColumn = 0; spriteColumn < 5; spriteColumn++) {\n      var spriteIndex = spriteColumn * 8 + spriteRow; // Sprites occupy 4 bytes in the sprite attribute table\n\n      var spriteTableIndex = spriteIndex * 4; // Y positon is offset by 16, X position is offset by 8\n\n      var spriteYPosition = eightBitLoadFromGBMemory(Graphics.memoryLocationSpriteAttributesTable + spriteTableIndex);\n      var spriteXPosition = eightBitLoadFromGBMemory(Graphics.memoryLocationSpriteAttributesTable + spriteTableIndex + 1);\n      var spriteTileId = eightBitLoadFromGBMemory(Graphics.memoryLocationSpriteAttributesTable + spriteTableIndex + 2);\n      var tilesToDraw = 1;\n\n      if (Lcd.tallSpriteSize) {\n        // @binji says in 8x16 mode, even tileId always drawn first\n        // This will fix shantae sprites which always uses odd numbered indexes\n        // TODO: Do the actual Pandocs thing:\n        // \"In 8x16 mode, the lower bit of the tile number is ignored. Ie. the upper 8x8 tile is \"NN AND FEh\", and the lower 8x8 tile is \"NN OR 01h\".\"\n        // So just knock off the last bit? :)\n        if (spriteTileId % 2 === 1) {\n          spriteTileId -= 1;\n        }\n\n        tilesToDraw += 1;\n      } // Get our sprite attributes since we know we shall be drawing the tile\n\n\n      var spriteAttributes = eightBitLoadFromGBMemory(Graphics.memoryLocationSpriteAttributesTable + spriteTableIndex + 3); // Find which VRAM Bank to load from\n\n      var vramBankId = 0;\n\n      if (Cpu.GBCEnabled && checkBitOnByte(3, spriteAttributes)) {\n        vramBankId = 1;\n      } // Find which monochrome palette we should use\n\n\n      var paletteLocation = Graphics.memoryLocationSpritePaletteOne;\n\n      if (checkBitOnByte(4, spriteAttributes)) {\n        paletteLocation = Graphics.memoryLocationSpritePaletteTwo;\n      } // Start Drawing our tiles\n\n\n      for (var i = 0; i < tilesToDraw; i++) {\n        // Draw each Y line of the tile\n        for (var tileLineY = 0; tileLineY < 8; tileLineY++) {\n          drawPixelsFromLineOfTile(spriteTileId + i, // tileId\n          Graphics.memoryLocationTileDataSelectOneStart, // Graphics.memoryLocationTileDataSelect\n          vramBankId, // VRAM Bank\n          0, // Tile Line X Start\n          7, // Tile Line X End\n          tileLineY, // Tile Line Y\n          spriteRow * 8, // Output line X\n          spriteColumn * 16 + tileLineY + i * 8, // Output line Y\n          8 * 8, // Output Width\n          OAM_TILES_LOCATION, // Wasm Memory Start\n          false, // shouldRepresentMonochromeColorByColorId\n          paletteLocation, // paletteLocation\n          -1, // bgMapAttributes\n          spriteAttributes // spriteAttributes\n          );\n        }\n      }\n    }\n  }\n}\n\nfunction getDIV() {\n  return Timers.dividerRegister;\n}\n\nfunction getTIMA() {\n  return Timers.timerCounter;\n}\n\nfunction getTMA() {\n  return Timers.timerModulo;\n}\n\nfunction getTAC() {\n  var response = Timers.timerInputClock;\n\n  if (Timers.timerEnabled) {\n    response = setBitOnByte(2, response);\n  }\n\n  return response;\n} // Functions to debug internal gameboy memory\n\n\nfunction updateDebugGBMemory() {\n  for (var i = 0; i < DEBUG_GAMEBOY_MEMORY_SIZE; i++) {\n    store(DEBUG_GAMEBOY_MEMORY_LOCATION + i, eightBitLoadFromGBMemoryWithTraps(i));\n  } // Since we are debugging, we don't want to be responsible for tripping the breakpoints\n\n\n  Breakpoints.reachedBreakpoint = false;\n} // Public Exports\n\nvar WasmBoyCore = /*#__PURE__*/Object.freeze({\n  memory: memory,\n  config: config,\n  hasCoreStarted: hasCoreStarted,\n  saveState: saveState,\n  loadState: loadState,\n  isGBC: isGBC,\n  getStepsPerStepSet: getStepsPerStepSet,\n  getStepSets: getStepSets,\n  getSteps: getSteps,\n  executeMultipleFrames: executeMultipleFrames,\n  executeFrame: executeFrame,\n  executeFrameAndCheckAudio: executeFrameAndCheckAudio,\n  executeUntilCondition: executeUntilCondition,\n  executeStep: executeStep,\n  getCyclesPerCycleSet: getCyclesPerCycleSet,\n  getCycleSets: getCycleSets,\n  getCycles: getCycles,\n  setJoypadState: setJoypadState,\n  getNumberOfSamplesInAudioBuffer: getNumberOfSamplesInAudioBuffer,\n  clearAudioBuffer: clearAudioBuffer,\n  setManualColorizationPalette: setManualColorizationPalette,\n  WASMBOY_MEMORY_LOCATION: WASMBOY_MEMORY_LOCATION,\n  WASMBOY_MEMORY_SIZE: WASMBOY_MEMORY_SIZE,\n  WASMBOY_WASM_PAGES: WASMBOY_WASM_PAGES,\n  ASSEMBLYSCRIPT_MEMORY_LOCATION: ASSEMBLYSCRIPT_MEMORY_LOCATION,\n  ASSEMBLYSCRIPT_MEMORY_SIZE: ASSEMBLYSCRIPT_MEMORY_SIZE,\n  WASMBOY_STATE_LOCATION: WASMBOY_STATE_LOCATION,\n  WASMBOY_STATE_SIZE: WASMBOY_STATE_SIZE,\n  GAMEBOY_INTERNAL_MEMORY_LOCATION: GAMEBOY_INTERNAL_MEMORY_LOCATION,\n  GAMEBOY_INTERNAL_MEMORY_SIZE: GAMEBOY_INTERNAL_MEMORY_SIZE,\n  VIDEO_RAM_LOCATION: VIDEO_RAM_LOCATION,\n  VIDEO_RAM_SIZE: VIDEO_RAM_SIZE,\n  WORK_RAM_LOCATION: WORK_RAM_LOCATION,\n  WORK_RAM_SIZE: WORK_RAM_SIZE,\n  OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION: OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION,\n  OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE: OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE,\n  GRAPHICS_OUTPUT_LOCATION: GRAPHICS_OUTPUT_LOCATION,\n  GRAPHICS_OUTPUT_SIZE: GRAPHICS_OUTPUT_SIZE,\n  GBC_PALETTE_LOCATION: GBC_PALETTE_LOCATION,\n  GBC_PALETTE_SIZE: GBC_PALETTE_SIZE,\n  BG_PRIORITY_MAP_LOCATION: BG_PRIORITY_MAP_LOCATION,\n  BG_PRIORITY_MAP_SIZE: BG_PRIORITY_MAP_SIZE,\n  FRAME_LOCATION: FRAME_LOCATION,\n  FRAME_SIZE: FRAME_SIZE,\n  BACKGROUND_MAP_LOCATION: BACKGROUND_MAP_LOCATION,\n  BACKGROUND_MAP_SIZE: BACKGROUND_MAP_SIZE,\n  TILE_DATA_LOCATION: TILE_DATA_LOCATION,\n  TILE_DATA_SIZE: TILE_DATA_SIZE,\n  OAM_TILES_LOCATION: OAM_TILES_LOCATION,\n  OAM_TILES_SIZE: OAM_TILES_SIZE,\n  AUDIO_BUFFER_LOCATION: AUDIO_BUFFER_LOCATION,\n  AUDIO_BUFFER_SIZE: AUDIO_BUFFER_SIZE,\n  CHANNEL_1_BUFFER_LOCATION: CHANNEL_1_BUFFER_LOCATION,\n  CHANNEL_1_BUFFER_SIZE: CHANNEL_1_BUFFER_SIZE,\n  CHANNEL_2_BUFFER_LOCATION: CHANNEL_2_BUFFER_LOCATION,\n  CHANNEL_2_BUFFER_SIZE: CHANNEL_2_BUFFER_SIZE,\n  CHANNEL_3_BUFFER_LOCATION: CHANNEL_3_BUFFER_LOCATION,\n  CHANNEL_3_BUFFER_SIZE: CHANNEL_3_BUFFER_SIZE,\n  CHANNEL_4_BUFFER_LOCATION: CHANNEL_4_BUFFER_LOCATION,\n  CHANNEL_4_BUFFER_SIZE: CHANNEL_4_BUFFER_SIZE,\n  CARTRIDGE_RAM_LOCATION: CARTRIDGE_RAM_LOCATION,\n  CARTRIDGE_RAM_SIZE: CARTRIDGE_RAM_SIZE,\n  CARTRIDGE_ROM_LOCATION: CARTRIDGE_ROM_LOCATION,\n  CARTRIDGE_ROM_SIZE: CARTRIDGE_ROM_SIZE,\n  DEBUG_GAMEBOY_MEMORY_LOCATION: DEBUG_GAMEBOY_MEMORY_LOCATION,\n  DEBUG_GAMEBOY_MEMORY_SIZE: DEBUG_GAMEBOY_MEMORY_SIZE,\n  getWasmBoyOffsetFromGameBoyOffset: getWasmBoyOffsetFromGameBoyOffset,\n  setProgramCounterBreakpoint: setProgramCounterBreakpoint,\n  resetProgramCounterBreakpoint: resetProgramCounterBreakpoint,\n  setReadGbMemoryBreakpoint: setReadGbMemoryBreakpoint,\n  resetReadGbMemoryBreakpoint: resetReadGbMemoryBreakpoint,\n  setWriteGbMemoryBreakpoint: setWriteGbMemoryBreakpoint,\n  resetWriteGbMemoryBreakpoint: resetWriteGbMemoryBreakpoint,\n  getRegisterA: getRegisterA,\n  getRegisterB: getRegisterB,\n  getRegisterC: getRegisterC,\n  getRegisterD: getRegisterD,\n  getRegisterE: getRegisterE,\n  getRegisterH: getRegisterH,\n  getRegisterL: getRegisterL,\n  getRegisterF: getRegisterF,\n  getProgramCounter: getProgramCounter,\n  getStackPointer: getStackPointer,\n  getOpcodeAtProgramCounter: getOpcodeAtProgramCounter,\n  getLY: getLY,\n  drawBackgroundMapToWasmMemory: drawBackgroundMapToWasmMemory,\n  drawTileDataToWasmMemory: drawTileDataToWasmMemory,\n  drawOamToWasmMemory: drawOamToWasmMemory,\n  getDIV: getDIV,\n  getTIMA: getTIMA,\n  getTMA: getTMA,\n  getTAC: getTAC,\n  updateDebugGBMemory: updateDebugGBMemory\n});\n\nconst getWasmBoyTsCore = async () => {\n  const response = {\n    instance: {\n      exports: WasmBoyCore\n    },\n    byteMemory: memory.wasmByteMemory,\n    type: 'TypeScript'\n  };\n  return response;\n};\n\nexport default getWasmBoyTsCore;\n","// Common Static functions\n\n// Function to get performance timestamp\n// This is to support node vs. Browser\nexport const getPerformanceTimestamp = () => {\n  if (typeof window !== 'undefined') {\n    return performance.now();\n  }\n  return Date.now();\n};\n","import { getPerformanceTimestamp } from '../../common/common';\n\n// Function to add a timestamp to keep track\n// of how fast we are running\nexport function addTimeStamp(libWorker) {\n  // Track our Fps\n  // http://www.growingwiththeweb.com/2017/12/fast-simple-js-fps-counter.html\n  const currentHighResTime = getPerformanceTimestamp();\n  while (libWorker.fpsTimeStamps[0] < currentHighResTime - 1000) {\n    libWorker.fpsTimeStamps.shift();\n  }\n  libWorker.fpsTimeStamps.push(currentHighResTime);\n\n  libWorker.timeStampsUntilReady--;\n  if (libWorker.timeStampsUntilReady < 0) {\n    libWorker.timeStampsUntilReady = 0;\n  }\n\n  return currentHighResTime;\n}\n\n// Function to wait for a specified number,\n// of timestamps before setting the framerate\nexport function waitForTimeStampsForFrameRate(libWorker) {\n  if (libWorker.options.gameboyFrameRate <= 90) {\n    libWorker.timeStampsUntilReady = Math.floor(libWorker.options.gameboyFrameRate) * 1.25;\n  } else {\n    // Fast stretching should be hardcoded, that way it doesn't just say a large number for a long time\n    libWorker.timeStampsUntilReady = 120;\n  }\n}\n","// Imports\nimport { postMessage } from '../../../worker/workerapi';\nimport { getSmartWorkerMessage } from '../../../worker/smartworker';\nimport { WORKER_MESSAGE_TYPE, MEMORY_TYPE } from '../../../worker/constants';\n\nexport function transferGraphics(libWorker) {\n  const graphicsFrameEndIndex = libWorker.WASMBOY_CURRENT_FRAME_OUTPUT_LOCATION + libWorker.WASMBOY_CURRENT_FRAME_SIZE;\n  const graphicsFrameBuffer = libWorker.wasmByteMemory.slice(libWorker.WASMBOY_CURRENT_FRAME_OUTPUT_LOCATION, graphicsFrameEndIndex).buffer;\n  //libWorker.graphicsWorkerPort.postMessage(graphicsFrameBuffer, [graphicsFrameBuffer]);\n  libWorker.graphicsWorkerPort.postMessage(\n    getSmartWorkerMessage({\n      type: WORKER_MESSAGE_TYPE.UPDATED,\n      graphicsFrameBuffer\n    }),\n    [graphicsFrameBuffer]\n  );\n}\n","// Start our update and render process\n// Can't time by raf, as raf is not garunteed to be 60fps\n// Need to run like a web game, where updates to the state of the core are done a 60 fps\n// but we can render whenever the user would actually see the changes browser side in a raf\n// https://developer.mozilla.org/en-US/docs/Games/Anatomy\n\n// Imports\nimport { postMessage } from '../../worker/workerapi';\nimport { getSmartWorkerMessage } from '../../worker/smartworker';\nimport { WORKER_MESSAGE_TYPE, MEMORY_TYPE } from '../../worker/constants';\n\n// Memory\nimport { getCartridgeRam } from './memory/ram.js';\nimport { getGameBoyMemory } from './memory/gameboymemory.js';\nimport { getPaletteMemory } from './memory/palettememory.js';\nimport { getInternalState } from './memory/internalstate.js';\n\n// Timestamps\nimport { getPerformanceTimestamp } from '../../common/common';\nimport { addTimeStamp, waitForTimeStampsForFrameRate } from './timestamp';\n\n// Transferring\nimport { transferGraphics } from './graphics/transfer';\n\n// Some variables to help with Audio Latency\n// 0.25 (quarter of a second), just felt right from testing :)\nconst MAX_AUDIO_LATENCY = 0.25;\n// Pass over samples once we have enough worth playing:\n// https://www.reddit.com/r/EmuDev/comments/5gkwi5/gb_apu_sound_emulation/\nconst AUDIO_BUFFER_SIZE = 1024;\n\n// FPS measuring\nlet currentHighResTime;\nlet currentFps;\nlet gameboyFrameRateWithSpeed;\n\n// interval to set timeout\nlet intervalRate;\n\nfunction scheduleNextUpdate(libWorker) {\n  // Get our high res time\n  const highResTime = getPerformanceTimestamp();\n\n  // Find how long it has been since the last timestamp\n  const timeSinceLastTimestamp = highResTime - libWorker.fpsTimeStamps[libWorker.fpsTimeStamps.length - 1];\n\n  // Get the next time we should update using our interval rate\n  let nextUpdateTime = intervalRate - timeSinceLastTimestamp;\n  if (nextUpdateTime < 0) {\n    nextUpdateTime = 0;\n  }\n\n  // Lastly, increase by our lib worker speed\n  if (libWorker.speed && libWorker.speed > 0) {\n    nextUpdateTime = nextUpdateTime / libWorker.speed;\n  }\n\n  libWorker.updateId = setTimeout(() => {\n    update(libWorker);\n  }, Math.floor(nextUpdateTime));\n}\n\n// Function to run an update on the emulator itself\nexport function update(libWorker, passedIntervalRate) {\n  // Don't run if paused\n  if (libWorker.paused) {\n    return true;\n  }\n\n  // Set the intervalRate if it was passed\n  if (passedIntervalRate !== undefined) {\n    intervalRate = passedIntervalRate;\n  }\n\n  // Set a timestamp for this moment\n  // And make sure we are on track for FPS\n  currentFps = libWorker.getFPS();\n  gameboyFrameRateWithSpeed = libWorker.options.gameboyFrameRate + 1;\n\n  if (libWorker.speed && libWorker.speed > 0) {\n    gameboyFrameRateWithSpeed = gameboyFrameRateWithSpeed * libWorker.speed;\n  }\n\n  if (currentFps > gameboyFrameRateWithSpeed) {\n    // Pop a timestamp off of the front\n    // This is to avoid infinite loop here on loadstate\n    libWorker.fpsTimeStamps.shift();\n    scheduleNextUpdate(libWorker);\n    return true;\n  } else {\n    currentHighResTime = addTimeStamp(libWorker);\n  }\n\n  // Check if we are outputting audio\n  const shouldCheckAudio = !libWorker.options.headless && !libWorker.pauseFpsThrottle && libWorker.options.isAudioEnabled;\n\n  // Execute\n  // Wrapped in promise to better handle audio slowdowns and things of that sort\n  const executePromise = new Promise(resolve => {\n    // Update (Execute a frame)\n    let response;\n    if (shouldCheckAudio) {\n      executeAndCheckAudio(libWorker, resolve);\n    } else {\n      response = libWorker.wasmInstance.exports.executeFrame();\n      resolve(response);\n    }\n  });\n\n  executePromise.then(response => {\n    // Handle our update() response\n    if (response >= 0) {\n      // Pass messages to everyone\n      postMessage(\n        getSmartWorkerMessage({\n          type: WORKER_MESSAGE_TYPE.UPDATED,\n          fps: currentFps\n        })\n      );\n\n      // Check if we have frameskip\n      let shouldSkipRenderingFrame = false;\n      if (libWorker.options.frameSkip && libWorker.options.frameSkip > 0) {\n        libWorker.frameSkipCounter++;\n\n        if (libWorker.frameSkipCounter <= libWorker.options.frameSkip) {\n          shouldSkipRenderingFrame = true;\n        } else {\n          libWorker.frameSkipCounter = 0;\n        }\n      }\n\n      // Transfer Graphics\n      if (!shouldSkipRenderingFrame) {\n        transferGraphics(libWorker);\n      }\n\n      // Transfer Memory for things like save states\n      const memoryObject = {\n        type: WORKER_MESSAGE_TYPE.UPDATED\n      };\n      memoryObject[MEMORY_TYPE.CARTRIDGE_RAM] = getCartridgeRam(libWorker).buffer;\n      memoryObject[MEMORY_TYPE.GAMEBOY_MEMORY] = getGameBoyMemory(libWorker).buffer;\n      memoryObject[MEMORY_TYPE.PALETTE_MEMORY] = getPaletteMemory(libWorker).buffer;\n      memoryObject[MEMORY_TYPE.INTERNAL_STATE] = getInternalState(libWorker).buffer;\n\n      // Check for any undefined values\n      Object.keys(memoryObject).forEach(key => {\n        if (memoryObject[key] === undefined) {\n          memoryObject[key] = new Uint8Array().buffer;\n        }\n      });\n\n      libWorker.memoryWorkerPort.postMessage(getSmartWorkerMessage(memoryObject), [\n        memoryObject[MEMORY_TYPE.CARTRIDGE_RAM],\n        memoryObject[MEMORY_TYPE.GAMEBOY_MEMORY],\n        memoryObject[MEMORY_TYPE.PALETTE_MEMORY],\n        memoryObject[MEMORY_TYPE.INTERNAL_STATE]\n      ]);\n\n      // Check if we hit a breakpoint\n      if (response === 2) {\n        postMessage(\n          getSmartWorkerMessage({\n            type: WORKER_MESSAGE_TYPE.BREAKPOINT\n          })\n        );\n      } else {\n        scheduleNextUpdate(libWorker);\n      }\n    } else {\n      postMessage(\n        getSmartWorkerMessage({\n          type: WORKER_MESSAGE_TYPE.CRASHED\n        })\n      );\n      libWorker.paused = true;\n    }\n  });\n}\n\n// If audio is enabled, sync by audio\n// Audio will pass us its forward latency, and if it is too far ahead,\n// Then we can wait a little bit to let audio catch up\n// 0.25 (quarter of a second), just felt right from testing :)\nfunction executeAndCheckAudio(libWorker, resolve) {\n  // Get our response\n  let response = -1;\n  response = libWorker.wasmInstance.exports.executeFrameAndCheckAudio(AUDIO_BUFFER_SIZE);\n\n  // If our response is not 1, simply resolve\n  if (response !== 1) {\n    resolve(response);\n  }\n\n  // Do some audio magic\n  if (response === 1) {\n    // Get our audioQueueIndex\n    const audioQueueIndex = libWorker.wasmInstance.exports.getNumberOfSamplesInAudioBuffer();\n\n    // Check if we are sending too much audio\n    const isTooMuchLatency = libWorker.currentAudioLatencyInSeconds > MAX_AUDIO_LATENCY;\n    const isRunningFullSpeed = currentFps >= gameboyFrameRateWithSpeed;\n\n    if (isTooMuchLatency && isRunningFullSpeed) {\n      sendAudio(libWorker, audioQueueIndex);\n      // Wait, Set a timeout for when we would like to\n      // Continue executing. * 1000 for seconds -> milli\n      // Wait for half the difference, since it may take time to execute, and things\n      const latencyDifferenceInSeconds = libWorker.currentAudioLatencyInSeconds - MAX_AUDIO_LATENCY;\n      const latencyDifferenceInMilli = Math.floor(latencyDifferenceInSeconds * 1000);\n      setTimeout(() => {\n        waitForTimeStampsForFrameRate(libWorker);\n        executeAndCheckAudio(libWorker, resolve);\n      }, Math.floor(latencyDifferenceInMilli / 10));\n    } else {\n      sendAudio(libWorker, audioQueueIndex);\n      executeAndCheckAudio(libWorker, resolve);\n    }\n  }\n}\n\nfunction sendAudio(libWorker, audioQueueIndex) {\n  // Send out our audio\n  // audioQueueIndex * 2, because audio Queue index represents 1 sample,\n  // for left AND right channel. Therefore the end index is, twice\n  // of the audioQueueIndex\n\n  // Build our message bits\n  const audioBuffer = libWorker.wasmByteMemory.slice(\n    libWorker.WASMBOY_SOUND_OUTPUT_LOCATION,\n    libWorker.WASMBOY_SOUND_OUTPUT_LOCATION + audioQueueIndex * 2\n  ).buffer;\n  const message = {\n    type: WORKER_MESSAGE_TYPE.UPDATED,\n    audioBuffer,\n    numberOfSamples: audioQueueIndex,\n    fps: currentFps,\n    allowFastSpeedStretching: libWorker.options.gameboyFrameRate > 60\n  };\n  const messageTransferrables = [audioBuffer];\n\n  // If audio debugging is enabled, we gotta send a lot more\n  if (libWorker.options && libWorker.options.enableAudioDebugging) {\n    // Channel 1\n    const channel1Buffer = libWorker.wasmByteMemory.slice(\n      libWorker.WASMBOY_CHANNEL_1_OUTPUT_LOCATION,\n      libWorker.WASMBOY_CHANNEL_1_OUTPUT_LOCATION + audioQueueIndex * 2\n    ).buffer;\n    message.channel1Buffer = channel1Buffer;\n    messageTransferrables.push(channel1Buffer);\n\n    // Channel 2\n    const channel2Buffer = libWorker.wasmByteMemory.slice(\n      libWorker.WASMBOY_CHANNEL_2_OUTPUT_LOCATION,\n      libWorker.WASMBOY_CHANNEL_2_OUTPUT_LOCATION + audioQueueIndex * 2\n    ).buffer;\n    message.channel2Buffer = channel2Buffer;\n    messageTransferrables.push(channel2Buffer);\n\n    // Channel 3\n    const channel3Buffer = libWorker.wasmByteMemory.slice(\n      libWorker.WASMBOY_CHANNEL_3_OUTPUT_LOCATION,\n      libWorker.WASMBOY_CHANNEL_3_OUTPUT_LOCATION + audioQueueIndex * 2\n    ).buffer;\n    message.channel3Buffer = channel3Buffer;\n    messageTransferrables.push(channel3Buffer);\n\n    // Channel 4\n    const channel4Buffer = libWorker.wasmByteMemory.slice(\n      libWorker.WASMBOY_CHANNEL_4_OUTPUT_LOCATION,\n      libWorker.WASMBOY_CHANNEL_4_OUTPUT_LOCATION + audioQueueIndex * 2\n    ).buffer;\n    message.channel4Buffer = channel4Buffer;\n    messageTransferrables.push(channel4Buffer);\n  }\n\n  libWorker.audioWorkerPort.postMessage(getSmartWorkerMessage(message), messageTransferrables);\n  libWorker.wasmInstance.exports.clearAudioBuffer();\n}\n","// Web worker for wasmboy lib\n// Will be used for running wasm, and controlling child workers.\n\n// Using transferables: https://stackoverflow.com/questions/16071211/using-transferable-objects-from-a-web-worker\n\nimport { postMessage, onMessage } from '../../worker/workerapi';\nimport { WORKER_MESSAGE_TYPE, WORKER_ID } from '../../worker/constants';\nimport { getEventData, isInBrowser } from '../../worker/util';\nimport { getSmartWorkerMessage } from '../../worker/smartworker';\n\n// Post message handlers\nimport { graphicsWorkerOnMessage } from './graphics/onmessage';\nimport { audioWorkerOnMessage } from './audio/onmessage';\nimport { controllerWorkerOnMessage } from './controller/onmessage';\nimport { memoryWorkerOnMessage } from './memory/onmessage';\n\n// Only One response will be used on build time\n// Using Babel plugin to filter imports\nimport getWasmBoyWasmCore from '../../../dist/core/getWasmBoyWasmCore.esm';\nimport getWasmBoyTsCore from '../../../dist/core/getWasmBoyTsCore.esm';\n\n// Update to run the core emulator\nimport { update } from './update';\n\n// Timestamps\nimport { waitForTimeStampsForFrameRate } from './timestamp';\n\n// Transfer\nimport { transferGraphics } from './graphics/transfer';\n\n// Our stateful object\n// Representing our lib worker as a singleton\n// Not using normal classes because:\n// Class functions weren't working for some odd reason, and 'this' was getting wonky\nlet libWorker;\nlibWorker = {\n  // Wasmboy Module Ports\n  graphicsWorkerPort: undefined,\n  memoryWorkerPort: undefined,\n  controllerWorkerPort: undefined,\n  audioWorkerPort: undefined,\n\n  // Wasm Module Properties\n  wasmInstance: undefined,\n  wasmByteMemory: undefined,\n\n  // Lib options\n  options: undefined,\n\n  // Some Constants from the wasm module\n  WASMBOY_GAME_BYTES_LOCATION: 0,\n  WASMBOY_GAME_RAM_BANKS_LOCATION: 0,\n  WASMBOY_INTERNAL_STATE_SIZE: 0,\n  WASMBOY_INTERNAL_STATE_LOCATION: 0,\n  WASMBOY_INTERNAL_MEMORY_SIZE: 0,\n  WASMBOY_INTERNAL_MEMORY_LOCATION: 0,\n  WASMBOY_PALETTE_MEMORY_SIZE: 0,\n  WASMBOY_PALETTE_MEMORY_LOCATION: 0,\n  WASMBOY_CURRENT_FRAME_OUTPUT_LOCATION: 0,\n  WASMBOY_CURRENT_FRAME_SIZE: 0,\n  WASMBOY_SOUND_OUTPUT_LOCATION: 0,\n  WASMBOY_CHANNEL_1_OUTPUT_LOCATION: 0,\n  WASMBOY_CHANNEL_2_OUTPUT_LOCATION: 0,\n  WASMBOY_CHANNEL_3_OUTPUT_LOCATION: 0,\n  WASMBOY_CHANNEL_4_OUTPUT_LOCATION: 0,\n\n  // Playing state\n  paused: true,\n\n  // Our update setTimeout ref\n  updateId: undefined,\n\n  // Our fps timestamps\n  timeStampsUntilReady: 0,\n  fpsTimeStamps: [],\n\n  // Our current speed\n  speed: 0,\n\n  // Frame Skipping\n  frameSkipCounter: 0,\n\n  // Audio latency\n  currentAudioLatencyInSeconds: 0,\n\n  // Message Handler from the main thread\n  messageHandler: event => {\n    // Handle our messages from the main thread\n    const eventData = getEventData(event);\n\n    switch (eventData.message.type) {\n      case WORKER_MESSAGE_TYPE.CONNECT: {\n        // Assign our worker ports on connect\n        if (eventData.message.workerId === WORKER_ID.GRAPHICS) {\n          libWorker.graphicsWorkerPort = eventData.message.ports[0];\n          onMessage(graphicsWorkerOnMessage.bind(undefined, libWorker), libWorker.graphicsWorkerPort);\n        } else if (eventData.message.workerId === WORKER_ID.MEMORY) {\n          libWorker.memoryWorkerPort = eventData.message.ports[0];\n          onMessage(memoryWorkerOnMessage.bind(undefined, libWorker), libWorker.memoryWorkerPort);\n        } else if (eventData.message.workerId === WORKER_ID.CONTROLLER) {\n          libWorker.controllerWorkerPort = eventData.message.ports[0];\n          onMessage(controllerWorkerOnMessage.bind(undefined, libWorker), libWorker.controllerWorkerPort);\n        } else if (eventData.message.workerId === WORKER_ID.AUDIO) {\n          libWorker.audioWorkerPort = eventData.message.ports[0];\n          onMessage(audioWorkerOnMessage.bind(undefined, libWorker), libWorker.audioWorkerPort);\n        }\n\n        // Simply post back that we are ready\n        postMessage(getSmartWorkerMessage(undefined, eventData.messageId));\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.INSTANTIATE_WASM: {\n        const instantiateTask = async () => {\n          let response;\n          // Only One response will be used on build time\n          // Using Babel plugin to filter imports\n          response = await getWasmBoyWasmCore(isInBrowser);\n          response = await getWasmBoyTsCore();\n\n          libWorker.wasmInstance = response.instance;\n          libWorker.wasmByteMemory = response.byteMemory;\n          postMessage(\n            getSmartWorkerMessage(\n              {\n                type: response.type\n              },\n              eventData.messageId\n            )\n          );\n          return;\n        };\n        instantiateTask();\n        return;\n      }\n      case WORKER_MESSAGE_TYPE.CONFIG: {\n        // Config will come in as an array, pass in values using apply\n        // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply\n        const config = eventData.message.config;\n        libWorker.wasmInstance.exports.config.apply(libWorker, config);\n        libWorker.options = eventData.message.options;\n        postMessage(getSmartWorkerMessage(undefined, eventData.messageId));\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.RESET_AUDIO_QUEUE: {\n        // Reset the audio queue index to stop weird pauses when trying to load a game\n        libWorker.wasmInstance.exports.clearAudioBuffer();\n        postMessage(getSmartWorkerMessage(undefined, eventData.messageId));\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.PLAY: {\n        if (!libWorker.paused || !libWorker.wasmInstance || !libWorker.wasmByteMemory) {\n          postMessage(getSmartWorkerMessage({ error: true }, eventData.messageId));\n          return;\n        }\n\n        // Re-initialize some of our values\n        libWorker.paused = false;\n        libWorker.fpsTimeStamps = [];\n        waitForTimeStampsForFrameRate(libWorker);\n        libWorker.frameSkipCounter = 0;\n        libWorker.currentAudioLatencyInSeconds = 0;\n\n        // Apply any GBC colorization\n        if (!libWorker.options.isGbcColorizationEnabled) {\n          libWorker.wasmInstance.exports.setManualColorizationPalette(0);\n        } else if (libWorker.options.gbcColorizationPalette) {\n          const colorizationPalettes = [\n            'wasmboygb',\n            'brown',\n            'red',\n            'darkbrown',\n            'green',\n            'darkgreen',\n            'inverted',\n            'pastelmix',\n            'orange',\n            'yellow',\n            'blue',\n            'darkblue',\n            'grayscale'\n          ];\n\n          libWorker.wasmInstance.exports.setManualColorizationPalette(\n            colorizationPalettes.indexOf(libWorker.options.gbcColorizationPalette.toLowerCase())\n          );\n        }\n\n        // 1000 / 60 = 60fps\n        // Add one to the framerate, as we would rather be slightly faster,\n        // than slightly slower\n        const intervalRate = 1000 / libWorker.options.gameboyFrameRate;\n\n        update(libWorker, intervalRate);\n\n        postMessage(getSmartWorkerMessage(undefined, eventData.messageId));\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.PAUSE: {\n        // Call our update\n        libWorker.paused = true;\n        if (libWorker.updateId) {\n          clearTimeout(libWorker.updateId);\n          libWorker.updateId = undefined;\n        }\n        postMessage(getSmartWorkerMessage(undefined, eventData.messageId));\n        return;\n      }\n\n      // Debugging Messages\n      case WORKER_MESSAGE_TYPE.RUN_WASM_EXPORT: {\n        let response;\n        if (eventData.message.parameters) {\n          response = libWorker.wasmInstance.exports[eventData.message.export].apply(undefined, eventData.message.parameters);\n        } else {\n          response = libWorker.wasmInstance.exports[eventData.message.export]();\n        }\n        postMessage(\n          getSmartWorkerMessage(\n            {\n              type: WORKER_MESSAGE_TYPE.RUN_WASM_EXPORT,\n              response: response\n            },\n            eventData.messageId\n          )\n        );\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.GET_WASM_MEMORY_SECTION: {\n        let start = 0;\n        let end = libWorker.wasmByteMemory.length;\n        if (eventData.message.start) {\n          start = eventData.message.start;\n        }\n        if (eventData.message.end) {\n          end = eventData.message.end;\n        }\n\n        const response = libWorker.wasmByteMemory.slice(start, end).buffer;\n        postMessage(\n          getSmartWorkerMessage(\n            {\n              type: WORKER_MESSAGE_TYPE.RUN_WASM_EXPORT,\n              response: response\n            },\n            eventData.messageId\n          ),\n          [response]\n        );\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.GET_WASM_CONSTANT: {\n        const response = libWorker.wasmInstance.exports[eventData.message.constant].valueOf();\n        postMessage(\n          getSmartWorkerMessage(\n            {\n              type: WORKER_MESSAGE_TYPE.GET_WASM_CONSTANT,\n              response: response\n            },\n            eventData.messageId\n          )\n        );\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.FORCE_OUTPUT_FRAME: {\n        transferGraphics(libWorker);\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.SET_SPEED: {\n        libWorker.speed = eventData.message.speed;\n\n        // Reset all of our fps tracking\n        libWorker.fpsTimeStamps = [];\n        libWorker.timeStampsUntilReady = 60;\n        waitForTimeStampsForFrameRate(libWorker);\n        libWorker.frameSkipCounter = 0;\n        libWorker.currentAudioLatencyInSeconds = 0;\n\n        libWorker.wasmInstance.exports.clearAudioBuffer();\n        return;\n      }\n\n      case WORKER_MESSAGE_TYPE.IS_GBC: {\n        const response = libWorker.wasmInstance.exports.isGBC() > 0;\n\n        postMessage(\n          getSmartWorkerMessage(\n            {\n              type: WORKER_MESSAGE_TYPE.IS_GBC,\n              response: response\n            },\n            eventData.messageId\n          )\n        );\n        return;\n      }\n\n      default: {\n        //handle other messages from main\n        console.log('Unknown WasmBoy Worker message:', eventData);\n      }\n    }\n  },\n\n  // Function to return the current FPS\n  // http://www.growingwiththeweb.com/2017/12/fast-simple-js-fps-counter.html\n  getFPS: () => {\n    if (libWorker.timeStampsUntilReady > 0) {\n      if (libWorker.speed && libWorker.speed > 0) {\n        return libWorker.options.gameboyFrameRate * libWorker.speed;\n      }\n      return libWorker.options.gameboyFrameRate;\n    } else if (libWorker.fpsTimeStamps) {\n      return libWorker.fpsTimeStamps.length;\n    }\n\n    return 0;\n  }\n};\n\n// Assign the worker a message handler\nonMessage(libWorker.messageHandler);\n"],"names":["getEventData","event","data","isInBrowser","self","parentPort","require","postMessage","message","transferArray","onMessage","callback","port","console","error","onmessage","on","WORKER_MESSAGE_TYPE","CONNECT","INSTANTIATE_WASM","CLEAR_MEMORY","CLEAR_MEMORY_DONE","GET_MEMORY","SET_MEMORY","SET_MEMORY_DONE","GET_CONSTANTS","GET_CONSTANTS_DONE","CONFIG","RESET_AUDIO_QUEUE","PLAY","BREAKPOINT","PAUSE","UPDATED","CRASHED","SET_JOYPAD_STATE","AUDIO_LATENCY","RUN_WASM_EXPORT","GET_WASM_MEMORY_SECTION","GET_WASM_CONSTANT","FORCE_OUTPUT_FRAME","SET_SPEED","IS_GBC","WORKER_ID","LIB","GRAPHICS","MEMORY","CONTROLLER","AUDIO","MEMORY_TYPE","CARTRIDGE_RAM","CARTRIDGE_ROM","CARTRIDGE_HEADER","GAMEBOY_MEMORY","PALETTE_MEMORY","INTERNAL_STATE","idCounter","generateId","randomId","Math","random","toString","replace","substr","id","getSmartWorkerMessage","messageId","workerId","graphicsWorkerOnMessage","libWorker","eventData","type","WASMBOY_CURRENT_FRAME_OUTPUT_LOCATION","wasmInstance","exports","FRAME_LOCATION","valueOf","WASMBOY_CURRENT_FRAME_SIZE","FRAME_SIZE","graphicsWorkerPort","audioWorkerOnMessage","WASMBOY_SOUND_OUTPUT_LOCATION","AUDIO_BUFFER_LOCATION","WASMBOY_CHANNEL_1_OUTPUT_LOCATION","CHANNEL_1_BUFFER_LOCATION","WASMBOY_CHANNEL_2_OUTPUT_LOCATION","CHANNEL_2_BUFFER_LOCATION","WASMBOY_CHANNEL_3_OUTPUT_LOCATION","CHANNEL_3_BUFFER_LOCATION","WASMBOY_CHANNEL_4_OUTPUT_LOCATION","CHANNEL_4_BUFFER_LOCATION","audioWorkerPort","currentAudioLatencyInSeconds","latency","controllerWorkerOnMessage","setJoypadStateParamsAsArray","setJoypadState","apply","getCartridgeRom","wasmByteMemory","Uint8Array","cartridgeType","WASMBOY_GAME_BYTES_LOCATION","romSize","undefined","cartridgeRom","slice","getCartridgeRam","ramSize","cartridgeRam","WASMBOY_GAME_RAM_BANKS_LOCATION","getCartridgeHeader","headerLength","headerLocation","headerArray","getGameBoyMemory","WASMBOY_INTERNAL_MEMORY_LOCATION","WASMBOY_INTERNAL_MEMORY_SIZE","getPaletteMemory","WASMBOY_PALETTE_MEMORY_LOCATION","WASMBOY_PALETTE_MEMORY_SIZE","getInternalState","saveState","WASMBOY_INTERNAL_STATE_LOCATION","WASMBOY_INTERNAL_STATE_SIZE","memoryWorkerOnMessage","i","length","memoryWorkerPort","buffer","CARTRIDGE_ROM_LOCATION","CARTRIDGE_RAM_LOCATION","WASMBOY_STATE_SIZE","WASMBOY_STATE_LOCATION","GAMEBOY_INTERNAL_MEMORY_SIZE","GAMEBOY_INTERNAL_MEMORY_LOCATION","GBC_PALETTE_SIZE","GBC_PALETTE_LOCATION","memoryKeys","Object","keys","includes","set","loadState","responseMemory","responseTransferrables","memoryTypes","push","cartridgeHeader","gameboyMemory","paletteMemory","internalState","wasmboyMemorySize","Uint8ClampedArray","memory","size","grow","load","offset","store","value","abs","ceil","ASSEMBLYSCRIPT_MEMORY_LOCATION","ASSEMBLYSCRIPT_MEMORY_SIZE","VIDEO_RAM_LOCATION","VIDEO_RAM_SIZE","WORK_RAM_LOCATION","WORK_RAM_SIZE","OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION","OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE","BG_PRIORITY_MAP_LOCATION","BG_PRIORITY_MAP_SIZE","BACKGROUND_MAP_LOCATION","BACKGROUND_MAP_SIZE","TILE_DATA_LOCATION","TILE_DATA_SIZE","OAM_TILES_LOCATION","OAM_TILES_SIZE","GRAPHICS_OUTPUT_LOCATION","GRAPHICS_OUTPUT_SIZE","CHANNEL_1_BUFFER_SIZE","CHANNEL_2_BUFFER_SIZE","CHANNEL_3_BUFFER_SIZE","CHANNEL_4_BUFFER_SIZE","AUDIO_BUFFER_SIZE","CARTRIDGE_RAM_SIZE","CARTRIDGE_ROM_SIZE","DEBUG_GAMEBOY_MEMORY_LOCATION","DEBUG_GAMEBOY_MEMORY_SIZE","WASMBOY_MEMORY_LOCATION","WASMBOY_MEMORY_SIZE","WASMBOY_WASM_PAGES","Config","enableBootRom","useGbcWhenAvailable","audioBatchProcessing","graphicsBatchProcessing","timersBatchProcessing","graphicsDisableScanlineRendering","audioAccumulateSamples","tileRendering","tileCaching","enableAudioDebugging","u8Portable","param","u16Portable","i8Portable","i32Portable","setFlagBit","flagBit","flagValue","bitwiseOperand","Cpu","registerF","setZeroFlag$$1","setSubtractFlag","setHalfCarryFlag","setCarryFlag","getZeroFlag$$1","getSubtractFlag","getHalfCarryFlag","getCarryFlag$$1","checkAndSetEightBitHalfCarryFlag","amountToAdd","result","checkAndSetEightBitCarryFlag","checkAndSetSixteenBitFlagsAddOverflow","valueOne","valueTwo","useStackPointerBits","signedValueOne","flagXor","halfCarryXor","halfCarryAnd","WasmBoyGBColors","bgWhite","bgLightGrey","bgDarkGrey","bgBlack","obj0White","obj0LightGrey","obj0DarkGrey","obj0Black","obj1White","obj1LightGrey","obj1DarkGrey","obj1Black","GreenColors","OrangeColors","BrownColors","InvertedColors","GrayscaleColors","PastelMixColors","DarkBrownColors","DarkGreenColors","DarkBlueColors","RedColors","BlueColors","YellowColors","Table00Entry08Colors","Table01Entry0BColors","Table01Entry10Colors","Table03Entry0AColors","Table05Entry00Colors","Table05Entry01Colors","Table05Entry02Colors","Table05Entry08Colors","Table05Entry09Colors","Table05Entry11Colors","Table05Entry14Colors","Table05Entry15Colors","Colors","initializeColors","setManualColorizationPalette","titleChecksum","eightBitLoadFromGBMemory","hash","setHashColorizationPalette","getRedFromHexColor","color","getGreenFromHexColor","getBlueFromHexColor","colorizationId","concatenateBytes","highByte","lowByte","splitHighByte","groupedByte","splitLowByte","rotateByteLeft","rotateByteLeftThroughCarry","rotateByteRight","rotateByteRightThroughCarry","setBitOnByte","bitPosition","byte","resetBitOnByte","checkBitOnByte","Palette","memoryLocationBackgroundPaletteIndex","memoryLocationBackgroundPaletteData","memoryLocationSpritePaletteIndex","memoryLocationSpritePaletteData","memoryLocationBackgroundPalette","memoryLocationSpritePaletteOne","memoryLocationSpritePaletteTwo","initializePalette","GBCEnabled","eightBitStoreIntoGBMemory","getMonochromeColorFromPalette","colorId","paletteMemoryLocation","shouldRepresentColorByColorId","rgbColor","getColorizedGbHexColorFromPalette","hexColor","writeColorPaletteToMemory","paletteIndex","isSprite","storePaletteByteInWasmMemory","incrementPaletteIndexIfSet","getRgbColorFromPalette","paletteId","paletteHighByte","loadPaletteByteFromWasmMemory","paletteLowByte","getColorComponentFromRgb","colorRgb","bitMask","colorValue","paletteIndexByte","addPriorityforPixel","x","y","hasGbcBgPriority","bgPriorityByte","getPixelStart","getPriorityforPixel","clearPriorityMap","TileCache","tileId","horizontalFlip","nextXIndexToPerformCacheCheck","resetTileCache","drawPixelsFromLineOfTile","tileDataMemoryLocation","vramBankId","tileLineXStart","tileLineXEnd","tileLineY","outputLineX","outputLineY","outputWidth","wasmMemoryStart","shouldRepresentMonochromeColorByColorId","paletteLocation","bgMapAttributes","spriteAttributes","pixelsDrawn","tileDataAddress","getTileDataAddress","byteOneForLineOfTilePixels","loadFromVramBank","byteTwoForLineOfTilePixels","iteratedOutputX","pixelXInTile","paletteColorId","red","green","blue","bgPalette","rgbColorPalette","Graphics","monochromeColor","pixelStart","getTilePixelStart","gbcBgPriority","tileIdFromTileMap","memoryLocationTileDataSelectZeroStart","isDutyCycleClockPositiveOrNegativeForWaveform","channelDuty","waveFormPositionOnDuty","Channel1","updateNRx0","NRx0SweepPeriod","NRx0Negate","NRx0SweepShift","updateNRx1","NRx1Duty","NRx1LengthLoad","lengthCounter","updateNRx2","NRx2StartingVolume","NRx2EnvelopeAddMode","NRx2EnvelopePeriod","isDacEnabled","updateNRx3","NRx3FrequencyLSB","frequency","NRx4FrequencyMSB","updateNRx4","NRx4LengthEnabled","storeBooleanDirectlyToWasmMemory","getSaveStateMemoryOffset","saveStateSlot","isEnabled","frequencyTimer","envelopeCounter","volume","dutyCycle","isSweepEnabled","sweepCounter","sweepShadowFrequency","loadBooleanDirectlyFromWasmMemory","initialize","memoryLocationNRx0","memoryLocationNRx1","memoryLocationNRx2","memoryLocationNRx3","memoryLocationNRx4","getSampleFromCycleCounter","accumulatedCycles","cycleCounter","getSample","resetTimer","GBCDoubleSpeed","numberOfCycles","overflowAmount","outputVolume","sample","trigger","calculateSweepAndCheckOverflow","willChannelUpdate","updateSweep","updateLength","updateEnvelope","setFrequency","passedFrequencyHighBits","passedFrequencyLowBits","register4","newRegister4","channelNumber","newFrequency","getNewFrequencyFromSweep","oldFrequency","Channel2","Channel3","NRx2VolumeCode","waveTablePosition","volumeCodeChanged","volumeCode","positionIndexToAdd","memoryLocationWaveSample","memoryLocationWaveTable","Channel4","divisorCode","NRx3ClockShift","NRx3WidthMode","NRx3DivisorCode","divisor","linearFeedbackShiftRegister","getNoiseChannelFrequencyPeriod","lfsrBitZero","lfsrBitOne","xorLfsrBitZeroOne","response","SoundAccumulator","channel1Sample","channel2Sample","channel3Sample","channel4Sample","channel1DacEnabled","channel2DacEnabled","channel3DacEnabled","channel4DacEnabled","leftChannelSampleUnsignedByte","rightChannelSampleUnsignedByte","mixerVolumeChanged","mixerEnabledChanged","needToRemixSamples","initializeSoundAccumulator","accumulateSound","channel1WillUpdate","didChannelDacChange","channel2WillUpdate","channel3WillUpdate","channel4WillUpdate","downSampleCycleCounter","Sound","downSampleCycleMultiplier","maxDownSampleCycles","mixChannelSamples","setLeftAndRightOutputForAudioQueue","audioQueueIndex","maxIndex","wasmBoyMemoryMaxBufferSize","channel1Enabled","channel2Enabled","channel3Enabled","channel4Enabled","batchProcessCycles","updateNR50","NR50LeftMixerVolume","NR50RightMixerVolume","updateNR51","NR51IsChannel4EnabledOnLeftOutput","NR51IsChannel3EnabledOnLeftOutput","NR51IsChannel2EnabledOnLeftOutput","NR51IsChannel1EnabledOnLeftOutput","NR51IsChannel4EnabledOnRightOutput","NR51IsChannel3EnabledOnRightOutput","NR51IsChannel2EnabledOnRightOutput","NR51IsChannel1EnabledOnRightOutput","updateNR52","NR52IsSoundEnabled","maxFrameSequenceCycles","CLOCK_SPEED","frameSequenceCycleCounter","frameSequencer","clearAudioBuffer","currentCycles","memoryLocationNR50","memoryLocationNR51","memoryLocationNR52","memoryLocationChannel3LoadRegisterStart","initializeSound","batchProcessAudio","updateSound","frameSequencerUpdated","updateFrameSequencer","calculateSound","getNumberOfSamplesInAudioBuffer","mixedSample","leftChannelSample","rightChannelSample","getSampleAsUnsignedByte","mixerVolume","precision","convertedSample","maxDivider","leftVolume","rightVolume","bufferLocation","audioQueueOffset","SoundRegisterWriteTraps","SoundRegisterReadTraps","registerNR52","Interrupts","updateInterruptEnabled","isVBlankInterruptEnabled","bitPositionVBlankInterrupt","isLcdInterruptEnabled","bitPositionLcdInterrupt","isTimerInterruptEnabled","bitPositionTimerInterrupt","isSerialInterruptEnabled","bitPositionSerialInterrupt","isJoypadInterruptEnabled","bitPositionJoypadInterrupt","interruptsEnabledValue","updateInterruptRequested","isVBlankInterruptRequested","isLcdInterruptRequested","isTimerInterruptRequested","isSerialInterruptRequested","isJoypadInterruptRequested","interruptsRequestedValue","areInterruptsPending","masterInterruptSwitch","masterInterruptSwitchDelay","memoryLocationInterruptEnabled","memoryLocationInterruptRequest","initializeInterrupts","checkInterrupts","isAnInterruptRequestedAndEnabledValue","wasInterruptHandled","isHaltNoJump","_handleInterrupt","interuptHandlerCycles","isHalted","exitHaltAndStop","setInterrupts","interruptRequest","stackPointer","sixteenBitStoreIntoGBMemory","programCounter","_requestInterrupt","requestVBlankInterrupt","requestLcdInterrupt","requestTimerInterrupt","requestJoypadInterrupt","requestSerialInterrupt","Timers","updateDividerRegister","oldDividerRegister","dividerRegister","memoryLocationDividerRegister","timerEnabled","_checkDividerRegisterFallingEdgeDetector","_incrementTimerCounter","updateTimerCounter","timerCounterWasReset","timerCounterOverflowDelay","timerCounter","updateTimerModulo","timerModulo","updateTimerControl","oldTimerEnabled","newTimerInputClock","oldTimerCounterMaskBit","_getTimerCounterMaskBit","timerInputClock","newTimerCounterMaskBit","shouldIncrementTimerCounter","memoryLocationTimerCounter","memoryLocationTimerModulo","memoryLocationTimerControl","timerCounterMask","initializeTimers","batchProcessTimers","updateTimers","cyclesIncreased","curDividerRegister","counter","newDividerRegister","timerCounterMaskBit","Serial","updateTransferControl","isShiftClockInternal","isClockSpeedFast","transferStartFlag","memoryLocationSerialTransferData","memoryLocationSerialTransferControl","numberOfBitsTransferred","initializeSerial","updateSerial","oldCycles","curCycles","_checkFallingEdgeDetector","transferData","transferControl","newCycles","maskBit","_getFallingEdgeMaskBit","Joypad","updateJoypad","joypadRegisterFlipped","isDpadType","isButtonType","memoryLocationJoypadRegister","up","down","left","right","a","b","select","start","getJoypadState","joypadRegister","_pressJoypadButton","_releaseJoypadButton","buttonId","isStopped","isButtonStateChanging","_getJoypadButtonStateFromButtonId","_setJoypadButtonStateFromButtonId","isDpadTypeButton","shouldRequestInterrupt","isPressed","handleBanking","Memory","isRomOnly","isMBC1","isMBC2","romEnableByte","isRamBankingEnabled","isMBC5","currentRomBank","romBankLowerBits","isMBC3","isMBC1RomModeEnabled","romBankHigherBits","ramBankBits","currentRamBank","getRomBankAddress","gameboyOffset","switchableCartridgeRomLocation","getRamBankAddress","cartridgeRamLocation","initializeDma","startDmaTransfer","sourceAddressOffset","sourceAddress","spriteInformationByte","spriteInformationAddress","spriteInformationTableLocation","DMACycles","startHdmaTransfer","hdmaTriggerByteToBeWritten","isHblankHdmaActive","hdmaTriggerByte","memoryLocationHdmaTrigger","hdmaSource","getHdmaSourceFromMemory","hdmaDestination","getHdmaDestinationFromMemory","transferLength","hblankHdmaTransferLengthRemaining","hblankHdmaSource","hblankHdmaDestination","hdmaTransfer","updateHblankHdma","bytesToTransfer","remainingTransferLength","transferLengthAsByte","sourceByte","eightBitLoadFromGBMemoryWithTraps","hdmaDestinationWithWrapping","eightBitStoreIntoGBMemoryWithTraps","hdmaCycles","hdmaSourceHigh","memoryLocationHdmaSourceHigh","hdmaSourceLow","memoryLocationHdmaSourceLow","hdmaDestinationHigh","memoryLocationHdmaDestinationHigh","hdmaDestinationLow","memoryLocationHdmaDestinationLow","videoRamLocation","checkWriteTraps","memoryLocationSpeedSwitch","echoRamLocation","wramOffset","spriteInformationTableLocationEnd","Lcd","currentLcdMode","unusableMemoryLocation","unusableMemoryEndLocation","memoryLocationLcdControl","memoryLocationWindowX","updateLcdControl","memoryLocationLcdStatus","updateLcdStatus","memoryLocationScanlineRegister","scanlineRegister","memoryLocationCoincidenceCompare","coincidenceCompare","memoryLocationDmaTransfer","memoryLocationScrollX","scrollX","memoryLocationScrollY","scrollY","windowX","memoryLocationWindowY","windowY","memoryLocationGBCWRAMBank","memoryLocationGBCVRAMBank","getWasmBoyOffsetFromGameBoyOffset","gameboyOffsetHighByte","internalRamBankZeroLocation","wramBankId","Breakpoints","readGbMemory","writeGbMemory","reachedBreakpoint","setProgramCounterBreakpoint","breakpoint","resetProgramCounterBreakpoint","setReadGbMemoryBreakpoint","resetReadGbMemoryBreakpoint","setWriteGbMemoryBreakpoint","resetWriteGbMemoryBreakpoint","sixteenBitStoreIntoGBMemoryWithTraps","nextOffset","currentLcdStatus","valueNoBottomBits","lcdStatusOnlyBottomBits","wasLcdEnabled","enabled","windowTileMapDisplaySelect","windowDisplayEnabled","bgWindowTileDataSelect","bgTileMapDisplaySelect","tallSpriteSize","spriteDisplayEnable","bgDisplayEnabled","resetLcd","shouldBlankScreen","scanlineCycleCounter","lcdStatus","setLcdStatus","lcdMode","newLcdMode","MIN_CYCLES_SPRITES_LCD_MODE","checkCoincidence","renderBackground","tileMapMemoryLocation","pixelYPositionInMap","drawBackgroundWindowScanline","renderWindow","xOffset","iStart","tileYPositionInMap","pixelXPositionInMap","tileXPositionInMap","tileMapAddress","usedTileCache","drawLineOfTileFromTileCache","drawLineOfTileFromTileId","drawColorPixelFromTileId","drawMonochromePixelFromTileId","xPixel","yPixel","pixelYInTile","setPixelOnFrame","wasLastTileHorizontallyFlipped","isCurrentTileHorizontallyFlipped","tileCacheIndex","xPos","previousXPixel","previousTilePixelLocation","getRgbPixelStart","pixelPriority","xOffsetTileWidthRemainder","tileXStart","tileXEnd","renderSprites","useLargerSprites","spriteTableIndex","index","memoryLocationSpriteAttributesTable","spriteYPosition","spriteXPosition","spriteTileId","spriteHeight","isSpritePriorityBehindWindowAndBackground","flipSpriteY","flipSpriteX","currentSpriteLine","spriteTileAddressStart","memoryLocationTileDataSelectOneStart","spriteTileAddress","spriteDataByteOneForLineOfTilePixels","spriteDataByteTwoForLineOfTilePixels","tilePixel","spritePixelXInTile","spriteColorId","spriteXPixelLocationInCameraView","shouldShowFromLcdcPriority","shouldHideFromOamPriority","shouldHideFromBgPriority","bgColorFromPriorityByte","spritePaletteLocation","MAX_CYCLES_PER_SCANLINE","MIN_CYCLES_TRANSFER_DATA_LCD_MODE","memoryLocationTileMapSelectZeroStart","memoryLocationTileMapSelectOneStart","batchProcessGraphics","updateGraphics","initializeGraphics","_drawScanline","_renderEntireFrame","wasmBoyAddress","checkReadTraps","currentSpeedSwitchRegister","upperDividerRegisterBits","readTrapResult","sixteenBitLoadFromGBMemory","lowByteReadTrapResult","highByteReadTrapResult","cartridgeRomLocation","internalRamBankOneLocation","initializeCartridge","MAX_CYCLES_PER_FRAME","enableHalt","isHaltNormal","haltTypeValue","isHaltBug","registerA","registerB","registerC","registerD","registerE","registerH","registerL","initializeCpu","addARegister","register","addAThroughCarryRegister","overflowedResult","subARegister","negativeRegister","subAThroughCarryRegister","carryRegisterCheck","andARegister","xorARegister","orARegister","cpARegister","tempResult","rotateRegisterLeft","rotateRegisterRight","rotateRegisterLeftThroughCarry","hasHighbit","rotateRegisterRightThroughCarry","hasLowBit","shiftLeftRegister","shiftRightArithmeticRegister","hasLowbit","swapNibblesOnRegister","highNibble","lowNibble","shiftRightLogicalRegister","testBitOnRegister","testByte","setBitOnRegister","bitValue","setByte","relativeJump","relativeJumpOffset","handleCbOpcode","cbOpcode","handledOpcode","instructionRegisterValue","instructionRegisterResult","registerNumber","eightBitLoadSyncCycles","opcodeHighNibble","eightBitStoreSyncCycles","executeOpcode$$1","opcode","handleOpcode0x","handleOpcode1x","handleOpcode2x","handleOpcode3x","handleOpcode4x","handleOpcode5x","handleOpcode6x","handleOpcode7x","handleOpcode8x","handleOpcode9x","handleOpcodeAx","handleOpcodeBx","handleOpcodeCx","handleOpcodeDx","handleOpcodeEx","handleOpcodeFx","syncCycles","sixteenBitLoadSyncCycles","sixteenBitStoreSyncCycles","getDataByteOne","getDataByteTwo","getConcatenatedDataByte","concatenatedDataByte","registerBC3","registerHL","registerBC9","registerBCB","speedSwitch","registerDE3","registerDE9","registerDEA","registerDEB","sixteenBitDataByte","registerHL2","registerHL3","adjustedRegister","adjustment","registerHL9","registerHLA","registerHLB","registerHL4","valueAtHL4","incrementer","registerHL5","valueAtHL5","valueAtHL6","valueAtHLE","registerBC1","cbCycles","registerDE1","largeDataByteOne","registerHL1","signedDataByteOne","registerAF1","Cycles","cyclesPerCycleSet","cycleSets","cycles","getCyclesPerCycleSet","getCycleSets","getCycles","trackCyclesRan","resetCycles","Execute","stepsPerStepSet","stepSets","steps","RESPONSE_CONDITION_ERROR","RESPONSE_CONDITION_FRAME","RESPONSE_CONDITION_AUDIO","RESPONSE_CONDITION_BREAKPOINT","getStepsPerStepSet","getStepSets","getSteps","trackStepsRan","esteps","resetSteps","executeMultipleFrames","numberOfFrames","frameResponse","framesRun","executeFrame","executeUntilCondition","executeFrameAndCheckAudio","maxAudioBuffer","checkMaxCyclesPerFrame","audioBufferSize","errorCondition","frameCondition","audioBufferCondition","executeStep","setHasCoreStarted","haltBugOpcode","haltBugCycles","interruptCycles","hasStarted","hasCoreStarted","config","gbcType","isGBC","getRegisterA","getRegisterB","getRegisterC","getRegisterD","getRegisterE","getRegisterH","getRegisterL","getRegisterF","getProgramCounter","getStackPointer","getOpcodeAtProgramCounter","getLY","drawBackgroundMapToWasmMemory","showColor","drawTileDataToWasmMemory","tileDataMapGridY","tileDataMapGridX","spriteRow","spriteColumn","spriteIndex","currentSpriteAttributes","spriteVramBankId","foundTileMapAddress","drawOamToWasmMemory","tilesToDraw","getDIV","getTIMA","getTMA","getTAC","updateDebugGBMemory","WasmBoyCore","freeze","getWasmBoyTsCore","instance","byteMemory","getPerformanceTimestamp","window","performance","now","Date","addTimeStamp","currentHighResTime","fpsTimeStamps","shift","timeStampsUntilReady","waitForTimeStampsForFrameRate","options","gameboyFrameRate","floor","transferGraphics","graphicsFrameEndIndex","graphicsFrameBuffer","MAX_AUDIO_LATENCY","currentFps","gameboyFrameRateWithSpeed","intervalRate","scheduleNextUpdate","highResTime","timeSinceLastTimestamp","nextUpdateTime","speed","updateId","setTimeout","update","passedIntervalRate","paused","getFPS","shouldCheckAudio","headless","pauseFpsThrottle","isAudioEnabled","executePromise","Promise","resolve","executeAndCheckAudio","then","fps","shouldSkipRenderingFrame","frameSkip","frameSkipCounter","memoryObject","forEach","key","isTooMuchLatency","isRunningFullSpeed","sendAudio","latencyDifferenceInSeconds","latencyDifferenceInMilli","audioBuffer","numberOfSamples","allowFastSpeedStretching","messageTransferrables","channel1Buffer","channel2Buffer","channel3Buffer","channel4Buffer","controllerWorkerPort","messageHandler","ports","bind","instantiateTask","isGbcColorizationEnabled","gbcColorizationPalette","colorizationPalettes","indexOf","toLowerCase","clearTimeout","parameters","export","end","constant","log"],"mappings":"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"}