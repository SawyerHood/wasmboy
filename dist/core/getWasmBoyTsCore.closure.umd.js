'use strict';(function(Ra,u){"object"===typeof exports&&"undefined"!==typeof module?module.exports=u():"function"===typeof define&&define.amd?define(u):Ra.WasmBoyTsCore=u()})(this,function(){function Ra(a,d){a=1<<a&255;b.registerF=0<d?b.registerF|a:b.registerF&(255^a);return b.registerF}function u(a){Ra(7,a)}function p(a){Ra(6,a)}function C(a){Ra(5,a)}function G(a){Ra(4,a)}function Na(){return b.registerF>>7&1}function Q(){return b.registerF>>4&1}function M(a,d){0<=d?C(0!==((a&15)+(d&15)&16)):C((Math.abs(d)&
15)>(a&15))}function rb(a,d){0<=d?G(a>(a+d&255)):G(Math.abs(d)>a)}function Sa(a,d,b){b?(a=a^d^a+d,C(0!==(a&16)),G(0!==(a&256))):(b=a+d&65535,G(b<a),C(0!==((a^d^b)&4096)))}function Lb(a){switch(a){case 0:c.bgWhite=H.bgWhite;c.bgLightGrey=H.bgLightGrey;c.bgDarkGrey=H.bgDarkGrey;c.bgBlack=H.bgBlack;c.obj0White=H.obj0White;c.obj0LightGrey=H.obj0LightGrey;c.obj0DarkGrey=H.obj0DarkGrey;c.obj0Black=H.obj0Black;c.obj1White=H.obj1White;c.obj1LightGrey=H.obj1LightGrey;c.obj1DarkGrey=H.obj1DarkGrey;c.obj1Black=
H.obj1Black;break;case 1:c.bgWhite=ca.bgWhite;c.bgLightGrey=ca.bgLightGrey;c.bgDarkGrey=ca.bgDarkGrey;c.bgBlack=ca.bgBlack;c.obj0White=ca.obj0White;c.obj0LightGrey=ca.obj0LightGrey;c.obj0DarkGrey=ca.obj0DarkGrey;c.obj0Black=ca.obj0Black;c.obj1White=ca.obj1White;c.obj1LightGrey=ca.obj1LightGrey;c.obj1DarkGrey=ca.obj1DarkGrey;c.obj1Black=ca.obj1Black;break;case 2:c.bgWhite=da.bgWhite;c.bgLightGrey=da.bgLightGrey;c.bgDarkGrey=da.bgDarkGrey;c.bgBlack=da.bgBlack;c.obj0White=da.obj0White;c.obj0LightGrey=
da.obj0LightGrey;c.obj0DarkGrey=da.obj0DarkGrey;c.obj0Black=da.obj0Black;c.obj1White=da.obj1White;c.obj1LightGrey=da.obj1LightGrey;c.obj1DarkGrey=da.obj1DarkGrey;c.obj1Black=da.obj1Black;break;case 3:c.bgWhite=ea.bgWhite;c.bgLightGrey=ea.bgLightGrey;c.bgDarkGrey=ea.bgDarkGrey;c.bgBlack=ea.bgBlack;c.obj0White=ea.obj0White;c.obj0LightGrey=ea.obj0LightGrey;c.obj0DarkGrey=ea.obj0DarkGrey;c.obj0Black=ea.obj0Black;c.obj1White=ea.obj1White;c.obj1LightGrey=ea.obj1LightGrey;c.obj1DarkGrey=ea.obj1DarkGrey;
c.obj1Black=ea.obj1Black;break;case 4:c.bgWhite=fa.bgWhite;c.bgLightGrey=fa.bgLightGrey;c.bgDarkGrey=fa.bgDarkGrey;c.bgBlack=fa.bgBlack;c.obj0White=fa.obj0White;c.obj0LightGrey=fa.obj0LightGrey;c.obj0DarkGrey=fa.obj0DarkGrey;c.obj0Black=fa.obj0Black;c.obj1White=fa.obj1White;c.obj1LightGrey=fa.obj1LightGrey;c.obj1DarkGrey=fa.obj1DarkGrey;c.obj1Black=fa.obj1Black;break;case 5:c.bgWhite=ha.bgWhite;c.bgLightGrey=ha.bgLightGrey;c.bgDarkGrey=ha.bgDarkGrey;c.bgBlack=ha.bgBlack;c.obj0White=ha.obj0White;c.obj0LightGrey=
ha.obj0LightGrey;c.obj0DarkGrey=ha.obj0DarkGrey;c.obj0Black=ha.obj0Black;c.obj1White=ha.obj1White;c.obj1LightGrey=ha.obj1LightGrey;c.obj1DarkGrey=ha.obj1DarkGrey;c.obj1Black=ha.obj1Black;break;case 6:c.bgWhite=ia.bgWhite;c.bgLightGrey=ia.bgLightGrey;c.bgDarkGrey=ia.bgDarkGrey;c.bgBlack=ia.bgBlack;c.obj0White=ia.obj0White;c.obj0LightGrey=ia.obj0LightGrey;c.obj0DarkGrey=ia.obj0DarkGrey;c.obj0Black=ia.obj0Black;c.obj1White=ia.obj1White;c.obj1LightGrey=ia.obj1LightGrey;c.obj1DarkGrey=ia.obj1DarkGrey;
c.obj1Black=ia.obj1Black;break;case 7:c.bgWhite=ja.bgWhite;c.bgLightGrey=ja.bgLightGrey;c.bgDarkGrey=ja.bgDarkGrey;c.bgBlack=ja.bgBlack;c.obj0White=ja.obj0White;c.obj0LightGrey=ja.obj0LightGrey;c.obj0DarkGrey=ja.obj0DarkGrey;c.obj0Black=ja.obj0Black;c.obj1White=ja.obj1White;c.obj1LightGrey=ja.obj1LightGrey;c.obj1DarkGrey=ja.obj1DarkGrey;c.obj1Black=ja.obj1Black;break;case 8:c.bgWhite=ka.bgWhite;c.bgLightGrey=ka.bgLightGrey;c.bgDarkGrey=ka.bgDarkGrey;c.bgBlack=ka.bgBlack;c.obj0White=ka.obj0White;c.obj0LightGrey=
ka.obj0LightGrey;c.obj0DarkGrey=ka.obj0DarkGrey;c.obj0Black=ka.obj0Black;c.obj1White=ka.obj1White;c.obj1LightGrey=ka.obj1LightGrey;c.obj1DarkGrey=ka.obj1DarkGrey;c.obj1Black=ka.obj1Black;break;case 9:c.bgWhite=la.bgWhite;c.bgLightGrey=la.bgLightGrey;c.bgDarkGrey=la.bgDarkGrey;c.bgBlack=la.bgBlack;c.obj0White=la.obj0White;c.obj0LightGrey=la.obj0LightGrey;c.obj0DarkGrey=la.obj0DarkGrey;c.obj0Black=la.obj0Black;c.obj1White=la.obj1White;c.obj1LightGrey=la.obj1LightGrey;c.obj1DarkGrey=la.obj1DarkGrey;
c.obj1Black=la.obj1Black;break;case 10:c.bgWhite=ma.bgWhite;c.bgLightGrey=ma.bgLightGrey;c.bgDarkGrey=ma.bgDarkGrey;c.bgBlack=ma.bgBlack;c.obj0White=ma.obj0White;c.obj0LightGrey=ma.obj0LightGrey;c.obj0DarkGrey=ma.obj0DarkGrey;c.obj0Black=ma.obj0Black;c.obj1White=ma.obj1White;c.obj1LightGrey=ma.obj1LightGrey;c.obj1DarkGrey=ma.obj1DarkGrey;c.obj1Black=ma.obj1Black;break;case 11:c.bgWhite=na.bgWhite;c.bgLightGrey=na.bgLightGrey;c.bgDarkGrey=na.bgDarkGrey;c.bgBlack=na.bgBlack;c.obj0White=na.obj0White;
c.obj0LightGrey=na.obj0LightGrey;c.obj0DarkGrey=na.obj0DarkGrey;c.obj0Black=na.obj0Black;c.obj1White=na.obj1White;c.obj1LightGrey=na.obj1LightGrey;c.obj1DarkGrey=na.obj1DarkGrey;c.obj1Black=na.obj1Black;break;case 12:c.bgWhite=oa.bgWhite,c.bgLightGrey=oa.bgLightGrey,c.bgDarkGrey=oa.bgDarkGrey,c.bgBlack=oa.bgBlack,c.obj0White=oa.obj0White,c.obj0LightGrey=oa.obj0LightGrey,c.obj0DarkGrey=oa.obj0DarkGrey,c.obj0Black=oa.obj0Black,c.obj1White=oa.obj1White,c.obj1LightGrey=oa.obj1LightGrey,c.obj1DarkGrey=
oa.obj1DarkGrey,c.obj1Black=oa.obj1Black}}function g(a,d){return(a&255)<<8|d&255}function z(a){return(a&65280)>>8}function D(a,d){return d&~(1<<a)}function n(a,d){return 0!=(d&1<<a)}function gb(a,d){a=w(d)>>2*a&3;if(d===Ta.memoryLocationSpritePaletteOne)switch(d=c.obj0White,a){case 1:d=c.obj0LightGrey;break;case 2:d=c.obj0DarkGrey;break;case 3:d=c.obj0Black}else if(d===Ta.memoryLocationSpritePaletteTwo)switch(d=c.obj1White,a){case 1:d=c.obj1LightGrey;break;case 2:d=c.obj1DarkGrey;break;case 3:d=c.obj1Black}else switch(d=
c.bgWhite,a){case 1:d=c.bgLightGrey;break;case 2:d=c.bgDarkGrey;break;case 3:d=c.bgBlack}return d}function hb(a,d,b){d=8*a+2*d;a=Mb(d+1,b);b=Mb(d,b);return g(a,b)}function pa(a,d){a*=5;return 8*((d&31<<a)>>a)}function Mb(a,d){a&=63;d&&(a+=64);return f[Ua+a]}function ib(a,d,b,c){void 0===b&&(b=0);void 0===c&&(c=!1);b&=3;c&&(b|=4);f[Va+(160*d+a)]=b}function sb(a,d,c,x,B,e,m,h,l,g,k,jb,p,t){var aa=0;d=ab(d,a);a=T(d+2*e,c);c=T(d+2*e+1,c);for(e=x;e<=B;++e)if(d=m+(e-x),d<l){var O=e;if(0>p||!n(5,p))O=7-
O;var Qa=0;n(O,c)&&(Qa+=1,Qa<<=1);n(O,a)&&(Qa+=1);if(b.GBCEnabled&&(0<=p||0<=t)){O=0<=t;var ba=p&7;O&&(ba=t&7);var N=hb(ba,Qa,O);O=pa(0,N);ba=pa(1,N);N=pa(2,N)}else if(0>=jb&&(jb=q.memoryLocationBackgroundPalette),k){ba=Qa;N=k;void 0===N&&(N=!1);O=ba;N||(O=w(jb)>>(ba<<1)&3);ba=242;switch(O){case 1:ba=160;break;case 2:ba=88;break;case 3:ba=8}ba=O=N=ba}else N=gb(Qa,jb),O=(N&16711680)>>16,ba=(N&65280)>>8,N&=255;var tb=3*(h*l+d);f[g+tb+0]=O;f[g+tb+1]=ba;f[g+tb+2]=N;O=!1;0<=p&&(O=n(7,p));ib(d,h,Qa,O);
aa++}return aa}function ab(a,d){a===q.memoryLocationTileDataSelectZeroStart&&(d=n(7,d)?d-128:d+128);return a+16*d}function Nb(a,d){switch(a){case 1:return n(d,129);case 2:return n(d,135);case 3:return n(d,126);default:return n(d,1)}}function Ob(){var a=Pb();2047>=a&&0<r.NRx0SweepShift&&(r.sweepShadowFrequency=a,r.setFrequency(a),a=Pb());2047<a&&(r.isEnabled=!1)}function Pb(){var a=r.sweepShadowFrequency;var d=a>>r.NRx0SweepShift;return d=r.NRx0Negate?a-d:a+d}function kb(a){switch(a){case r.channelNumber:a=
r.isDacEnabled;var d=t.channel1DacEnabled!==a;t.channel1DacEnabled=a;return d;case I.channelNumber:return a=I.isDacEnabled,d=t.channel2DacEnabled!==a,t.channel2DacEnabled=a,d;case F.channelNumber:return a=F.isDacEnabled,d=t.channel3DacEnabled!==a,t.channel3DacEnabled=a,d;case J.channelNumber:return a=J.isDacEnabled,d=t.channel4DacEnabled!==a,t.channel4DacEnabled=a,d}return!1}function bb(){for(var a=h.batchProcessCycles(),d=h.currentCycles;d>=a;)Qb(a),d-=a;h.currentCycles=d}function Qb(a){var d=h.maxFrameSequenceCycles();
var b=h.frameSequenceCycleCounter+a;if(b>=d){h.frameSequenceCycleCounter=b-d;d=h.frameSequencer;switch(d){case 0:r.updateLength();I.updateLength();F.updateLength();J.updateLength();break;case 2:r.updateLength();I.updateLength();F.updateLength();J.updateLength();r.updateSweep();break;case 4:r.updateLength();I.updateLength();F.updateLength();J.updateLength();break;case 6:r.updateLength();I.updateLength();F.updateLength();J.updateLength();r.updateSweep();break;case 7:r.updateEnvelope(),I.updateEnvelope(),
J.updateEnvelope()}h.frameSequencer=d+1&7;d=!0}else h.frameSequenceCycleCounter=b,d=!1;if(L.audioAccumulateSamples&&!d){d=r.willChannelUpdate(a)||kb(r.channelNumber);b=I.willChannelUpdate(a)||kb(I.channelNumber);var c=F.willChannelUpdate(a)||kb(F.channelNumber),f=J.willChannelUpdate(a)||kb(J.channelNumber);d&&(t.channel1Sample=r.getSampleFromCycleCounter());b&&(t.channel2Sample=I.getSampleFromCycleCounter());c&&(t.channel3Sample=F.getSampleFromCycleCounter());f&&(t.channel4Sample=J.getSampleFromCycleCounter());
if(d||b||c||f)t.needToRemixSamples=!0;d=h.downSampleCycleCounter;d+=a*h.downSampleCycleMultiplier;a=h.maxDownSampleCycles();d>=a&&(d-=a,t.needToRemixSamples||t.mixerVolumeChanged||t.mixerEnabledChanged?Wa(t.channel1Sample,t.channel2Sample,t.channel3Sample,t.channel4Sample):h.downSampleCycleCounter=d,Xa(t.leftChannelSampleUnsignedByte+1,t.rightChannelSampleUnsignedByte+1,lb),a=h.audioQueueIndex+1,a>=(h.wasmBoyMemoryMaxBufferSize>>1|0)-1&&--a,h.audioQueueIndex=a);h.downSampleCycleCounter=d}else{d=r.getSample(a)|
0;b=I.getSample(a)|0;c=F.getSample(a)|0;f=J.getSample(a)|0;t.channel1Sample=d;t.channel2Sample=b;t.channel3Sample=c;t.channel4Sample=f;a=h.downSampleCycleCounter+a*h.downSampleCycleMultiplier;if(a>=h.maxDownSampleCycles()){a-=h.maxDownSampleCycles();var e=Wa(d,b,c,f),n=z(e);Xa(n+1,(e&255)+1,lb);L.enableAudioDebugging&&(e=Wa(d,15,15,15),n=z(e),Xa(n+1,(e&255)+1,ub),e=Wa(15,b,15,15),n=z(e),Xa(n+1,(e&255)+1,vb),e=Wa(15,15,c,15),n=z(e),Xa(n+1,(e&255)+1,wb),e=Wa(15,15,15,f),n=z(e),Xa(n+1,(e&255)+1,xb));
d=h.audioQueueIndex+1;d>=(h.wasmBoyMemoryMaxBufferSize>>1|0)-1&&--d;h.audioQueueIndex=d}h.downSampleCycleCounter=a}}function Rb(){return h.audioQueueIndex}function Sb(){h.audioQueueIndex=0}function Wa(a,d,b,c){void 0===a&&(a=15);void 0===d&&(d=15);void 0===b&&(b=15);void 0===c&&(c=15);t.mixerVolumeChanged=!1;var aa=0+(h.NR51IsChannel1EnabledOnLeftOutput?a:15);aa+=h.NR51IsChannel2EnabledOnLeftOutput?d:15;aa+=h.NR51IsChannel3EnabledOnLeftOutput?b:15;aa+=h.NR51IsChannel4EnabledOnLeftOutput?c:15;a=0+
(h.NR51IsChannel1EnabledOnRightOutput?a:15);a+=h.NR51IsChannel2EnabledOnRightOutput?d:15;a+=h.NR51IsChannel3EnabledOnRightOutput?b:15;a+=h.NR51IsChannel4EnabledOnRightOutput?c:15;t.mixerEnabledChanged=!1;t.needToRemixSamples=!1;d=Tb(aa,h.NR50LeftMixerVolume+1);b=Tb(a,h.NR50RightMixerVolume+1);t.leftChannelSampleUnsignedByte=d;t.rightChannelSampleUnsignedByte=b;return g(d,b)}function Tb(a,d){if(60===a)return 127;a=1E5*(a-60)*d>>3;a=(a/1E5|0)+60;a=1E5*a/(12E6/254|0)|0;return a|=0}function Xa(a,d,b){b+=
h.audioQueueIndex<<1;f[b+0]=a+1;f[b+1]=d+1}function cb(a){mb(!1);var d=w(l.memoryLocationInterruptRequest);d=D(a,d);l.interruptsRequestedValue=d;e(l.memoryLocationInterruptRequest,d);b.stackPointer-=2;b.isHalted();d=b.stackPointer;var c=b.programCounter,x=z(c);e(d+0,c&255);e(d+1,x);switch(a){case l.bitPositionVBlankInterrupt:l.isVBlankInterruptRequested=!1;b.programCounter=64;break;case l.bitPositionLcdInterrupt:l.isLcdInterruptRequested=!1;b.programCounter=72;break;case l.bitPositionTimerInterrupt:l.isTimerInterruptRequested=
!1;b.programCounter=80;break;case l.bitPositionSerialInterrupt:l.isSerialInterruptRequested=!1;b.programCounter=88;break;case l.bitPositionJoypadInterrupt:l.isJoypadInterruptRequested=!1,b.programCounter=96}}function Ya(a){var b=w(l.memoryLocationInterruptRequest);b|=1<<a;l.interruptsRequestedValue=b;e(l.memoryLocationInterruptRequest,b)}function mb(a){a?l.masterInterruptSwitchDelay=!0:l.masterInterruptSwitch=!1}function yb(a){for(var b=0;b<a;){var c=k.dividerRegister,x=c;b+=4;x+=4;x&=65535;k.dividerRegister=
x;if(k.timerEnabled){var f=k.timerCounterWasReset;k.timerCounterOverflowDelay?(k.timerCounter=k.timerModulo,l.isTimerInterruptRequested=!0,Ya(l.bitPositionTimerInterrupt),k.timerCounterOverflowDelay=!1,k.timerCounterWasReset=!0):f&&(k.timerCounterWasReset=!1);Ub(c,x)&&zb()}}}function zb(){var a=k.timerCounter;255<++a&&(k.timerCounterOverflowDelay=!0,a=0);k.timerCounter=a}function Ub(a,b){var d=Ab(k.timerInputClock);return n(d,a)&&!n(d,b)}function Ab(a){switch(a){case 0:return 9;case 1:return 3;case 2:return 5;
case 3:return 7}return 0}function Oa(a){var d=b.isStopped=!1;ec(a)||(d=!0);Da(a,!0);d&&(d=!1,3>=a&&(d=!0),a=!1,y.isDpadType&&d&&(a=!0),y.isButtonType&&!d&&(a=!0),a&&(l.isJoypadInterruptRequested=!0,Ya(l.bitPositionJoypadInterrupt)))}function ec(a){switch(a){case 0:return y.up;case 1:return y.right;case 2:return y.down;case 3:return y.left;case 4:return y.a;case 5:return y.b;case 6:return y.select;case 7:return y.start;default:return!1}}function Da(a,b){switch(a){case 0:y.up=b;break;case 1:y.right=
b;break;case 2:y.down=b;break;case 3:y.left=b;break;case 4:y.a=b;break;case 5:y.b=b;break;case 6:y.select=b;break;case 7:y.start=b}}function Vb(a,d,c){for(var aa=0;aa<c;++aa){for(var f=Bb(a+aa),e=d+aa;40959<e;)e-=8192;Wb(e,f)}m.DMACycles+=(32<<b.GBCDoubleSpeed)*(c>>4)}function Cb(a,d){if(a===b.memoryLocationSpeedSwitch)return e(b.memoryLocationSpeedSwitch,d&1),!1;if(b.BootROMEnabled&&a===b.memoryLocationBootROMSwitch)return b.BootROMEnabled=!1,b.programCounter=255,!0;var c=m.videoRamLocation,x=m.spriteInformationTableLocation;
if(a<c){if(!m.isRomOnly){c=m.isMBC1;var B=m.isMBC2;if(8191>=a){if(!B||n(4,d))d&=15,0===d?m.isRamBankingEnabled=!1:10===d&&(m.isRamBankingEnabled=!0)}else 16383>=a?(x=m.isMBC5,!x||12287>=a?(a=m.currentRomBank,B&&(a=d&15),c?(d&=31,a&=224):m.isMBC3?(d&=127,a&=128):x&&(a&=0),m.currentRomBank=a|d):m.currentRomBank=g(0<d,m.currentRomBank&255)):!B&&24575>=a?c&&m.isMBC1RomModeEnabled?(a=m.currentRomBank&31,m.currentRomBank=a|d&224):(d=m.isMBC5?d&15:d&3,m.currentRamBank=d):!B&&32767>=a&&c&&(m.isMBC1RomModeEnabled=
n(0,d))}return!1}if(a>=c&&a<m.cartridgeRamLocation)return!0;if(a>=m.echoRamLocation&&a<x)return e(a-8192,d),!0;if(a>=x&&a<=m.spriteInformationTableLocationEnd)return 2<=v.currentLcdMode;if(a>=m.unusableMemoryLocation&&a<=m.unusableMemoryEndLocation)return!1;if(a===V.memoryLocationSerialTransferControl)return V.updateTransferControl(d);if(65296<=a&&65318>=a){bb();if(a===h.memoryLocationNR52||h.NR52IsSoundEnabled){switch(a){case r.memoryLocationNRx0:r.updateNRx0(d);break;case F.memoryLocationNRx0:F.updateNRx0(d);
break;case r.memoryLocationNRx1:r.updateNRx1(d);break;case I.memoryLocationNRx1:I.updateNRx1(d);break;case F.memoryLocationNRx1:F.updateNRx1(d);break;case J.memoryLocationNRx1:J.updateNRx1(d);break;case r.memoryLocationNRx2:r.updateNRx2(d);break;case I.memoryLocationNRx2:I.updateNRx2(d);break;case F.memoryLocationNRx2:F.volumeCodeChanged=!0;F.updateNRx2(d);break;case J.memoryLocationNRx2:J.updateNRx2(d);break;case r.memoryLocationNRx3:r.updateNRx3(d);break;case I.memoryLocationNRx3:I.updateNRx3(d);
break;case F.memoryLocationNRx3:F.updateNRx3(d);break;case J.memoryLocationNRx3:J.updateNRx3(d);break;case r.memoryLocationNRx4:n(7,d)&&(r.updateNRx4(d),r.trigger());break;case I.memoryLocationNRx4:n(7,d)&&(I.updateNRx4(d),I.trigger());break;case F.memoryLocationNRx4:n(7,d)&&(F.updateNRx4(d),F.trigger());break;case J.memoryLocationNRx4:n(7,d)&&(J.updateNRx4(d),J.trigger());break;case h.memoryLocationNR50:h.updateNR50(d);t.mixerVolumeChanged=!0;break;case h.memoryLocationNR51:h.updateNR51(d);t.mixerEnabledChanged=
!0;break;case h.memoryLocationNR52:if(h.updateNR52(d),!n(7,d))for(d=65296;65318>d;++d)e(d,0)}d=!0}else d=!1;return d}65328<=a&&65343>=a&&bb();if(a>=v.memoryLocationLcdControl&&a<=q.memoryLocationWindowX){if(a===v.memoryLocationLcdControl)return v.updateLcdControl(d),!0;if(a===v.memoryLocationLcdStatus)return v.updateLcdStatus(d),!1;if(a===q.memoryLocationScanlineRegister)return q.scanlineRegister=0,e(a,0),!1;if(a===v.memoryLocationCoincidenceCompare)return v.coincidenceCompare=d,!0;if(a===q.memoryLocationDmaTransfer){d<<=
8;for(a=0;159>=a;++a)c=w(d+a),e(m.spriteInformationTableLocation+a,c);m.DMACycles=644;return!0}switch(a){case q.memoryLocationScrollX:q.scrollX=d;break;case q.memoryLocationScrollY:q.scrollY=d;break;case q.memoryLocationWindowX:q.windowX=d;break;case q.memoryLocationWindowY:q.windowY=d}return!0}if(a===m.memoryLocationHdmaTrigger)return b.GBCEnabled&&(m.isHblankHdmaActive&&!n(7,d)?(m.isHblankHdmaActive=!1,d=w(m.memoryLocationHdmaTrigger),e(m.memoryLocationHdmaTrigger,d|128)):(a=w(m.memoryLocationHdmaSourceHigh),
c=w(m.memoryLocationHdmaSourceLow),a=g(a,c)&65520,c=w(m.memoryLocationHdmaDestinationHigh),x=w(m.memoryLocationHdmaDestinationLow),c=g(c,x),c=(c&8176)+m.videoRamLocation,x=D(7,d),x=x+1<<4,n(7,d)?(m.isHblankHdmaActive=!0,m.hblankHdmaTransferLengthRemaining=x,m.hblankHdmaSource=a,m.hblankHdmaDestination=c,e(m.memoryLocationHdmaTrigger,D(7,d))):(Vb(a,c,x),e(m.memoryLocationHdmaTrigger,255)))),!1;if((a===m.memoryLocationGBCWRAMBank||a===m.memoryLocationGBCVRAMBank)&&m.isHblankHdmaActive&&(c=m.hblankHdmaSource,
16384<=c&&32767>=c||53248<=c&&57343>=c))return!1;if(a>=Ta.memoryLocationBackgroundPaletteIndex&&a<=Ta.memoryLocationSpritePaletteData){c=Ta.memoryLocationSpritePaletteData;if(a===Ta.memoryLocationBackgroundPaletteData||a===c)x=w(a-1),x=D(6,x),B=x&63,a===c&&(B+=64),f[Ua+B]=d,d=x,--a,n(7,d)&&e(a,d+1|128);return!0}if(a>=k.memoryLocationDividerRegister&&a<=k.memoryLocationTimerControl){yb(k.currentCycles);k.currentCycles=0;switch(a){case k.memoryLocationDividerRegister:return k.updateDividerRegister(),
!1;case k.memoryLocationTimerCounter:k.updateTimerCounter(d);break;case k.memoryLocationTimerModulo:k.updateTimerModulo(d);break;case k.memoryLocationTimerControl:k.updateTimerControl(d)}return!0}a===y.memoryLocationJoypadRegister&&y.updateJoypad(d);if(a===l.memoryLocationInterruptRequest)return l.updateInterruptRequested(d),!0;a===l.memoryLocationInterruptEnabled&&l.updateInterruptEnabled(d);return!0}function Db(a){switch(a>>12){case 0:if(b.BootROMEnabled)if(b.GBCEnabled){if(256>a||511<a&&2304>a)return a+
nb}else if(!b.GBCEnabled&&256>a)return a+nb;case 1:case 2:case 3:return a+ob;case 4:case 5:case 6:case 7:var d=m.currentRomBank;m.isMBC5||0!==d||(d=1);return 16384*d+(a-m.switchableCartridgeRomLocation)+ob;case 8:case 9:return d=0,b.GBCEnabled&&(d=w(m.memoryLocationGBCVRAMBank)&1),a-m.videoRamLocation+2048+8192*d;case 10:case 11:return 8192*m.currentRamBank+(a-m.cartridgeRamLocation)+Eb;case 12:return a-m.internalRamBankZeroLocation+18432;case 13:return d=0,b.GBCEnabled&&(d=w(m.memoryLocationGBCWRAMBank)&
7),a-m.internalRamBankZeroLocation+18432+4096*((1>d?1:d)-1);default:return a-m.echoRamLocation+51200}}function e(a,b){a=Db(a);f[a]=b}function Wb(a,b){a===W.writeGbMemory&&(W.reachedBreakpoint=!0);Cb(a,b)&&e(a,b)}function Xb(a){q.scanlineCycleCounter=0;q.scanlineRegister=0;e(q.memoryLocationScanlineRegister,0);var b=w(v.memoryLocationLcdStatus);b=D(1,b);b=D(0,b);v.currentLcdMode=0;e(v.memoryLocationLcdStatus,b);if(a)for(a=0;93184>a;++a)f[Za+a]=255}function Yb(a,b){0!==a&&1!==a||q.scanlineRegister!==
v.coincidenceCompare?b=D(2,b):(b|=4,n(6,b)&&(l.isLcdInterruptRequested=!0,Ya(l.bitPositionLcdInterrupt)));return b}function Zb(a,d,c,x,e,m){for(var aa=x>>3;160>e;++e){var B=e+m;256<=B&&(B-=256);var h=c+(aa<<5)+(B>>3),l=T(h,0),g=!1;if(L.tileCaching){var k=e;var p=a,t=B,N=h,u=l,v=0,r=$a.nextXIndexToPerformCacheCheck;if(0<p&&8<k&&u===$a.tileId&&k===r){u=n(5,w(N-1));N=n(5,w(N));for(var y=0;8>y;++y){u!==N&&(y=7-y);var z=k+y;if(160>=z){var A=k-(8-y),C=Za+3*(160*p+z);Y(z,p,0,f[C]);Y(z,p,1,f[C]);Y(z,p,2,
f[C]);A=f[Va+(160*p+A)];ib(z,p,D(2,A),n(2,A));v++}}}else $a.tileId=u;k>=r&&(r=k+8,p=t&7|0,k<p&&(r+=p));$a.nextXIndexToPerformCacheCheck=r;k=v;0<k&&(e+=k-1,g=!0)}L.tileRendering&&!g?(g=e,k=a,p=B,B=d,v=x&7|0,r=0,0==g&&(r=p-(p>>3<<3)),p=7,160<g+8&&(p=160-g),t=-1,u=0,b.GBCEnabled&&(t=T(h,1),u=n(3,t)|0,n(6,t)&&(v=7-v)),k=sb(l,B,u,r,p,v,g,k,160,Za,!1,0,t,-1),0<k&&(e+=k-1)):g||(b.GBCEnabled?(g=e,k=a,r=x,v=ab(d,l),l=T(h,1),r=r&7|0,n(6,l)&&(r=7-r),p=n(3,l)|0,h=T(v+2*r,p),v=T(v+2*r+1,p),r=B&7|0,n(5,l)||(r=
7-r),B=0,n(r,v)&&(B=B+1<<1),n(r,h)&&(B+=1),r=hb(l&7,B,!1),h=pa(0,r),v=pa(1,r),r=pa(2,r),Y(g,k,0,h),Y(g,k,1,v),Y(g,k,2,r),ib(g,k,B,n(7,l))):(h=e,g=a,v=x,k=ab(d,l),v=v&7|0,l=T(k+2*v,0),k=T(k+2*v+1,0),v=B&7|0,v=7-v,B=0,n(v,k)&&(B=B+1<<1),n(v,l)&&(B+=1),l=gb(B,q.memoryLocationBackgroundPalette),Y(h,g,0,(l&16711680)>>16),Y(h,g,1,(l&65280)>>8),Y(h,g,2,l&255),ib(h,g,B)))}}function $b(a){if(v.enabled)for(q.scanlineCycleCounter+=a,a=L.graphicsDisableScanlineRendering;q.scanlineCycleCounter>=q.MAX_CYCLES_PER_SCANLINE();){q.scanlineCycleCounter-=
q.MAX_CYCLES_PER_SCANLINE();var b=q.scanlineRegister;if(144===b){if(a)for(var c=0;144>=c;++c)Fb(c);else Fb(b);for(c=0;144>c;++c)for(var x=0;160>x;++x)f[Va+(160*c+x)]=0;$a.tileId=-1;$a.nextXIndexToPerformCacheCheck=-1}else 144>b&&(a||Fb(b));b=153<b?0:b+1;q.scanlineRegister=b}if(v.enabled){b=q.scanlineRegister;c=v.currentLcdMode;a=0;if(144<=b)a=1;else{x=q.scanlineCycleCounter;var B=q.MIN_CYCLES_SPRITES_LCD_MODE();x>=B?a=2:x>=B&&(a=3)}if(c!==a){b=w(v.memoryLocationLcdStatus);v.currentLcdMode=a;c=!1;
switch(a){case 0:b=D(0,b);b=D(1,b);c=n(3,b);break;case 1:b=D(1,b);b|=1;c=n(4,b);break;case 2:b=D(0,b);b|=2;c=n(5,b);break;case 3:b|=3}c&&(l.isLcdInterruptRequested=!0,Ya(l.bitPositionLcdInterrupt));0===a&&m.isHblankHdmaActive&&(x=16,c=m.hblankHdmaTransferLengthRemaining,c<x&&(x=c),Vb(m.hblankHdmaSource,m.hblankHdmaDestination,x),m.hblankHdmaSource+=x,m.hblankHdmaDestination+=x,c-=x,m.hblankHdmaTransferLengthRemaining=c,x=m.memoryLocationHdmaTrigger,0>=c?(m.isHblankHdmaActive=!1,e(x,255)):e(x,D(7,
(c>>4)-1)));1===a&&(l.isVBlankInterruptRequested=!0,Ya(l.bitPositionVBlankInterrupt));b=Yb(a,b);e(v.memoryLocationLcdStatus,b)}else 153===b&&(b=w(v.memoryLocationLcdStatus),b=Yb(a,b),e(v.memoryLocationLcdStatus,b))}}function Fb(a){var d=q.memoryLocationTileDataSelectZeroStart;v.bgWindowTileDataSelect&&(d=q.memoryLocationTileDataSelectOneStart);if(b.GBCEnabled||v.bgDisplayEnabled){var c=q.memoryLocationTileMapSelectZeroStart;v.bgTileMapDisplaySelect&&(c=q.memoryLocationTileMapSelectOneStart);Zb(a,
d,c,a+q.scrollY&255,0,q.scrollX)}if(v.windowDisplayEnabled){c=q.memoryLocationTileMapSelectZeroStart;v.windowTileMapDisplaySelect&&(c=q.memoryLocationTileMapSelectOneStart);var x=q.windowX,e=q.windowY;a<e||(x-=7,Zb(a,d,c,a-e,x,-x|0))}if(v.spriteDisplayEnable)for(d=v.tallSpriteSize,c=39;0<=c;--c){e=4*c;var m=q.memoryLocationSpriteAttributesTable+e,h=w(m+0);x=w(m+1);var l=w(m+2);h-=16;x-=8;var g=8;d&&(g=16,l-=l&1);if(a>=h&&a<h+g){e=w(q.memoryLocationSpriteAttributesTable+e+3);m=n(7,e);var k=n(6,e),
p=n(5,e);h=a-h;k&&(h=g-h,--h);h<<=1;l=ab(q.memoryLocationTileDataSelectOneStart,l);l+=h;g=b.GBCEnabled&&n(3,e);h=T(l+0,g);l=T(l+1,g);for(g=7;0<=g;--g){k=g;p&&(k-=7,k=-k);var r=0;n(k,l)&&(r=r+1<<1);n(k,h)&&(r+=1);if(0!==r&&(k=x+(7-g),0<=k&&160>=k)){var t=b.GBCEnabled&&!v.bgDisplayEnabled,u=!1,y=!1;if(!t){var z=f[Va+(160*a+k)],A=z&3;m&&0<A?u=!0:b.GBCEnabled&&n(2,z)&&0<A&&(y=!0)}if(t||!u&&!y)b.GBCEnabled?(u=hb(e&7,r,!0),r=pa(0,u),t=pa(1,u),u=pa(2,u),Y(k,a,0,r),Y(k,a,1,t),Y(k,a,2,u)):(t=q.memoryLocationSpritePaletteOne,
n(4,e)&&(t=q.memoryLocationSpritePaletteTwo),r=gb(r,t),Y(k,a,0,(r&16711680)>>16),Y(k,a,1,(r&65280)>>8),Y(k,a,2,r&255))}}}}}function Y(a,b,c,e){f[Za+3*(160*b+a)+c]=e}function T(a,b){return f[a-m.videoRamLocation+2048+8192*(b&1)]}function Gb(a){var d=m.videoRamLocation;return a<d||a>=d&&a<m.cartridgeRamLocation?-1:a>=m.echoRamLocation&&a<m.spriteInformationTableLocation?w(a-8192):a>=m.spriteInformationTableLocation&&a<=m.spriteInformationTableLocationEnd?2>v.currentLcdMode?255:-1:a===b.memoryLocationSpeedSwitch?
(a=255,d=w(b.memoryLocationSpeedSwitch),n(0,d)||(a=D(0,a)),b.GBCDoubleSpeed||(a=D(7,a)),a):a===q.memoryLocationScanlineRegister?(e(a,q.scanlineRegister),q.scanlineRegister):65296<=a&&65318>=a?(bb(),a=a===h.memoryLocationNR52?w(h.memoryLocationNR52)&128|112:-1,a):65328<=a&&65343>=a?(bb(),-1):a===k.memoryLocationDividerRegister?(d=z(k.dividerRegister),e(a,d),d):a===k.memoryLocationTimerCounter?(e(a,k.timerCounter),k.timerCounter):a===l.memoryLocationInterruptRequest?224|l.interruptsRequestedValue:a===
y.memoryLocationJoypadRegister?(a=y.joypadRegisterFlipped,y.isDpadType?(a=y.up?D(2,a):a|4,a=y.right?D(0,a):a|1,a=y.down?D(3,a):a|8,a=y.left?D(1,a):a|2):y.isButtonType&&(a=y.a?D(0,a):a|1,a=y.b?D(1,a):a|2,a=y.select?D(2,a):a|4,a=y.start?D(3,a):a|8),a|240):-1}function w(a){return f[Db(a)]}function Bb(a){a===W.readGbMemory&&(W.reachedBreakpoint=!0);var b=Gb(a);return-1===b?w(a):b}function K(a){return 0<f[a]}function Ea(a){var d=b.registerA;M(d,a);rb(d,a);d=d+a&255;b.registerA=d;u(0===d);p(0)}function Fa(a){var d=
b.registerA,c=d+a+Q()&255;C(0!=((d^a^c)&16));a=d+a+Q()&65535;G(0<(a&256));b.registerA=c;u(0===c);p(0)}function Ga(a){var d=-1*a;var c=b.registerA;M(c,d);rb(c,d);c=c-a&255;b.registerA=c;u(0===c);p(1)}function Ha(a){var d=b.registerA,c=d-a-Q()&255;C(0!=((d^a^c)&16));a=d-a-Q()&65535;G(0<(a&256));b.registerA=c;u(0===c);p(1)}function Ia(a){a&=b.registerA;b.registerA=a;u(0===a);p(0);C(1);G(0)}function Ja(a){a=(b.registerA^a)&255;b.registerA=a;u(0===a);p(0);C(0);G(0)}function Ka(a){a|=b.registerA;b.registerA=
a;u(0===a);p(0);C(0);G(0)}function La(a){var d=b.registerA;a*=-1;M(d,a);rb(d,a);u(0===d+a);p(1)}function Pa(a,b){u(0===(b&1<<a));p(0);C(1);return b}function X(a,b,c){return 0<b?c|1<<a:c&~(1<<a)}function db(a){var d=b.programCounter;d=(d+(a<<24>>24)&65535)+1&65535;b.programCounter=d}function ac(a){var d=b.programCounter;d=d+1&65535;b.isHaltBug&&(d=d-1&65535);b.programCounter=d;switch((a&240)>>4){case 0:return fc(a);case 1:return gc(a);case 2:return hc(a);case 3:return ic(a);case 4:return jc(a);case 5:return kc(a);
case 6:return lc(a);case 7:return mc(a);case 8:return nc(a);case 9:return oc(a);case 10:return pc(a);case 11:return qc(a);case 12:return rc(a);case 13:return sc(a);case 14:return tc(a);default:return uc(a)}}function E(a){Ma(4);return Bb(a)}function P(a,b){Ma(4);Wb(a,b)}function Ca(a){Ma(8);var b=Gb(a);b=-1===b?w(a):b;a+=1;var c=Gb(a);a=-1===c?w(a):c;return g(a,b)}function R(a,b){Ma(8);var d=z(b);b&=255;Cb(a,b)&&e(a,b);a+=1;Cb(a,d)&&e(a,d)}function A(){Ma(4);return w(b.programCounter)}function U(){Ma(4);
var a=w(b.programCounter+1&65535);return g(a,A())}function fc(a){switch(a){case 0:return 4;case 1:return a=U(),b.registerB=z(a),b.registerC=a&255,b.programCounter=b.programCounter+2&65535,4;case 2:return P(g(b.registerB,b.registerC),b.registerA),4;case 3:return a=g(b.registerB,b.registerC),a++,b.registerB=z(a),b.registerC=a&255,8;case 4:return a=b.registerB,M(a,1),a=a+1&255,b.registerB=a,u(0===a),p(0),4;case 5:return a=b.registerB,M(a,-1),a=a-1&255,b.registerB=a,u(0===a),p(1),4;case 6:return b.registerB=
A(),b.programCounter=b.programCounter+1&65535,4;case 7:return a=b.registerA,G(128===(a&128)),b.registerA=(a<<1|a>>7)&255,u(0),p(0),C(0),4;case 8:return R(U(),b.stackPointer),b.programCounter=b.programCounter+2&65535,4;case 9:a=g(b.registerH,b.registerL);var d=g(b.registerB,b.registerC);Sa(a,d,!1);a=a+d&65535;b.registerH=z(a);b.registerL=a&255;p(0);return 8;case 10:return b.registerA=E(g(b.registerB,b.registerC)),4;case 11:return a=g(b.registerB,b.registerC),a=a-1&65535,b.registerB=z(a),b.registerC=
a&255,8;case 12:return a=b.registerC,M(a,1),a=a+1&255,b.registerC=a,u(0===a),p(0),4;case 13:return a=b.registerC,M(a,-1),a=a-1&255,b.registerC=a,u(0===a),p(1),4;case 14:return b.registerC=A(),b.programCounter=b.programCounter+1&65535,4;case 15:return a=b.registerA,G(0<(a&1)),b.registerA=(a>>1|a<<7)&255,u(0),p(0),C(0),4}return-1}function gc(a){switch(a){case 16:if(b.GBCEnabled&&(a=E(b.memoryLocationSpeedSwitch),n(0,a)))return a=D(0,a),n(7,a)?(b.GBCDoubleSpeed=!1,a=D(7,a)):(b.GBCDoubleSpeed=!0,a|=128),
P(b.memoryLocationSpeedSwitch,a),68;b.isStopped=!0;b.programCounter=b.programCounter+1&65535;return 4;case 17:return a=U(),b.registerD=z(a),b.registerE=a&255,b.programCounter=b.programCounter+2&65535,4;case 18:return P(g(b.registerD,b.registerE),b.registerA),4;case 19:return a=g(b.registerD,b.registerE),a=a+1&65535,b.registerD=z(a),b.registerE=a&255,8;case 20:return a=b.registerD,M(a,1),b.registerD=a+1&255,u(0===b.registerD),p(0),4;case 21:return a=b.registerD,M(a,-1),b.registerD=a-1&255,u(0===b.registerD),
p(1),4;case 22:return b.registerD=A(),b.programCounter=b.programCounter+1&65535,4;case 23:return a=128===(b.registerA&128),b.registerA=(b.registerA<<1|Q())&255,G(a),u(0),p(0),C(0),4;case 24:return db(A()),8;case 25:a=g(b.registerH,b.registerL);var d=g(b.registerD,b.registerE);Sa(a,d,!1);a=a+d&65535;b.registerH=z(a);b.registerL=a&255;p(0);return 8;case 26:return a=g(b.registerD,b.registerE),b.registerA=E(a),4;case 27:return a=g(b.registerD,b.registerE),a=a-1&65535,b.registerD=z(a),b.registerE=a&255,
8;case 28:return a=b.registerE,M(a,1),a=a+1&255,b.registerE=a,u(0===a),p(0),4;case 29:return a=b.registerE,M(a,-1),a=a-1&255,b.registerE=a,u(0===a),p(1),4;case 30:return b.registerE=A(),b.programCounter=b.programCounter+1&65535,4;case 31:return a=1===(b.registerA&1),b.registerA=(b.registerA>>1|Q()<<7)&255,G(a),u(0),p(0),C(0),4}return-1}function hc(a){switch(a){case 32:return 0===Na()?db(A()):b.programCounter=b.programCounter+1&65535,8;case 33:return a=U(),b.registerH=z(a),b.registerL=a&255,b.programCounter=
b.programCounter+2&65535,4;case 34:return a=g(b.registerH,b.registerL),P(a,b.registerA),a=a+1&65535,b.registerH=z(a),b.registerL=a&255,4;case 35:return a=g(b.registerH,b.registerL),a=a+1&65535,b.registerH=z(a),b.registerL=a&255,8;case 36:return a=b.registerH,M(a,1),a=a+1&255,b.registerH=a,u(0===a),p(0),4;case 37:return a=b.registerH,M(a,-1),a=a-1&255,b.registerH=a,u(0===a),p(1),4;case 38:return b.registerH=A(),b.programCounter=b.programCounter+1&65535,4;case 39:a=0;0<(b.registerF>>5&1)&&(a|=6);0<
Q()&&(a|=96);var d=b.registerA;0<(b.registerF>>6&1)?d=d-a&255:(9<(d&15)&&(a|=6),153<d&&(a|=96),d=d+a&255);u(0===d);G(0!==(a&96));C(0);b.registerA=d;return 4;case 40:return 0<Na()?db(A()):b.programCounter=b.programCounter+1&65535,8;case 41:return a=g(b.registerH,b.registerL),Sa(a,a,!1),a=2*a&65535,b.registerH=z(a),b.registerL=a&255,p(0),8;case 42:return a=g(b.registerH,b.registerL),b.registerA=E(a),a=a+1&65535,b.registerH=z(a),b.registerL=a&255,4;case 43:return a=g(b.registerH,b.registerL),a=a-1&65535,
b.registerH=z(a),b.registerL=a&255,8;case 44:return a=b.registerL,M(a,1),a=a+1&255,b.registerL=a,u(0===a),p(0),4;case 45:return a=b.registerL,M(a,-1),a=a-1&255,b.registerL=a,u(0===a),p(1),4;case 46:return b.registerL=A(),b.programCounter=b.programCounter+1&65535,4;case 47:return b.registerA=~b.registerA,p(1),C(1),4}return-1}function ic(a){switch(a){case 48:return 0===Q()?db(A()):b.programCounter=b.programCounter+1&65535,8;case 49:return b.stackPointer=U(),b.programCounter=b.programCounter+2&65535,
4;case 50:return a=g(b.registerH,b.registerL),P(a,b.registerA),a=a-1&65535,b.registerH=z(a),b.registerL=a&255,4;case 51:return b.stackPointer=b.stackPointer+1&65535,8;case 52:a=g(b.registerH,b.registerL);var d=E(a);M(d,1);d=d+1&255;u(0===d);p(0);P(a,d);return 4;case 53:return a=g(b.registerH,b.registerL),d=E(a),M(d,-1),d=d-1&255,u(0===d),p(1),P(a,d),4;case 54:return P(g(b.registerH,b.registerL),A()),b.programCounter=b.programCounter+1&65535,4;case 55:return p(0),C(0),G(1),4;case 56:return 1===Q()?
db(A()):b.programCounter=b.programCounter+1&65535,8;case 57:return a=g(b.registerH,b.registerL),Sa(a,b.stackPointer,!1),a=a+b.stackPointer&65535,b.registerH=z(a),b.registerL=a&255,p(0),8;case 58:return a=g(b.registerH,b.registerL),b.registerA=E(a),a=a-1&65535,b.registerH=z(a),b.registerL=a&255,4;case 59:return b.stackPointer=b.stackPointer-1&65535,8;case 60:return a=b.registerA,M(a,1),a=a+1&255,b.registerA=a,u(0===a),p(0),4;case 61:return a=b.registerA,M(a,-1),a=a-1&255,b.registerA=a,u(0===a),p(1),
4;case 62:return b.registerA=A(),b.programCounter=b.programCounter+1&65535,4;case 63:return p(0),C(0),G(0>=Q()),4}return-1}function jc(a){switch(a){case 64:return 4;case 65:return b.registerB=b.registerC,4;case 66:return b.registerB=b.registerD,4;case 67:return b.registerB=b.registerE,4;case 68:return b.registerB=b.registerH,4;case 69:return b.registerB=b.registerL,4;case 70:return b.registerB=E(g(b.registerH,b.registerL)),4;case 71:return b.registerB=b.registerA,4;case 72:return b.registerC=b.registerB,
4;case 73:return 4;case 74:return b.registerC=b.registerD,4;case 75:return b.registerC=b.registerE,4;case 76:return b.registerC=b.registerH,4;case 77:return b.registerC=b.registerL,4;case 78:return b.registerC=E(g(b.registerH,b.registerL)),4;case 79:return b.registerC=b.registerA,4}return-1}function kc(a){switch(a){case 80:return b.registerD=b.registerB,4;case 81:return b.registerD=b.registerC,4;case 82:return 4;case 83:return b.registerD=b.registerE,4;case 84:return b.registerD=b.registerH,4;case 85:return b.registerD=
b.registerL,4;case 86:return b.registerD=E(g(b.registerH,b.registerL)),4;case 87:return b.registerD=b.registerA,4;case 88:return b.registerE=b.registerB,4;case 89:return b.registerE=b.registerC,4;case 90:return b.registerE=b.registerD,4;case 91:return 4;case 92:return b.registerE=b.registerH,4;case 93:return b.registerE=b.registerL,4;case 94:return b.registerE=E(g(b.registerH,b.registerL)),4;case 95:return b.registerE=b.registerA,4}return-1}function lc(a){switch(a){case 96:return b.registerH=b.registerB,
4;case 97:return b.registerH=b.registerC,4;case 98:return b.registerH=b.registerD,4;case 99:return b.registerH=b.registerE,4;case 100:return b.registerH=b.registerH,4;case 101:return b.registerH=b.registerL,4;case 102:return b.registerH=E(g(b.registerH,b.registerL)),4;case 103:return b.registerH=b.registerA,4;case 104:return b.registerL=b.registerB,4;case 105:return b.registerL=b.registerC,4;case 106:return b.registerL=b.registerD,4;case 107:return b.registerL=b.registerE,4;case 108:return b.registerL=
b.registerH,4;case 109:return b.registerL=b.registerL,4;case 110:return b.registerL=E(g(b.registerH,b.registerL)),4;case 111:return b.registerL=b.registerA,4}return-1}function mc(a){switch(a){case 112:return P(g(b.registerH,b.registerL),b.registerB),4;case 113:return P(g(b.registerH,b.registerL),b.registerC),4;case 114:return P(g(b.registerH,b.registerL),b.registerD),4;case 115:return P(g(b.registerH,b.registerL),b.registerE),4;case 116:return P(g(b.registerH,b.registerL),b.registerH),4;case 117:return P(g(b.registerH,
b.registerL),b.registerL),4;case 118:return m.isHblankHdmaActive||b.enableHalt(),4;case 119:return P(g(b.registerH,b.registerL),b.registerA),4;case 120:return b.registerA=b.registerB,4;case 121:return b.registerA=b.registerC,4;case 122:return b.registerA=b.registerD,4;case 123:return b.registerA=b.registerE,4;case 124:return b.registerA=b.registerH,4;case 125:return b.registerA=b.registerL,4;case 126:return b.registerA=E(g(b.registerH,b.registerL)),4;case 127:return 4}return-1}function nc(a){switch(a){case 128:return Ea(b.registerB),
4;case 129:return Ea(b.registerC),4;case 130:return Ea(b.registerD),4;case 131:return Ea(b.registerE),4;case 132:return Ea(b.registerH),4;case 133:return Ea(b.registerL),4;case 134:return a=E(g(b.registerH,b.registerL)),Ea(a),4;case 135:return Ea(b.registerA),4;case 136:return Fa(b.registerB),4;case 137:return Fa(b.registerC),4;case 138:return Fa(b.registerD),4;case 139:return Fa(b.registerE),4;case 140:return Fa(b.registerH),4;case 141:return Fa(b.registerL),4;case 142:return a=E(g(b.registerH,b.registerL)),
Fa(a),4;case 143:return Fa(b.registerA),4}return-1}function oc(a){switch(a){case 144:return Ga(b.registerB),4;case 145:return Ga(b.registerC),4;case 146:return Ga(b.registerD),4;case 147:return Ga(b.registerE),4;case 148:return Ga(b.registerH),4;case 149:return Ga(b.registerL),4;case 150:return a=E(g(b.registerH,b.registerL)),Ga(a),4;case 151:return Ga(b.registerA),4;case 152:return Ha(b.registerB),4;case 153:return Ha(b.registerC),4;case 154:return Ha(b.registerD),4;case 155:return Ha(b.registerE),
4;case 156:return Ha(b.registerH),4;case 157:return Ha(b.registerL),4;case 158:return a=E(g(b.registerH,b.registerL)),Ha(a),4;case 159:return Ha(b.registerA),4}return-1}function pc(a){switch(a){case 160:return Ia(b.registerB),4;case 161:return Ia(b.registerC),4;case 162:return Ia(b.registerD),4;case 163:return Ia(b.registerE),4;case 164:return Ia(b.registerH),4;case 165:return Ia(b.registerL),4;case 166:return a=E(g(b.registerH,b.registerL)),Ia(a),4;case 167:return Ia(b.registerA),4;case 168:return Ja(b.registerB),
4;case 169:return Ja(b.registerC),4;case 170:return Ja(b.registerD),4;case 171:return Ja(b.registerE),4;case 172:return Ja(b.registerH),4;case 173:return Ja(b.registerL),4;case 174:return a=E(g(b.registerH,b.registerL)),Ja(a),4;case 175:return Ja(b.registerA),4}return-1}function qc(a){switch(a){case 176:return Ka(b.registerB),4;case 177:return Ka(b.registerC),4;case 178:return Ka(b.registerD),4;case 179:return Ka(b.registerE),4;case 180:return Ka(b.registerH),4;case 181:return Ka(b.registerL),4;case 182:return a=
E(g(b.registerH,b.registerL)),Ka(a),4;case 183:return Ka(b.registerA),4;case 184:return La(b.registerB),4;case 185:return La(b.registerC),4;case 186:return La(b.registerD),4;case 187:return La(b.registerE),4;case 188:return La(b.registerH),4;case 189:return La(b.registerL),4;case 190:return a=E(g(b.registerH,b.registerL)),La(a),4;case 191:return La(b.registerA),4}return-1}function rc(a){switch(a){case 192:return 0===Na()?(a=b.stackPointer,b.programCounter=Ca(a),b.stackPointer=a+2&65535,12):8;case 193:return a=
Ca(b.stackPointer),b.stackPointer=b.stackPointer+2&65535,b.registerB=z(a),b.registerC=a&255,4;case 194:if(0===Na())return b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 195:return b.programCounter=U(),8;case 196:if(0===Na())return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2&65535),b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 197:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,g(b.registerB,b.registerC)),
8;case 198:return Ea(A()),b.programCounter=b.programCounter+1&65535,4;case 199:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=0,8;case 200:return 1===Na()?(a=b.stackPointer,b.programCounter=Ca(a),b.stackPointer=a+2&65535,12):8;case 201:return a=b.stackPointer,b.programCounter=Ca(a),b.stackPointer=a+2&65535,8;case 202:if(1===Na())return b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 203:var d=A();a=-1;var c=!1,e=0,f=0,n=d&7;
switch(n){case 0:e=b.registerB;break;case 1:e=b.registerC;break;case 2:e=b.registerD;break;case 3:e=b.registerE;break;case 4:e=b.registerH;break;case 5:e=b.registerL;break;case 6:e=E(g(b.registerH,b.registerL));break;case 7:e=b.registerA}var h=(d&240)>>4;switch(h){case 0:7>=d?(d=e,G(128===(d&128)),d=(d<<1|d>>7)&255,u(0===d),p(0),C(0),f=d,c=!0):15>=d&&(d=e,G(0<(d&1)),d=(d>>1|d<<7)&255,u(0===d),p(0),C(0),f=d,c=!0);break;case 1:23>=d?(d=e,c=128===(d&128),d=(d<<1|Q())&255,G(c),u(0===d),p(0),C(0),f=d,
c=!0):31>=d&&(d=e,c=1===(d&1),d=(d>>1|Q()<<7)&255,G(c),u(0===d),p(0),C(0),f=d,c=!0);break;case 2:39>=d?(d=e,c=128===(d&128),d=d<<1&255,G(c),u(0===d),p(0),C(0),f=d,c=!0):47>=d&&(d=e,c=128===(d&128),e=1===(d&1),d=d>>1&255,c&&(d|=128),u(0===d),p(0),C(0),G(e),f=d,c=!0);break;case 3:55>=d?(d=e,d=((d&15)<<4|(d&240)>>4)&255,u(0===d),p(0),C(0),G(0),f=d,c=!0):63>=d&&(d=e,c=1===(d&1),d=d>>1&255,u(0===d),p(0),C(0),G(c),f=d,c=!0);break;case 4:71>=d?(f=Pa(0,e),c=!0):79>=d&&(f=Pa(1,e),c=!0);break;case 5:87>=d?
(f=Pa(2,e),c=!0):95>=d&&(f=Pa(3,e),c=!0);break;case 6:103>=d?(f=Pa(4,e),c=!0):111>=d&&(f=Pa(5,e),c=!0);break;case 7:119>=d?(f=Pa(6,e),c=!0):127>=d&&(f=Pa(7,e),c=!0);break;case 8:135>=d?(f=X(0,0,e),c=!0):143>=d&&(f=X(1,0,e),c=!0);break;case 9:151>=d?(f=X(2,0,e),c=!0):159>=d&&(f=X(3,0,e),c=!0);break;case 10:167>=d?(f=X(4,0,e),c=!0):175>=d&&(f=X(5,0,e),c=!0);break;case 11:183>=d?(f=X(6,0,e),c=!0):191>=d&&(f=X(7,0,e),c=!0);break;case 12:199>=d?(f=X(0,1,e),c=!0):207>=d&&(f=X(1,1,e),c=!0);break;case 13:215>=
d?(f=X(2,1,e),c=!0):223>=d&&(f=X(3,1,e),c=!0);break;case 14:231>=d?(f=X(4,1,e),c=!0):239>=d&&(f=X(5,1,e),c=!0);break;case 15:247>=d?(f=X(6,1,e),c=!0):255>=d&&(f=X(7,1,e),c=!0)}switch(n){case 0:b.registerB=f;break;case 1:b.registerC=f;break;case 2:b.registerD=f;break;case 3:b.registerE=f;break;case 4:b.registerH=f;break;case 5:b.registerL=f;break;case 6:(4>h||7<h)&&P(g(b.registerH,b.registerL),f);break;case 7:b.registerA=f}c&&(a=4);b.programCounter=b.programCounter+1&65535;return a;case 204:if(1===
Na())return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2),b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 205:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2&65535),b.programCounter=U(),8;case 206:return Fa(A()),b.programCounter=b.programCounter+1&65535,4;case 207:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=8}return-1}function sc(a){switch(a){case 208:return 0===Q()?(a=b.stackPointer,
b.programCounter=Ca(a),b.stackPointer=a+2&65535,12):8;case 209:a=b.stackPointer;var d=Ca(a);b.stackPointer=a+2&65535;b.registerD=z(d);b.registerE=d&255;return 4;case 210:if(0===Q())return b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 212:if(0===Q())return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2),b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 213:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,g(b.registerD,
b.registerE)),8;case 214:return Ga(A()),b.programCounter=b.programCounter+1&65535,4;case 215:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=16,8;case 216:return 1===Q()?(a=b.stackPointer,b.programCounter=Ca(a),b.stackPointer=a+2&65535,12):8;case 217:return a=b.stackPointer,b.programCounter=Ca(a),mb(!0),b.stackPointer=a+2&65535,8;case 218:if(1===Q())return b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 220:if(1===Q())return a=
b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2&65535),b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 222:return Ha(A()),b.programCounter=b.programCounter+1&65535,4;case 223:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=24,8}return-1}function tc(a){switch(a){case 224:return a=A(),P(65280+a,b.registerA),b.programCounter=b.programCounter+1&65535,4;case 225:a=b.stackPointer;var d=Ca(a);b.stackPointer=a+2&65535;
b.registerH=z(d);b.registerL=d&255;return 4;case 226:return P(65280+b.registerC,b.registerA),4;case 229:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,g(b.registerH,b.registerL)),8;case 230:return Ia(A()),b.programCounter=b.programCounter+1&65535,4;case 231:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=32,8;case 232:return a=A()<<24>>24,Sa(b.stackPointer,a,!0),b.stackPointer=b.stackPointer+a&65535,u(0),p(0),b.programCounter=b.programCounter+1&65535,
12;case 233:return b.programCounter=g(b.registerH,b.registerL),4;case 234:return P(U(),b.registerA),b.programCounter=b.programCounter+2&65535,4;case 238:return Ja(A()),b.programCounter=b.programCounter+1&65535,4;case 239:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=40,8}return-1}function uc(a){switch(a){case 240:return a=A(),b.registerA=E(65280+a)&255,b.programCounter=b.programCounter+1&65535,4;case 241:a=b.stackPointer;var d=Ca(a);b.stackPointer=a+2&65535;
b.registerA=z(d);b.registerF=d&255;return 4;case 242:return b.registerA=E(65280+b.registerC)&255,4;case 243:return mb(!1),4;case 245:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,g(b.registerA,b.registerF)),8;case 246:return Ka(A()),b.programCounter=b.programCounter+1&65535,4;case 247:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=48,8;case 248:return d=A()<<24>>24,a=b.stackPointer,u(0),p(0),Sa(a,d,!0),a=a+d&65535,b.registerH=z(a),b.registerL=a&255,
b.programCounter=b.programCounter+1&65535,8;case 249:return b.stackPointer=g(b.registerH,b.registerL),8;case 250:return b.registerA=E(U()),b.programCounter=b.programCounter+2&65535,4;case 251:return mb(!0),4;case 254:return La(A()),b.programCounter=b.programCounter+1&65535,4;case 255:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=56,8}return-1}function Ma(a){0<m.DMACycles&&(a+=m.DMACycles,m.DMACycles=0);b.currentCycles+=a;if(!b.isStopped){if(L.graphicsBatchProcessing){q.currentCycles+=
a;for(var d=q.batchProcessCycles();q.currentCycles>=d;)$b(d),q.currentCycles-=d}else $b(a);L.audioBatchProcessing?(h.currentCycles+=a,bb()):Qb(a);d=a;if(V.transferStartFlag)for(var c=0;c<d;){var f=V.currentCycles,g=f;c+=4;g+=4;65535<g&&(g-=65536);V.currentCycles=g;var p=V.isClockSpeedFast?2:7;n(p,f)&&!n(p,g)&&(f=V.memoryLocationSerialTransferData,g=w(f),g=(g<<1)+1,g&=255,e(f,g),f=V.numberOfBitsTransferred,8===++f?(V.numberOfBitsTransferred=0,l.isSerialInterruptRequested=!0,Ya(l.bitPositionSerialInterrupt),
f=V.memoryLocationSerialTransferControl,g=w(f),e(f,D(7,g)),V.transferStartFlag=!1):V.numberOfBitsTransferred=f)}}L.timersBatchProcessing?(k.currentCycles+=a,yb(k.currentCycles),k.currentCycles=0):yb(a);d=Z.cycles;d+=a;d>=Z.cyclesPerCycleSet&&(Z.cycleSets+=1,d-=Z.cyclesPerCycleSet);Z.cycles=d}function bc(){return Hb(!0,-1)}function Hb(a,d){void 0===d&&(d=-1);a=1024;0<d?a=d:0>d&&(a=-1);for(var c=!1,e=!1,f=!1;!(c||e||f||W.reachedBreakpoint);)d=cc(),0>d?c=!0:b.currentCycles>=b.MAX_CYCLES_PER_FRAME()?
e=!0:-1<a&&Rb()>=a&&(f=!0);if(e)return b.currentCycles-=b.MAX_CYCLES_PER_FRAME(),S.RESPONSE_CONDITION_FRAME;if(f)return S.RESPONSE_CONDITION_AUDIO;if(W.reachedBreakpoint)return W.reachedBreakpoint=!1,S.RESPONSE_CONDITION_BREAKPOINT;b.programCounter=b.programCounter-1&65535;return-1}function cc(){eb=!0;if(b.isHaltBug){var a=w(b.programCounter);a=ac(a);Ma(a);b.exitHaltAndStop()}l.masterInterruptSwitchDelay&&(l.masterInterruptSwitch=!0,l.masterInterruptSwitchDelay=!1);if(0<(l.interruptsEnabledValue&
l.interruptsRequestedValue&31)){a=!1;l.masterInterruptSwitch&&!b.isHaltNoJump&&(l.isVBlankInterruptEnabled&&l.isVBlankInterruptRequested?(cb(l.bitPositionVBlankInterrupt),a=!0):l.isLcdInterruptEnabled&&l.isLcdInterruptRequested?(cb(l.bitPositionLcdInterrupt),a=!0):l.isTimerInterruptEnabled&&l.isTimerInterruptRequested?(cb(l.bitPositionTimerInterrupt),a=!0):l.isSerialInterruptEnabled&&l.isSerialInterruptRequested?(cb(l.bitPositionSerialInterrupt),a=!0):l.isJoypadInterruptEnabled&&l.isJoypadInterruptRequested&&
(cb(l.bitPositionJoypadInterrupt),a=!0));var d=0;a&&(d=20,b.isHalted()&&(b.exitHaltAndStop(),d+=4));b.isHalted()&&b.exitHaltAndStop();a=d}else a=0;0<a&&Ma(a);a=4;b.isHalted()||b.isStopped||(a=w(b.programCounter),a=ac(a));b.registerF&=240;if(0>=a)return a;Ma(a);d=S.steps;d+=1;d>=S.stepsPerStepSet&&(S.stepSets+=1,d-=S.stepsPerStepSet);S.steps=d;b.programCounter===W.programCounter&&(W.reachedBreakpoint=!0);return a}const f=new Uint8ClampedArray(9109504),fb={size:()=>9109504,grow:()=>{},wasmByteMemory:f};
var vc=65536,Ua=67584,Va=Ua+128,Za=Va+23552,pb=Za+93184,Ib=pb+196608,qb=Ib+147456,wc=Ua,xc=qb-Ua+15360,ub=qb+15360,vb=ub+131072,wb=vb+131072,xb=wb+131072,lb=xb+131072,Eb=lb+131072,nb=Eb+131072,ob=nb+2560,Jb=ob+8258560,dc=Jb+65535+1,Kb=Math.ceil(dc/1024/64)+1,L=function(){function a(){}a.enableBootRom=!1;a.useGbcWhenAvailable=!0;a.audioBatchProcessing=!1;a.graphicsBatchProcessing=!1;a.timersBatchProcessing=!1;a.graphicsDisableScanlineRendering=!1;a.audioAccumulateSamples=!1;a.tileRendering=!1;a.tileCaching=
!1;a.enableAudioDebugging=!1;return a}(),H=function(){function a(){}a.bgWhite=15921906;a.bgLightGrey=10526880;a.bgDarkGrey=5789784;a.bgBlack=526344;a.obj0White=15921906;a.obj0LightGrey=10526880;a.obj0DarkGrey=5789784;a.obj0Black=526344;a.obj1White=15921906;a.obj1LightGrey=10526880;a.obj1DarkGrey=5789784;a.obj1Black=526344;return a}(),fa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=5439232;a.bgDarkGrey=16728576;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=5439232;a.obj0DarkGrey=16728576;
a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=5439232;a.obj1DarkGrey=16728576;a.obj1Black=0;return a}(),ka=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16776960;a.bgDarkGrey=16711680;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16776960;a.obj0DarkGrey=16711680;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16776960;a.obj1DarkGrey=16711680;a.obj1Black=0;return a}(),ca=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16756067;a.bgDarkGrey=8663296;a.bgBlack=0;a.obj0White=
16777215;a.obj0LightGrey=16756067;a.obj0DarkGrey=8663296;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),ia=function(){function a(){}a.bgWhite=0;a.bgLightGrey=33924;a.bgDarkGrey=16768512;a.bgBlack=16777215;a.obj0White=0;a.obj0LightGrey=33924;a.obj0DarkGrey=16768512;a.obj0Black=16777215;a.obj1White=0;a.obj1LightGrey=33924;a.obj1DarkGrey=16768512;a.obj1Black=16777215;return a}(),oa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=
10855845;a.bgDarkGrey=5395026;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=10855845;a.obj0DarkGrey=5395026;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=10855845;a.obj1DarkGrey=5395026;a.obj1Black=0;return a}(),ja=function(){function a(){}a.bgWhite=16777125;a.bgLightGrey=16749716;a.bgDarkGrey=9737471;a.bgBlack=0;a.obj0White=16777125;a.obj0LightGrey=16749716;a.obj0DarkGrey=9737471;a.obj0Black=0;a.obj1White=16777125;a.obj1LightGrey=16749716;a.obj1DarkGrey=9737471;a.obj1Black=0;return a}(),
ea=function(){function a(){}a.bgWhite=16770757;a.bgLightGrey=13540484;a.bgDarkGrey=8678185;a.bgBlack=5910792;a.obj0White=16777215;a.obj0LightGrey=16756067;a.obj0DarkGrey=8663296;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),ha=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=8126257;a.bgDarkGrey=25541;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=
16745604;a.obj1DarkGrey=9714234;a.obj1Black=0;return a}(),na=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=9211102;a.bgDarkGrey=5395084;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),da=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=8126257;a.obj0DarkGrey=
33792;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),ma=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=255;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),la=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16776960;a.bgDarkGrey=8079872;a.bgBlack=0;a.obj0White=16777215;
a.obj0LightGrey=6530559;a.obj0DarkGrey=255;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),qa=function(){function a(){}a.bgWhite=10853631;a.bgLightGrey=16776960;a.bgDarkGrey=25344;a.bgBlack=0;a.obj0White=10853631;a.obj0LightGrey=16776960;a.obj0DarkGrey=25344;a.obj0Black=0;a.obj1White=10853631;a.obj1LightGrey=16776960;a.obj1DarkGrey=25344;a.obj1Black=0;return a}(),ra=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=
255;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),sa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=8126257;a.obj0DarkGrey=33792;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16745604;a.obj1DarkGrey=9714234;a.obj1Black=0;return a}(),ta=function(){function a(){}a.bgWhite=
11908607;a.bgLightGrey=16777108;a.bgDarkGrey=11360834;a.bgBlack=0;a.obj0White=0;a.obj0LightGrey=16777215;a.obj0DarkGrey=16745604;a.obj0Black=9714234;a.obj1White=0;a.obj1LightGrey=16777215;a.obj1DarkGrey=16745604;a.obj1Black=9714234;return a}(),ua=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=11382148;a.bgDarkGrey=4354939;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16741120;a.obj0DarkGrey=9716224;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=5946879;a.obj1DarkGrey=16711680;a.obj1Black=
255;return a}(),va=function(){function a(){}a.bgWhite=16777116;a.bgLightGrey=9745919;a.bgDarkGrey=6526067;a.bgBlack=14906;a.obj0White=16762178;a.obj0LightGrey=16766464;a.obj0DarkGrey=9714176;a.obj0Black=4849664;a.obj1White=16777215;a.obj1LightGrey=16745604;a.obj1DarkGrey=9714234;a.obj1Black=0;return a}(),wa=function(){function a(){}a.bgWhite=7077632;a.bgLightGrey=16777215;a.bgDarkGrey=16732746;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16777215;a.obj0DarkGrey=6530559;a.obj0Black=255;a.obj1White=
16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),xa=function(){function a(){}a.bgWhite=10853631;a.bgLightGrey=16776960;a.bgDarkGrey=25344;a.bgBlack=0;a.obj0White=16737106;a.obj0LightGrey=14024704;a.obj0DarkGrey=6488064;a.obj0Black=0;a.obj1White=255;a.obj1LightGrey=16777215;a.obj1DarkGrey=16777083;a.obj1Black=34047;return a}(),ya=function(){function a(){}a.bgWhite=16777166;a.bgLightGrey=6549487;a.bgDarkGrey=10257457;a.bgBlack=5921370;a.obj0White=16777215;a.obj0LightGrey=
16741120;a.obj0DarkGrey=9716224;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),za=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=65280;a.obj0DarkGrey=3245056;a.obj0Black=18944;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),Aa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=255;a.bgBlack=
0;a.obj0White=16776960;a.obj0LightGrey=16711680;a.obj0DarkGrey=6488064;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),Ba=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=11382148;a.bgDarkGrey=4354939;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16756067;a.obj0DarkGrey=16756067;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),c=function(){function a(){}a.bgWhite=H.bgWhite;
a.bgLightGrey=H.bgLightGrey;a.bgDarkGrey=H.bgDarkGrey;a.bgBlack=H.bgBlack;a.obj0White=H.obj0White;a.obj0LightGrey=H.obj0LightGrey;a.obj0DarkGrey=H.obj0DarkGrey;a.obj0Black=H.obj0Black;a.obj1White=H.obj1White;a.obj1LightGrey=H.obj1LightGrey;a.obj1DarkGrey=H.obj1DarkGrey;a.obj1Black=H.obj1Black;return a}(),Ta=function(){function a(){}a.memoryLocationBackgroundPaletteIndex=65384;a.memoryLocationBackgroundPaletteData=65385;a.memoryLocationSpritePaletteIndex=65386;a.memoryLocationSpritePaletteData=65387;
a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;return a}(),$a=function(){function a(){}a.tileId=-1;a.horizontalFlip=!1;a.nextXIndexToPerformCacheCheck=-1;return a}(),r=function(){function a(){}a.updateNRx0=function(b){a.NRx0SweepPeriod=(b&112)>>4;a.NRx0Negate=n(3,b);a.NRx0SweepShift=b&7};a.updateNRx1=function(b){a.NRx1Duty=b>>6&3;a.NRx1LengthLoad=b&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(b){a.NRx2StartingVolume=
b>>4&15;a.NRx2EnvelopeAddMode=n(3,b);a.NRx2EnvelopePeriod=b&7;a.isDacEnabled=0<(b&248)};a.updateNRx3=function(b){a.NRx3FrequencyLSB=b;a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){a.NRx4LengthEnabled=n(6,b);b&=7;a.NRx4FrequencyMSB=b;a.frequency=b<<8|a.NRx3FrequencyLSB};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;f[1025+50*a.saveStateSlot]=a.frequencyTimer;f[1029+50*a.saveStateSlot]=a.envelopeCounter;f[1033+50*a.saveStateSlot]=a.lengthCounter;f[1038+50*a.saveStateSlot]=
a.volume;f[1043+50*a.saveStateSlot]=a.dutyCycle;f[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty;f[1049+50*a.saveStateSlot]=a.isSweepEnabled;f[1050+50*a.saveStateSlot]=a.sweepCounter;f[1055+50*a.saveStateSlot]=a.sweepShadowFrequency};a.loadState=function(){a.isEnabled=K(1024+50*a.saveStateSlot);a.frequencyTimer=f[1025+50*a.saveStateSlot];a.envelopeCounter=f[1029+50*a.saveStateSlot];a.lengthCounter=f[1033+50*a.saveStateSlot];a.volume=f[1038+50*a.saveStateSlot];a.dutyCycle=f[1043+50*a.saveStateSlot];
a.waveFormPositionOnDuty=f[1044+50*a.saveStateSlot];a.isSweepEnabled=K(1049+50*a.saveStateSlot);a.sweepCounter=f[1050+50*a.saveStateSlot];a.sweepShadowFrequency=f[1055+50*a.saveStateSlot]};a.initialize=function(){e(a.memoryLocationNRx0,128);e(a.memoryLocationNRx1,191);e(a.memoryLocationNRx2,243);e(a.memoryLocationNRx3,193);e(a.memoryLocationNRx4,191);b.BootROMEnabled&&(e(a.memoryLocationNRx1,63),e(a.memoryLocationNRx2,0),e(a.memoryLocationNRx3,0),e(a.memoryLocationNRx4,184))};a.getSampleFromCycleCounter=
function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){var d=2048-a.frequency<<2;b.GBCDoubleSpeed&&(d<<=2);a.frequencyTimer=d};a.getSample=function(b){b=a.frequencyTimer-b;if(0>=b){var d=Math.abs(b);a.frequencyTimer=b;a.resetTimer();a.frequencyTimer-=d;a.waveFormPositionOnDuty=a.waveFormPositionOnDuty+1&7}else a.frequencyTimer=b;if(a.isEnabled&&a.isDacEnabled)b=a.volume;else return 15;d=1;Nb(a.NRx1Duty,a.waveFormPositionOnDuty)||(d=-d);return d*b+15};a.trigger=
function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.sweepShadowFrequency=a.frequency;a.sweepCounter=a.NRx0SweepPeriod;a.isSweepEnabled=0<a.NRx0SweepPeriod&&0<a.NRx0SweepShift;0<a.NRx0SweepShift&&Ob();a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){b=a.cycleCounter+b;a.cycleCounter=b;return!(0<a.frequencyTimer-b)};a.updateSweep=function(){var b=a.sweepCounter-1;0>=b?(a.sweepCounter=
a.NRx0SweepPeriod,a.isSweepEnabled&&0<a.NRx0SweepPeriod&&Ob()):a.sweepCounter=b};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-1;if(0>=b&&(b=a.NRx2EnvelopePeriod,0!==b)){var c=a.volume;a.NRx2EnvelopeAddMode&&15>c?c+=1:!a.NRx2EnvelopeAddMode&&0<c&&--c;a.volume=c}a.envelopeCounter=b};a.setFrequency=function(b){var d=b>>8;b&=255;var c=w(a.memoryLocationNRx4)&248|d;e(a.memoryLocationNRx3,
b);e(a.memoryLocationNRx4,c);a.NRx3FrequencyLSB=b;a.NRx4FrequencyMSB=d;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.memoryLocationNRx0=65296;a.NRx0SweepPeriod=0;a.NRx0Negate=!1;a.NRx0SweepShift=0;a.memoryLocationNRx1=65297;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65298;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65299;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65300;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=
1;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.isSweepEnabled=!1;a.sweepCounter=0;a.sweepShadowFrequency=0;a.saveStateSlot=7;return a}(),I=function(){function a(){}a.updateNRx1=function(b){a.NRx1Duty=b>>6&3;a.NRx1LengthLoad=b&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(b){a.NRx2StartingVolume=b>>4&15;a.NRx2EnvelopeAddMode=n(3,b);a.NRx2EnvelopePeriod=b&7;a.isDacEnabled=
0<(b&248)};a.updateNRx3=function(b){a.NRx3FrequencyLSB=b;a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){a.NRx4LengthEnabled=n(6,b);b&=7;a.NRx4FrequencyMSB=b;a.frequency=b<<8|a.NRx3FrequencyLSB};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;f[1025+50*a.saveStateSlot]=a.frequencyTimer;f[1029+50*a.saveStateSlot]=a.envelopeCounter;f[1033+50*a.saveStateSlot]=a.lengthCounter;f[1038+50*a.saveStateSlot]=a.volume;f[1043+50*a.saveStateSlot]=a.dutyCycle;f[1044+50*a.saveStateSlot]=
a.waveFormPositionOnDuty};a.loadState=function(){a.isEnabled=K(1024+50*a.saveStateSlot);a.frequencyTimer=f[1025+50*a.saveStateSlot];a.envelopeCounter=f[1029+50*a.saveStateSlot];a.lengthCounter=f[1033+50*a.saveStateSlot];a.volume=f[1038+50*a.saveStateSlot];a.dutyCycle=f[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=f[1044+50*a.saveStateSlot]};a.initialize=function(){e(a.memoryLocationNRx1-1,255);e(a.memoryLocationNRx1,63);e(a.memoryLocationNRx2,0);e(a.memoryLocationNRx3,0);e(a.memoryLocationNRx4,
184)};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){a.frequencyTimer=2048-a.frequency<<2<<b.GBCDoubleSpeed};a.getSample=function(b){b=a.frequencyTimer-b;a.frequencyTimer=b;0>=b&&(b=Math.abs(b),a.resetTimer(),a.frequencyTimer-=b,a.waveFormPositionOnDuty=a.waveFormPositionOnDuty+1&7);if(a.isEnabled&&a.isDacEnabled)b=a.volume;else return 15;var d=1;Nb(a.NRx1Duty,a.waveFormPositionOnDuty)||(d=-d);return d*b+15};a.trigger=function(){a.isEnabled=
!0;0===a.lengthCounter&&(a.lengthCounter=64);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){b=a.cycleCounter+b;a.cycleCounter=b;return!(0<a.frequencyTimer-b)};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-1;if(0>=b&&(b=a.NRx2EnvelopePeriod,0!==b)){var c=a.volume;a.NRx2EnvelopeAddMode&&
15>c?c+=1:!a.NRx2EnvelopeAddMode&&0<c&&--c;a.volume=c}a.envelopeCounter=b};a.setFrequency=function(b){var d=b>>8;b&=255;var c=w(a.memoryLocationNRx4)&248|d;e(a.memoryLocationNRx3,b);e(a.memoryLocationNRx4,c);a.NRx3FrequencyLSB=b;a.NRx4FrequencyMSB=d;a.frequency=d<<8|b};a.cycleCounter=0;a.memoryLocationNRx1=65302;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65303;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65304;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=
65305;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=2;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.saveStateSlot=8;return a}(),F=function(){function a(){}a.updateNRx0=function(b){a.isDacEnabled=n(7,b)};a.updateNRx1=function(b){a.NRx1LengthLoad=b;a.lengthCounter=256-a.NRx1LengthLoad};a.updateNRx2=function(b){a.NRx2VolumeCode=b>>5&15};a.updateNRx3=function(b){a.NRx3FrequencyLSB=
b;a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){a.NRx4LengthEnabled=n(6,b);b&=7;a.NRx4FrequencyMSB=b;a.frequency=b<<8|a.NRx3FrequencyLSB};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;f[1025+50*a.saveStateSlot]=a.frequencyTimer;f[1029+50*a.saveStateSlot]=a.lengthCounter;f[1033+50*a.saveStateSlot]=a.waveTablePosition};a.loadState=function(){a.isEnabled=K(1024+50*a.saveStateSlot);a.frequencyTimer=f[1025+50*a.saveStateSlot];a.lengthCounter=f[1029+50*a.saveStateSlot];a.waveTablePosition=
f[1033+50*a.saveStateSlot]};a.initialize=function(){e(a.memoryLocationNRx0,127);e(a.memoryLocationNRx1,255);e(a.memoryLocationNRx2,159);e(a.memoryLocationNRx3,0);e(a.memoryLocationNRx4,184);a.volumeCodeChanged=!0};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){a.frequencyTimer=2048-a.frequency<<1<<b.GBCDoubleSpeed};a.getSample=function(b){var d=a.frequencyTimer;d-=b;0>=d?(b=Math.abs(d),a.frequencyTimer=d,a.resetTimer(),a.frequencyTimer-=
b,a.waveTablePosition=a.waveTablePosition+1&31):a.frequencyTimer=d;d=a.volumeCode;if(a.isEnabled&&a.isDacEnabled)a.volumeCodeChanged&&(d=w(a.memoryLocationNRx2),d=d>>5&15,a.volumeCode=d,a.volumeCodeChanged=!1);else return 15;var c=a.waveTablePosition;b=w(a.memoryLocationWaveTable+(c>>1|0));b=b>>((0===(c&1))<<2)&15;c=0;switch(d){case 0:b>>=4;break;case 1:c=1;break;case 2:b>>=1;c=2;break;default:b>>=2,c=4}return b=(0<c?b/c:0)+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=
256);a.resetTimer();a.waveTablePosition=0;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){a.cycleCounter+=b;return!(!a.volumeCodeChanged&&0<a.frequencyTimer-a.cycleCounter)};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.cycleCounter=0;a.memoryLocationNRx0=65306;a.memoryLocationNRx1=65307;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65308;a.NRx2VolumeCode=0;a.memoryLocationNRx3=65309;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=
65310;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.memoryLocationWaveTable=65328;a.channelNumber=3;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.lengthCounter=0;a.waveTablePosition=0;a.volumeCode=0;a.volumeCodeChanged=!1;a.saveStateSlot=9;return a}(),J=function(){function a(){}a.updateNRx1=function(b){a.NRx1LengthLoad=b&63;a.lengthCounter=64-a.NRx1LengthLoad};a.updateNRx2=function(b){a.NRx2StartingVolume=b>>4&15;a.NRx2EnvelopeAddMode=n(3,b);a.NRx2EnvelopePeriod=b&7;a.isDacEnabled=
0<(b&248)};a.updateNRx3=function(b){var d=b&7;a.NRx3ClockShift=b>>4;a.NRx3WidthMode=n(3,b);a.NRx3DivisorCode=d;d<<=1;1>d&&(d=1);a.divisor=d<<3};a.updateNRx4=function(b){a.NRx4LengthEnabled=n(6,b)};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;f[1025+50*a.saveStateSlot]=a.frequencyTimer;f[1029+50*a.saveStateSlot]=a.envelopeCounter;f[1033+50*a.saveStateSlot]=a.lengthCounter;f[1038+50*a.saveStateSlot]=a.volume;f[1043+50*a.saveStateSlot]=a.linearFeedbackShiftRegister};a.loadState=function(){a.isEnabled=
K(1024+50*a.saveStateSlot);a.frequencyTimer=f[1025+50*a.saveStateSlot];a.envelopeCounter=f[1029+50*a.saveStateSlot];a.lengthCounter=f[1033+50*a.saveStateSlot];a.volume=f[1038+50*a.saveStateSlot];a.linearFeedbackShiftRegister=f[1043+50*a.saveStateSlot]};a.initialize=function(){e(a.memoryLocationNRx1-1,255);e(a.memoryLocationNRx1,255);e(a.memoryLocationNRx2,0);e(a.memoryLocationNRx3,0);e(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};
a.getSample=function(b){var d=a.frequencyTimer;d-=b;if(0>=d){b=Math.abs(d);d=a.getNoiseChannelFrequencyPeriod();d-=b;b=a.linearFeedbackShiftRegister;var c=b&1^b>>1&1;b=b>>1|c<<14;a.NRx3WidthMode&&(b=b&-65|c<<6);a.linearFeedbackShiftRegister=b}a.frequencyTimer=d;if(a.isEnabled&&a.isDacEnabled)d=a.volume;else return 15;b=n(0,a.linearFeedbackShiftRegister)?-1:1;return b*d+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=64);a.frequencyTimer=a.getNoiseChannelFrequencyPeriod();
a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.linearFeedbackShiftRegister=32767;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){a.cycleCounter+=b;return!(0<a.frequencyTimer-a.cycleCounter)};a.getNoiseChannelFrequencyPeriod=function(){return a.divisor<<a.NRx3ClockShift<<b.GBCDoubleSpeed};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-
1;if(0>=b&&(b=a.NRx2EnvelopePeriod,0!==b)){var c=a.volume;a.NRx2EnvelopeAddMode&&15>c?c+=1:!a.NRx2EnvelopeAddMode&&0<c&&--c;a.volume=c}a.envelopeCounter=b};a.cycleCounter=0;a.memoryLocationNRx1=65312;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65313;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65314;a.NRx3ClockShift=0;a.NRx3WidthMode=!1;a.NRx3DivisorCode=0;a.memoryLocationNRx4=65315;a.NRx4LengthEnabled=!1;a.channelNumber=4;a.isEnabled=!1;a.isDacEnabled=!1;
a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.divisor=0;a.linearFeedbackShiftRegister=0;a.saveStateSlot=10;return a}(),t=function(){function a(){}a.channel1Sample=15;a.channel2Sample=15;a.channel3Sample=15;a.channel4Sample=15;a.channel1DacEnabled=!1;a.channel2DacEnabled=!1;a.channel3DacEnabled=!1;a.channel4DacEnabled=!1;a.leftChannelSampleUnsignedByte=127;a.rightChannelSampleUnsignedByte=127;a.mixerVolumeChanged=!1;a.mixerEnabledChanged=!1;a.needToRemixSamples=!1;return a}(),
h=function(){function a(){}a.batchProcessCycles=function(){return 87<<b.GBCDoubleSpeed};a.updateNR50=function(b){a.NR50LeftMixerVolume=b>>4&7;a.NR50RightMixerVolume=b&7};a.updateNR51=function(b){a.NR51IsChannel4EnabledOnLeftOutput=n(7,b);a.NR51IsChannel3EnabledOnLeftOutput=n(6,b);a.NR51IsChannel2EnabledOnLeftOutput=n(5,b);a.NR51IsChannel1EnabledOnLeftOutput=n(4,b);a.NR51IsChannel4EnabledOnRightOutput=n(3,b);a.NR51IsChannel3EnabledOnRightOutput=n(2,b);a.NR51IsChannel2EnabledOnRightOutput=n(1,b);a.NR51IsChannel1EnabledOnRightOutput=
n(0,b)};a.updateNR52=function(b){a.NR52IsSoundEnabled=n(7,b)};a.maxFrameSequenceCycles=function(){return 8192<<b.GBCDoubleSpeed};a.maxDownSampleCycles=function(){return b.CLOCK_SPEED()};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.frameSequenceCycleCounter;f[1028+50*a.saveStateSlot]=a.downSampleCycleCounter;f[1029+50*a.saveStateSlot]=a.frameSequencer};a.loadState=function(){a.frameSequenceCycleCounter=f[1024+50*a.saveStateSlot];a.downSampleCycleCounter=f[1028+50*a.saveStateSlot];a.frameSequencer=
f[1029+50*a.saveStateSlot];Sb()};a.currentCycles=0;a.memoryLocationNR50=65316;a.NR50LeftMixerVolume=0;a.NR50RightMixerVolume=0;a.memoryLocationNR51=65317;a.NR51IsChannel1EnabledOnLeftOutput=!0;a.NR51IsChannel2EnabledOnLeftOutput=!0;a.NR51IsChannel3EnabledOnLeftOutput=!0;a.NR51IsChannel4EnabledOnLeftOutput=!0;a.NR51IsChannel1EnabledOnRightOutput=!0;a.NR51IsChannel2EnabledOnRightOutput=!0;a.NR51IsChannel3EnabledOnRightOutput=!0;a.NR51IsChannel4EnabledOnRightOutput=!0;a.memoryLocationNR52=65318;a.NR52IsSoundEnabled=
!0;a.memoryLocationChannel3LoadRegisterStart=65328;a.frameSequenceCycleCounter=0;a.downSampleCycleCounter=0;a.downSampleCycleMultiplier=48E3;a.frameSequencer=0;a.audioQueueIndex=0;a.wasmBoyMemoryMaxBufferSize=131072;a.saveStateSlot=6;return a}(),l=function(){function a(){}a.updateInterruptEnabled=function(b){a.isVBlankInterruptEnabled=n(a.bitPositionVBlankInterrupt,b);a.isLcdInterruptEnabled=n(a.bitPositionLcdInterrupt,b);a.isTimerInterruptEnabled=n(a.bitPositionTimerInterrupt,b);a.isSerialInterruptEnabled=
n(a.bitPositionSerialInterrupt,b);a.isJoypadInterruptEnabled=n(a.bitPositionJoypadInterrupt,b);a.interruptsEnabledValue=b};a.updateInterruptRequested=function(b){a.isVBlankInterruptRequested=n(a.bitPositionVBlankInterrupt,b);a.isLcdInterruptRequested=n(a.bitPositionLcdInterrupt,b);a.isTimerInterruptRequested=n(a.bitPositionTimerInterrupt,b);a.isSerialInterruptRequested=n(a.bitPositionSerialInterrupt,b);a.isJoypadInterruptRequested=n(a.bitPositionJoypadInterrupt,b);a.interruptsRequestedValue=b};a.areInterruptsPending=
function(){return 0<(a.interruptsRequestedValue&a.interruptsEnabledValue&31)};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.masterInterruptSwitch;f[1025+50*a.saveStateSlot]=a.masterInterruptSwitchDelay};a.loadState=function(){a.masterInterruptSwitch=K(1024+50*a.saveStateSlot);a.masterInterruptSwitchDelay=K(1025+50*a.saveStateSlot);a.updateInterruptEnabled(w(a.memoryLocationInterruptEnabled));a.updateInterruptRequested(w(a.memoryLocationInterruptRequest))};a.masterInterruptSwitch=!1;a.masterInterruptSwitchDelay=
!1;a.bitPositionVBlankInterrupt=0;a.bitPositionLcdInterrupt=1;a.bitPositionTimerInterrupt=2;a.bitPositionSerialInterrupt=3;a.bitPositionJoypadInterrupt=4;a.memoryLocationInterruptEnabled=65535;a.interruptsEnabledValue=0;a.isVBlankInterruptEnabled=!1;a.isLcdInterruptEnabled=!1;a.isTimerInterruptEnabled=!1;a.isSerialInterruptEnabled=!1;a.isJoypadInterruptEnabled=!1;a.memoryLocationInterruptRequest=65295;a.interruptsRequestedValue=0;a.isVBlankInterruptRequested=!1;a.isLcdInterruptRequested=!1;a.isTimerInterruptRequested=
!1;a.isSerialInterruptRequested=!1;a.isJoypadInterruptRequested=!1;a.saveStateSlot=2;return a}(),k=function(){function a(){}a.batchProcessCycles=function(){return 256};a.updateDividerRegister=function(){var b=a.dividerRegister;a.dividerRegister=0;e(a.memoryLocationDividerRegister,0);a.timerEnabled&&Ub(b,0)&&zb()};a.updateTimerCounter=function(b){if(a.timerEnabled){if(a.timerCounterWasReset)return;a.timerCounterOverflowDelay&&(a.timerCounterOverflowDelay=!1)}a.timerCounter=b};a.updateTimerModulo=function(b){a.timerModulo=
b;a.timerEnabled&&a.timerCounterWasReset&&(a.timerCounter=b,a.timerCounterWasReset=!1)};a.updateTimerControl=function(b){var d=a.timerEnabled;a.timerEnabled=n(2,b);b&=3;if(!d){d=Ab(a.timerInputClock);var c=Ab(b),e=a.dividerRegister;(a.timerEnabled?n(d,e):n(d,e)&&n(c,e))&&zb()}a.timerInputClock=b};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.currentCycles;f[1028+50*a.saveStateSlot]=a.dividerRegister;f[1032+50*a.saveStateSlot]=a.timerCounterOverflowDelay;f[1035+50*a.saveStateSlot]=a.timerCounterWasReset;
e(a.memoryLocationTimerCounter,a.timerCounter)};a.loadState=function(){a.currentCycles=f[1024+50*a.saveStateSlot];a.dividerRegister=f[1028+50*a.saveStateSlot];a.timerCounterOverflowDelay=K(1032+50*a.saveStateSlot);a.timerCounterWasReset=K(1035+50*a.saveStateSlot);a.timerCounter=w(a.memoryLocationTimerCounter);a.timerModulo=w(a.memoryLocationTimerModulo);a.timerInputClock=w(a.memoryLocationTimerControl)};a.currentCycles=0;a.memoryLocationDividerRegister=65284;a.dividerRegister=0;a.memoryLocationTimerCounter=
65285;a.timerCounter=0;a.timerCounterOverflowDelay=!1;a.timerCounterWasReset=!1;a.timerCounterMask=0;a.memoryLocationTimerModulo=65286;a.timerModulo=0;a.memoryLocationTimerControl=65287;a.timerEnabled=!1;a.timerInputClock=0;a.saveStateSlot=5;return a}(),V=function(){function a(){}a.updateTransferControl=function(b){a.isShiftClockInternal=n(0,b);a.isClockSpeedFast=n(1,b);a.transferStartFlag=n(7,b);return!0};a.currentCycles=0;a.memoryLocationSerialTransferData=65281;a.memoryLocationSerialTransferControl=
65282;a.numberOfBitsTransferred=0;a.isShiftClockInternal=!1;a.isClockSpeedFast=!1;a.transferStartFlag=!1;return a}(),y=function(){function a(){}a.updateJoypad=function(b){a.joypadRegisterFlipped=b^255;a.isDpadType=n(4,a.joypadRegisterFlipped);a.isButtonType=n(5,a.joypadRegisterFlipped)};a.saveState=function(){};a.loadState=function(){a.updateJoypad(w(a.memoryLocationJoypadRegister))};a.up=!1;a.down=!1;a.left=!1;a.right=!1;a.a=!1;a.b=!1;a.select=!1;a.start=!1;a.memoryLocationJoypadRegister=65280;a.joypadRegisterFlipped=
0;a.isDpadType=!1;a.isButtonType=!1;a.saveStateSlot=3;return a}(),W=function(){function a(){}a.programCounter=-1;a.readGbMemory=-1;a.writeGbMemory=-1;a.reachedBreakpoint=!1;return a}(),v=function(){function a(){}a.updateLcdStatus=function(b){var d=w(a.memoryLocationLcdStatus);b=b&248|d&7|128;e(a.memoryLocationLcdStatus,b)};a.updateLcdControl=function(b){var d=a.enabled;a.enabled=n(7,b);a.windowTileMapDisplaySelect=n(6,b);a.windowDisplayEnabled=n(5,b);a.bgWindowTileDataSelect=n(4,b);a.bgTileMapDisplaySelect=
n(3,b);a.tallSpriteSize=n(2,b);a.spriteDisplayEnable=n(1,b);a.bgDisplayEnabled=n(0,b);d&&!a.enabled&&Xb(!0);!d&&a.enabled&&Xb(!1)};a.memoryLocationLcdStatus=65345;a.currentLcdMode=0;a.memoryLocationCoincidenceCompare=65349;a.coincidenceCompare=0;a.memoryLocationLcdControl=65344;a.enabled=!0;a.windowTileMapDisplaySelect=!1;a.windowDisplayEnabled=!1;a.bgWindowTileDataSelect=!1;a.bgTileMapDisplaySelect=!1;a.tallSpriteSize=!1;a.spriteDisplayEnable=!1;a.bgDisplayEnabled=!1;return a}(),q=function(){function a(){}
a.batchProcessCycles=function(){return a.MAX_CYCLES_PER_SCANLINE()};a.MAX_CYCLES_PER_SCANLINE=function(){return 153===a.scanlineRegister?4<<b.GBCDoubleSpeed:456<<b.GBCDoubleSpeed};a.MIN_CYCLES_SPRITES_LCD_MODE=function(){return 376<<b.GBCDoubleSpeed};a.MIN_CYCLES_TRANSFER_DATA_LCD_MODE=function(){return 249<<b.GBCDoubleSpeed};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.scanlineCycleCounter;f[1028+50*a.saveStateSlot]=v.currentLcdMode;e(a.memoryLocationScanlineRegister,a.scanlineRegister)};
a.loadState=function(){a.scanlineCycleCounter=f[1024+50*a.saveStateSlot];v.currentLcdMode=f[1028+50*a.saveStateSlot];a.scanlineRegister=w(a.memoryLocationScanlineRegister);v.updateLcdControl(w(v.memoryLocationLcdControl))};a.currentCycles=0;a.scanlineCycleCounter=0;a.memoryLocationScanlineRegister=65348;a.scanlineRegister=0;a.memoryLocationDmaTransfer=65350;a.memoryLocationScrollX=65347;a.scrollX=0;a.memoryLocationScrollY=65346;a.scrollY=0;a.memoryLocationWindowX=65355;a.windowX=0;a.memoryLocationWindowY=
65354;a.windowY=0;a.memoryLocationTileMapSelectZeroStart=38912;a.memoryLocationTileMapSelectOneStart=39936;a.memoryLocationTileDataSelectZeroStart=34816;a.memoryLocationTileDataSelectOneStart=32768;a.memoryLocationSpriteAttributesTable=65024;a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;a.saveStateSlot=1;return a}(),m=function(){function a(){}a.saveState=function(){f[1024+50*a.saveStateSlot]=a.currentRomBank;f[1026+50*a.saveStateSlot]=
a.currentRamBank;f[1028+50*a.saveStateSlot]=a.isRamBankingEnabled;f[1029+50*a.saveStateSlot]=a.isMBC1RomModeEnabled;f[1030+50*a.saveStateSlot]=a.isRomOnly;f[1031+50*a.saveStateSlot]=a.isMBC1;f[1032+50*a.saveStateSlot]=a.isMBC2;f[1033+50*a.saveStateSlot]=a.isMBC3;f[1034+50*a.saveStateSlot]=a.isMBC5};a.loadState=function(){a.currentRomBank=f[1024+50*a.saveStateSlot];a.currentRamBank=f[1026+50*a.saveStateSlot];a.isRamBankingEnabled=K(1028+50*a.saveStateSlot);a.isMBC1RomModeEnabled=K(1029+50*a.saveStateSlot);
a.isRomOnly=K(1030+50*a.saveStateSlot);a.isMBC1=K(1031+50*a.saveStateSlot);a.isMBC2=K(1032+50*a.saveStateSlot);a.isMBC3=K(1033+50*a.saveStateSlot);a.isMBC5=K(1034+50*a.saveStateSlot)};a.cartridgeRomLocation=0;a.switchableCartridgeRomLocation=16384;a.videoRamLocation=32768;a.cartridgeRamLocation=40960;a.internalRamBankZeroLocation=49152;a.internalRamBankOneLocation=53248;a.echoRamLocation=57344;a.spriteInformationTableLocation=65024;a.spriteInformationTableLocationEnd=65183;a.unusableMemoryLocation=
65184;a.unusableMemoryEndLocation=65279;a.currentRomBank=0;a.currentRamBank=0;a.isRamBankingEnabled=!1;a.isMBC1RomModeEnabled=!0;a.isRomOnly=!0;a.isMBC1=!1;a.isMBC2=!1;a.isMBC3=!1;a.isMBC5=!1;a.memoryLocationHdmaSourceHigh=65361;a.memoryLocationHdmaSourceLow=65362;a.memoryLocationHdmaDestinationHigh=65363;a.memoryLocationHdmaDestinationLow=65364;a.memoryLocationHdmaTrigger=65365;a.DMACycles=0;a.isHblankHdmaActive=!1;a.hblankHdmaTransferLengthRemaining=0;a.hblankHdmaSource=0;a.hblankHdmaDestination=
0;a.memoryLocationGBCVRAMBank=65359;a.memoryLocationGBCWRAMBank=65392;a.saveStateSlot=4;return a}(),b=function(){function a(){}a.CLOCK_SPEED=function(){return 4194304<<a.GBCDoubleSpeed};a.MAX_CYCLES_PER_FRAME=function(){return 70224<<a.GBCDoubleSpeed};a.enableHalt=function(){l.masterInterruptSwitch?a.isHaltNormal=!0:0===(l.interruptsEnabledValue&l.interruptsRequestedValue&31)?a.isHaltNoJump=!0:a.isHaltBug=!0};a.exitHaltAndStop=function(){a.isHaltNoJump=!1;a.isHaltNormal=!1;a.isHaltBug=!1;a.isStopped=
!1};a.isHalted=function(){return a.isHaltNormal||a.isHaltNoJump};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.registerA;f[1025+50*a.saveStateSlot]=a.registerB;f[1026+50*a.saveStateSlot]=a.registerC;f[1027+50*a.saveStateSlot]=a.registerD;f[1028+50*a.saveStateSlot]=a.registerE;f[1029+50*a.saveStateSlot]=a.registerH;f[1030+50*a.saveStateSlot]=a.registerL;f[1031+50*a.saveStateSlot]=a.registerF;f[1032+50*a.saveStateSlot]=a.stackPointer;f[1034+50*a.saveStateSlot]=a.programCounter;f[1036+50*a.saveStateSlot]=
a.currentCycles;f[1041+50*a.saveStateSlot]=a.isHaltNormal;f[1042+50*a.saveStateSlot]=a.isHaltNoJump;f[1043+50*a.saveStateSlot]=a.isHaltBug;f[1044+50*a.saveStateSlot]=a.isStopped;f[1045+50*a.saveStateSlot]=a.BootROMEnabled;f[1046+50*a.saveStateSlot]=a.GBCEnabled;f[1047+50*a.saveStateSlot]=a.GBCDoubleSpeed};a.loadState=function(){a.registerA=f[1024+50*a.saveStateSlot];a.registerB=f[1025+50*a.saveStateSlot];a.registerC=f[1026+50*a.saveStateSlot];a.registerD=f[1027+50*a.saveStateSlot];a.registerE=f[1028+
50*a.saveStateSlot];a.registerH=f[1029+50*a.saveStateSlot];a.registerL=f[1030+50*a.saveStateSlot];a.registerF=f[1031+50*a.saveStateSlot];a.stackPointer=f[1032+50*a.saveStateSlot];a.programCounter=f[1034+50*a.saveStateSlot];a.currentCycles=f[1036+50*a.saveStateSlot];a.isHaltNormal=K(1041+50*a.saveStateSlot);a.isHaltNoJump=K(1042+50*a.saveStateSlot);a.isHaltBug=K(1043+50*a.saveStateSlot);a.isStopped=K(1044+50*a.saveStateSlot);a.BootROMEnabled=K(1045+50*a.saveStateSlot);a.GBCEnabled=K(1046+50*a.saveStateSlot);
a.GBCDoubleSpeed=K(1047+50*a.saveStateSlot)};a.memoryLocationBootROMSwitch=65360;a.BootROMEnabled=!1;a.GBCEnabled=!1;a.memoryLocationSpeedSwitch=65357;a.GBCDoubleSpeed=!1;a.registerA=0;a.registerB=0;a.registerC=0;a.registerD=0;a.registerE=0;a.registerH=0;a.registerL=0;a.registerF=0;a.stackPointer=0;a.programCounter=0;a.currentCycles=0;a.isHaltNormal=!1;a.isHaltNoJump=!1;a.isHaltBug=!1;a.isStopped=!1;a.saveStateSlot=0;return a}(),Z=function(){function a(){}a.cyclesPerCycleSet=2E9;a.cycleSets=0;a.cycles=
0;return a}(),S=function(){function a(){}a.stepsPerStepSet=2E9;a.stepSets=0;a.steps=0;a.RESPONSE_CONDITION_ERROR=-1;a.RESPONSE_CONDITION_FRAME=0;a.RESPONSE_CONDITION_AUDIO=1;a.RESPONSE_CONDITION_BREAKPOINT=2;return a}();fb.size()<Kb&&fb.grow(Kb-fb.size());var eb=!1,yc=Object.freeze({memory:fb,config:function(a,d,f,n,g,p,u,v,O,y){L.enableBootRom=0<a;L.useGbcWhenAvailable=0<d;L.audioBatchProcessing=0<f;L.graphicsBatchProcessing=0<n;L.timersBatchProcessing=0<g;L.graphicsDisableScanlineRendering=0<p;
L.audioAccumulateSamples=0<u;L.tileRendering=0<v;L.tileCaching=0<O;L.enableAudioDebugging=0<y;a=w(323);b.GBCEnabled=192===a||L.useGbcWhenAvailable&&128===a?!0:!1;eb=!1;Z.cyclesPerCycleSet=2E9;Z.cycleSets=0;Z.cycles=0;S.stepsPerStepSet=2E9;S.stepSets=0;S.steps=0;b.BootROMEnabled=L.enableBootRom?!0:!1;b.GBCDoubleSpeed=!1;b.registerA=0;b.registerB=0;b.registerC=0;b.registerD=0;b.registerE=0;b.registerH=0;b.registerL=0;b.registerF=0;b.stackPointer=0;b.programCounter=0;b.currentCycles=0;b.isHaltNormal=
!1;b.isHaltNoJump=!1;b.isHaltBug=!1;b.isStopped=!1;b.BootROMEnabled||(b.GBCEnabled?(b.registerA=17,b.registerF=128,b.registerB=0,b.registerC=0,b.registerD=255,b.registerE=86,b.registerH=0,b.registerL=13):(b.registerA=1,b.registerF=176,b.registerB=0,b.registerC=19,b.registerD=0,b.registerE=216,b.registerH=1,b.registerL=77),b.programCounter=256,b.stackPointer=65534);m.isRamBankingEnabled=!1;m.isMBC1RomModeEnabled=!0;a=w(327);m.isRomOnly=0===a;m.isMBC1=1<=a&&3>=a;m.isMBC2=5<=a&&6>=a;m.isMBC3=15<=a&&
19>=a;m.isMBC5=25<=a&&30>=a;m.currentRomBank=1;m.currentRamBank=0;e(m.memoryLocationGBCVRAMBank,0);e(m.memoryLocationGBCWRAMBank,1);e(65361,255);e(65362,255);e(65363,255);e(65364,255);e(65365,255);q.currentCycles=0;q.scanlineCycleCounter=0;q.scanlineRegister=0;q.scrollX=0;q.scrollY=0;q.windowX=0;q.windowY=0;q.scanlineRegister=144;b.GBCEnabled?(e(65345,129),e(65348,144),e(65351,252)):(e(65345,133),e(65350,255),e(65351,252),e(65352,255),e(65353,255));q.scanlineRegister=144;e(65344,144);e(65359,0);e(65392,
1);b.BootROMEnabled&&(b.GBCEnabled?(q.scanlineRegister=0,e(65344,0),e(65345,128),e(65348,0)):(q.scanlineRegister=0,e(65344,0),e(65345,132)));Lb(0);if(!b.GBCEnabled&&(!b.BootROMEnabled||b.GBCEnabled)){a=0;for(d=308;323>=d;d++)a+=w(d);switch(a&255){case 136:c.bgWhite=qa.bgWhite;c.bgLightGrey=qa.bgLightGrey;c.bgDarkGrey=qa.bgDarkGrey;c.bgBlack=qa.bgBlack;c.obj0White=qa.obj0White;c.obj0LightGrey=qa.obj0LightGrey;c.obj0DarkGrey=qa.obj0DarkGrey;c.obj0Black=qa.obj0Black;c.obj1White=qa.obj1White;c.obj1LightGrey=
qa.obj1LightGrey;c.obj1DarkGrey=qa.obj1DarkGrey;c.obj1Black=qa.obj1Black;break;case 97:c.bgWhite=ra.bgWhite;c.bgLightGrey=ra.bgLightGrey;c.bgDarkGrey=ra.bgDarkGrey;c.bgBlack=ra.bgBlack;c.obj0White=ra.obj0White;c.obj0LightGrey=ra.obj0LightGrey;c.obj0DarkGrey=ra.obj0DarkGrey;c.obj0Black=ra.obj0Black;c.obj1White=ra.obj1White;c.obj1LightGrey=ra.obj1LightGrey;c.obj1DarkGrey=ra.obj1DarkGrey;c.obj1Black=ra.obj1Black;break;case 20:c.bgWhite=sa.bgWhite;c.bgLightGrey=sa.bgLightGrey;c.bgDarkGrey=sa.bgDarkGrey;
c.bgBlack=sa.bgBlack;c.obj0White=sa.obj0White;c.obj0LightGrey=sa.obj0LightGrey;c.obj0DarkGrey=sa.obj0DarkGrey;c.obj0Black=sa.obj0Black;c.obj1White=sa.obj1White;c.obj1LightGrey=sa.obj1LightGrey;c.obj1DarkGrey=sa.obj1DarkGrey;c.obj1Black=sa.obj1Black;break;case 70:c.bgWhite=ta.bgWhite;c.bgLightGrey=ta.bgLightGrey;c.bgDarkGrey=ta.bgDarkGrey;c.bgBlack=ta.bgBlack;c.obj0White=ta.obj0White;c.obj0LightGrey=ta.obj0LightGrey;c.obj0DarkGrey=ta.obj0DarkGrey;c.obj0Black=ta.obj0Black;c.obj1White=ta.obj1White;c.obj1LightGrey=
ta.obj1LightGrey;c.obj1DarkGrey=ta.obj1DarkGrey;c.obj1Black=ta.obj1Black;break;case 89:case 198:c.bgWhite=ua.bgWhite;c.bgLightGrey=ua.bgLightGrey;c.bgDarkGrey=ua.bgDarkGrey;c.bgBlack=ua.bgBlack;c.obj0White=ua.obj0White;c.obj0LightGrey=ua.obj0LightGrey;c.obj0DarkGrey=ua.obj0DarkGrey;c.obj0Black=ua.obj0Black;c.obj1White=ua.obj1White;c.obj1LightGrey=ua.obj1LightGrey;c.obj1DarkGrey=ua.obj1DarkGrey;c.obj1Black=ua.obj1Black;break;case 134:case 168:c.bgWhite=va.bgWhite;c.bgLightGrey=va.bgLightGrey;c.bgDarkGrey=
va.bgDarkGrey;c.bgBlack=va.bgBlack;c.obj0White=va.obj0White;c.obj0LightGrey=va.obj0LightGrey;c.obj0DarkGrey=va.obj0DarkGrey;c.obj0Black=va.obj0Black;c.obj1White=va.obj1White;c.obj1LightGrey=va.obj1LightGrey;c.obj1DarkGrey=va.obj1DarkGrey;c.obj1Black=va.obj1Black;break;case 191:case 206:case 209:case 240:c.bgWhite=wa.bgWhite;c.bgLightGrey=wa.bgLightGrey;c.bgDarkGrey=wa.bgDarkGrey;c.bgBlack=wa.bgBlack;c.obj0White=wa.obj0White;c.obj0LightGrey=wa.obj0LightGrey;c.obj0DarkGrey=wa.obj0DarkGrey;c.obj0Black=
wa.obj0Black;c.obj1White=wa.obj1White;c.obj1LightGrey=wa.obj1LightGrey;c.obj1DarkGrey=wa.obj1DarkGrey;c.obj1Black=wa.obj1Black;break;case 39:case 73:case 92:case 179:c.bgWhite=xa.bgWhite;c.bgLightGrey=xa.bgLightGrey;c.bgDarkGrey=xa.bgDarkGrey;c.bgBlack=xa.bgBlack;c.obj0White=xa.obj0White;c.obj0LightGrey=xa.obj0LightGrey;c.obj0DarkGrey=xa.obj0DarkGrey;c.obj0Black=xa.obj0Black;c.obj1White=xa.obj1White;c.obj1LightGrey=xa.obj1LightGrey;c.obj1DarkGrey=xa.obj1DarkGrey;c.obj1Black=xa.obj1Black;break;case 201:c.bgWhite=
ya.bgWhite;c.bgLightGrey=ya.bgLightGrey;c.bgDarkGrey=ya.bgDarkGrey;c.bgBlack=ya.bgBlack;c.obj0White=ya.obj0White;c.obj0LightGrey=ya.obj0LightGrey;c.obj0DarkGrey=ya.obj0DarkGrey;c.obj0Black=ya.obj0Black;c.obj1White=ya.obj1White;c.obj1LightGrey=ya.obj1LightGrey;c.obj1DarkGrey=ya.obj1DarkGrey;c.obj1Black=ya.obj1Black;break;case 112:c.bgWhite=za.bgWhite;c.bgLightGrey=za.bgLightGrey;c.bgDarkGrey=za.bgDarkGrey;c.bgBlack=za.bgBlack;c.obj0White=za.obj0White;c.obj0LightGrey=za.obj0LightGrey;c.obj0DarkGrey=
za.obj0DarkGrey;c.obj0Black=za.obj0Black;c.obj1White=za.obj1White;c.obj1LightGrey=za.obj1LightGrey;c.obj1DarkGrey=za.obj1DarkGrey;c.obj1Black=za.obj1Black;break;case 70:c.bgWhite=Aa.bgWhite;c.bgLightGrey=Aa.bgLightGrey;c.bgDarkGrey=Aa.bgDarkGrey;c.bgBlack=Aa.bgBlack;c.obj0White=Aa.obj0White;c.obj0LightGrey=Aa.obj0LightGrey;c.obj0DarkGrey=Aa.obj0DarkGrey;c.obj0Black=Aa.obj0Black;c.obj1White=Aa.obj1White;c.obj1LightGrey=Aa.obj1LightGrey;c.obj1DarkGrey=Aa.obj1DarkGrey;c.obj1Black=Aa.obj1Black;break;
case 211:c.bgWhite=Ba.bgWhite,c.bgLightGrey=Ba.bgLightGrey,c.bgDarkGrey=Ba.bgDarkGrey,c.bgBlack=Ba.bgBlack,c.obj0White=Ba.obj0White,c.obj0LightGrey=Ba.obj0LightGrey,c.obj0DarkGrey=Ba.obj0DarkGrey,c.obj0Black=Ba.obj0Black,c.obj1White=Ba.obj1White,c.obj1LightGrey=Ba.obj1LightGrey,c.obj1DarkGrey=Ba.obj1DarkGrey,c.obj1Black=Ba.obj1Black}}b.GBCEnabled?(e(65384,192),e(65385,255),e(65386,193),e(65387,13)):(e(65384,255),e(65385,255),e(65386,255),e(65387,255));b.BootROMEnabled&&b.GBCEnabled&&(e(65385,32),
e(65387,138));h.currentCycles=0;h.NR50LeftMixerVolume=0;h.NR50RightMixerVolume=0;h.NR51IsChannel1EnabledOnLeftOutput=!0;h.NR51IsChannel2EnabledOnLeftOutput=!0;h.NR51IsChannel3EnabledOnLeftOutput=!0;h.NR51IsChannel4EnabledOnLeftOutput=!0;h.NR51IsChannel1EnabledOnRightOutput=!0;h.NR51IsChannel2EnabledOnRightOutput=!0;h.NR51IsChannel3EnabledOnRightOutput=!0;h.NR51IsChannel4EnabledOnRightOutput=!0;h.NR52IsSoundEnabled=!0;h.frameSequenceCycleCounter=0;h.downSampleCycleCounter=0;h.frameSequencer=0;h.audioQueueIndex=
0;r.initialize();I.initialize();F.initialize();J.initialize();e(h.memoryLocationNR50,119);h.updateNR50(119);e(h.memoryLocationNR51,243);h.updateNR51(243);e(h.memoryLocationNR52,241);h.updateNR52(241);b.BootROMEnabled&&(e(h.memoryLocationNR50,0),h.updateNR50(0),e(h.memoryLocationNR51,0),h.updateNR51(0),e(h.memoryLocationNR52,112),h.updateNR52(112));t.channel1Sample=15;t.channel2Sample=15;t.channel3Sample=15;t.channel4Sample=15;t.channel1DacEnabled=!1;t.channel2DacEnabled=!1;t.channel3DacEnabled=!1;
t.channel4DacEnabled=!1;t.leftChannelSampleUnsignedByte=127;t.rightChannelSampleUnsignedByte=127;t.mixerVolumeChanged=!0;t.mixerEnabledChanged=!0;t.needToRemixSamples=!1;l.updateInterruptEnabled(0);e(l.memoryLocationInterruptEnabled,l.interruptsEnabledValue);l.updateInterruptRequested(225);e(l.memoryLocationInterruptRequest,l.interruptsRequestedValue);k.currentCycles=0;k.dividerRegister=0;k.timerCounter=0;k.timerModulo=0;k.timerEnabled=!1;k.timerInputClock=0;k.timerCounterOverflowDelay=!1;k.timerCounterWasReset=
!1;b.GBCEnabled?(e(65284,30),k.dividerRegister=7840):(e(65284,171),k.dividerRegister=43980);e(65287,248);k.timerInputClock=248;b.BootROMEnabled&&!b.GBCEnabled&&(e(65284,0),k.dividerRegister=4);V.currentCycles=0;V.numberOfBitsTransferred=0;b.GBCEnabled?(e(65282,124),V.updateTransferControl(124)):(e(65282,126),V.updateTransferControl(126));b.GBCEnabled?(e(65392,248),e(65359,254),e(65357,126),e(65280,207),e(65295,225),e(65388,254),e(65397,143)):(e(65392,255),e(65359,255),e(65357,255),e(65280,207),e(65295,
225))},hasCoreStarted:function(){return eb},saveState:function(){b.saveState();q.saveState();l.saveState();y.saveState();m.saveState();k.saveState();h.saveState();r.saveState();I.saveState();F.saveState();J.saveState();eb=!1},loadState:function(){b.loadState();q.loadState();l.loadState();y.loadState();m.loadState();k.loadState();h.loadState();r.loadState();I.loadState();F.loadState();J.loadState();eb=!1;Z.cyclesPerCycleSet=2E9;Z.cycleSets=0;Z.cycles=0;S.stepsPerStepSet=2E9;S.stepSets=0;S.steps=0},
isGBC:function(){return b.GBCEnabled},getStepsPerStepSet:function(){return S.stepsPerStepSet},getStepSets:function(){return S.stepSets},getSteps:function(){return S.steps},executeMultipleFrames:function(a){for(var b=0,c=0;c<a&&0<=b;)b=bc(),c+=1;return 0>b?b:0},executeFrame:bc,executeFrameAndCheckAudio:function(a){void 0===a&&(a=0);return Hb(!0,a)},executeUntilCondition:Hb,executeStep:cc,getCyclesPerCycleSet:function(){return Z.cyclesPerCycleSet},getCycleSets:function(){return Z.cycleSets},getCycles:function(){return Z.cycles},
setJoypadState:function(a,b,c,e,f,n,h,g){0<a?Oa(0):Da(0,!1);0<b?Oa(1):Da(1,!1);0<c?Oa(2):Da(2,!1);0<e?Oa(3):Da(3,!1);0<f?Oa(4):Da(4,!1);0<n?Oa(5):Da(5,!1);0<h?Oa(6):Da(6,!1);0<g?Oa(7):Da(7,!1)},getNumberOfSamplesInAudioBuffer:Rb,clearAudioBuffer:Sb,setManualColorizationPalette:Lb,WASMBOY_MEMORY_LOCATION:0,WASMBOY_MEMORY_SIZE:dc,WASMBOY_WASM_PAGES:Kb,ASSEMBLYSCRIPT_MEMORY_LOCATION:0,ASSEMBLYSCRIPT_MEMORY_SIZE:1024,WASMBOY_STATE_LOCATION:1024,WASMBOY_STATE_SIZE:1024,GAMEBOY_INTERNAL_MEMORY_LOCATION:2048,
GAMEBOY_INTERNAL_MEMORY_SIZE:vc,VIDEO_RAM_LOCATION:2048,VIDEO_RAM_SIZE:16384,WORK_RAM_LOCATION:18432,WORK_RAM_SIZE:32768,OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION:51200,OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE:16384,GRAPHICS_OUTPUT_LOCATION:wc,GRAPHICS_OUTPUT_SIZE:xc,GBC_PALETTE_LOCATION:Ua,GBC_PALETTE_SIZE:128,BG_PRIORITY_MAP_LOCATION:Va,BG_PRIORITY_MAP_SIZE:23552,FRAME_LOCATION:Za,FRAME_SIZE:93184,BACKGROUND_MAP_LOCATION:pb,BACKGROUND_MAP_SIZE:196608,TILE_DATA_LOCATION:Ib,TILE_DATA_SIZE:147456,OAM_TILES_LOCATION:qb,
OAM_TILES_SIZE:15360,AUDIO_BUFFER_LOCATION:lb,AUDIO_BUFFER_SIZE:131072,CHANNEL_1_BUFFER_LOCATION:ub,CHANNEL_1_BUFFER_SIZE:131072,CHANNEL_2_BUFFER_LOCATION:vb,CHANNEL_2_BUFFER_SIZE:131072,CHANNEL_3_BUFFER_LOCATION:wb,CHANNEL_3_BUFFER_SIZE:131072,CHANNEL_4_BUFFER_LOCATION:xb,CHANNEL_4_BUFFER_SIZE:131072,CARTRIDGE_RAM_LOCATION:Eb,CARTRIDGE_RAM_SIZE:131072,BOOT_ROM_LOCATION:nb,BOOT_ROM_SIZE:2560,CARTRIDGE_ROM_LOCATION:ob,CARTRIDGE_ROM_SIZE:8258560,DEBUG_GAMEBOY_MEMORY_LOCATION:Jb,DEBUG_GAMEBOY_MEMORY_SIZE:65535,
getWasmBoyOffsetFromGameBoyOffset:Db,setProgramCounterBreakpoint:function(a){W.programCounter=a},resetProgramCounterBreakpoint:function(){W.programCounter=-1},setReadGbMemoryBreakpoint:function(a){W.readGbMemory=a},resetReadGbMemoryBreakpoint:function(){W.readGbMemory=-1},setWriteGbMemoryBreakpoint:function(a){W.writeGbMemory=a},resetWriteGbMemoryBreakpoint:function(){W.writeGbMemory=-1},getRegisterA:function(){return b.registerA},getRegisterB:function(){return b.registerB},getRegisterC:function(){return b.registerC},
getRegisterD:function(){return b.registerD},getRegisterE:function(){return b.registerE},getRegisterH:function(){return b.registerH},getRegisterL:function(){return b.registerL},getRegisterF:function(){return b.registerF},getProgramCounter:function(){return b.programCounter},getStackPointer:function(){return b.stackPointer},getOpcodeAtProgramCounter:function(){return w(b.programCounter)},getLY:function(){return q.scanlineRegister},drawBackgroundMapToWasmMemory:function(a){var d=q.memoryLocationTileDataSelectZeroStart;
v.bgWindowTileDataSelect&&(d=q.memoryLocationTileDataSelectOneStart);var c=q.memoryLocationTileMapSelectZeroStart;v.bgTileMapDisplaySelect&&(c=q.memoryLocationTileMapSelectOneStart);for(var e=0;256>e;e++)for(var h=0;256>h;h++){var g=e,m=h,k=c+32*(g>>3)+(m>>3),l=T(k,0);l=ab(d,l);var p=g%8;g=m%8;g=7-g;m=0;b.GBCEnabled&&0<a&&(m=T(k,1));n(6,m)&&(p=7-p);var r=0;n(3,m)&&(r=1);k=T(l+2*p,r);l=T(l+2*p+1,r);p=0;n(g,l)&&(p+=1,p<<=1);n(g,k)&&(p+=1);l=3*(256*e+h);b.GBCEnabled&&0<a?(k=hb(m&7,p,!1),m=pa(0,k),g=
pa(1,k),k=pa(2,k),l=pb+l,f[l]=m,f[l+1]=g,f[l+2]=k):(m=gb(p,q.memoryLocationBackgroundPalette),l=pb+l,f[l+0]=(m&16711680)>>16,f[l+1]=(m&65280)>>8,f[l+2]=m&255)}},drawTileDataToWasmMemory:function(){for(var a=0;23>a;a++)for(var c=0;31>c;c++){var e=0;15<c&&(e=1);var f=a;15<a&&(f-=15);f<<=4;f=15<c?f+(c-15):f+c;var g=q.memoryLocationTileDataSelectOneStart;15<a&&(g=q.memoryLocationTileDataSelectZeroStart);for(var h=q.memoryLocationBackgroundPalette,m=-1,l=-1,k=0;8>k;k++)for(var p=0;5>p;p++){var r=4*(8*
p+k),t=w(q.memoryLocationSpriteAttributesTable+r+2);f===t&&(r=w(q.memoryLocationSpriteAttributesTable+r+3),t=0,b.GBCEnabled&&n(3,r)&&(t=1),t===e&&(l=r,k=8,p=5,h=q.memoryLocationSpritePaletteOne,n(4,l)&&(h=q.memoryLocationSpritePaletteTwo)))}if(b.GBCEnabled&&0>l){k=q.memoryLocationTileMapSelectZeroStart;v.bgTileMapDisplaySelect&&(k=q.memoryLocationTileMapSelectOneStart);p=-1;for(r=0;32>r;r++)for(t=0;32>t;t++){var u=k+32*t+r,y=T(u,0);f===y&&(p=u,t=r=32)}0<=p&&(m=T(p,1))}for(k=0;8>k;k++)sb(f,g,e,0,7,
k,8*c,8*a+k,248,Ib,!1,h,m,l)}},drawOamToWasmMemory:function(){for(var a=0;8>a;a++)for(var c=0;5>c;c++){var e=4*(8*c+a);w(q.memoryLocationSpriteAttributesTable+e);w(q.memoryLocationSpriteAttributesTable+e+1);var f=w(q.memoryLocationSpriteAttributesTable+e+2),g=1;v.tallSpriteSize&&(1===f%2&&--f,g+=1);e=w(q.memoryLocationSpriteAttributesTable+e+3);var h=0;b.GBCEnabled&&n(3,e)&&(h=1);var k=q.memoryLocationSpritePaletteOne;n(4,e)&&(k=q.memoryLocationSpritePaletteTwo);for(var l=0;l<g;l++)for(var m=0;8>
m;m++)sb(f+l,q.memoryLocationTileDataSelectOneStart,h,0,7,m,8*a,16*c+m+8*l,64,qb,!1,k,-1,e)}},getDIV:function(){return k.dividerRegister},getTIMA:function(){return k.timerCounter},getTMA:function(){return k.timerModulo},getTAC:function(){var a=k.timerInputClock;k.timerEnabled&&(a|=4);return a},updateDebugGBMemory:function(){for(var a=0;65535>a;a++){var b=Bb(a);f[Jb+a]=b}W.reachedBreakpoint=!1}});return async()=>({instance:{exports:yc},byteMemory:fb.wasmByteMemory,type:"TypeScript"})});
//# sourceMappingURL=getWasmBoyTsCore.closure.umd.js.map
