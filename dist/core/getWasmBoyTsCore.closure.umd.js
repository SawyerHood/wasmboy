'use strict';(function(Ra,r){"object"===typeof exports&&"undefined"!==typeof module?module.exports=r():"function"===typeof define&&define.amd?define(r):Ra.WasmBoyTsCore=r()})(this,function(){function Ra(a,c){a=1<<a&255;b.registerF=0<c?b.registerF|a:b.registerF&(255^a);return b.registerF}function r(a){Ra(7,a)}function v(a){Ra(6,a)}function G(a){Ra(5,a)}function I(a){Ra(4,a)}function Na(){return b.registerF>>7&1}function Q(){return b.registerF>>4&1}function M(a,c){0<=c?G(0!==((a&15)+(c&15)&16)):G((Math.abs(c)&
15)>(a&15))}function rb(a,c){0<=c?I(a>(a+c&255)):I(Math.abs(c)>a)}function Sa(a,c,b){b?(a=a^c^a+c,G(0!==(a&16)),I(0!==(a&256))):(b=a+c&65535,I(b<a),G(0!==((a^c^b)&4096)))}function Nb(a){switch(a){case 0:d.bgWhite=J.bgWhite;d.bgLightGrey=J.bgLightGrey;d.bgDarkGrey=J.bgDarkGrey;d.bgBlack=J.bgBlack;d.obj0White=J.obj0White;d.obj0LightGrey=J.obj0LightGrey;d.obj0DarkGrey=J.obj0DarkGrey;d.obj0Black=J.obj0Black;d.obj1White=J.obj1White;d.obj1LightGrey=J.obj1LightGrey;d.obj1DarkGrey=J.obj1DarkGrey;d.obj1Black=
J.obj1Black;break;case 1:d.bgWhite=ca.bgWhite;d.bgLightGrey=ca.bgLightGrey;d.bgDarkGrey=ca.bgDarkGrey;d.bgBlack=ca.bgBlack;d.obj0White=ca.obj0White;d.obj0LightGrey=ca.obj0LightGrey;d.obj0DarkGrey=ca.obj0DarkGrey;d.obj0Black=ca.obj0Black;d.obj1White=ca.obj1White;d.obj1LightGrey=ca.obj1LightGrey;d.obj1DarkGrey=ca.obj1DarkGrey;d.obj1Black=ca.obj1Black;break;case 2:d.bgWhite=da.bgWhite;d.bgLightGrey=da.bgLightGrey;d.bgDarkGrey=da.bgDarkGrey;d.bgBlack=da.bgBlack;d.obj0White=da.obj0White;d.obj0LightGrey=
da.obj0LightGrey;d.obj0DarkGrey=da.obj0DarkGrey;d.obj0Black=da.obj0Black;d.obj1White=da.obj1White;d.obj1LightGrey=da.obj1LightGrey;d.obj1DarkGrey=da.obj1DarkGrey;d.obj1Black=da.obj1Black;break;case 3:d.bgWhite=ea.bgWhite;d.bgLightGrey=ea.bgLightGrey;d.bgDarkGrey=ea.bgDarkGrey;d.bgBlack=ea.bgBlack;d.obj0White=ea.obj0White;d.obj0LightGrey=ea.obj0LightGrey;d.obj0DarkGrey=ea.obj0DarkGrey;d.obj0Black=ea.obj0Black;d.obj1White=ea.obj1White;d.obj1LightGrey=ea.obj1LightGrey;d.obj1DarkGrey=ea.obj1DarkGrey;
d.obj1Black=ea.obj1Black;break;case 4:d.bgWhite=fa.bgWhite;d.bgLightGrey=fa.bgLightGrey;d.bgDarkGrey=fa.bgDarkGrey;d.bgBlack=fa.bgBlack;d.obj0White=fa.obj0White;d.obj0LightGrey=fa.obj0LightGrey;d.obj0DarkGrey=fa.obj0DarkGrey;d.obj0Black=fa.obj0Black;d.obj1White=fa.obj1White;d.obj1LightGrey=fa.obj1LightGrey;d.obj1DarkGrey=fa.obj1DarkGrey;d.obj1Black=fa.obj1Black;break;case 5:d.bgWhite=ha.bgWhite;d.bgLightGrey=ha.bgLightGrey;d.bgDarkGrey=ha.bgDarkGrey;d.bgBlack=ha.bgBlack;d.obj0White=ha.obj0White;d.obj0LightGrey=
ha.obj0LightGrey;d.obj0DarkGrey=ha.obj0DarkGrey;d.obj0Black=ha.obj0Black;d.obj1White=ha.obj1White;d.obj1LightGrey=ha.obj1LightGrey;d.obj1DarkGrey=ha.obj1DarkGrey;d.obj1Black=ha.obj1Black;break;case 6:d.bgWhite=ia.bgWhite;d.bgLightGrey=ia.bgLightGrey;d.bgDarkGrey=ia.bgDarkGrey;d.bgBlack=ia.bgBlack;d.obj0White=ia.obj0White;d.obj0LightGrey=ia.obj0LightGrey;d.obj0DarkGrey=ia.obj0DarkGrey;d.obj0Black=ia.obj0Black;d.obj1White=ia.obj1White;d.obj1LightGrey=ia.obj1LightGrey;d.obj1DarkGrey=ia.obj1DarkGrey;
d.obj1Black=ia.obj1Black;break;case 7:d.bgWhite=ja.bgWhite;d.bgLightGrey=ja.bgLightGrey;d.bgDarkGrey=ja.bgDarkGrey;d.bgBlack=ja.bgBlack;d.obj0White=ja.obj0White;d.obj0LightGrey=ja.obj0LightGrey;d.obj0DarkGrey=ja.obj0DarkGrey;d.obj0Black=ja.obj0Black;d.obj1White=ja.obj1White;d.obj1LightGrey=ja.obj1LightGrey;d.obj1DarkGrey=ja.obj1DarkGrey;d.obj1Black=ja.obj1Black;break;case 8:d.bgWhite=ka.bgWhite;d.bgLightGrey=ka.bgLightGrey;d.bgDarkGrey=ka.bgDarkGrey;d.bgBlack=ka.bgBlack;d.obj0White=ka.obj0White;d.obj0LightGrey=
ka.obj0LightGrey;d.obj0DarkGrey=ka.obj0DarkGrey;d.obj0Black=ka.obj0Black;d.obj1White=ka.obj1White;d.obj1LightGrey=ka.obj1LightGrey;d.obj1DarkGrey=ka.obj1DarkGrey;d.obj1Black=ka.obj1Black;break;case 9:d.bgWhite=la.bgWhite;d.bgLightGrey=la.bgLightGrey;d.bgDarkGrey=la.bgDarkGrey;d.bgBlack=la.bgBlack;d.obj0White=la.obj0White;d.obj0LightGrey=la.obj0LightGrey;d.obj0DarkGrey=la.obj0DarkGrey;d.obj0Black=la.obj0Black;d.obj1White=la.obj1White;d.obj1LightGrey=la.obj1LightGrey;d.obj1DarkGrey=la.obj1DarkGrey;
d.obj1Black=la.obj1Black;break;case 10:d.bgWhite=ma.bgWhite;d.bgLightGrey=ma.bgLightGrey;d.bgDarkGrey=ma.bgDarkGrey;d.bgBlack=ma.bgBlack;d.obj0White=ma.obj0White;d.obj0LightGrey=ma.obj0LightGrey;d.obj0DarkGrey=ma.obj0DarkGrey;d.obj0Black=ma.obj0Black;d.obj1White=ma.obj1White;d.obj1LightGrey=ma.obj1LightGrey;d.obj1DarkGrey=ma.obj1DarkGrey;d.obj1Black=ma.obj1Black;break;case 11:d.bgWhite=na.bgWhite;d.bgLightGrey=na.bgLightGrey;d.bgDarkGrey=na.bgDarkGrey;d.bgBlack=na.bgBlack;d.obj0White=na.obj0White;
d.obj0LightGrey=na.obj0LightGrey;d.obj0DarkGrey=na.obj0DarkGrey;d.obj0Black=na.obj0Black;d.obj1White=na.obj1White;d.obj1LightGrey=na.obj1LightGrey;d.obj1DarkGrey=na.obj1DarkGrey;d.obj1Black=na.obj1Black;break;case 12:d.bgWhite=oa.bgWhite,d.bgLightGrey=oa.bgLightGrey,d.bgDarkGrey=oa.bgDarkGrey,d.bgBlack=oa.bgBlack,d.obj0White=oa.obj0White,d.obj0LightGrey=oa.obj0LightGrey,d.obj0DarkGrey=oa.obj0DarkGrey,d.obj0Black=oa.obj0Black,d.obj1White=oa.obj1White,d.obj1LightGrey=oa.obj1LightGrey,d.obj1DarkGrey=
oa.obj1DarkGrey,d.obj1Black=oa.obj1Black}}function l(a,c){return(a&255)<<8|c&255}function D(a){return(a&65280)>>8}function C(a,c){return c&~(1<<a)}function g(a,c){return 0!=(c&1<<a)}function gb(a,c){a=t(c)>>2*a&3;if(c===Ta.memoryLocationSpritePaletteOne)switch(c=d.obj0White,a){case 1:c=d.obj0LightGrey;break;case 2:c=d.obj0DarkGrey;break;case 3:c=d.obj0Black}else if(c===Ta.memoryLocationSpritePaletteTwo)switch(c=d.obj1White,a){case 1:c=d.obj1LightGrey;break;case 2:c=d.obj1DarkGrey;break;case 3:c=d.obj1Black}else switch(c=
d.bgWhite,a){case 1:c=d.bgLightGrey;break;case 2:c=d.bgDarkGrey;break;case 3:c=d.bgBlack}return c}function hb(a,c,b){c=8*a+2*c;a=Ob(c+1,b);b=Ob(c,b);return l(a,b)}function pa(a,c){a*=5;return 8*((c&31<<a)>>a)}function Ob(a,c){a&=63;c&&(a+=64);return f[Ua+a]}function ib(a,c,b,d){void 0===b&&(b=0);void 0===d&&(d=!1);b&=3;d&&(b|=4);f[Va+(160*c+a)]=b}function sb(a,c,d,E,x,e,m,h,k,l,n,jb,u,v){var aa=0;c=ab(c,a);a=T(c+2*e,d);d=T(c+2*e+1,d);for(e=E;e<=x;++e)if(c=m+(e-E),c<k){var O=e;if(0>u||!g(5,u))O=7-
O;var Qa=0;g(O,d)&&(Qa+=1,Qa<<=1);g(O,a)&&(Qa+=1);if(b.GBCEnabled&&(0<=u||0<=v)){O=0<=v;var ba=u&7;O&&(ba=v&7);var N=hb(ba,Qa,O);O=pa(0,N);ba=pa(1,N);N=pa(2,N)}else if(0>=jb&&(jb=q.memoryLocationBackgroundPalette),n){ba=Qa;N=n;void 0===N&&(N=!1);O=ba;N||(O=t(jb)>>(ba<<1)&3);ba=242;switch(O){case 1:ba=160;break;case 2:ba=88;break;case 3:ba=8}ba=O=N=ba}else N=gb(Qa,jb),O=(N&16711680)>>16,ba=(N&65280)>>8,N&=255;var tb=3*(h*k+c);f[l+tb+0]=O;f[l+tb+1]=ba;f[l+tb+2]=N;O=!1;0<=u&&(O=g(7,u));ib(c,h,Qa,O);
aa++}return aa}function ab(a,c){a===q.memoryLocationTileDataSelectZeroStart&&(c=g(7,c)?c-128:c+128);return a+16*c}function Pb(a,c){switch(a){case 1:return g(c,129);case 2:return g(c,135);case 3:return g(c,126);default:return g(c,1)}}function ub(){var a=p.sweepShadowFrequency,c=a>>p.NRx0SweepShift;p.NRx0Negate?(p.sweepNegateShouldDisableChannelOnClear=!0,c=a-c):c=a+c;return c}function kb(a){switch(a){case p.channelNumber:a=p.isDacEnabled;var c=w.channel1DacEnabled!==a;w.channel1DacEnabled=a;return c;
case z.channelNumber:return a=z.isDacEnabled,c=w.channel2DacEnabled!==a,w.channel2DacEnabled=a,c;case u.channelNumber:return a=u.isDacEnabled,c=w.channel3DacEnabled!==a,w.channel3DacEnabled=a,c;case B.channelNumber:return a=B.isDacEnabled,c=w.channel4DacEnabled!==a,w.channel4DacEnabled=a,c}return!1}function bb(){for(var a=h.batchProcessCycles(),c=h.currentCycles;c>=a;)Qb(a),c-=a;h.currentCycles=c}function Qb(a){var c=h.maxFrameSequenceCycles();var b=h.frameSequenceCycleCounter+a;if(b>=c){h.frameSequenceCycleCounter=
b-c;c=h.frameSequencer+1&7;switch(c){case 0:p.updateLength();z.updateLength();u.updateLength();B.updateLength();break;case 2:p.updateLength();z.updateLength();u.updateLength();B.updateLength();p.updateSweep();break;case 4:p.updateLength();z.updateLength();u.updateLength();B.updateLength();break;case 6:p.updateLength();z.updateLength();u.updateLength();B.updateLength();p.updateSweep();break;case 7:p.updateEnvelope(),z.updateEnvelope(),B.updateEnvelope()}h.frameSequencer=c;c=!0}else h.frameSequenceCycleCounter=
b,c=!1;if(L.audioAccumulateSamples&&!c){c=p.willChannelUpdate(a)||kb(p.channelNumber);b=z.willChannelUpdate(a)||kb(z.channelNumber);var d=u.willChannelUpdate(a)||kb(u.channelNumber),f=B.willChannelUpdate(a)||kb(B.channelNumber);c&&(w.channel1Sample=p.getSampleFromCycleCounter());b&&(w.channel2Sample=z.getSampleFromCycleCounter());d&&(w.channel3Sample=u.getSampleFromCycleCounter());f&&(w.channel4Sample=B.getSampleFromCycleCounter());if(c||b||d||f)w.needToRemixSamples=!0;c=h.downSampleCycleCounter;
c+=a;a=h.maxDownSampleCycles();c>=a&&(c-=a,w.needToRemixSamples||w.mixerVolumeChanged||w.mixerEnabledChanged?Wa(w.channel1Sample,w.channel2Sample,w.channel3Sample,w.channel4Sample):h.downSampleCycleCounter=c,Xa(w.leftChannelSampleUnsignedByte+1,w.rightChannelSampleUnsignedByte+1,lb),a=h.audioQueueIndex+1,a>=(h.wasmBoyMemoryMaxBufferSize>>1|0)-1&&--a,h.audioQueueIndex=a);h.downSampleCycleCounter=c}else{c=p.getSample(a)|0;b=z.getSample(a)|0;d=u.getSample(a)|0;f=B.getSample(a)|0;w.channel1Sample=c;w.channel2Sample=
b;w.channel3Sample=d;w.channel4Sample=f;a=h.downSampleCycleCounter+a;if(a>=h.maxDownSampleCycles()){a-=h.maxDownSampleCycles();var e=Wa(c,b,d,f),g=D(e);Xa(g+1,(e&255)+1,lb);L.enableAudioDebugging&&(e=Wa(c,15,15,15),g=D(e),Xa(g+1,(e&255)+1,vb),e=Wa(15,b,15,15),g=D(e),Xa(g+1,(e&255)+1,wb),e=Wa(15,15,d,15),g=D(e),Xa(g+1,(e&255)+1,xb),e=Wa(15,15,15,f),g=D(e),Xa(g+1,(e&255)+1,yb));c=h.audioQueueIndex+1;c>=(h.wasmBoyMemoryMaxBufferSize>>1|0)-1&&--c;h.audioQueueIndex=c}h.downSampleCycleCounter=a}}function Rb(){return h.audioQueueIndex}
function Sb(){h.audioQueueIndex=0}function Wa(a,c,b,d){void 0===a&&(a=15);void 0===c&&(c=15);void 0===b&&(b=15);void 0===d&&(d=15);w.mixerVolumeChanged=!1;var aa=0+(h.NR51IsChannel1EnabledOnLeftOutput?a:15);aa+=h.NR51IsChannel2EnabledOnLeftOutput?c:15;aa+=h.NR51IsChannel3EnabledOnLeftOutput?b:15;aa+=h.NR51IsChannel4EnabledOnLeftOutput?d:15;a=0+(h.NR51IsChannel1EnabledOnRightOutput?a:15);a+=h.NR51IsChannel2EnabledOnRightOutput?c:15;a+=h.NR51IsChannel3EnabledOnRightOutput?b:15;a+=h.NR51IsChannel4EnabledOnRightOutput?
d:15;w.mixerEnabledChanged=!1;w.needToRemixSamples=!1;c=Tb(aa,h.NR50LeftMixerVolume+1);b=Tb(a,h.NR50RightMixerVolume+1);w.leftChannelSampleUnsignedByte=c;w.rightChannelSampleUnsignedByte=b;return l(c,b)}function Tb(a,c){if(60===a)return 127;a=1E5*(a-60)*c>>3;a=(a/1E5|0)+60;a=1E5*a/(12E6/254|0)|0;return a|=0}function Xa(a,c,b){b+=h.audioQueueIndex<<1;f[b+0]=a+1;f[b+1]=c+1}function dc(a){switch(a){case p.memoryLocationNRx0:return a=t(p.memoryLocationNRx0),a|128;case z.memoryLocationNRx0:return a=t(z.memoryLocationNRx0),
a|255;case u.memoryLocationNRx0:return a=t(u.memoryLocationNRx0),a|127;case B.memoryLocationNRx0:return a=t(B.memoryLocationNRx0),a|255;case h.memoryLocationNR50:return a=t(h.memoryLocationNR50),a|0;case p.memoryLocationNRx1:return a=t(p.memoryLocationNRx1),a|63;case z.memoryLocationNRx1:return a=t(z.memoryLocationNRx1),a|63;case u.memoryLocationNRx1:return a=t(u.memoryLocationNRx1),a|255;case B.memoryLocationNRx1:return a=t(B.memoryLocationNRx1),a|255;case h.memoryLocationNR51:return a=t(h.memoryLocationNR51),
a|0;case p.memoryLocationNRx2:return a=t(p.memoryLocationNRx2),a|0;case z.memoryLocationNRx2:return a=t(z.memoryLocationNRx2),a|0;case u.memoryLocationNRx2:return a=t(u.memoryLocationNRx2),a|159;case B.memoryLocationNRx2:return a=t(B.memoryLocationNRx2),a|0;case h.memoryLocationNR52:return a=0,a=h.NR52IsSoundEnabled?a|128:C(7,a),a=p.isEnabled?a|1:C(0,a),a=z.isEnabled?a|2:C(1,a),a=u.isEnabled?a|4:C(2,a),a=B.isEnabled?a|8:C(3,a),a|112;case p.memoryLocationNRx3:return a=t(p.memoryLocationNRx3),a|255;
case z.memoryLocationNRx3:return a=t(z.memoryLocationNRx3),a|255;case u.memoryLocationNRx3:return a=t(u.memoryLocationNRx3),a|255;case B.memoryLocationNRx3:return a=t(B.memoryLocationNRx3),a|0;case p.memoryLocationNRx4:return a=t(p.memoryLocationNRx4),a|191;case z.memoryLocationNRx4:return a=t(z.memoryLocationNRx4),a|191;case u.memoryLocationNRx4:return a=t(u.memoryLocationNRx4),a|191;case B.memoryLocationNRx4:return a=t(B.memoryLocationNRx4),a|191}return-1}function cb(a){mb(!1);var c=t(k.memoryLocationInterruptRequest);
c=C(a,c);k.interruptsRequestedValue=c;e(k.memoryLocationInterruptRequest,c);b.stackPointer-=2;b.isHalted();c=b.stackPointer;var d=b.programCounter,E=D(d);e(c+0,d&255);e(c+1,E);switch(a){case k.bitPositionVBlankInterrupt:k.isVBlankInterruptRequested=!1;b.programCounter=64;break;case k.bitPositionLcdInterrupt:k.isLcdInterruptRequested=!1;b.programCounter=72;break;case k.bitPositionTimerInterrupt:k.isTimerInterruptRequested=!1;b.programCounter=80;break;case k.bitPositionSerialInterrupt:k.isSerialInterruptRequested=
!1;b.programCounter=88;break;case k.bitPositionJoypadInterrupt:k.isJoypadInterruptRequested=!1,b.programCounter=96}}function Ya(a){var c=t(k.memoryLocationInterruptRequest);c|=1<<a;k.interruptsRequestedValue=c;e(k.memoryLocationInterruptRequest,c)}function mb(a){a?k.masterInterruptSwitchDelay=!0:k.masterInterruptSwitch=!1}function zb(a){for(var c=0;c<a;){var b=n.dividerRegister,d=b;c+=4;d+=4;d&=65535;n.dividerRegister=d;if(n.timerEnabled){var f=n.timerCounterWasReset;n.timerCounterOverflowDelay?(n.timerCounter=
n.timerModulo,k.isTimerInterruptRequested=!0,Ya(k.bitPositionTimerInterrupt),n.timerCounterOverflowDelay=!1,n.timerCounterWasReset=!0):f&&(n.timerCounterWasReset=!1);Ub(b,d)&&Ab()}}}function Ab(){var a=n.timerCounter;255<++a&&(n.timerCounterOverflowDelay=!0,a=0);n.timerCounter=a}function Ub(a,c){var b=Bb(n.timerInputClock);return g(b,a)&&!g(b,c)}function Bb(a){switch(a){case 0:return 9;case 1:return 3;case 2:return 5;case 3:return 7}return 0}function Oa(a){var c=b.isStopped=!1;ec(a)||(c=!0);Da(a,
!0);c&&(c=!1,3>=a&&(c=!0),a=!1,A.isDpadType&&c&&(a=!0),A.isButtonType&&!c&&(a=!0),a&&(k.isJoypadInterruptRequested=!0,Ya(k.bitPositionJoypadInterrupt)))}function ec(a){switch(a){case 0:return A.up;case 1:return A.right;case 2:return A.down;case 3:return A.left;case 4:return A.a;case 5:return A.b;case 6:return A.select;case 7:return A.start;default:return!1}}function Da(a,c){switch(a){case 0:A.up=c;break;case 1:A.right=c;break;case 2:A.down=c;break;case 3:A.left=c;break;case 4:A.a=c;break;case 5:A.b=
c;break;case 6:A.select=c;break;case 7:A.start=c}}function Vb(a,c,d){for(var aa=0;aa<d;++aa){for(var f=Cb(a+aa),e=c+aa;40959<e;)e-=8192;Db(e,f)}m.DMACycles+=(32<<b.GBCDoubleSpeed)*(d>>4)}function Eb(a,c){if(a===b.memoryLocationSpeedSwitch)return e(b.memoryLocationSpeedSwitch,c&1),!1;if(b.BootROMEnabled&&a===b.memoryLocationBootROMSwitch)return b.BootROMEnabled=!1,b.programCounter=255,!0;var d=m.videoRamLocation,E=m.spriteInformationTableLocation;if(a<d){if(!m.isRomOnly){d=m.isMBC1;var x=m.isMBC2;
if(8191>=a){if(!x||g(4,c))c&=15,0===c?m.isRamBankingEnabled=!1:10===c&&(m.isRamBankingEnabled=!0)}else 16383>=a?(E=m.isMBC5,!E||12287>=a?(a=m.currentRomBank,x&&(a=c&15),d?(c&=31,a&=224):m.isMBC3?(c&=127,a&=128):E&&(a&=0),m.currentRomBank=a|c):m.currentRomBank=l(0<c,m.currentRomBank&255)):!x&&24575>=a?d&&m.isMBC1RomModeEnabled?(a=m.currentRomBank&31,m.currentRomBank=a|c&224):(c=m.isMBC5?c&15:c&3,m.currentRamBank=c):!x&&32767>=a&&d&&(m.isMBC1RomModeEnabled=g(0,c))}return!1}if(a>=d&&a<m.cartridgeRamLocation)return!0;
if(a>=m.echoRamLocation&&a<E)return e(a-8192,c),!0;if(a>=E&&a<=m.spriteInformationTableLocationEnd)return 2<=y.currentLcdMode;if(a>=m.unusableMemoryLocation&&a<=m.unusableMemoryEndLocation)return!1;if(a===V.memoryLocationSerialTransferControl)return V.updateTransferControl(c);if(65296<=a&&65318>=a){bb();if(a===h.memoryLocationNR52||h.NR52IsSoundEnabled){switch(a){case p.memoryLocationNRx0:p.updateNRx0(c);break;case u.memoryLocationNRx0:u.updateNRx0(c);break;case p.memoryLocationNRx1:p.updateNRx1(c);
break;case z.memoryLocationNRx1:z.updateNRx1(c);break;case u.memoryLocationNRx1:u.updateNRx1(c);break;case B.memoryLocationNRx1:B.updateNRx1(c);break;case p.memoryLocationNRx2:p.updateNRx2(c);break;case z.memoryLocationNRx2:z.updateNRx2(c);break;case u.memoryLocationNRx2:u.volumeCodeChanged=!0;u.updateNRx2(c);break;case B.memoryLocationNRx2:B.updateNRx2(c);break;case p.memoryLocationNRx3:p.updateNRx3(c);break;case z.memoryLocationNRx3:z.updateNRx3(c);break;case u.memoryLocationNRx3:u.updateNRx3(c);
break;case B.memoryLocationNRx3:B.updateNRx3(c);break;case p.memoryLocationNRx4:p.updateNRx4(c);break;case z.memoryLocationNRx4:z.updateNRx4(c);break;case u.memoryLocationNRx4:u.updateNRx4(c);break;case B.memoryLocationNRx4:B.updateNRx4(c);break;case h.memoryLocationNR50:h.updateNR50(c);w.mixerVolumeChanged=!0;break;case h.memoryLocationNR51:h.updateNR51(c);w.mixerEnabledChanged=!0;break;case h.memoryLocationNR52:a=h.NR52IsSoundEnabled;!a&&g(7,c)&&(h.frameSequencer=7,p.waveFormPositionOnDuty=0,z.waveFormPositionOnDuty=
0);if(a&&!g(7,c))for(a=65296;65318>a;++a)Db(a,0);h.updateNR52(c)}c=!0}else c=!1;return c}if(65328<=a&&65343>=a)return bb(),u.isEnabled?(u.handleWaveRamWrite(c),!1):!0;if(a>=y.memoryLocationLcdControl&&a<=q.memoryLocationWindowX){if(a===y.memoryLocationLcdControl)return y.updateLcdControl(c),!0;if(a===y.memoryLocationLcdStatus)return y.updateLcdStatus(c),!1;if(a===q.memoryLocationScanlineRegister)return q.scanlineRegister=0,e(a,0),!1;if(a===y.memoryLocationCoincidenceCompare)return y.coincidenceCompare=
c,!0;if(a===q.memoryLocationDmaTransfer){c<<=8;for(a=0;159>=a;++a)d=t(c+a),e(m.spriteInformationTableLocation+a,d);m.DMACycles=644;return!0}switch(a){case q.memoryLocationScrollX:q.scrollX=c;break;case q.memoryLocationScrollY:q.scrollY=c;break;case q.memoryLocationWindowX:q.windowX=c;break;case q.memoryLocationWindowY:q.windowY=c}return!0}if(a===m.memoryLocationHdmaTrigger)return b.GBCEnabled&&(m.isHblankHdmaActive&&!g(7,c)?(m.isHblankHdmaActive=!1,c=t(m.memoryLocationHdmaTrigger),e(m.memoryLocationHdmaTrigger,
c|128)):(a=t(m.memoryLocationHdmaSourceHigh),d=t(m.memoryLocationHdmaSourceLow),a=l(a,d)&65520,d=t(m.memoryLocationHdmaDestinationHigh),E=t(m.memoryLocationHdmaDestinationLow),d=l(d,E),d=(d&8176)+m.videoRamLocation,E=C(7,c),E=E+1<<4,g(7,c)?(m.isHblankHdmaActive=!0,m.hblankHdmaTransferLengthRemaining=E,m.hblankHdmaSource=a,m.hblankHdmaDestination=d,e(m.memoryLocationHdmaTrigger,C(7,c))):(Vb(a,d,E),e(m.memoryLocationHdmaTrigger,255)))),!1;if((a===m.memoryLocationGBCWRAMBank||a===m.memoryLocationGBCVRAMBank)&&
m.isHblankHdmaActive&&(d=m.hblankHdmaSource,16384<=d&&32767>=d||53248<=d&&57343>=d))return!1;if(a>=Ta.memoryLocationBackgroundPaletteIndex&&a<=Ta.memoryLocationSpritePaletteData){d=Ta.memoryLocationSpritePaletteData;if(a===Ta.memoryLocationBackgroundPaletteData||a===d)E=t(a-1),E=C(6,E),x=E&63,a===d&&(x+=64),f[Ua+x]=c,c=E,--a,g(7,c)&&e(a,c+1|128);return!0}if(a>=n.memoryLocationDividerRegister&&a<=n.memoryLocationTimerControl){zb(n.currentCycles);n.currentCycles=0;switch(a){case n.memoryLocationDividerRegister:return n.updateDividerRegister(),
!1;case n.memoryLocationTimerCounter:n.updateTimerCounter(c);break;case n.memoryLocationTimerModulo:n.updateTimerModulo(c);break;case n.memoryLocationTimerControl:n.updateTimerControl(c)}return!0}a===A.memoryLocationJoypadRegister&&A.updateJoypad(c);if(a===k.memoryLocationInterruptRequest)return k.updateInterruptRequested(c),!0;a===k.memoryLocationInterruptEnabled&&k.updateInterruptEnabled(c);return!0}function Fb(a){switch(a>>12){case 0:if(b.BootROMEnabled)if(b.GBCEnabled){if(256>a||511<a&&2304>a)return a+
nb}else if(!b.GBCEnabled&&256>a)return a+nb;case 1:case 2:case 3:return a+ob;case 4:case 5:case 6:case 7:var c=m.currentRomBank;m.isMBC5||0!==c||(c=1);return 16384*c+(a-m.switchableCartridgeRomLocation)+ob;case 8:case 9:return c=0,b.GBCEnabled&&(c=t(m.memoryLocationGBCVRAMBank)&1),a-m.videoRamLocation+2048+8192*c;case 10:case 11:return 8192*m.currentRamBank+(a-m.cartridgeRamLocation)+Gb;case 12:return a-m.internalRamBankZeroLocation+18432;case 13:return c=0,b.GBCEnabled&&(c=t(m.memoryLocationGBCWRAMBank)&
7),a-m.internalRamBankZeroLocation+18432+4096*((1>c?1:c)-1);default:return a-m.echoRamLocation+51200}}function e(a,c){a=Fb(a);f[a]=c}function Db(a,c){a===W.writeGbMemory&&(W.reachedBreakpoint=!0);Eb(a,c)&&e(a,c)}function Wb(a){q.scanlineCycleCounter=0;q.scanlineRegister=0;e(q.memoryLocationScanlineRegister,0);var c=t(y.memoryLocationLcdStatus);c=C(1,c);c=C(0,c);y.currentLcdMode=0;e(y.memoryLocationLcdStatus,c);if(a)for(a=0;93184>a;++a)f[Za+a]=255}function Xb(a,c){0!==a&&1!==a||q.scanlineRegister!==
y.coincidenceCompare?c=C(2,c):(c|=4,g(6,c)&&(k.isLcdInterruptRequested=!0,Ya(k.bitPositionLcdInterrupt)));return c}function Yb(a,c,d,E,e,m){for(var aa=E>>3;160>e;++e){var x=e+m;256<=x&&(x-=256);var h=d+(aa<<5)+(x>>3),k=T(h,0),l=!1;if(L.tileCaching){var n=e;var u=a,v=x,N=h,w=k,r=0,p=$a.nextXIndexToPerformCacheCheck;if(0<u&&8<n&&w===$a.tileId&&n===p){w=g(5,t(N-1));N=g(5,t(N));for(var y=0;8>y;++y){w!==N&&(y=7-y);var z=n+y;if(160>=z){var A=n-(8-y),B=Za+3*(160*u+z);Y(z,u,0,f[B]);Y(z,u,1,f[B]);Y(z,u,2,
f[B]);A=f[Va+(160*u+A)];ib(z,u,C(2,A),g(2,A));r++}}}else $a.tileId=w;n>=p&&(p=n+8,u=v&7|0,n<u&&(p+=u));$a.nextXIndexToPerformCacheCheck=p;n=r;0<n&&(e+=n-1,l=!0)}L.tileRendering&&!l?(l=e,n=a,u=x,x=c,r=E&7|0,p=0,0==l&&(p=u-(u>>3<<3)),u=7,160<l+8&&(u=160-l),v=-1,w=0,b.GBCEnabled&&(v=T(h,1),w=g(3,v)|0,g(6,v)&&(r=7-r)),n=sb(k,x,w,p,u,r,l,n,160,Za,!1,0,v,-1),0<n&&(e+=n-1)):l||(b.GBCEnabled?(l=e,n=a,p=E,r=ab(c,k),k=T(h,1),p=p&7|0,g(6,k)&&(p=7-p),u=g(3,k)|0,h=T(r+2*p,u),r=T(r+2*p+1,u),p=x&7|0,g(5,k)||(p=
7-p),x=0,g(p,r)&&(x=x+1<<1),g(p,h)&&(x+=1),p=hb(k&7,x,!1),h=pa(0,p),r=pa(1,p),p=pa(2,p),Y(l,n,0,h),Y(l,n,1,r),Y(l,n,2,p),ib(l,n,x,g(7,k))):(h=e,l=a,r=E,n=ab(c,k),r=r&7|0,k=T(n+2*r,0),n=T(n+2*r+1,0),r=x&7|0,r=7-r,x=0,g(r,n)&&(x=x+1<<1),g(r,k)&&(x+=1),k=gb(x,q.memoryLocationBackgroundPalette),Y(h,l,0,(k&16711680)>>16),Y(h,l,1,(k&65280)>>8),Y(h,l,2,k&255),ib(h,l,x)))}}function Zb(a){if(y.enabled)for(q.scanlineCycleCounter+=a,a=L.graphicsDisableScanlineRendering;q.scanlineCycleCounter>=q.MAX_CYCLES_PER_SCANLINE();){q.scanlineCycleCounter-=
q.MAX_CYCLES_PER_SCANLINE();var c=q.scanlineRegister;if(144===c){if(a)for(var b=0;144>=b;++b)Hb(b);else Hb(c);for(b=0;144>b;++b)for(var d=0;160>d;++d)f[Va+(160*b+d)]=0;$a.tileId=-1;$a.nextXIndexToPerformCacheCheck=-1}else 144>c&&(a||Hb(c));c=153<c?0:c+1;q.scanlineRegister=c}if(y.enabled){c=q.scanlineRegister;b=y.currentLcdMode;a=0;if(144<=c)a=1;else{d=q.scanlineCycleCounter;var x=q.MIN_CYCLES_SPRITES_LCD_MODE();d>=x?a=2:d>=x&&(a=3)}if(b!==a){c=t(y.memoryLocationLcdStatus);y.currentLcdMode=a;b=!1;
switch(a){case 0:c=C(0,c);c=C(1,c);b=g(3,c);break;case 1:c=C(1,c);c|=1;b=g(4,c);break;case 2:c=C(0,c);c|=2;b=g(5,c);break;case 3:c|=3}b&&(k.isLcdInterruptRequested=!0,Ya(k.bitPositionLcdInterrupt));0===a&&m.isHblankHdmaActive&&(d=16,b=m.hblankHdmaTransferLengthRemaining,b<d&&(d=b),Vb(m.hblankHdmaSource,m.hblankHdmaDestination,d),m.hblankHdmaSource+=d,m.hblankHdmaDestination+=d,b-=d,m.hblankHdmaTransferLengthRemaining=b,d=m.memoryLocationHdmaTrigger,0>=b?(m.isHblankHdmaActive=!1,e(d,255)):e(d,C(7,
(b>>4)-1)));1===a&&(k.isVBlankInterruptRequested=!0,Ya(k.bitPositionVBlankInterrupt));c=Xb(a,c);e(y.memoryLocationLcdStatus,c)}else 153===c&&(c=t(y.memoryLocationLcdStatus),c=Xb(a,c),e(y.memoryLocationLcdStatus,c))}}function Hb(a){var c=q.memoryLocationTileDataSelectZeroStart;y.bgWindowTileDataSelect&&(c=q.memoryLocationTileDataSelectOneStart);if(b.GBCEnabled||y.bgDisplayEnabled){var d=q.memoryLocationTileMapSelectZeroStart;y.bgTileMapDisplaySelect&&(d=q.memoryLocationTileMapSelectOneStart);Yb(a,
c,d,a+q.scrollY&255,0,q.scrollX)}if(y.windowDisplayEnabled){d=q.memoryLocationTileMapSelectZeroStart;y.windowTileMapDisplaySelect&&(d=q.memoryLocationTileMapSelectOneStart);var e=q.windowX,x=q.windowY;a<x||(e-=7,Yb(a,c,d,a-x,e,-e|0))}if(y.spriteDisplayEnable)for(c=y.tallSpriteSize,d=39;0<=d;--d){x=4*d;var h=q.memoryLocationSpriteAttributesTable+x,m=t(h+0);e=t(h+1);var k=t(h+2);m-=16;e-=8;var l=8;c&&(l=16,k-=k&1);if(a>=m&&a<m+l){x=t(q.memoryLocationSpriteAttributesTable+x+3);h=g(7,x);var n=g(6,x),
u=g(5,x);m=a-m;n&&(m=l-m,--m);m<<=1;k=ab(q.memoryLocationTileDataSelectOneStart,k);k+=m;l=b.GBCEnabled&&g(3,x);m=T(k+0,l);k=T(k+1,l);for(l=7;0<=l;--l){n=l;u&&(n-=7,n=-n);var p=0;g(n,k)&&(p=p+1<<1);g(n,m)&&(p+=1);if(0!==p&&(n=e+(7-l),0<=n&&160>=n)){var r=b.GBCEnabled&&!y.bgDisplayEnabled,v=!1,w=!1;if(!r){var z=f[Va+(160*a+n)],A=z&3;h&&0<A?v=!0:b.GBCEnabled&&g(2,z)&&0<A&&(w=!0)}if(r||!v&&!w)b.GBCEnabled?(v=hb(x&7,p,!0),p=pa(0,v),r=pa(1,v),v=pa(2,v),Y(n,a,0,p),Y(n,a,1,r),Y(n,a,2,v)):(r=q.memoryLocationSpritePaletteOne,
g(4,x)&&(r=q.memoryLocationSpritePaletteTwo),p=gb(p,r),Y(n,a,0,(p&16711680)>>16),Y(n,a,1,(p&65280)>>8),Y(n,a,2,p&255))}}}}}function Y(a,b,d,e){f[Za+3*(160*b+a)+d]=e}function T(a,b){return f[a-m.videoRamLocation+2048+8192*(b&1)]}function Ib(a){var c=m.videoRamLocation;return a<c||a>=c&&a<m.cartridgeRamLocation?-1:a>=m.echoRamLocation&&a<m.spriteInformationTableLocation?t(a-8192):a>=m.spriteInformationTableLocation&&a<=m.spriteInformationTableLocationEnd?2>y.currentLcdMode?255:-1:a===b.memoryLocationSpeedSwitch?
(a=255,c=t(b.memoryLocationSpeedSwitch),g(0,c)||(a=C(0,a)),b.GBCDoubleSpeed||(a=C(7,a)),a):a===q.memoryLocationScanlineRegister?(e(a,q.scanlineRegister),q.scanlineRegister):65296<=a&&65318>=a?(bb(),dc(a)):65319<=a&&65327>=a?255:65328<=a&&65343>=a?(bb(),u.isEnabled?u.handleWaveRamRead():-1):a===n.memoryLocationDividerRegister?(c=D(n.dividerRegister),e(a,c),c):a===n.memoryLocationTimerCounter?(e(a,n.timerCounter),n.timerCounter):a===k.memoryLocationInterruptRequest?224|k.interruptsRequestedValue:a===
A.memoryLocationJoypadRegister?(a=A.joypadRegisterFlipped,A.isDpadType?(a=A.up?C(2,a):a|4,a=A.right?C(0,a):a|1,a=A.down?C(3,a):a|8,a=A.left?C(1,a):a|2):A.isButtonType&&(a=A.a?C(0,a):a|1,a=A.b?C(1,a):a|2,a=A.select?C(2,a):a|4,a=A.start?C(3,a):a|8),a|240):-1}function t(a){return f[Fb(a)]}function Cb(a){a===W.readGbMemory&&(W.reachedBreakpoint=!0);var b=Ib(a);return-1===b?t(a):b}function K(a){return 0<f[a]}function Ea(a){var c=b.registerA;M(c,a);rb(c,a);c=c+a&255;b.registerA=c;r(0===c);v(0)}function Fa(a){var c=
b.registerA,d=c+a+Q()&255;G(0!=((c^a^d)&16));a=c+a+Q()&65535;I(0<(a&256));b.registerA=d;r(0===d);v(0)}function Ga(a){var c=-1*a;var d=b.registerA;M(d,c);rb(d,c);d=d-a&255;b.registerA=d;r(0===d);v(1)}function Ha(a){var c=b.registerA,d=c-a-Q()&255;G(0!=((c^a^d)&16));a=c-a-Q()&65535;I(0<(a&256));b.registerA=d;r(0===d);v(1)}function Ia(a){a&=b.registerA;b.registerA=a;r(0===a);v(0);G(1);I(0)}function Ja(a){a=(b.registerA^a)&255;b.registerA=a;r(0===a);v(0);G(0);I(0)}function Ka(a){a|=b.registerA;b.registerA=
a;r(0===a);v(0);G(0);I(0)}function La(a){var c=b.registerA;a*=-1;M(c,a);rb(c,a);r(0===c+a);v(1)}function Pa(a,b){r(0===(b&1<<a));v(0);G(1);return b}function X(a,b,d){return 0<b?d|1<<a:d&~(1<<a)}function db(a){var c=b.programCounter;c=(c+(a<<24>>24)&65535)+1&65535;b.programCounter=c}function $b(a){var c=b.programCounter;c=c+1&65535;b.isHaltBug&&(c=c-1&65535);b.programCounter=c;switch((a&240)>>4){case 0:return fc(a);case 1:return gc(a);case 2:return hc(a);case 3:return ic(a);case 4:return jc(a);case 5:return kc(a);
case 6:return lc(a);case 7:return mc(a);case 8:return nc(a);case 9:return oc(a);case 10:return pc(a);case 11:return qc(a);case 12:return rc(a);case 13:return sc(a);case 14:return tc(a);default:return uc(a)}}function H(a){Ma(4);return Cb(a)}function P(a,b){Ma(4);Db(a,b)}function Ca(a){Ma(8);var b=Ib(a);b=-1===b?t(a):b;a+=1;var d=Ib(a);a=-1===d?t(a):d;return l(a,b)}function R(a,b){Ma(8);var c=D(b);b&=255;Eb(a,b)&&e(a,b);a+=1;Eb(a,c)&&e(a,c)}function F(){Ma(4);return t(b.programCounter)}function U(){Ma(4);
var a=t(b.programCounter+1&65535);return l(a,F())}function fc(a){switch(a){case 0:return 4;case 1:return a=U(),b.registerB=D(a),b.registerC=a&255,b.programCounter=b.programCounter+2&65535,4;case 2:return P(l(b.registerB,b.registerC),b.registerA),4;case 3:return a=l(b.registerB,b.registerC),a++,b.registerB=D(a),b.registerC=a&255,8;case 4:return a=b.registerB,M(a,1),a=a+1&255,b.registerB=a,r(0===a),v(0),4;case 5:return a=b.registerB,M(a,-1),a=a-1&255,b.registerB=a,r(0===a),v(1),4;case 6:return b.registerB=
F(),b.programCounter=b.programCounter+1&65535,4;case 7:return a=b.registerA,I(128===(a&128)),b.registerA=(a<<1|a>>7)&255,r(0),v(0),G(0),4;case 8:return R(U(),b.stackPointer),b.programCounter=b.programCounter+2&65535,4;case 9:a=l(b.registerH,b.registerL);var c=l(b.registerB,b.registerC);Sa(a,c,!1);a=a+c&65535;b.registerH=D(a);b.registerL=a&255;v(0);return 8;case 10:return b.registerA=H(l(b.registerB,b.registerC)),4;case 11:return a=l(b.registerB,b.registerC),a=a-1&65535,b.registerB=D(a),b.registerC=
a&255,8;case 12:return a=b.registerC,M(a,1),a=a+1&255,b.registerC=a,r(0===a),v(0),4;case 13:return a=b.registerC,M(a,-1),a=a-1&255,b.registerC=a,r(0===a),v(1),4;case 14:return b.registerC=F(),b.programCounter=b.programCounter+1&65535,4;case 15:return a=b.registerA,I(0<(a&1)),b.registerA=(a>>1|a<<7)&255,r(0),v(0),G(0),4}return-1}function gc(a){switch(a){case 16:if(b.GBCEnabled&&(a=H(b.memoryLocationSpeedSwitch),g(0,a)))return a=C(0,a),g(7,a)?(b.GBCDoubleSpeed=!1,a=C(7,a)):(b.GBCDoubleSpeed=!0,a|=128),
P(b.memoryLocationSpeedSwitch,a),68;b.isStopped=!0;b.programCounter=b.programCounter+1&65535;return 4;case 17:return a=U(),b.registerD=D(a),b.registerE=a&255,b.programCounter=b.programCounter+2&65535,4;case 18:return P(l(b.registerD,b.registerE),b.registerA),4;case 19:return a=l(b.registerD,b.registerE),a=a+1&65535,b.registerD=D(a),b.registerE=a&255,8;case 20:return a=b.registerD,M(a,1),b.registerD=a+1&255,r(0===b.registerD),v(0),4;case 21:return a=b.registerD,M(a,-1),b.registerD=a-1&255,r(0===b.registerD),
v(1),4;case 22:return b.registerD=F(),b.programCounter=b.programCounter+1&65535,4;case 23:return a=128===(b.registerA&128),b.registerA=(b.registerA<<1|Q())&255,I(a),r(0),v(0),G(0),4;case 24:return db(F()),8;case 25:a=l(b.registerH,b.registerL);var c=l(b.registerD,b.registerE);Sa(a,c,!1);a=a+c&65535;b.registerH=D(a);b.registerL=a&255;v(0);return 8;case 26:return a=l(b.registerD,b.registerE),b.registerA=H(a),4;case 27:return a=l(b.registerD,b.registerE),a=a-1&65535,b.registerD=D(a),b.registerE=a&255,
8;case 28:return a=b.registerE,M(a,1),a=a+1&255,b.registerE=a,r(0===a),v(0),4;case 29:return a=b.registerE,M(a,-1),a=a-1&255,b.registerE=a,r(0===a),v(1),4;case 30:return b.registerE=F(),b.programCounter=b.programCounter+1&65535,4;case 31:return a=1===(b.registerA&1),b.registerA=(b.registerA>>1|Q()<<7)&255,I(a),r(0),v(0),G(0),4}return-1}function hc(a){switch(a){case 32:return 0===Na()?db(F()):b.programCounter=b.programCounter+1&65535,8;case 33:return a=U(),b.registerH=D(a),b.registerL=a&255,b.programCounter=
b.programCounter+2&65535,4;case 34:return a=l(b.registerH,b.registerL),P(a,b.registerA),a=a+1&65535,b.registerH=D(a),b.registerL=a&255,4;case 35:return a=l(b.registerH,b.registerL),a=a+1&65535,b.registerH=D(a),b.registerL=a&255,8;case 36:return a=b.registerH,M(a,1),a=a+1&255,b.registerH=a,r(0===a),v(0),4;case 37:return a=b.registerH,M(a,-1),a=a-1&255,b.registerH=a,r(0===a),v(1),4;case 38:return b.registerH=F(),b.programCounter=b.programCounter+1&65535,4;case 39:a=0;0<(b.registerF>>5&1)&&(a|=6);0<
Q()&&(a|=96);var c=b.registerA;0<(b.registerF>>6&1)?c=c-a&255:(9<(c&15)&&(a|=6),153<c&&(a|=96),c=c+a&255);r(0===c);I(0!==(a&96));G(0);b.registerA=c;return 4;case 40:return 0<Na()?db(F()):b.programCounter=b.programCounter+1&65535,8;case 41:return a=l(b.registerH,b.registerL),Sa(a,a,!1),a=2*a&65535,b.registerH=D(a),b.registerL=a&255,v(0),8;case 42:return a=l(b.registerH,b.registerL),b.registerA=H(a),a=a+1&65535,b.registerH=D(a),b.registerL=a&255,4;case 43:return a=l(b.registerH,b.registerL),a=a-1&65535,
b.registerH=D(a),b.registerL=a&255,8;case 44:return a=b.registerL,M(a,1),a=a+1&255,b.registerL=a,r(0===a),v(0),4;case 45:return a=b.registerL,M(a,-1),a=a-1&255,b.registerL=a,r(0===a),v(1),4;case 46:return b.registerL=F(),b.programCounter=b.programCounter+1&65535,4;case 47:return b.registerA=~b.registerA,v(1),G(1),4}return-1}function ic(a){switch(a){case 48:return 0===Q()?db(F()):b.programCounter=b.programCounter+1&65535,8;case 49:return b.stackPointer=U(),b.programCounter=b.programCounter+2&65535,
4;case 50:return a=l(b.registerH,b.registerL),P(a,b.registerA),a=a-1&65535,b.registerH=D(a),b.registerL=a&255,4;case 51:return b.stackPointer=b.stackPointer+1&65535,8;case 52:a=l(b.registerH,b.registerL);var c=H(a);M(c,1);c=c+1&255;r(0===c);v(0);P(a,c);return 4;case 53:return a=l(b.registerH,b.registerL),c=H(a),M(c,-1),c=c-1&255,r(0===c),v(1),P(a,c),4;case 54:return P(l(b.registerH,b.registerL),F()),b.programCounter=b.programCounter+1&65535,4;case 55:return v(0),G(0),I(1),4;case 56:return 1===Q()?
db(F()):b.programCounter=b.programCounter+1&65535,8;case 57:return a=l(b.registerH,b.registerL),Sa(a,b.stackPointer,!1),a=a+b.stackPointer&65535,b.registerH=D(a),b.registerL=a&255,v(0),8;case 58:return a=l(b.registerH,b.registerL),b.registerA=H(a),a=a-1&65535,b.registerH=D(a),b.registerL=a&255,4;case 59:return b.stackPointer=b.stackPointer-1&65535,8;case 60:return a=b.registerA,M(a,1),a=a+1&255,b.registerA=a,r(0===a),v(0),4;case 61:return a=b.registerA,M(a,-1),a=a-1&255,b.registerA=a,r(0===a),v(1),
4;case 62:return b.registerA=F(),b.programCounter=b.programCounter+1&65535,4;case 63:return v(0),G(0),I(0>=Q()),4}return-1}function jc(a){switch(a){case 64:return 4;case 65:return b.registerB=b.registerC,4;case 66:return b.registerB=b.registerD,4;case 67:return b.registerB=b.registerE,4;case 68:return b.registerB=b.registerH,4;case 69:return b.registerB=b.registerL,4;case 70:return b.registerB=H(l(b.registerH,b.registerL)),4;case 71:return b.registerB=b.registerA,4;case 72:return b.registerC=b.registerB,
4;case 73:return 4;case 74:return b.registerC=b.registerD,4;case 75:return b.registerC=b.registerE,4;case 76:return b.registerC=b.registerH,4;case 77:return b.registerC=b.registerL,4;case 78:return b.registerC=H(l(b.registerH,b.registerL)),4;case 79:return b.registerC=b.registerA,4}return-1}function kc(a){switch(a){case 80:return b.registerD=b.registerB,4;case 81:return b.registerD=b.registerC,4;case 82:return 4;case 83:return b.registerD=b.registerE,4;case 84:return b.registerD=b.registerH,4;case 85:return b.registerD=
b.registerL,4;case 86:return b.registerD=H(l(b.registerH,b.registerL)),4;case 87:return b.registerD=b.registerA,4;case 88:return b.registerE=b.registerB,4;case 89:return b.registerE=b.registerC,4;case 90:return b.registerE=b.registerD,4;case 91:return 4;case 92:return b.registerE=b.registerH,4;case 93:return b.registerE=b.registerL,4;case 94:return b.registerE=H(l(b.registerH,b.registerL)),4;case 95:return b.registerE=b.registerA,4}return-1}function lc(a){switch(a){case 96:return b.registerH=b.registerB,
4;case 97:return b.registerH=b.registerC,4;case 98:return b.registerH=b.registerD,4;case 99:return b.registerH=b.registerE,4;case 100:return b.registerH=b.registerH,4;case 101:return b.registerH=b.registerL,4;case 102:return b.registerH=H(l(b.registerH,b.registerL)),4;case 103:return b.registerH=b.registerA,4;case 104:return b.registerL=b.registerB,4;case 105:return b.registerL=b.registerC,4;case 106:return b.registerL=b.registerD,4;case 107:return b.registerL=b.registerE,4;case 108:return b.registerL=
b.registerH,4;case 109:return b.registerL=b.registerL,4;case 110:return b.registerL=H(l(b.registerH,b.registerL)),4;case 111:return b.registerL=b.registerA,4}return-1}function mc(a){switch(a){case 112:return P(l(b.registerH,b.registerL),b.registerB),4;case 113:return P(l(b.registerH,b.registerL),b.registerC),4;case 114:return P(l(b.registerH,b.registerL),b.registerD),4;case 115:return P(l(b.registerH,b.registerL),b.registerE),4;case 116:return P(l(b.registerH,b.registerL),b.registerH),4;case 117:return P(l(b.registerH,
b.registerL),b.registerL),4;case 118:return m.isHblankHdmaActive||b.enableHalt(),4;case 119:return P(l(b.registerH,b.registerL),b.registerA),4;case 120:return b.registerA=b.registerB,4;case 121:return b.registerA=b.registerC,4;case 122:return b.registerA=b.registerD,4;case 123:return b.registerA=b.registerE,4;case 124:return b.registerA=b.registerH,4;case 125:return b.registerA=b.registerL,4;case 126:return b.registerA=H(l(b.registerH,b.registerL)),4;case 127:return 4}return-1}function nc(a){switch(a){case 128:return Ea(b.registerB),
4;case 129:return Ea(b.registerC),4;case 130:return Ea(b.registerD),4;case 131:return Ea(b.registerE),4;case 132:return Ea(b.registerH),4;case 133:return Ea(b.registerL),4;case 134:return a=H(l(b.registerH,b.registerL)),Ea(a),4;case 135:return Ea(b.registerA),4;case 136:return Fa(b.registerB),4;case 137:return Fa(b.registerC),4;case 138:return Fa(b.registerD),4;case 139:return Fa(b.registerE),4;case 140:return Fa(b.registerH),4;case 141:return Fa(b.registerL),4;case 142:return a=H(l(b.registerH,b.registerL)),
Fa(a),4;case 143:return Fa(b.registerA),4}return-1}function oc(a){switch(a){case 144:return Ga(b.registerB),4;case 145:return Ga(b.registerC),4;case 146:return Ga(b.registerD),4;case 147:return Ga(b.registerE),4;case 148:return Ga(b.registerH),4;case 149:return Ga(b.registerL),4;case 150:return a=H(l(b.registerH,b.registerL)),Ga(a),4;case 151:return Ga(b.registerA),4;case 152:return Ha(b.registerB),4;case 153:return Ha(b.registerC),4;case 154:return Ha(b.registerD),4;case 155:return Ha(b.registerE),
4;case 156:return Ha(b.registerH),4;case 157:return Ha(b.registerL),4;case 158:return a=H(l(b.registerH,b.registerL)),Ha(a),4;case 159:return Ha(b.registerA),4}return-1}function pc(a){switch(a){case 160:return Ia(b.registerB),4;case 161:return Ia(b.registerC),4;case 162:return Ia(b.registerD),4;case 163:return Ia(b.registerE),4;case 164:return Ia(b.registerH),4;case 165:return Ia(b.registerL),4;case 166:return a=H(l(b.registerH,b.registerL)),Ia(a),4;case 167:return Ia(b.registerA),4;case 168:return Ja(b.registerB),
4;case 169:return Ja(b.registerC),4;case 170:return Ja(b.registerD),4;case 171:return Ja(b.registerE),4;case 172:return Ja(b.registerH),4;case 173:return Ja(b.registerL),4;case 174:return a=H(l(b.registerH,b.registerL)),Ja(a),4;case 175:return Ja(b.registerA),4}return-1}function qc(a){switch(a){case 176:return Ka(b.registerB),4;case 177:return Ka(b.registerC),4;case 178:return Ka(b.registerD),4;case 179:return Ka(b.registerE),4;case 180:return Ka(b.registerH),4;case 181:return Ka(b.registerL),4;case 182:return a=
H(l(b.registerH,b.registerL)),Ka(a),4;case 183:return Ka(b.registerA),4;case 184:return La(b.registerB),4;case 185:return La(b.registerC),4;case 186:return La(b.registerD),4;case 187:return La(b.registerE),4;case 188:return La(b.registerH),4;case 189:return La(b.registerL),4;case 190:return a=H(l(b.registerH,b.registerL)),La(a),4;case 191:return La(b.registerA),4}return-1}function rc(a){switch(a){case 192:return 0===Na()?(a=b.stackPointer,b.programCounter=Ca(a),b.stackPointer=a+2&65535,12):8;case 193:return a=
Ca(b.stackPointer),b.stackPointer=b.stackPointer+2&65535,b.registerB=D(a),b.registerC=a&255,4;case 194:if(0===Na())return b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 195:return b.programCounter=U(),8;case 196:if(0===Na())return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2&65535),b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 197:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,l(b.registerB,b.registerC)),
8;case 198:return Ea(F()),b.programCounter=b.programCounter+1&65535,4;case 199:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=0,8;case 200:return 1===Na()?(a=b.stackPointer,b.programCounter=Ca(a),b.stackPointer=a+2&65535,12):8;case 201:return a=b.stackPointer,b.programCounter=Ca(a),b.stackPointer=a+2&65535,8;case 202:if(1===Na())return b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 203:var c=F();a=-1;var d=!1,e=0,f=0,g=c&7;
switch(g){case 0:e=b.registerB;break;case 1:e=b.registerC;break;case 2:e=b.registerD;break;case 3:e=b.registerE;break;case 4:e=b.registerH;break;case 5:e=b.registerL;break;case 6:e=H(l(b.registerH,b.registerL));break;case 7:e=b.registerA}var h=(c&240)>>4;switch(h){case 0:7>=c?(c=e,I(128===(c&128)),c=(c<<1|c>>7)&255,r(0===c),v(0),G(0),f=c,d=!0):15>=c&&(c=e,I(0<(c&1)),c=(c>>1|c<<7)&255,r(0===c),v(0),G(0),f=c,d=!0);break;case 1:23>=c?(c=e,d=128===(c&128),c=(c<<1|Q())&255,I(d),r(0===c),v(0),G(0),f=c,
d=!0):31>=c&&(c=e,d=1===(c&1),c=(c>>1|Q()<<7)&255,I(d),r(0===c),v(0),G(0),f=c,d=!0);break;case 2:39>=c?(c=e,d=128===(c&128),c=c<<1&255,I(d),r(0===c),v(0),G(0),f=c,d=!0):47>=c&&(c=e,d=128===(c&128),e=1===(c&1),c=c>>1&255,d&&(c|=128),r(0===c),v(0),G(0),I(e),f=c,d=!0);break;case 3:55>=c?(c=e,c=((c&15)<<4|(c&240)>>4)&255,r(0===c),v(0),G(0),I(0),f=c,d=!0):63>=c&&(c=e,d=1===(c&1),c=c>>1&255,r(0===c),v(0),G(0),I(d),f=c,d=!0);break;case 4:71>=c?(f=Pa(0,e),d=!0):79>=c&&(f=Pa(1,e),d=!0);break;case 5:87>=c?
(f=Pa(2,e),d=!0):95>=c&&(f=Pa(3,e),d=!0);break;case 6:103>=c?(f=Pa(4,e),d=!0):111>=c&&(f=Pa(5,e),d=!0);break;case 7:119>=c?(f=Pa(6,e),d=!0):127>=c&&(f=Pa(7,e),d=!0);break;case 8:135>=c?(f=X(0,0,e),d=!0):143>=c&&(f=X(1,0,e),d=!0);break;case 9:151>=c?(f=X(2,0,e),d=!0):159>=c&&(f=X(3,0,e),d=!0);break;case 10:167>=c?(f=X(4,0,e),d=!0):175>=c&&(f=X(5,0,e),d=!0);break;case 11:183>=c?(f=X(6,0,e),d=!0):191>=c&&(f=X(7,0,e),d=!0);break;case 12:199>=c?(f=X(0,1,e),d=!0):207>=c&&(f=X(1,1,e),d=!0);break;case 13:215>=
c?(f=X(2,1,e),d=!0):223>=c&&(f=X(3,1,e),d=!0);break;case 14:231>=c?(f=X(4,1,e),d=!0):239>=c&&(f=X(5,1,e),d=!0);break;case 15:247>=c?(f=X(6,1,e),d=!0):255>=c&&(f=X(7,1,e),d=!0)}switch(g){case 0:b.registerB=f;break;case 1:b.registerC=f;break;case 2:b.registerD=f;break;case 3:b.registerE=f;break;case 4:b.registerH=f;break;case 5:b.registerL=f;break;case 6:(4>h||7<h)&&P(l(b.registerH,b.registerL),f);break;case 7:b.registerA=f}d&&(a=4);b.programCounter=b.programCounter+1&65535;return a;case 204:if(1===
Na())return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2),b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 205:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2&65535),b.programCounter=U(),8;case 206:return Fa(F()),b.programCounter=b.programCounter+1&65535,4;case 207:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=8}return-1}function sc(a){switch(a){case 208:return 0===Q()?(a=b.stackPointer,
b.programCounter=Ca(a),b.stackPointer=a+2&65535,12):8;case 209:a=b.stackPointer;var c=Ca(a);b.stackPointer=a+2&65535;b.registerD=D(c);b.registerE=c&255;return 4;case 210:if(0===Q())return b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 212:if(0===Q())return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2),b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 213:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,l(b.registerD,
b.registerE)),8;case 214:return Ga(F()),b.programCounter=b.programCounter+1&65535,4;case 215:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=16,8;case 216:return 1===Q()?(a=b.stackPointer,b.programCounter=Ca(a),b.stackPointer=a+2&65535,12):8;case 217:return a=b.stackPointer,b.programCounter=Ca(a),mb(!0),b.stackPointer=a+2&65535,8;case 218:if(1===Q())return b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 220:if(1===Q())return a=
b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter+2&65535),b.programCounter=U(),8;b.programCounter=b.programCounter+2&65535;return 12;case 222:return Ha(F()),b.programCounter=b.programCounter+1&65535,4;case 223:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=24,8}return-1}function tc(a){switch(a){case 224:return a=F(),P(65280+a,b.registerA),b.programCounter=b.programCounter+1&65535,4;case 225:a=b.stackPointer;var c=Ca(a);b.stackPointer=a+2&65535;
b.registerH=D(c);b.registerL=c&255;return 4;case 226:return P(65280+b.registerC,b.registerA),4;case 229:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,l(b.registerH,b.registerL)),8;case 230:return Ia(F()),b.programCounter=b.programCounter+1&65535,4;case 231:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=32,8;case 232:return a=F()<<24>>24,Sa(b.stackPointer,a,!0),b.stackPointer=b.stackPointer+a&65535,r(0),v(0),b.programCounter=b.programCounter+1&65535,
12;case 233:return b.programCounter=l(b.registerH,b.registerL),4;case 234:return P(U(),b.registerA),b.programCounter=b.programCounter+2&65535,4;case 238:return Ja(F()),b.programCounter=b.programCounter+1&65535,4;case 239:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=40,8}return-1}function uc(a){switch(a){case 240:return a=F(),b.registerA=H(65280+a)&255,b.programCounter=b.programCounter+1&65535,4;case 241:a=b.stackPointer;var c=Ca(a);b.stackPointer=a+2&65535;
b.registerA=D(c);b.registerF=c&255;return 4;case 242:return b.registerA=H(65280+b.registerC)&255,4;case 243:return mb(!1),4;case 245:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,l(b.registerA,b.registerF)),8;case 246:return Ka(F()),b.programCounter=b.programCounter+1&65535,4;case 247:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=48,8;case 248:return c=F()<<24>>24,a=b.stackPointer,r(0),v(0),Sa(a,c,!0),a=a+c&65535,b.registerH=D(a),b.registerL=a&255,
b.programCounter=b.programCounter+1&65535,8;case 249:return b.stackPointer=l(b.registerH,b.registerL),8;case 250:return b.registerA=H(U()),b.programCounter=b.programCounter+2&65535,4;case 251:return mb(!0),4;case 254:return La(F()),b.programCounter=b.programCounter+1&65535,4;case 255:return a=b.stackPointer-2&65535,b.stackPointer=a,R(a,b.programCounter),b.programCounter=56,8}return-1}function Ma(a){0<m.DMACycles&&(a+=m.DMACycles,m.DMACycles=0);b.currentCycles+=a;if(!b.isStopped){if(L.graphicsBatchProcessing){q.currentCycles+=
a;for(var c=q.batchProcessCycles();q.currentCycles>=c;)Zb(c),q.currentCycles-=c}else Zb(a);L.audioBatchProcessing?(h.currentCycles+=a,bb()):Qb(a);c=a;if(V.transferStartFlag)for(var d=0;d<c;){var f=V.currentCycles,l=f;d+=4;l+=4;65535<l&&(l-=65536);V.currentCycles=l;var p=V.isClockSpeedFast?2:7;g(p,f)&&!g(p,l)&&(f=V.memoryLocationSerialTransferData,l=t(f),l=(l<<1)+1,l&=255,e(f,l),f=V.numberOfBitsTransferred,8===++f?(V.numberOfBitsTransferred=0,k.isSerialInterruptRequested=!0,Ya(k.bitPositionSerialInterrupt),
f=V.memoryLocationSerialTransferControl,l=t(f),e(f,C(7,l)),V.transferStartFlag=!1):V.numberOfBitsTransferred=f)}}L.timersBatchProcessing?(n.currentCycles+=a,zb(n.currentCycles),n.currentCycles=0):zb(a);c=Z.cycles;c+=a;c>=Z.cyclesPerCycleSet&&(Z.cycleSets+=1,c-=Z.cyclesPerCycleSet);Z.cycles=c}function ac(){return Jb(!0,-1)}function Jb(a,c){void 0===c&&(c=-1);a=1024;0<c?a=c:0>c&&(a=-1);for(var d=!1,e=!1,f=!1;!(d||e||f||W.reachedBreakpoint);)c=bc(),0>c?d=!0:b.currentCycles>=b.MAX_CYCLES_PER_FRAME()?
e=!0:-1<a&&Rb()>=a&&(f=!0);if(e)return b.currentCycles-=b.MAX_CYCLES_PER_FRAME(),S.RESPONSE_CONDITION_FRAME;if(f)return S.RESPONSE_CONDITION_AUDIO;if(W.reachedBreakpoint)return W.reachedBreakpoint=!1,S.RESPONSE_CONDITION_BREAKPOINT;b.programCounter=b.programCounter-1&65535;return-1}function bc(){eb=!0;if(b.isHaltBug){var a=t(b.programCounter);a=$b(a);Ma(a);b.exitHaltAndStop()}k.masterInterruptSwitchDelay&&(k.masterInterruptSwitch=!0,k.masterInterruptSwitchDelay=!1);if(0<(k.interruptsEnabledValue&
k.interruptsRequestedValue&31)){a=!1;k.masterInterruptSwitch&&!b.isHaltNoJump&&(k.isVBlankInterruptEnabled&&k.isVBlankInterruptRequested?(cb(k.bitPositionVBlankInterrupt),a=!0):k.isLcdInterruptEnabled&&k.isLcdInterruptRequested?(cb(k.bitPositionLcdInterrupt),a=!0):k.isTimerInterruptEnabled&&k.isTimerInterruptRequested?(cb(k.bitPositionTimerInterrupt),a=!0):k.isSerialInterruptEnabled&&k.isSerialInterruptRequested?(cb(k.bitPositionSerialInterrupt),a=!0):k.isJoypadInterruptEnabled&&k.isJoypadInterruptRequested&&
(cb(k.bitPositionJoypadInterrupt),a=!0));var c=0;a&&(c=20,b.isHalted()&&(b.exitHaltAndStop(),c+=4));b.isHalted()&&b.exitHaltAndStop();a=c}else a=0;0<a&&Ma(a);a=4;b.isHalted()||b.isStopped||(a=t(b.programCounter),a=$b(a));b.registerF&=240;if(0>=a)return a;Ma(a);c=S.steps;c+=1;c>=S.stepsPerStepSet&&(S.stepSets+=1,c-=S.stepsPerStepSet);S.steps=c;b.programCounter===W.programCounter&&(W.reachedBreakpoint=!0);return a}const f=new Uint8ClampedArray(9109504),fb={size:()=>9109504,grow:()=>{},wasmByteMemory:f};
var vc=65536,Ua=67584,Va=Ua+128,Za=Va+23552,pb=Za+93184,Kb=pb+196608,qb=Kb+147456,wc=Ua,xc=qb-Ua+15360,vb=qb+15360,wb=vb+131072,xb=wb+131072,yb=xb+131072,lb=yb+131072,Gb=lb+131072,nb=Gb+131072,ob=nb+2560,Lb=ob+8258560,cc=Lb+65535+1,Mb=Math.ceil(cc/1024/64)+1,L=function(){function a(){}a.enableBootRom=!1;a.useGbcWhenAvailable=!0;a.audioBatchProcessing=!1;a.graphicsBatchProcessing=!1;a.timersBatchProcessing=!1;a.graphicsDisableScanlineRendering=!1;a.audioAccumulateSamples=!1;a.tileRendering=!1;a.tileCaching=
!1;a.enableAudioDebugging=!1;return a}(),J=function(){function a(){}a.bgWhite=15921906;a.bgLightGrey=10526880;a.bgDarkGrey=5789784;a.bgBlack=526344;a.obj0White=15921906;a.obj0LightGrey=10526880;a.obj0DarkGrey=5789784;a.obj0Black=526344;a.obj1White=15921906;a.obj1LightGrey=10526880;a.obj1DarkGrey=5789784;a.obj1Black=526344;return a}(),fa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=5439232;a.bgDarkGrey=16728576;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=5439232;a.obj0DarkGrey=16728576;
a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=5439232;a.obj1DarkGrey=16728576;a.obj1Black=0;return a}(),ka=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16776960;a.bgDarkGrey=16711680;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16776960;a.obj0DarkGrey=16711680;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16776960;a.obj1DarkGrey=16711680;a.obj1Black=0;return a}(),ca=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16756067;a.bgDarkGrey=8663296;a.bgBlack=0;a.obj0White=
16777215;a.obj0LightGrey=16756067;a.obj0DarkGrey=8663296;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),ia=function(){function a(){}a.bgWhite=0;a.bgLightGrey=33924;a.bgDarkGrey=16768512;a.bgBlack=16777215;a.obj0White=0;a.obj0LightGrey=33924;a.obj0DarkGrey=16768512;a.obj0Black=16777215;a.obj1White=0;a.obj1LightGrey=33924;a.obj1DarkGrey=16768512;a.obj1Black=16777215;return a}(),oa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=
10855845;a.bgDarkGrey=5395026;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=10855845;a.obj0DarkGrey=5395026;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=10855845;a.obj1DarkGrey=5395026;a.obj1Black=0;return a}(),ja=function(){function a(){}a.bgWhite=16777125;a.bgLightGrey=16749716;a.bgDarkGrey=9737471;a.bgBlack=0;a.obj0White=16777125;a.obj0LightGrey=16749716;a.obj0DarkGrey=9737471;a.obj0Black=0;a.obj1White=16777125;a.obj1LightGrey=16749716;a.obj1DarkGrey=9737471;a.obj1Black=0;return a}(),
ea=function(){function a(){}a.bgWhite=16770757;a.bgLightGrey=13540484;a.bgDarkGrey=8678185;a.bgBlack=5910792;a.obj0White=16777215;a.obj0LightGrey=16756067;a.obj0DarkGrey=8663296;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),ha=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=8126257;a.bgDarkGrey=25541;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=
16745604;a.obj1DarkGrey=9714234;a.obj1Black=0;return a}(),na=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=9211102;a.bgDarkGrey=5395084;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),da=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=8126257;a.obj0DarkGrey=
33792;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),ma=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=255;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),la=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16776960;a.bgDarkGrey=8079872;a.bgBlack=0;a.obj0White=16777215;
a.obj0LightGrey=6530559;a.obj0DarkGrey=255;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),qa=function(){function a(){}a.bgWhite=10853631;a.bgLightGrey=16776960;a.bgDarkGrey=25344;a.bgBlack=0;a.obj0White=10853631;a.obj0LightGrey=16776960;a.obj0DarkGrey=25344;a.obj0Black=0;a.obj1White=10853631;a.obj1LightGrey=16776960;a.obj1DarkGrey=25344;a.obj1Black=0;return a}(),ra=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=
255;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16745604;a.obj0DarkGrey=9714234;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),sa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=8126257;a.obj0DarkGrey=33792;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=16745604;a.obj1DarkGrey=9714234;a.obj1Black=0;return a}(),ta=function(){function a(){}a.bgWhite=
11908607;a.bgLightGrey=16777108;a.bgDarkGrey=11360834;a.bgBlack=0;a.obj0White=0;a.obj0LightGrey=16777215;a.obj0DarkGrey=16745604;a.obj0Black=9714234;a.obj1White=0;a.obj1LightGrey=16777215;a.obj1DarkGrey=16745604;a.obj1Black=9714234;return a}(),ua=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=11382148;a.bgDarkGrey=4354939;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16741120;a.obj0DarkGrey=9716224;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=5946879;a.obj1DarkGrey=16711680;a.obj1Black=
255;return a}(),va=function(){function a(){}a.bgWhite=16777116;a.bgLightGrey=9745919;a.bgDarkGrey=6526067;a.bgBlack=14906;a.obj0White=16762178;a.obj0LightGrey=16766464;a.obj0DarkGrey=9714176;a.obj0Black=4849664;a.obj1White=16777215;a.obj1LightGrey=16745604;a.obj1DarkGrey=9714234;a.obj1Black=0;return a}(),wa=function(){function a(){}a.bgWhite=7077632;a.bgLightGrey=16777215;a.bgDarkGrey=16732746;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16777215;a.obj0DarkGrey=6530559;a.obj0Black=255;a.obj1White=
16777215;a.obj1LightGrey=16756067;a.obj1DarkGrey=8663296;a.obj1Black=0;return a}(),xa=function(){function a(){}a.bgWhite=10853631;a.bgLightGrey=16776960;a.bgDarkGrey=25344;a.bgBlack=0;a.obj0White=16737106;a.obj0LightGrey=14024704;a.obj0DarkGrey=6488064;a.obj0Black=0;a.obj1White=255;a.obj1LightGrey=16777215;a.obj1DarkGrey=16777083;a.obj1Black=34047;return a}(),ya=function(){function a(){}a.bgWhite=16777166;a.bgLightGrey=6549487;a.bgDarkGrey=10257457;a.bgBlack=5921370;a.obj0White=16777215;a.obj0LightGrey=
16741120;a.obj0DarkGrey=9716224;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),za=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=16745604;a.bgDarkGrey=9714234;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=65280;a.obj0DarkGrey=3245056;a.obj0Black=18944;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),Aa=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=6530559;a.bgDarkGrey=255;a.bgBlack=
0;a.obj0White=16776960;a.obj0LightGrey=16711680;a.obj0DarkGrey=6488064;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=8126257;a.obj1DarkGrey=33792;a.obj1Black=0;return a}(),Ba=function(){function a(){}a.bgWhite=16777215;a.bgLightGrey=11382148;a.bgDarkGrey=4354939;a.bgBlack=0;a.obj0White=16777215;a.obj0LightGrey=16756067;a.obj0DarkGrey=16756067;a.obj0Black=0;a.obj1White=16777215;a.obj1LightGrey=6530559;a.obj1DarkGrey=255;a.obj1Black=0;return a}(),d=function(){function a(){}a.bgWhite=J.bgWhite;
a.bgLightGrey=J.bgLightGrey;a.bgDarkGrey=J.bgDarkGrey;a.bgBlack=J.bgBlack;a.obj0White=J.obj0White;a.obj0LightGrey=J.obj0LightGrey;a.obj0DarkGrey=J.obj0DarkGrey;a.obj0Black=J.obj0Black;a.obj1White=J.obj1White;a.obj1LightGrey=J.obj1LightGrey;a.obj1DarkGrey=J.obj1DarkGrey;a.obj1Black=J.obj1Black;return a}(),Ta=function(){function a(){}a.memoryLocationBackgroundPaletteIndex=65384;a.memoryLocationBackgroundPaletteData=65385;a.memoryLocationSpritePaletteIndex=65386;a.memoryLocationSpritePaletteData=65387;
a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;return a}(),$a=function(){function a(){}a.tileId=-1;a.horizontalFlip=!1;a.nextXIndexToPerformCacheCheck=-1;return a}(),p=function(){function a(){}a.updateNRx0=function(b){var c=a.NRx0Negate;a.NRx0SweepPeriod=(b&112)>>4;a.NRx0Negate=g(3,b);a.NRx0SweepShift=b&7;c&&!a.NRx0Negate&&a.sweepNegateShouldDisableChannelOnClear&&(a.isEnabled=!1)};a.updateNRx1=function(b){a.NRx1Duty=b>>6&3;a.NRx1LengthLoad=
b&63;a.lengthCounter=a.MAX_LENGTH-a.NRx1LengthLoad};a.updateNRx2=function(b){a.NRx2StartingVolume=b>>4&15;a.NRx2EnvelopeAddMode=g(3,b);a.NRx2EnvelopePeriod=b&7;b=0<(b&248);a.isDacEnabled=b;b||(a.isEnabled=b)};a.updateNRx3=function(b){a.NRx3FrequencyLSB=b;a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){var c=b&7;a.NRx4FrequencyMSB=c;a.frequency=c<<8|a.NRx3FrequencyLSB;c=1===(h.frameSequencer&1);var d=!a.NRx4LengthEnabled&&g(6,b);!c&&0<a.lengthCounter&&d&&(--a.lengthCounter,g(7,b)||0!==
a.lengthCounter||(a.isEnabled=!1));a.NRx4LengthEnabled=g(6,b);g(7,b)&&(a.trigger(),!c&&a.lengthCounter===a.MAX_LENGTH&&a.NRx4LengthEnabled&&--a.lengthCounter)};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;f[1025+50*a.saveStateSlot]=a.frequencyTimer;f[1029+50*a.saveStateSlot]=a.envelopeCounter;f[1033+50*a.saveStateSlot]=a.lengthCounter;f[1038+50*a.saveStateSlot]=a.volume;f[1043+50*a.saveStateSlot]=a.dutyCycle;f[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty;f[1049+50*a.saveStateSlot]=
a.isSweepEnabled;f[1050+50*a.saveStateSlot]=a.sweepCounter;f[1055+50*a.saveStateSlot]=a.sweepShadowFrequency};a.loadState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;a.frequencyTimer=f[1025+50*a.saveStateSlot];a.envelopeCounter=f[1029+50*a.saveStateSlot];a.lengthCounter=f[1033+50*a.saveStateSlot];a.volume=f[1038+50*a.saveStateSlot];a.dutyCycle=f[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=f[1044+50*a.saveStateSlot];a.isSweepEnabled=K(1049+50*a.saveStateSlot);a.sweepCounter=f[1050+50*a.saveStateSlot];
a.sweepShadowFrequency=f[1055+50*a.saveStateSlot]};a.initialize=function(){e(a.memoryLocationNRx0,128);e(a.memoryLocationNRx1,191);e(a.memoryLocationNRx2,243);e(a.memoryLocationNRx3,193);e(a.memoryLocationNRx4,191);b.BootROMEnabled&&(e(a.memoryLocationNRx1,63),e(a.memoryLocationNRx2,0),e(a.memoryLocationNRx3,0),e(a.memoryLocationNRx4,184))};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){var c=2048-a.frequency<<2;b.GBCDoubleSpeed&&
(c<<=2);a.frequencyTimer=c};a.getSample=function(b){var c=a.frequencyTimer;for(c-=b;0>=c;)b=Math.abs(c),a.resetTimer(),c=a.frequencyTimer,c-=b,a.waveFormPositionOnDuty=a.waveFormPositionOnDuty+1&7;a.frequencyTimer=c;if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;b=1;Pb(a.NRx1Duty,a.waveFormPositionOnDuty)||(b=-b);return b*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=a.MAX_LENGTH);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;
a.sweepShadowFrequency=a.frequency;a.sweepCounter=0===a.NRx0SweepPeriod?8:a.NRx0SweepPeriod;a.isSweepEnabled=0<a.NRx0SweepPeriod||0<a.NRx0SweepShift;a.sweepNegateShouldDisableChannelOnClear=!1;var b;if(b=0<a.NRx0SweepShift)b=2047<ub()?!0:!1;b&&(a.isEnabled=!1);a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){b=a.cycleCounter+b;a.cycleCounter=b;return!(0<a.frequencyTimer-b)};a.updateSweep=function(){if(a.isEnabled&&a.isSweepEnabled){var b=a.sweepCounter-1;0>=b?0===a.NRx0SweepPeriod?
a.sweepCounter=8:(a.sweepCounter=a.NRx0SweepPeriod,b=ub(),2047<b&&(a.isEnabled=!1),0<a.NRx0SweepShift&&(a.setFrequency(b),2047<ub()&&(a.isEnabled=!1))):a.sweepCounter=b}};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&(--b,0===b&&(a.isEnabled=!1));a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-1;if(0>=b&&(b=a.NRx2EnvelopePeriod,0!==b)){var d=a.volume;a.NRx2EnvelopeAddMode&&15>d?d+=1:!a.NRx2EnvelopeAddMode&&0<d&&--d;a.volume=d}a.envelopeCounter=b};
a.setFrequency=function(b){a.sweepShadowFrequency=b;var c=b>>8&7;b&=255;var d=t(a.memoryLocationNRx4)&248|c;e(a.memoryLocationNRx3,b);e(a.memoryLocationNRx4,d);a.NRx3FrequencyLSB=b;a.NRx4FrequencyMSB=c;a.frequency=a.NRx4FrequencyMSB<<8|a.NRx3FrequencyLSB};a.cycleCounter=0;a.MAX_LENGTH=64;a.memoryLocationNRx0=65296;a.NRx0SweepPeriod=0;a.NRx0Negate=!1;a.NRx0SweepShift=0;a.memoryLocationNRx1=65297;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65298;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=
!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65299;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65300;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=1;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.isSweepEnabled=!1;a.sweepCounter=0;a.sweepShadowFrequency=0;a.sweepNegateShouldDisableChannelOnClear=!1;a.saveStateSlot=7;return a}(),z=function(){function a(){}a.updateNRx1=function(b){a.NRx1Duty=
b>>6&3;a.NRx1LengthLoad=b&63;a.lengthCounter=a.MAX_LENGTH-a.NRx1LengthLoad};a.updateNRx2=function(b){a.NRx2StartingVolume=b>>4&15;a.NRx2EnvelopeAddMode=g(3,b);a.NRx2EnvelopePeriod=b&7;b=0<(b&248);a.isDacEnabled=b;b||(a.isEnabled=b)};a.updateNRx3=function(b){a.NRx3FrequencyLSB=b;a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){var c=b&7;a.NRx4FrequencyMSB=c;a.frequency=c<<8|a.NRx3FrequencyLSB;c=1===(h.frameSequencer&1);var d=!a.NRx4LengthEnabled&&g(6,b);!c&&0<a.lengthCounter&&d&&(--a.lengthCounter,
g(7,b)||0!==a.lengthCounter||(a.isEnabled=!1));a.NRx4LengthEnabled=g(6,b);g(7,b)&&(a.trigger(),!c&&a.lengthCounter===a.MAX_LENGTH&&a.NRx4LengthEnabled&&--a.lengthCounter)};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;f[1025+50*a.saveStateSlot]=a.frequencyTimer;f[1029+50*a.saveStateSlot]=a.envelopeCounter;f[1033+50*a.saveStateSlot]=a.lengthCounter;f[1038+50*a.saveStateSlot]=a.volume;f[1043+50*a.saveStateSlot]=a.dutyCycle;f[1044+50*a.saveStateSlot]=a.waveFormPositionOnDuty};a.loadState=
function(){a.isEnabled=K(1024+50*a.saveStateSlot);a.frequencyTimer=f[1025+50*a.saveStateSlot];a.envelopeCounter=f[1029+50*a.saveStateSlot];a.lengthCounter=f[1033+50*a.saveStateSlot];a.volume=f[1038+50*a.saveStateSlot];a.dutyCycle=f[1043+50*a.saveStateSlot];a.waveFormPositionOnDuty=f[1044+50*a.saveStateSlot]};a.initialize=function(){e(a.memoryLocationNRx1-1,255);e(a.memoryLocationNRx1,63);e(a.memoryLocationNRx2,0);e(a.memoryLocationNRx3,0);e(a.memoryLocationNRx4,184)};a.getSampleFromCycleCounter=function(){var b=
a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){a.frequencyTimer=2048-a.frequency<<2<<b.GBCDoubleSpeed};a.getSample=function(b){var c=a.frequencyTimer;for(c-=b;0>=c;)b=Math.abs(c),a.resetTimer(),c=a.frequencyTimer,c-=b,a.waveFormPositionOnDuty=a.waveFormPositionOnDuty+1&7;a.frequencyTimer=c;if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;b=1;Pb(a.NRx1Duty,a.waveFormPositionOnDuty)||(b=-b);return b*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&
(a.lengthCounter=a.MAX_LENGTH);a.resetTimer();a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){b=a.cycleCounter+b;a.cycleCounter=b;return!(0<a.frequencyTimer-b)};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-1;if(0>=b&&(b=a.NRx2EnvelopePeriod,0!==b)){var d=a.volume;a.NRx2EnvelopeAddMode&&
15>d?d+=1:!a.NRx2EnvelopeAddMode&&0<d&&--d;a.volume=d}a.envelopeCounter=b};a.setFrequency=function(b){var c=b>>8;b&=255;var d=t(a.memoryLocationNRx4)&248|c;e(a.memoryLocationNRx3,b);e(a.memoryLocationNRx4,d);a.NRx3FrequencyLSB=b;a.NRx4FrequencyMSB=c;a.frequency=c<<8|b};a.cycleCounter=0;a.MAX_LENGTH=64;a.memoryLocationNRx0=65301;a.memoryLocationNRx1=65302;a.NRx1Duty=0;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65303;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=
65304;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65305;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.channelNumber=2;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.dutyCycle=0;a.waveFormPositionOnDuty=0;a.saveStateSlot=8;return a}(),u=function(){function a(){}a.updateNRx0=function(b){b=g(7,b);!a.isDacEnabled&&b&&(a.sampleBuffer=0);a.isDacEnabled=b;b||(a.isEnabled=b)};a.updateNRx1=function(b){a.NRx1LengthLoad=b;a.lengthCounter=a.MAX_LENGTH-
a.NRx1LengthLoad};a.updateNRx2=function(b){a.NRx2VolumeCode=b>>5&15};a.updateNRx3=function(b){a.NRx3FrequencyLSB=b;a.frequency=a.NRx4FrequencyMSB<<8|b};a.updateNRx4=function(b){var c=b&7;a.NRx4FrequencyMSB=c;a.frequency=c<<8|a.NRx3FrequencyLSB;c=1===(h.frameSequencer&1);if(!c){var d=!a.NRx4LengthEnabled&&g(6,b);0<a.lengthCounter&&d&&(--a.lengthCounter,g(7,b)||0!==a.lengthCounter||(a.isEnabled=!1))}a.NRx4LengthEnabled=g(6,b);g(7,b)&&(a.trigger(),!c&&a.lengthCounter===a.MAX_LENGTH&&a.NRx4LengthEnabled&&
--a.lengthCounter)};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;f[1025+50*a.saveStateSlot]=a.frequencyTimer;f[1029+50*a.saveStateSlot]=a.lengthCounter;f[1033+50*a.saveStateSlot]=a.waveTablePosition};a.loadState=function(){a.isEnabled=K(1024+50*a.saveStateSlot);a.frequencyTimer=f[1025+50*a.saveStateSlot];a.lengthCounter=f[1029+50*a.saveStateSlot];a.waveTablePosition=f[1033+50*a.saveStateSlot]};a.handleWaveRamRead=function(){return t(u.memoryLocationWaveTable+(u.waveTablePosition>>
1|0))};a.handleWaveRamWrite=function(b){e(a.memoryLocationWaveTable+(a.waveTablePosition>>1|0),b)};a.initialize=function(){e(a.memoryLocationNRx0,127);e(a.memoryLocationNRx1,255);e(a.memoryLocationNRx2,159);e(a.memoryLocationNRx3,0);e(a.memoryLocationNRx4,184);a.volumeCodeChanged=!0};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};a.resetTimer=function(){a.frequencyTimer=2048-a.frequency<<1<<b.GBCDoubleSpeed};a.getSample=function(b){if(!a.isEnabled||
!a.isDacEnabled)return 15;var c=a.volumeCode;a.volumeCodeChanged&&(c=t(a.memoryLocationNRx2),c=c>>5&15,a.volumeCode=c,a.volumeCodeChanged=!1);var d=u.sampleBuffer;d>>=(0===(u.waveTablePosition&1))<<2;d&=15;var e=0;switch(c){case 0:d>>=4;break;case 1:e=1;break;case 2:d>>=1;e=2;break;default:d>>=2,e=4}d=(0<e?d/e:0)+15;c=a.frequencyTimer;for(c-=b;0>=c;){b=Math.abs(c);a.resetTimer();c=a.frequencyTimer;c-=b;b=u.waveTablePosition;for(b+=1;32<=b;)b-=32;u.waveTablePosition=b;u.sampleBuffer=t(u.memoryLocationWaveTable+
(u.waveTablePosition>>1|0))}a.frequencyTimer=c;return d};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=a.MAX_LENGTH);a.resetTimer();a.frequencyTimer+=6;a.waveTablePosition=0;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){a.cycleCounter+=b;return!(!a.volumeCodeChanged&&0<a.frequencyTimer-a.cycleCounter)};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.cycleCounter=0;a.MAX_LENGTH=
256;a.memoryLocationNRx0=65306;a.memoryLocationNRx1=65307;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65308;a.NRx2VolumeCode=0;a.memoryLocationNRx3=65309;a.NRx3FrequencyLSB=0;a.memoryLocationNRx4=65310;a.NRx4LengthEnabled=!1;a.NRx4FrequencyMSB=0;a.memoryLocationWaveTable=65328;a.channelNumber=3;a.isEnabled=!1;a.isDacEnabled=!1;a.frequency=0;a.frequencyTimer=0;a.lengthCounter=0;a.waveTablePosition=0;a.volumeCode=0;a.volumeCodeChanged=!1;a.sampleBuffer=0;a.saveStateSlot=9;return a}(),B=function(){function a(){}
a.updateNRx1=function(b){a.NRx1LengthLoad=b&63;a.lengthCounter=a.MAX_LENGTH-a.NRx1LengthLoad};a.updateNRx2=function(b){a.NRx2StartingVolume=b>>4&15;a.NRx2EnvelopeAddMode=g(3,b);a.NRx2EnvelopePeriod=b&7;b=0<(b&248);a.isDacEnabled=b;b||(a.isEnabled=b)};a.updateNRx3=function(b){var c=b&7;a.NRx3ClockShift=b>>4;a.NRx3WidthMode=g(3,b);a.NRx3DivisorCode=c;c<<=1;1>c&&(c=1);a.divisor=c<<3};a.updateNRx4=function(b){var c=1===(h.frameSequencer&1),d=!a.NRx4LengthEnabled&&g(6,b);!c&&0<a.lengthCounter&&d&&(--a.lengthCounter,
g(7,b)||0!==a.lengthCounter||(a.isEnabled=!1));a.NRx4LengthEnabled=g(6,b);g(7,b)&&(a.trigger(),!c&&a.lengthCounter===a.MAX_LENGTH&&a.NRx4LengthEnabled&&--a.lengthCounter)};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.isEnabled;f[1025+50*a.saveStateSlot]=a.frequencyTimer;f[1029+50*a.saveStateSlot]=a.envelopeCounter;f[1033+50*a.saveStateSlot]=a.lengthCounter;f[1038+50*a.saveStateSlot]=a.volume;f[1043+50*a.saveStateSlot]=a.linearFeedbackShiftRegister};a.loadState=function(){a.isEnabled=K(1024+
50*a.saveStateSlot);a.frequencyTimer=f[1025+50*a.saveStateSlot];a.envelopeCounter=f[1029+50*a.saveStateSlot];a.lengthCounter=f[1033+50*a.saveStateSlot];a.volume=f[1038+50*a.saveStateSlot];a.linearFeedbackShiftRegister=f[1043+50*a.saveStateSlot]};a.initialize=function(){e(a.memoryLocationNRx1-1,255);e(a.memoryLocationNRx1,255);e(a.memoryLocationNRx2,0);e(a.memoryLocationNRx3,0);e(a.memoryLocationNRx4,191)};a.getSampleFromCycleCounter=function(){var b=a.cycleCounter;a.cycleCounter=0;return a.getSample(b)};
a.getSample=function(b){var c=a.frequencyTimer;c-=b;if(0>=c){b=Math.abs(c);c=a.getNoiseChannelFrequencyPeriod();c-=b;b=a.linearFeedbackShiftRegister;var d=b&1^b>>1&1;b=b>>1|d<<14;a.NRx3WidthMode&&(b=b&-65|d<<6);a.linearFeedbackShiftRegister=b}0>c&&(c=0);a.frequencyTimer=c;if(a.isEnabled&&a.isDacEnabled)c=a.volume;else return 15;b=g(0,a.linearFeedbackShiftRegister)?-1:1;return b*c+15};a.trigger=function(){a.isEnabled=!0;0===a.lengthCounter&&(a.lengthCounter=a.MAX_LENGTH);a.frequencyTimer=a.getNoiseChannelFrequencyPeriod();
a.envelopeCounter=a.NRx2EnvelopePeriod;a.volume=a.NRx2StartingVolume;a.linearFeedbackShiftRegister=32767;a.isDacEnabled||(a.isEnabled=!1)};a.willChannelUpdate=function(b){a.cycleCounter+=b;return!(0<a.frequencyTimer-a.cycleCounter)};a.getNoiseChannelFrequencyPeriod=function(){return a.divisor<<a.NRx3ClockShift<<b.GBCDoubleSpeed};a.updateLength=function(){var b=a.lengthCounter;0<b&&a.NRx4LengthEnabled&&--b;0===b&&(a.isEnabled=!1);a.lengthCounter=b};a.updateEnvelope=function(){var b=a.envelopeCounter-
1;if(0>=b&&(b=a.NRx2EnvelopePeriod,0!==b)){var d=a.volume;a.NRx2EnvelopeAddMode&&15>d?d+=1:!a.NRx2EnvelopeAddMode&&0<d&&--d;a.volume=d}a.envelopeCounter=b};a.cycleCounter=0;a.MAX_LENGTH=64;a.memoryLocationNRx0=65311;a.memoryLocationNRx1=65312;a.NRx1LengthLoad=0;a.memoryLocationNRx2=65313;a.NRx2StartingVolume=0;a.NRx2EnvelopeAddMode=!1;a.NRx2EnvelopePeriod=0;a.memoryLocationNRx3=65314;a.NRx3ClockShift=0;a.NRx3WidthMode=!1;a.NRx3DivisorCode=0;a.memoryLocationNRx4=65315;a.NRx4LengthEnabled=!1;a.channelNumber=
4;a.isEnabled=!1;a.isDacEnabled=!1;a.frequencyTimer=0;a.envelopeCounter=0;a.lengthCounter=0;a.volume=0;a.divisor=0;a.linearFeedbackShiftRegister=0;a.saveStateSlot=10;return a}(),w=function(){function a(){}a.channel1Sample=15;a.channel2Sample=15;a.channel3Sample=15;a.channel4Sample=15;a.channel1DacEnabled=!1;a.channel2DacEnabled=!1;a.channel3DacEnabled=!1;a.channel4DacEnabled=!1;a.leftChannelSampleUnsignedByte=127;a.rightChannelSampleUnsignedByte=127;a.mixerVolumeChanged=!1;a.mixerEnabledChanged=!1;
a.needToRemixSamples=!1;return a}(),h=function(){function a(){}a.batchProcessCycles=function(){return 87<<b.GBCDoubleSpeed};a.updateNR50=function(b){a.NR50LeftMixerVolume=b>>4&7;a.NR50RightMixerVolume=b&7};a.updateNR51=function(b){a.NR51IsChannel4EnabledOnLeftOutput=g(7,b);a.NR51IsChannel3EnabledOnLeftOutput=g(6,b);a.NR51IsChannel2EnabledOnLeftOutput=g(5,b);a.NR51IsChannel1EnabledOnLeftOutput=g(4,b);a.NR51IsChannel4EnabledOnRightOutput=g(3,b);a.NR51IsChannel3EnabledOnRightOutput=g(2,b);a.NR51IsChannel2EnabledOnRightOutput=
g(1,b);a.NR51IsChannel1EnabledOnRightOutput=g(0,b)};a.updateNR52=function(b){a.NR52IsSoundEnabled=g(7,b)};a.maxFrameSequenceCycles=function(){return 8192<<b.GBCDoubleSpeed};a.maxDownSampleCycles=function(){return b.CLOCK_SPEED()/a.sampleRate};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.frameSequenceCycleCounter;f[1028+50*a.saveStateSlot]=a.downSampleCycleCounter;f[1029+50*a.saveStateSlot]=a.frameSequencer};a.loadState=function(){a.frameSequenceCycleCounter=f[1024+50*a.saveStateSlot];a.downSampleCycleCounter=
f[1028+50*a.saveStateSlot];a.frameSequencer=f[1029+50*a.saveStateSlot];Sb()};a.currentCycles=0;a.memoryLocationNR50=65316;a.NR50LeftMixerVolume=0;a.NR50RightMixerVolume=0;a.memoryLocationNR51=65317;a.NR51IsChannel1EnabledOnLeftOutput=!0;a.NR51IsChannel2EnabledOnLeftOutput=!0;a.NR51IsChannel3EnabledOnLeftOutput=!0;a.NR51IsChannel4EnabledOnLeftOutput=!0;a.NR51IsChannel1EnabledOnRightOutput=!0;a.NR51IsChannel2EnabledOnRightOutput=!0;a.NR51IsChannel3EnabledOnRightOutput=!0;a.NR51IsChannel4EnabledOnRightOutput=
!0;a.memoryLocationNR52=65318;a.NR52IsSoundEnabled=!0;a.memoryLocationChannel3LoadRegisterStart=65328;a.frameSequenceCycleCounter=0;a.downSampleCycleCounter=0;a.sampleRate=44100;a.frameSequencer=0;a.audioQueueIndex=0;a.wasmBoyMemoryMaxBufferSize=131072;a.saveStateSlot=6;return a}(),k=function(){function a(){}a.updateInterruptEnabled=function(b){a.isVBlankInterruptEnabled=g(a.bitPositionVBlankInterrupt,b);a.isLcdInterruptEnabled=g(a.bitPositionLcdInterrupt,b);a.isTimerInterruptEnabled=g(a.bitPositionTimerInterrupt,
b);a.isSerialInterruptEnabled=g(a.bitPositionSerialInterrupt,b);a.isJoypadInterruptEnabled=g(a.bitPositionJoypadInterrupt,b);a.interruptsEnabledValue=b};a.updateInterruptRequested=function(b){a.isVBlankInterruptRequested=g(a.bitPositionVBlankInterrupt,b);a.isLcdInterruptRequested=g(a.bitPositionLcdInterrupt,b);a.isTimerInterruptRequested=g(a.bitPositionTimerInterrupt,b);a.isSerialInterruptRequested=g(a.bitPositionSerialInterrupt,b);a.isJoypadInterruptRequested=g(a.bitPositionJoypadInterrupt,b);a.interruptsRequestedValue=
b};a.areInterruptsPending=function(){return 0<(a.interruptsRequestedValue&a.interruptsEnabledValue&31)};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.masterInterruptSwitch;f[1025+50*a.saveStateSlot]=a.masterInterruptSwitchDelay};a.loadState=function(){a.masterInterruptSwitch=K(1024+50*a.saveStateSlot);a.masterInterruptSwitchDelay=K(1025+50*a.saveStateSlot);a.updateInterruptEnabled(t(a.memoryLocationInterruptEnabled));a.updateInterruptRequested(t(a.memoryLocationInterruptRequest))};a.masterInterruptSwitch=
!1;a.masterInterruptSwitchDelay=!1;a.bitPositionVBlankInterrupt=0;a.bitPositionLcdInterrupt=1;a.bitPositionTimerInterrupt=2;a.bitPositionSerialInterrupt=3;a.bitPositionJoypadInterrupt=4;a.memoryLocationInterruptEnabled=65535;a.interruptsEnabledValue=0;a.isVBlankInterruptEnabled=!1;a.isLcdInterruptEnabled=!1;a.isTimerInterruptEnabled=!1;a.isSerialInterruptEnabled=!1;a.isJoypadInterruptEnabled=!1;a.memoryLocationInterruptRequest=65295;a.interruptsRequestedValue=0;a.isVBlankInterruptRequested=!1;a.isLcdInterruptRequested=
!1;a.isTimerInterruptRequested=!1;a.isSerialInterruptRequested=!1;a.isJoypadInterruptRequested=!1;a.saveStateSlot=2;return a}(),n=function(){function a(){}a.batchProcessCycles=function(){return 256};a.updateDividerRegister=function(){var b=a.dividerRegister;a.dividerRegister=0;e(a.memoryLocationDividerRegister,0);a.timerEnabled&&Ub(b,0)&&Ab()};a.updateTimerCounter=function(b){if(a.timerEnabled){if(a.timerCounterWasReset)return;a.timerCounterOverflowDelay&&(a.timerCounterOverflowDelay=!1)}a.timerCounter=
b};a.updateTimerModulo=function(b){a.timerModulo=b;a.timerEnabled&&a.timerCounterWasReset&&(a.timerCounter=b,a.timerCounterWasReset=!1)};a.updateTimerControl=function(b){var c=a.timerEnabled;a.timerEnabled=g(2,b);b&=3;if(!c){c=Bb(a.timerInputClock);var d=Bb(b),e=a.dividerRegister;(a.timerEnabled?g(c,e):g(c,e)&&g(d,e))&&Ab()}a.timerInputClock=b};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.currentCycles;f[1028+50*a.saveStateSlot]=a.dividerRegister;f[1032+50*a.saveStateSlot]=a.timerCounterOverflowDelay;
f[1035+50*a.saveStateSlot]=a.timerCounterWasReset;e(a.memoryLocationTimerCounter,a.timerCounter)};a.loadState=function(){a.currentCycles=f[1024+50*a.saveStateSlot];a.dividerRegister=f[1028+50*a.saveStateSlot];a.timerCounterOverflowDelay=K(1032+50*a.saveStateSlot);a.timerCounterWasReset=K(1035+50*a.saveStateSlot);a.timerCounter=t(a.memoryLocationTimerCounter);a.timerModulo=t(a.memoryLocationTimerModulo);a.timerInputClock=t(a.memoryLocationTimerControl)};a.currentCycles=0;a.memoryLocationDividerRegister=
65284;a.dividerRegister=0;a.memoryLocationTimerCounter=65285;a.timerCounter=0;a.timerCounterOverflowDelay=!1;a.timerCounterWasReset=!1;a.timerCounterMask=0;a.memoryLocationTimerModulo=65286;a.timerModulo=0;a.memoryLocationTimerControl=65287;a.timerEnabled=!1;a.timerInputClock=0;a.saveStateSlot=5;return a}(),V=function(){function a(){}a.updateTransferControl=function(b){a.isShiftClockInternal=g(0,b);a.isClockSpeedFast=g(1,b);a.transferStartFlag=g(7,b);return!0};a.currentCycles=0;a.memoryLocationSerialTransferData=
65281;a.memoryLocationSerialTransferControl=65282;a.numberOfBitsTransferred=0;a.isShiftClockInternal=!1;a.isClockSpeedFast=!1;a.transferStartFlag=!1;return a}(),A=function(){function a(){}a.updateJoypad=function(b){a.joypadRegisterFlipped=b^255;a.isDpadType=g(4,a.joypadRegisterFlipped);a.isButtonType=g(5,a.joypadRegisterFlipped)};a.saveState=function(){};a.loadState=function(){a.updateJoypad(t(a.memoryLocationJoypadRegister))};a.up=!1;a.down=!1;a.left=!1;a.right=!1;a.a=!1;a.b=!1;a.select=!1;a.start=
!1;a.memoryLocationJoypadRegister=65280;a.joypadRegisterFlipped=0;a.isDpadType=!1;a.isButtonType=!1;a.saveStateSlot=3;return a}(),W=function(){function a(){}a.programCounter=-1;a.readGbMemory=-1;a.writeGbMemory=-1;a.reachedBreakpoint=!1;return a}(),y=function(){function a(){}a.updateLcdStatus=function(b){var c=t(a.memoryLocationLcdStatus);b=b&248|c&7|128;e(a.memoryLocationLcdStatus,b)};a.updateLcdControl=function(b){var c=a.enabled;a.enabled=g(7,b);a.windowTileMapDisplaySelect=g(6,b);a.windowDisplayEnabled=
g(5,b);a.bgWindowTileDataSelect=g(4,b);a.bgTileMapDisplaySelect=g(3,b);a.tallSpriteSize=g(2,b);a.spriteDisplayEnable=g(1,b);a.bgDisplayEnabled=g(0,b);c&&!a.enabled&&Wb(!0);!c&&a.enabled&&Wb(!1)};a.memoryLocationLcdStatus=65345;a.currentLcdMode=0;a.memoryLocationCoincidenceCompare=65349;a.coincidenceCompare=0;a.memoryLocationLcdControl=65344;a.enabled=!0;a.windowTileMapDisplaySelect=!1;a.windowDisplayEnabled=!1;a.bgWindowTileDataSelect=!1;a.bgTileMapDisplaySelect=!1;a.tallSpriteSize=!1;a.spriteDisplayEnable=
!1;a.bgDisplayEnabled=!1;return a}(),q=function(){function a(){}a.batchProcessCycles=function(){return a.MAX_CYCLES_PER_SCANLINE()};a.MAX_CYCLES_PER_SCANLINE=function(){return 153===a.scanlineRegister?4<<b.GBCDoubleSpeed:456<<b.GBCDoubleSpeed};a.MIN_CYCLES_SPRITES_LCD_MODE=function(){return 376<<b.GBCDoubleSpeed};a.MIN_CYCLES_TRANSFER_DATA_LCD_MODE=function(){return 249<<b.GBCDoubleSpeed};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.scanlineCycleCounter;f[1028+50*a.saveStateSlot]=y.currentLcdMode;
e(a.memoryLocationScanlineRegister,a.scanlineRegister)};a.loadState=function(){a.scanlineCycleCounter=f[1024+50*a.saveStateSlot];y.currentLcdMode=f[1028+50*a.saveStateSlot];a.scanlineRegister=t(a.memoryLocationScanlineRegister);y.updateLcdControl(t(y.memoryLocationLcdControl))};a.currentCycles=0;a.scanlineCycleCounter=0;a.memoryLocationScanlineRegister=65348;a.scanlineRegister=0;a.memoryLocationDmaTransfer=65350;a.memoryLocationScrollX=65347;a.scrollX=0;a.memoryLocationScrollY=65346;a.scrollY=0;a.memoryLocationWindowX=
65355;a.windowX=0;a.memoryLocationWindowY=65354;a.windowY=0;a.memoryLocationTileMapSelectZeroStart=38912;a.memoryLocationTileMapSelectOneStart=39936;a.memoryLocationTileDataSelectZeroStart=34816;a.memoryLocationTileDataSelectOneStart=32768;a.memoryLocationSpriteAttributesTable=65024;a.memoryLocationBackgroundPalette=65351;a.memoryLocationSpritePaletteOne=65352;a.memoryLocationSpritePaletteTwo=65353;a.saveStateSlot=1;return a}(),m=function(){function a(){}a.saveState=function(){f[1024+50*a.saveStateSlot]=
a.currentRomBank;f[1026+50*a.saveStateSlot]=a.currentRamBank;f[1028+50*a.saveStateSlot]=a.isRamBankingEnabled;f[1029+50*a.saveStateSlot]=a.isMBC1RomModeEnabled;f[1030+50*a.saveStateSlot]=a.isRomOnly;f[1031+50*a.saveStateSlot]=a.isMBC1;f[1032+50*a.saveStateSlot]=a.isMBC2;f[1033+50*a.saveStateSlot]=a.isMBC3;f[1034+50*a.saveStateSlot]=a.isMBC5};a.loadState=function(){a.currentRomBank=f[1024+50*a.saveStateSlot];a.currentRamBank=f[1026+50*a.saveStateSlot];a.isRamBankingEnabled=K(1028+50*a.saveStateSlot);
a.isMBC1RomModeEnabled=K(1029+50*a.saveStateSlot);a.isRomOnly=K(1030+50*a.saveStateSlot);a.isMBC1=K(1031+50*a.saveStateSlot);a.isMBC2=K(1032+50*a.saveStateSlot);a.isMBC3=K(1033+50*a.saveStateSlot);a.isMBC5=K(1034+50*a.saveStateSlot)};a.cartridgeRomLocation=0;a.switchableCartridgeRomLocation=16384;a.videoRamLocation=32768;a.cartridgeRamLocation=40960;a.internalRamBankZeroLocation=49152;a.internalRamBankOneLocation=53248;a.echoRamLocation=57344;a.spriteInformationTableLocation=65024;a.spriteInformationTableLocationEnd=
65183;a.unusableMemoryLocation=65184;a.unusableMemoryEndLocation=65279;a.currentRomBank=0;a.currentRamBank=0;a.isRamBankingEnabled=!1;a.isMBC1RomModeEnabled=!0;a.isRomOnly=!0;a.isMBC1=!1;a.isMBC2=!1;a.isMBC3=!1;a.isMBC5=!1;a.memoryLocationHdmaSourceHigh=65361;a.memoryLocationHdmaSourceLow=65362;a.memoryLocationHdmaDestinationHigh=65363;a.memoryLocationHdmaDestinationLow=65364;a.memoryLocationHdmaTrigger=65365;a.DMACycles=0;a.isHblankHdmaActive=!1;a.hblankHdmaTransferLengthRemaining=0;a.hblankHdmaSource=
0;a.hblankHdmaDestination=0;a.memoryLocationGBCVRAMBank=65359;a.memoryLocationGBCWRAMBank=65392;a.saveStateSlot=4;return a}(),b=function(){function a(){}a.CLOCK_SPEED=function(){return 4194304<<a.GBCDoubleSpeed};a.MAX_CYCLES_PER_FRAME=function(){return 70224<<a.GBCDoubleSpeed};a.enableHalt=function(){k.masterInterruptSwitch?a.isHaltNormal=!0:0===(k.interruptsEnabledValue&k.interruptsRequestedValue&31)?a.isHaltNoJump=!0:a.isHaltBug=!0};a.exitHaltAndStop=function(){a.isHaltNoJump=!1;a.isHaltNormal=
!1;a.isHaltBug=!1;a.isStopped=!1};a.isHalted=function(){return a.isHaltNormal||a.isHaltNoJump};a.saveState=function(){f[1024+50*a.saveStateSlot]=a.registerA;f[1025+50*a.saveStateSlot]=a.registerB;f[1026+50*a.saveStateSlot]=a.registerC;f[1027+50*a.saveStateSlot]=a.registerD;f[1028+50*a.saveStateSlot]=a.registerE;f[1029+50*a.saveStateSlot]=a.registerH;f[1030+50*a.saveStateSlot]=a.registerL;f[1031+50*a.saveStateSlot]=a.registerF;f[1032+50*a.saveStateSlot]=a.stackPointer;f[1034+50*a.saveStateSlot]=a.programCounter;
f[1036+50*a.saveStateSlot]=a.currentCycles;f[1041+50*a.saveStateSlot]=a.isHaltNormal;f[1042+50*a.saveStateSlot]=a.isHaltNoJump;f[1043+50*a.saveStateSlot]=a.isHaltBug;f[1044+50*a.saveStateSlot]=a.isStopped;f[1045+50*a.saveStateSlot]=a.BootROMEnabled;f[1046+50*a.saveStateSlot]=a.GBCEnabled;f[1047+50*a.saveStateSlot]=a.GBCDoubleSpeed};a.loadState=function(){a.registerA=f[1024+50*a.saveStateSlot];a.registerB=f[1025+50*a.saveStateSlot];a.registerC=f[1026+50*a.saveStateSlot];a.registerD=f[1027+50*a.saveStateSlot];
a.registerE=f[1028+50*a.saveStateSlot];a.registerH=f[1029+50*a.saveStateSlot];a.registerL=f[1030+50*a.saveStateSlot];a.registerF=f[1031+50*a.saveStateSlot];a.stackPointer=f[1032+50*a.saveStateSlot];a.programCounter=f[1034+50*a.saveStateSlot];a.currentCycles=f[1036+50*a.saveStateSlot];a.isHaltNormal=K(1041+50*a.saveStateSlot);a.isHaltNoJump=K(1042+50*a.saveStateSlot);a.isHaltBug=K(1043+50*a.saveStateSlot);a.isStopped=K(1044+50*a.saveStateSlot);a.BootROMEnabled=K(1045+50*a.saveStateSlot);a.GBCEnabled=
K(1046+50*a.saveStateSlot);a.GBCDoubleSpeed=K(1047+50*a.saveStateSlot)};a.memoryLocationBootROMSwitch=65360;a.BootROMEnabled=!1;a.GBCEnabled=!1;a.memoryLocationSpeedSwitch=65357;a.GBCDoubleSpeed=!1;a.registerA=0;a.registerB=0;a.registerC=0;a.registerD=0;a.registerE=0;a.registerH=0;a.registerL=0;a.registerF=0;a.stackPointer=0;a.programCounter=0;a.currentCycles=0;a.isHaltNormal=!1;a.isHaltNoJump=!1;a.isHaltBug=!1;a.isStopped=!1;a.saveStateSlot=0;return a}(),Z=function(){function a(){}a.cyclesPerCycleSet=
2E9;a.cycleSets=0;a.cycles=0;return a}(),S=function(){function a(){}a.stepsPerStepSet=2E9;a.stepSets=0;a.steps=0;a.RESPONSE_CONDITION_ERROR=-1;a.RESPONSE_CONDITION_FRAME=0;a.RESPONSE_CONDITION_AUDIO=1;a.RESPONSE_CONDITION_BREAKPOINT=2;return a}();fb.size()<Mb&&fb.grow(Mb-fb.size());var eb=!1,yc=Object.freeze({memory:fb,config:function(a,c,f,g,l,r,v,y,O,A){L.enableBootRom=0<a;L.useGbcWhenAvailable=0<c;L.audioBatchProcessing=0<f;L.graphicsBatchProcessing=0<g;L.timersBatchProcessing=0<l;L.graphicsDisableScanlineRendering=
0<r;L.audioAccumulateSamples=0<v;L.tileRendering=0<y;L.tileCaching=0<O;L.enableAudioDebugging=0<A;a=t(323);b.GBCEnabled=192===a||L.useGbcWhenAvailable&&128===a?!0:!1;eb=!1;Z.cyclesPerCycleSet=2E9;Z.cycleSets=0;Z.cycles=0;S.stepsPerStepSet=2E9;S.stepSets=0;S.steps=0;b.BootROMEnabled=L.enableBootRom?!0:!1;b.GBCDoubleSpeed=!1;b.registerA=0;b.registerB=0;b.registerC=0;b.registerD=0;b.registerE=0;b.registerH=0;b.registerL=0;b.registerF=0;b.stackPointer=0;b.programCounter=0;b.currentCycles=0;b.isHaltNormal=
!1;b.isHaltNoJump=!1;b.isHaltBug=!1;b.isStopped=!1;b.BootROMEnabled||(b.GBCEnabled?(b.registerA=17,b.registerF=128,b.registerB=0,b.registerC=0,b.registerD=255,b.registerE=86,b.registerH=0,b.registerL=13):(b.registerA=1,b.registerF=176,b.registerB=0,b.registerC=19,b.registerD=0,b.registerE=216,b.registerH=1,b.registerL=77),b.programCounter=256,b.stackPointer=65534);m.isRamBankingEnabled=!1;m.isMBC1RomModeEnabled=!0;a=t(327);m.isRomOnly=0===a;m.isMBC1=1<=a&&3>=a;m.isMBC2=5<=a&&6>=a;m.isMBC3=15<=a&&
19>=a;m.isMBC5=25<=a&&30>=a;m.currentRomBank=1;m.currentRamBank=0;e(m.memoryLocationGBCVRAMBank,0);e(m.memoryLocationGBCWRAMBank,1);e(65361,255);e(65362,255);e(65363,255);e(65364,255);e(65365,255);q.currentCycles=0;q.scanlineCycleCounter=0;q.scanlineRegister=0;q.scrollX=0;q.scrollY=0;q.windowX=0;q.windowY=0;q.scanlineRegister=144;b.GBCEnabled?(e(65345,129),e(65348,144),e(65351,252)):(e(65345,133),e(65350,255),e(65351,252),e(65352,255),e(65353,255));q.scanlineRegister=144;e(65344,144);e(65359,0);e(65392,
1);b.BootROMEnabled&&(b.GBCEnabled?(q.scanlineRegister=0,e(65344,0),e(65345,128),e(65348,0)):(q.scanlineRegister=0,e(65344,0),e(65345,132)));Nb(0);if(!b.GBCEnabled&&(!b.BootROMEnabled||b.GBCEnabled)){a=0;for(c=308;323>=c;c++)a+=t(c);switch(a&255){case 136:d.bgWhite=qa.bgWhite;d.bgLightGrey=qa.bgLightGrey;d.bgDarkGrey=qa.bgDarkGrey;d.bgBlack=qa.bgBlack;d.obj0White=qa.obj0White;d.obj0LightGrey=qa.obj0LightGrey;d.obj0DarkGrey=qa.obj0DarkGrey;d.obj0Black=qa.obj0Black;d.obj1White=qa.obj1White;d.obj1LightGrey=
qa.obj1LightGrey;d.obj1DarkGrey=qa.obj1DarkGrey;d.obj1Black=qa.obj1Black;break;case 97:d.bgWhite=ra.bgWhite;d.bgLightGrey=ra.bgLightGrey;d.bgDarkGrey=ra.bgDarkGrey;d.bgBlack=ra.bgBlack;d.obj0White=ra.obj0White;d.obj0LightGrey=ra.obj0LightGrey;d.obj0DarkGrey=ra.obj0DarkGrey;d.obj0Black=ra.obj0Black;d.obj1White=ra.obj1White;d.obj1LightGrey=ra.obj1LightGrey;d.obj1DarkGrey=ra.obj1DarkGrey;d.obj1Black=ra.obj1Black;break;case 20:d.bgWhite=sa.bgWhite;d.bgLightGrey=sa.bgLightGrey;d.bgDarkGrey=sa.bgDarkGrey;
d.bgBlack=sa.bgBlack;d.obj0White=sa.obj0White;d.obj0LightGrey=sa.obj0LightGrey;d.obj0DarkGrey=sa.obj0DarkGrey;d.obj0Black=sa.obj0Black;d.obj1White=sa.obj1White;d.obj1LightGrey=sa.obj1LightGrey;d.obj1DarkGrey=sa.obj1DarkGrey;d.obj1Black=sa.obj1Black;break;case 70:d.bgWhite=ta.bgWhite;d.bgLightGrey=ta.bgLightGrey;d.bgDarkGrey=ta.bgDarkGrey;d.bgBlack=ta.bgBlack;d.obj0White=ta.obj0White;d.obj0LightGrey=ta.obj0LightGrey;d.obj0DarkGrey=ta.obj0DarkGrey;d.obj0Black=ta.obj0Black;d.obj1White=ta.obj1White;d.obj1LightGrey=
ta.obj1LightGrey;d.obj1DarkGrey=ta.obj1DarkGrey;d.obj1Black=ta.obj1Black;break;case 89:case 198:d.bgWhite=ua.bgWhite;d.bgLightGrey=ua.bgLightGrey;d.bgDarkGrey=ua.bgDarkGrey;d.bgBlack=ua.bgBlack;d.obj0White=ua.obj0White;d.obj0LightGrey=ua.obj0LightGrey;d.obj0DarkGrey=ua.obj0DarkGrey;d.obj0Black=ua.obj0Black;d.obj1White=ua.obj1White;d.obj1LightGrey=ua.obj1LightGrey;d.obj1DarkGrey=ua.obj1DarkGrey;d.obj1Black=ua.obj1Black;break;case 134:case 168:d.bgWhite=va.bgWhite;d.bgLightGrey=va.bgLightGrey;d.bgDarkGrey=
va.bgDarkGrey;d.bgBlack=va.bgBlack;d.obj0White=va.obj0White;d.obj0LightGrey=va.obj0LightGrey;d.obj0DarkGrey=va.obj0DarkGrey;d.obj0Black=va.obj0Black;d.obj1White=va.obj1White;d.obj1LightGrey=va.obj1LightGrey;d.obj1DarkGrey=va.obj1DarkGrey;d.obj1Black=va.obj1Black;break;case 191:case 206:case 209:case 240:d.bgWhite=wa.bgWhite;d.bgLightGrey=wa.bgLightGrey;d.bgDarkGrey=wa.bgDarkGrey;d.bgBlack=wa.bgBlack;d.obj0White=wa.obj0White;d.obj0LightGrey=wa.obj0LightGrey;d.obj0DarkGrey=wa.obj0DarkGrey;d.obj0Black=
wa.obj0Black;d.obj1White=wa.obj1White;d.obj1LightGrey=wa.obj1LightGrey;d.obj1DarkGrey=wa.obj1DarkGrey;d.obj1Black=wa.obj1Black;break;case 39:case 73:case 92:case 179:d.bgWhite=xa.bgWhite;d.bgLightGrey=xa.bgLightGrey;d.bgDarkGrey=xa.bgDarkGrey;d.bgBlack=xa.bgBlack;d.obj0White=xa.obj0White;d.obj0LightGrey=xa.obj0LightGrey;d.obj0DarkGrey=xa.obj0DarkGrey;d.obj0Black=xa.obj0Black;d.obj1White=xa.obj1White;d.obj1LightGrey=xa.obj1LightGrey;d.obj1DarkGrey=xa.obj1DarkGrey;d.obj1Black=xa.obj1Black;break;case 201:d.bgWhite=
ya.bgWhite;d.bgLightGrey=ya.bgLightGrey;d.bgDarkGrey=ya.bgDarkGrey;d.bgBlack=ya.bgBlack;d.obj0White=ya.obj0White;d.obj0LightGrey=ya.obj0LightGrey;d.obj0DarkGrey=ya.obj0DarkGrey;d.obj0Black=ya.obj0Black;d.obj1White=ya.obj1White;d.obj1LightGrey=ya.obj1LightGrey;d.obj1DarkGrey=ya.obj1DarkGrey;d.obj1Black=ya.obj1Black;break;case 112:d.bgWhite=za.bgWhite;d.bgLightGrey=za.bgLightGrey;d.bgDarkGrey=za.bgDarkGrey;d.bgBlack=za.bgBlack;d.obj0White=za.obj0White;d.obj0LightGrey=za.obj0LightGrey;d.obj0DarkGrey=
za.obj0DarkGrey;d.obj0Black=za.obj0Black;d.obj1White=za.obj1White;d.obj1LightGrey=za.obj1LightGrey;d.obj1DarkGrey=za.obj1DarkGrey;d.obj1Black=za.obj1Black;break;case 70:d.bgWhite=Aa.bgWhite;d.bgLightGrey=Aa.bgLightGrey;d.bgDarkGrey=Aa.bgDarkGrey;d.bgBlack=Aa.bgBlack;d.obj0White=Aa.obj0White;d.obj0LightGrey=Aa.obj0LightGrey;d.obj0DarkGrey=Aa.obj0DarkGrey;d.obj0Black=Aa.obj0Black;d.obj1White=Aa.obj1White;d.obj1LightGrey=Aa.obj1LightGrey;d.obj1DarkGrey=Aa.obj1DarkGrey;d.obj1Black=Aa.obj1Black;break;
case 211:d.bgWhite=Ba.bgWhite,d.bgLightGrey=Ba.bgLightGrey,d.bgDarkGrey=Ba.bgDarkGrey,d.bgBlack=Ba.bgBlack,d.obj0White=Ba.obj0White,d.obj0LightGrey=Ba.obj0LightGrey,d.obj0DarkGrey=Ba.obj0DarkGrey,d.obj0Black=Ba.obj0Black,d.obj1White=Ba.obj1White,d.obj1LightGrey=Ba.obj1LightGrey,d.obj1DarkGrey=Ba.obj1DarkGrey,d.obj1Black=Ba.obj1Black}}b.GBCEnabled?(e(65384,192),e(65385,255),e(65386,193),e(65387,13)):(e(65384,255),e(65385,255),e(65386,255),e(65387,255));b.BootROMEnabled&&b.GBCEnabled&&(e(65385,32),
e(65387,138));h.currentCycles=0;h.NR50LeftMixerVolume=0;h.NR50RightMixerVolume=0;h.NR51IsChannel1EnabledOnLeftOutput=!0;h.NR51IsChannel2EnabledOnLeftOutput=!0;h.NR51IsChannel3EnabledOnLeftOutput=!0;h.NR51IsChannel4EnabledOnLeftOutput=!0;h.NR51IsChannel1EnabledOnRightOutput=!0;h.NR51IsChannel2EnabledOnRightOutput=!0;h.NR51IsChannel3EnabledOnRightOutput=!0;h.NR51IsChannel4EnabledOnRightOutput=!0;h.NR52IsSoundEnabled=!0;h.frameSequenceCycleCounter=0;h.downSampleCycleCounter=0;h.frameSequencer=0;h.audioQueueIndex=
0;p.initialize();z.initialize();u.initialize();B.initialize();e(h.memoryLocationNR50,119);h.updateNR50(119);e(h.memoryLocationNR51,243);h.updateNR51(243);e(h.memoryLocationNR52,241);h.updateNR52(241);b.BootROMEnabled&&(e(h.memoryLocationNR50,0),h.updateNR50(0),e(h.memoryLocationNR51,0),h.updateNR51(0),e(h.memoryLocationNR52,112),h.updateNR52(112));w.channel1Sample=15;w.channel2Sample=15;w.channel3Sample=15;w.channel4Sample=15;w.channel1DacEnabled=!1;w.channel2DacEnabled=!1;w.channel3DacEnabled=!1;
w.channel4DacEnabled=!1;w.leftChannelSampleUnsignedByte=127;w.rightChannelSampleUnsignedByte=127;w.mixerVolumeChanged=!0;w.mixerEnabledChanged=!0;w.needToRemixSamples=!1;k.updateInterruptEnabled(0);e(k.memoryLocationInterruptEnabled,k.interruptsEnabledValue);k.updateInterruptRequested(225);e(k.memoryLocationInterruptRequest,k.interruptsRequestedValue);n.currentCycles=0;n.dividerRegister=0;n.timerCounter=0;n.timerModulo=0;n.timerEnabled=!1;n.timerInputClock=0;n.timerCounterOverflowDelay=!1;n.timerCounterWasReset=
!1;b.GBCEnabled?(e(65284,30),n.dividerRegister=7840):(e(65284,171),n.dividerRegister=43980);e(65287,248);n.timerInputClock=248;b.BootROMEnabled&&!b.GBCEnabled&&(e(65284,0),n.dividerRegister=4);V.currentCycles=0;V.numberOfBitsTransferred=0;b.GBCEnabled?(e(65282,124),V.updateTransferControl(124)):(e(65282,126),V.updateTransferControl(126));b.GBCEnabled?(e(65392,248),e(65359,254),e(65357,126),e(65280,207),e(65295,225),e(65388,254),e(65397,143)):(e(65392,255),e(65359,255),e(65357,255),e(65280,207),e(65295,
225))},hasCoreStarted:function(){return eb},saveState:function(){b.saveState();q.saveState();k.saveState();A.saveState();m.saveState();n.saveState();h.saveState();p.saveState();z.saveState();u.saveState();B.saveState();eb=!1},loadState:function(){b.loadState();q.loadState();k.loadState();A.loadState();m.loadState();n.loadState();h.loadState();p.loadState();z.loadState();u.loadState();B.loadState();eb=!1;Z.cyclesPerCycleSet=2E9;Z.cycleSets=0;Z.cycles=0;S.stepsPerStepSet=2E9;S.stepSets=0;S.steps=0},
isGBC:function(){return b.GBCEnabled},getStepsPerStepSet:function(){return S.stepsPerStepSet},getStepSets:function(){return S.stepSets},getSteps:function(){return S.steps},executeMultipleFrames:function(a){for(var b=0,d=0;d<a&&0<=b;)b=ac(),d+=1;return 0>b?b:0},executeFrame:ac,executeFrameAndCheckAudio:function(a){void 0===a&&(a=0);return Jb(!0,a)},executeUntilCondition:Jb,executeStep:bc,getCyclesPerCycleSet:function(){return Z.cyclesPerCycleSet},getCycleSets:function(){return Z.cycleSets},getCycles:function(){return Z.cycles},
setJoypadState:function(a,b,d,e,f,g,h,m){0<a?Oa(0):Da(0,!1);0<b?Oa(1):Da(1,!1);0<d?Oa(2):Da(2,!1);0<e?Oa(3):Da(3,!1);0<f?Oa(4):Da(4,!1);0<g?Oa(5):Da(5,!1);0<h?Oa(6):Da(6,!1);0<m?Oa(7):Da(7,!1)},getNumberOfSamplesInAudioBuffer:Rb,clearAudioBuffer:Sb,setManualColorizationPalette:Nb,WASMBOY_MEMORY_LOCATION:0,WASMBOY_MEMORY_SIZE:cc,WASMBOY_WASM_PAGES:Mb,ASSEMBLYSCRIPT_MEMORY_LOCATION:0,ASSEMBLYSCRIPT_MEMORY_SIZE:1024,WASMBOY_STATE_LOCATION:1024,WASMBOY_STATE_SIZE:1024,GAMEBOY_INTERNAL_MEMORY_LOCATION:2048,
GAMEBOY_INTERNAL_MEMORY_SIZE:vc,VIDEO_RAM_LOCATION:2048,VIDEO_RAM_SIZE:16384,WORK_RAM_LOCATION:18432,WORK_RAM_SIZE:32768,OTHER_GAMEBOY_INTERNAL_MEMORY_LOCATION:51200,OTHER_GAMEBOY_INTERNAL_MEMORY_SIZE:16384,GRAPHICS_OUTPUT_LOCATION:wc,GRAPHICS_OUTPUT_SIZE:xc,GBC_PALETTE_LOCATION:Ua,GBC_PALETTE_SIZE:128,BG_PRIORITY_MAP_LOCATION:Va,BG_PRIORITY_MAP_SIZE:23552,FRAME_LOCATION:Za,FRAME_SIZE:93184,BACKGROUND_MAP_LOCATION:pb,BACKGROUND_MAP_SIZE:196608,TILE_DATA_LOCATION:Kb,TILE_DATA_SIZE:147456,OAM_TILES_LOCATION:qb,
OAM_TILES_SIZE:15360,AUDIO_BUFFER_LOCATION:lb,AUDIO_BUFFER_SIZE:131072,CHANNEL_1_BUFFER_LOCATION:vb,CHANNEL_1_BUFFER_SIZE:131072,CHANNEL_2_BUFFER_LOCATION:wb,CHANNEL_2_BUFFER_SIZE:131072,CHANNEL_3_BUFFER_LOCATION:xb,CHANNEL_3_BUFFER_SIZE:131072,CHANNEL_4_BUFFER_LOCATION:yb,CHANNEL_4_BUFFER_SIZE:131072,CARTRIDGE_RAM_LOCATION:Gb,CARTRIDGE_RAM_SIZE:131072,BOOT_ROM_LOCATION:nb,BOOT_ROM_SIZE:2560,CARTRIDGE_ROM_LOCATION:ob,CARTRIDGE_ROM_SIZE:8258560,DEBUG_GAMEBOY_MEMORY_LOCATION:Lb,DEBUG_GAMEBOY_MEMORY_SIZE:65535,
getWasmBoyOffsetFromGameBoyOffset:Fb,setProgramCounterBreakpoint:function(a){W.programCounter=a},resetProgramCounterBreakpoint:function(){W.programCounter=-1},setReadGbMemoryBreakpoint:function(a){W.readGbMemory=a},resetReadGbMemoryBreakpoint:function(){W.readGbMemory=-1},setWriteGbMemoryBreakpoint:function(a){W.writeGbMemory=a},resetWriteGbMemoryBreakpoint:function(){W.writeGbMemory=-1},getRegisterA:function(){return b.registerA},getRegisterB:function(){return b.registerB},getRegisterC:function(){return b.registerC},
getRegisterD:function(){return b.registerD},getRegisterE:function(){return b.registerE},getRegisterH:function(){return b.registerH},getRegisterL:function(){return b.registerL},getRegisterF:function(){return b.registerF},getProgramCounter:function(){return b.programCounter},getStackPointer:function(){return b.stackPointer},getOpcodeAtProgramCounter:function(){return t(b.programCounter)},getLY:function(){return q.scanlineRegister},drawBackgroundMapToWasmMemory:function(a){var c=q.memoryLocationTileDataSelectZeroStart;
y.bgWindowTileDataSelect&&(c=q.memoryLocationTileDataSelectOneStart);var d=q.memoryLocationTileMapSelectZeroStart;y.bgTileMapDisplaySelect&&(d=q.memoryLocationTileMapSelectOneStart);for(var e=0;256>e;e++)for(var h=0;256>h;h++){var m=e,l=h,n=d+32*(m>>3)+(l>>3),k=T(n,0);k=ab(c,k);var p=m%8;m=l%8;m=7-m;l=0;b.GBCEnabled&&0<a&&(l=T(n,1));g(6,l)&&(p=7-p);var t=0;g(3,l)&&(t=1);n=T(k+2*p,t);k=T(k+2*p+1,t);p=0;g(m,k)&&(p+=1,p<<=1);g(m,n)&&(p+=1);k=3*(256*e+h);b.GBCEnabled&&0<a?(n=hb(l&7,p,!1),l=pa(0,n),m=
pa(1,n),n=pa(2,n),k=pb+k,f[k]=l,f[k+1]=m,f[k+2]=n):(l=gb(p,q.memoryLocationBackgroundPalette),k=pb+k,f[k+0]=(l&16711680)>>16,f[k+1]=(l&65280)>>8,f[k+2]=l&255)}},drawTileDataToWasmMemory:function(){for(var a=0;23>a;a++)for(var c=0;31>c;c++){var d=0;15<c&&(d=1);var e=a;15<a&&(e-=15);e<<=4;e=15<c?e+(c-15):e+c;var f=q.memoryLocationTileDataSelectOneStart;15<a&&(f=q.memoryLocationTileDataSelectZeroStart);for(var l=q.memoryLocationBackgroundPalette,m=-1,h=-1,k=0;8>k;k++)for(var n=0;5>n;n++){var p=4*(8*
n+k),r=t(q.memoryLocationSpriteAttributesTable+p+2);e===r&&(p=t(q.memoryLocationSpriteAttributesTable+p+3),r=0,b.GBCEnabled&&g(3,p)&&(r=1),r===d&&(h=p,k=8,n=5,l=q.memoryLocationSpritePaletteOne,g(4,h)&&(l=q.memoryLocationSpritePaletteTwo)))}if(b.GBCEnabled&&0>h){k=q.memoryLocationTileMapSelectZeroStart;y.bgTileMapDisplaySelect&&(k=q.memoryLocationTileMapSelectOneStart);n=-1;for(p=0;32>p;p++)for(r=0;32>r;r++){var u=k+32*r+p,v=T(u,0);e===v&&(n=u,r=p=32)}0<=n&&(m=T(n,1))}for(k=0;8>k;k++)sb(e,f,d,0,7,
k,8*c,8*a+k,248,Kb,!1,l,m,h)}},drawOamToWasmMemory:function(){for(var a=0;8>a;a++)for(var c=0;5>c;c++){var d=4*(8*c+a);t(q.memoryLocationSpriteAttributesTable+d);t(q.memoryLocationSpriteAttributesTable+d+1);var e=t(q.memoryLocationSpriteAttributesTable+d+2),f=1;y.tallSpriteSize&&(1===e%2&&--e,f+=1);d=t(q.memoryLocationSpriteAttributesTable+d+3);var k=0;b.GBCEnabled&&g(3,d)&&(k=1);var l=q.memoryLocationSpritePaletteOne;g(4,d)&&(l=q.memoryLocationSpritePaletteTwo);for(var h=0;h<f;h++)for(var m=0;8>
m;m++)sb(e+h,q.memoryLocationTileDataSelectOneStart,k,0,7,m,8*a,16*c+m+8*h,64,qb,!1,l,-1,d)}},getDIV:function(){return n.dividerRegister},getTIMA:function(){return n.timerCounter},getTMA:function(){return n.timerModulo},getTAC:function(){var a=n.timerInputClock;n.timerEnabled&&(a|=4);return a},updateDebugGBMemory:function(){for(var a=0;65535>a;a++){var b=Cb(a);f[Lb+a]=b}W.reachedBreakpoint=!1}});return async()=>({instance:{exports:yc},byteMemory:fb.wasmByteMemory,type:"TypeScript"})});
//# sourceMappingURL=getWasmBoyTsCore.closure.umd.js.map
